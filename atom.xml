<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>æœ¨å­</title>
  <icon>https://blog.k8s.li/icon.png</icon>
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://blog.k8s.li/"/>
  <updated>2020-04-01T16:00:00.000Z</updated>
  <id>https://blog.k8s.li/</id>
  
  <author>
    <name>æœ¨å­</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>åŸºäº Gitlab-ci + Harobr çš„ CI æµæ°´çº¿</title>
    <link href="https://blog.k8s.li/gitlab-ci-harbor.html"/>
    <id>https://blog.k8s.li/gitlab-ci-harbor.html</id>
    <published>2020-04-01T16:00:00.000Z</published>
    <updated>2020-04-01T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>å¯¹äº CI/CDï¼ˆæŒç»­é›†æˆä¸æŒç»­äº¤ä»˜ï¼‰çš„åŸºæœ¬æ¦‚å¿µç½‘ç»œä¸Šå·²ç»æœ‰å¾ˆå¤šå¤§ä½¬åœ¨æ™®åŠå•¦ï¼Œå’±æ‰ç–å­¦æµ…æ€•è¯¯äººå­å¼Ÿæ‰€ä»¥å°±å‰½çªƒä¸€ä¸‹åˆ«äººçš„è§£é‡Šå•¦ğŸ˜‚ã€‚ä¸‹é¢å°±å‰½çªƒä¸€ä¸‹çº¢å¸½å­å®¶çš„ <a href="https://www.redhat.com/zh/topics/devops/what-is-ci-cd" target="_blank" rel="noopener">CI/CDæ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•ç†è§£æŒç»­é›†æˆã€æŒç»­äº¤ä»˜å’ŒæŒç»­éƒ¨ç½²</a> å®˜æ–¹æ–‡æ¡£ï¼š</p><p><strong>CI æŒç»­é›†æˆ</strong></p><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/409-images-for-snap-blog-postedit_image1.png" alt="Continuous integration puts the integration phase earlier in the development cycle"></p><p>å›¾ç‰‡å‰½çªƒè‡ª  <a href="https://www.mindtheproduct.com/what-the-hell-are-ci-cd-and-devops-a-cheatsheet-for-the-rest-of-us/" target="_blank" rel="noopener">The Product Managersâ€™ Guide to Continuous Delivery and DevOps</a></p><blockquote><p>CI/CD ä¸­çš„â€œCIâ€å§‹ç»ˆæŒ‡æŒç»­é›†æˆï¼Œå®ƒå±äºå¼€å‘äººå‘˜çš„è‡ªåŠ¨åŒ–æµç¨‹ã€‚æˆåŠŸçš„ CI æ„å‘³ç€åº”ç”¨ä»£ç çš„æ–°æ›´æ”¹ä¼šå®šæœŸæ„å»ºã€æµ‹è¯•å¹¶åˆå¹¶åˆ°å…±äº«å­˜å‚¨åº“ä¸­ã€‚è¯¥è§£å†³æ–¹æ¡ˆå¯ä»¥è§£å†³åœ¨ä¸€æ¬¡å¼€å‘ä¸­æœ‰å¤ªå¤šåº”ç”¨åˆ†æ”¯ï¼Œä»è€Œå¯¼è‡´ç›¸äº’å†²çªçš„é—®é¢˜ã€‚</p></blockquote><p><strong>CD æŒç»­äº¤ä»˜</strong></p><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/409-images-for-snap-blog-postedit_image4-manual.png" alt="Continuous Delivery is a software development discipline "></p><p>å›¾ç‰‡å‰½çªƒè‡ª <a href="https://www.mindtheproduct.com/what-the-hell-are-ci-cd-and-devops-a-cheatsheet-for-the-rest-of-us/" target="_blank" rel="noopener">The Product Managersâ€™ Guide to Continuous Delivery and DevOps</a></p><blockquote><p>CI/CD ä¸­çš„â€œCDâ€æŒ‡çš„æ˜¯æŒç»­äº¤ä»˜å’Œ/æˆ–æŒç»­éƒ¨ç½²ï¼Œè¿™äº›ç›¸å…³æ¦‚å¿µæœ‰æ—¶ä¼šäº¤å‰ä½¿ç”¨ã€‚ä¸¤è€…éƒ½äº‹å…³ç®¡é“åç»­é˜¶æ®µçš„è‡ªåŠ¨åŒ–ï¼Œä½†å®ƒä»¬æœ‰æ—¶ä¹Ÿä¼šå•ç‹¬ä½¿ç”¨ï¼Œç”¨äºè¯´æ˜è‡ªåŠ¨åŒ–ç¨‹åº¦ã€‚</p><p>æŒç»­<em>äº¤ä»˜</em>é€šå¸¸æ˜¯æŒ‡å¼€å‘äººå‘˜å¯¹åº”ç”¨çš„æ›´æ”¹ä¼šè‡ªåŠ¨è¿›è¡Œé”™è¯¯æµ‹è¯•å¹¶ä¸Šä¼ åˆ°å­˜å‚¨åº“ï¼ˆå¦‚ <a href="https://redhatofficial.github.io/#!/main" target="_blank" rel="noopener">GitHub</a> æˆ–å®¹å™¨æ³¨å†Œè¡¨ï¼‰ï¼Œç„¶åç”±è¿ç»´å›¢é˜Ÿå°†å…¶éƒ¨ç½²åˆ°å®æ—¶ç”Ÿäº§ç¯å¢ƒä¸­ã€‚è¿™æ—¨åœ¨è§£å†³å¼€å‘å’Œè¿ç»´å›¢é˜Ÿä¹‹é—´å¯è§æ€§åŠæ²Ÿé€šè¾ƒå·®çš„é—®é¢˜ã€‚å› æ­¤ï¼ŒæŒç»­äº¤ä»˜çš„ç›®çš„å°±æ˜¯ç¡®ä¿å°½å¯èƒ½å‡å°‘éƒ¨ç½²æ–°ä»£ç æ—¶æ‰€éœ€çš„å·¥ä½œé‡ã€‚</p></blockquote><p><strong>æŒç»­éƒ¨ç½²</strong></p><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/409-images-for-snap-blog-postedit_image4-manual-1585574252795.png" alt="Continuous Delivery is a software development discipline "></p><p>å›¾ç‰‡å‰½çªƒè‡ª  <a href="https://www.mindtheproduct.com/what-the-hell-are-ci-cd-and-devops-a-cheatsheet-for-the-rest-of-us/" target="_blank" rel="noopener">The Product Managersâ€™ Guide to Continuous Delivery and DevOps</a></p><blockquote><p>æŒç»­<em>éƒ¨ç½²</em>ï¼ˆå¦ä¸€ç§â€œCDâ€ï¼‰æŒ‡çš„æ˜¯è‡ªåŠ¨å°†å¼€å‘äººå‘˜çš„æ›´æ”¹ä»å­˜å‚¨åº“å‘å¸ƒåˆ°ç”Ÿäº§ç¯å¢ƒï¼Œä»¥ä¾›å®¢æˆ·ä½¿ç”¨ã€‚å®ƒä¸»è¦ä¸ºäº†è§£å†³å› æ‰‹åŠ¨æµç¨‹é™ä½åº”ç”¨äº¤ä»˜é€Ÿåº¦ï¼Œä»è€Œä½¿è¿ç»´å›¢é˜Ÿè¶…è´Ÿè·çš„é—®é¢˜ã€‚æŒç»­éƒ¨ç½²ä»¥æŒç»­äº¤ä»˜çš„ä¼˜åŠ¿ä¸ºæ ¹åŸºï¼Œå®ç°äº†ç®¡é“åç»­é˜¶æ®µçš„è‡ªåŠ¨åŒ–ã€‚</p></blockquote><p>æ€»ä¹‹è€Œè¨€  CI/CD æ˜¯ä¸€æ•´å¥—è½¯ä»¶å¼€å‘çš„æµæ°´çº¿ï¼Œå¼€å‘äººå‘˜æäº¤å®Œæ›´æ–°çš„ä»£ç ä¹‹åï¼Œæ ¹æ®æµæ°´çº¿çš„è§¦å‘æƒ…å†µæ¥æ‰§è¡Œè‡ªå®šä¹‰çš„æµæ°´çº¿ä»»åŠ¡ï¼Œæ¯”å¦‚ä»£ç è´¨é‡æ£€æµ‹ã€æ„å»º docker é•œåƒä¸ºäº¤ä»˜äº§å“ã€è‡ªåŠ¨åŒ–éƒ¨ç½²åˆ°æµ‹è¯•ç¯å¢ƒæˆ–ç”Ÿäº§ç¯å¢ƒç­‰ç­‰ã€‚è¿™äº›éœ€è¦ä¸€ç³»åˆ—ç›¸å…³çš„è½¯ä»¶æ¥æ„å»ºè¿™å¥— CI/CD çš„ç³»ç»Ÿï¼Œæœ¬æ–‡å°±é€šè¿‡ Gitlab + gitlab-ci + Harbor æ„å»ºä¸€ä¸ªç®€é™‹çš„ CI/CD æµæ°´çº¿ã€‚</p><p>å¦å¤–æ¨èè¯»ä¸€ä¸‹è¿™ç¯‡ <a href="https://www.mindtheproduct.com/what-the-hell-are-ci-cd-and-devops-a-cheatsheet-for-the-rest-of-us/" target="_blank" rel="noopener">The Product Managersâ€™ Guide to Continuous Delivery and DevOps </a></p><h2 id="Gitlab"><a href="#Gitlab" class="headerlink" title="Gitlab"></a>Gitlab</h2><p>ç›®å‰ Gitlab å®˜æ–¹ç»™å‡ºçš„å®‰è£…æ–¹å¼æœ‰å¾ˆå¤šç§ï¼Œæ™®éé‡‡ç”¨ Omnibus åŒ…ã€Docker å®‰è£…ã€‚ä¹Ÿå¯ä»¥ç”¨å®˜æ–¹çš„ helm Chart éƒ¨ç½²åœ¨ Kubernenets é›†ç¾¤ä¸­ï¼Œç„¶åä½¿ç”¨ç½‘ç»œå­˜å‚¨ï¼Œæ¯”å¦‚ Glusterã€NFSã€Cephã€vSAN ç­‰è¿›è¡Œ PG æ•°æ®åº“å’Œä»£ç ä»“åº“æŒä¹…åŒ–å­˜å‚¨ã€‚</p><p><strong>å®˜æ–¹å»ºè®®é‡‡ç”¨ Omnibus æ–¹å¼å®‰è£…ï¼š</strong></p><blockquote><p>æˆ‘ä»¬å¼ºçƒˆå»ºè®®ä½¿ç”¨ Omnibus åŒ…å®‰è£… GitLab ï¼Œå› ä¸ºå®ƒå®‰è£…èµ·æ¥æ›´å¿«ã€æ›´å®¹æ˜“å‡çº§ç‰ˆæœ¬ï¼Œè€Œä¸”åŒ…å«äº†å…¶ä»–å®‰è£…æ–¹å¼æ‰€æ²¡æœ‰çš„å¯é æ€§åŠŸèƒ½ã€‚</p></blockquote><h3 id="Omnibus-åŒ…å®‰è£…æ–¹å¼æ¯”è¾ƒ"><a href="#Omnibus-åŒ…å®‰è£…æ–¹å¼æ¯”è¾ƒ" class="headerlink" title="Omnibus åŒ…å®‰è£…æ–¹å¼æ¯”è¾ƒ"></a>Omnibus åŒ…å®‰è£…æ–¹å¼æ¯”è¾ƒ</h3><p>æ‘˜è‡ªå®˜æ–¹æ–‡æ¡£</p><ul><li>âœ… - Installed by default</li><li>âš™ - Requires additional configuration, or GitLab Managed Apps</li><li>â¤“ - Manual installation required</li><li>âŒ - Not supported or no instructions available</li><li>N/A - Not applicable</li></ul><table><thead><tr><th align="left">Component</th><th align="left">Description</th><th align="center"><a href="https://docs.gitlab.com/omnibus/" target="_blank" rel="noopener">Omnibus GitLab</a></th><th align="center"><a href="https://docs.gitlab.com/charts/" target="_blank" rel="noopener">GitLab chart</a></th><th align="center"><a href="https://gitlab.com/" target="_blank" rel="noopener">GitLab.com</a></th></tr></thead><tbody><tr><td align="left"><a href="https://docs.gitlab.com/ee/development/architecture.html#nginx" target="_blank" rel="noopener">NGINX</a></td><td align="left">Routes requests to appropriate components, terminates SSL</td><td align="center"><a href="https://docs.gitlab.com/omnibus/settings/" target="_blank" rel="noopener">âœ…</a></td><td align="center"><a href="https://docs.gitlab.com/charts/charts/nginx/" target="_blank" rel="noopener">âœ…</a></td><td align="center"><a href="https://about.gitlab.com/handbook/engineering/infrastructure/production/architecture/#service-architecture" target="_blank" rel="noopener">âœ…</a></td></tr><tr><td align="left"><a href="https://docs.gitlab.com/ee/development/architecture.html#unicorn" target="_blank" rel="noopener">Unicorn (GitLab Rails)</a></td><td align="left">Handles requests for the web interface and API</td><td align="center"><a href="https://docs.gitlab.com/omnibus/settings/unicorn.html" target="_blank" rel="noopener">âœ…</a></td><td align="center"><a href="https://docs.gitlab.com/charts/charts/gitlab/unicorn/" target="_blank" rel="noopener">âœ…</a></td><td align="center"><a href="https://docs.gitlab.com/ee/user/gitlab_com/index.html#unicorn" target="_blank" rel="noopener">âœ…</a></td></tr><tr><td align="left"><a href="https://docs.gitlab.com/ee/development/architecture.html#sidekiq" target="_blank" rel="noopener">Sidekiq</a></td><td align="left">Background jobs processor</td><td align="center"><a href="https://gitlab.com/gitlab-org/omnibus-gitlab/blob/master/files/gitlab-config-template/gitlab.rb.template" target="_blank" rel="noopener">âœ…</a></td><td align="center"><a href="https://docs.gitlab.com/charts/charts/gitlab/sidekiq/" target="_blank" rel="noopener">âœ…</a></td><td align="center"><a href="https://docs.gitlab.com/ee/user/gitlab_com/index.html#sidekiq" target="_blank" rel="noopener">âœ…</a></td></tr><tr><td align="left"><a href="https://docs.gitlab.com/ee/development/architecture.html#gitaly" target="_blank" rel="noopener">Gitaly</a></td><td align="left">Git RPC service for handling all Git calls made by GitLab</td><td align="center"><a href="https://docs.gitlab.com/ee/administration/gitaly/index.html" target="_blank" rel="noopener">âœ…</a></td><td align="center"><a href="https://docs.gitlab.com/charts/charts/gitlab/gitaly/" target="_blank" rel="noopener">âœ…</a></td><td align="center"><a href="https://about.gitlab.com/handbook/engineering/infrastructure/production/architecture/#service-architecture" target="_blank" rel="noopener">âœ…</a></td></tr><tr><td align="left"><a href="https://docs.gitlab.com/ee/development/architecture.html#praefect" target="_blank" rel="noopener">Praefect</a></td><td align="left">A transparent proxy between any Git client and Gitaly storage nodes.</td><td align="center"><a href="https://docs.gitlab.com/ee/administration/gitaly/index.html" target="_blank" rel="noopener">âœ…</a></td><td align="center"><a href="https://docs.gitlab.com/charts/charts/gitlab/gitaly/" target="_blank" rel="noopener">âŒ</a></td><td align="center"><a href="https://about.gitlab.com/handbook/engineering/infrastructure/production/architecture/#service-architecture" target="_blank" rel="noopener">âœ…</a></td></tr><tr><td align="left"><a href="https://docs.gitlab.com/ee/development/architecture.html#gitlab-workhorse" target="_blank" rel="noopener">GitLab Workhorse</a></td><td align="left">Smart reverse proxy, handles large HTTP requests</td><td align="center"><a href="https://gitlab.com/gitlab-org/omnibus-gitlab/blob/master/files/gitlab-config-template/gitlab.rb.template" target="_blank" rel="noopener">âœ…</a></td><td align="center"><a href="https://docs.gitlab.com/charts/charts/gitlab/unicorn/" target="_blank" rel="noopener">âœ…</a></td><td align="center"><a href="https://about.gitlab.com/handbook/engineering/infrastructure/production/architecture/#service-architecture" target="_blank" rel="noopener">âœ…</a></td></tr><tr><td align="left"><a href="https://docs.gitlab.com/ee/development/architecture.html#gitlab-shell" target="_blank" rel="noopener">GitLab Shell</a></td><td align="left">Handles <code>git</code> over SSH sessions</td><td align="center"><a href="https://gitlab.com/gitlab-org/omnibus-gitlab/blob/master/files/gitlab-config-template/gitlab.rb.template" target="_blank" rel="noopener">âœ…</a></td><td align="center"><a href="https://docs.gitlab.com/charts/charts/gitlab/gitlab-shell/" target="_blank" rel="noopener">âœ…</a></td><td align="center"><a href="https://about.gitlab.com/handbook/engineering/infrastructure/production/architecture/#service-architecture" target="_blank" rel="noopener">âœ…</a></td></tr><tr><td align="left"><a href="https://docs.gitlab.com/ee/development/architecture.html#gitlab-pages" target="_blank" rel="noopener">GitLab Pages</a></td><td align="left">Hosts static websites</td><td align="center"><a href="https://docs.gitlab.com/ee/administration/pages/index.html" target="_blank" rel="noopener">âš™</a></td><td align="center"><a href="https://gitlab.com/gitlab-org/charts/gitlab/issues/37" target="_blank" rel="noopener">âŒ</a></td><td align="center"><a href="https://docs.gitlab.com/ee/user/gitlab_com/index.html#gitlab-pages" target="_blank" rel="noopener">âœ…</a></td></tr><tr><td align="left"><a href="https://docs.gitlab.com/ee/development/architecture.html#registry" target="_blank" rel="noopener">Registry</a></td><td align="left">Container registry, allows pushing and pulling of images</td><td align="center"><a href="https://docs.gitlab.com/ee/administration/packages/container_registry.html#container-registry-domain-configuration" target="_blank" rel="noopener">âš™</a></td><td align="center"><a href="https://docs.gitlab.com/charts/charts/registry/" target="_blank" rel="noopener">âœ…</a></td><td align="center"><a href="https://docs.gitlab.com/ee/user/packages/container_registry/index.html#build-and-push-images-using-gitlab-cicd" target="_blank" rel="noopener">âœ…</a></td></tr><tr><td align="left"><a href="https://docs.gitlab.com/ee/development/architecture.html#redis" target="_blank" rel="noopener">Redis</a></td><td align="left">Caching service</td><td align="center"><a href="https://docs.gitlab.com/omnibus/settings/redis.html" target="_blank" rel="noopener">âœ…</a></td><td align="center"><a href="https://docs.gitlab.com/omnibus/settings/redis.html" target="_blank" rel="noopener">âœ…</a></td><td align="center"><a href="https://about.gitlab.com/handbook/engineering/infrastructure/production/architecture/#service-architecture" target="_blank" rel="noopener">âœ…</a></td></tr><tr><td align="left"><a href="https://docs.gitlab.com/ee/development/architecture.html#postgresql" target="_blank" rel="noopener">PostgreSQL</a></td><td align="left">Database</td><td align="center"><a href="https://docs.gitlab.com/omnibus/settings/database.html" target="_blank" rel="noopener">âœ…</a></td><td align="center"><a href="https://github.com/helm/charts/tree/master/stable/postgresql" target="_blank" rel="noopener">âœ…</a></td><td align="center"><a href="https://docs.gitlab.com/ee/user/gitlab_com/index.html#postgresql" target="_blank" rel="noopener">âœ…</a></td></tr><tr><td align="left"><a href="https://docs.gitlab.com/ee/development/architecture.html#pgbouncer" target="_blank" rel="noopener">PgBouncer</a></td><td align="left">Database connection pooling, failover</td><td align="center"><a href="https://docs.gitlab.com/ee/administration/high_availability/pgbouncer.html" target="_blank" rel="noopener">âš™</a></td><td align="center"><a href="https://docs.gitlab.com/charts/installation/deployment.html#postgresql" target="_blank" rel="noopener">âŒ</a></td><td align="center"><a href="https://about.gitlab.com/handbook/engineering/infrastructure/production/architecture/#database-architecture" target="_blank" rel="noopener">âœ…</a></td></tr><tr><td align="left"><a href="https://docs.gitlab.com/ee/development/architecture.html#consul" target="_blank" rel="noopener">Consul</a></td><td align="left">Database node discovery, failover</td><td align="center"><a href="https://docs.gitlab.com/ee/administration/high_availability/consul.html" target="_blank" rel="noopener">âš™</a></td><td align="center"><a href="https://docs.gitlab.com/charts/installation/deployment.html#postgresql" target="_blank" rel="noopener">âŒ</a></td><td align="center"><a href="https://docs.gitlab.com/ee/user/gitlab_com/index.html#consul" target="_blank" rel="noopener">âœ…</a></td></tr><tr><td align="left"><a href="https://docs.gitlab.com/ee/development/architecture.html#prometheus" target="_blank" rel="noopener">GitLab self-monitoring: Prometheus</a></td><td align="left">Time-series database, metrics collection, and query service</td><td align="center"><a href="https://docs.gitlab.com/ee/administration/monitoring/prometheus/index.html" target="_blank" rel="noopener">âœ…</a></td><td align="center"><a href="https://github.com/helm/charts/tree/master/stable/prometheus" target="_blank" rel="noopener">âœ…</a></td><td align="center"><a href="https://docs.gitlab.com/ee/user/gitlab_com/index.html#prometheus" target="_blank" rel="noopener">âœ…</a></td></tr><tr><td align="left"><a href="https://docs.gitlab.com/ee/development/architecture.html#alertmanager" target="_blank" rel="noopener">GitLab self-monitoring: Alertmanager</a></td><td align="left">Deduplicates, groups, and routes alerts from Prometheus</td><td align="center"><a href="https://gitlab.com/gitlab-org/omnibus-gitlab/blob/master/files/gitlab-config-template/gitlab.rb.template" target="_blank" rel="noopener">âš™</a></td><td align="center"><a href="https://github.com/helm/charts/tree/master/stable/prometheus" target="_blank" rel="noopener">âœ…</a></td><td align="center"><a href="https://about.gitlab.com/handbook/engineering/monitoring/" target="_blank" rel="noopener">âœ…</a></td></tr><tr><td align="left"><a href="https://docs.gitlab.com/ee/development/architecture.html#grafana" target="_blank" rel="noopener">GitLab self-monitoring: Grafana</a></td><td align="left">Metrics dashboard</td><td align="center"><a href="https://docs.gitlab.com/ee/administration/monitoring/performance/grafana_configuration.html" target="_blank" rel="noopener">âœ…</a></td><td align="center"><a href="https://github.com/helm/charts/tree/master/stable/grafana" target="_blank" rel="noopener">â¤“</a></td><td align="center"><a href="https://dashboards.gitlab.com/d/RZmbBr7mk/gitlab-triage?refresh=30s" target="_blank" rel="noopener">âœ…</a></td></tr><tr><td align="left"><a href="https://docs.gitlab.com/ee/development/architecture.html#sentry" target="_blank" rel="noopener">GitLab self-monitoring: Sentry</a></td><td align="left">Track errors generated by the GitLab instance</td><td align="center"><a href="https://docs.gitlab.com/omnibus/settings/configuration.html#error-reporting-and-logging-with-sentry" target="_blank" rel="noopener">â¤“</a></td><td align="center"><a href="https://gitlab.com/gitlab-org/charts/gitlab/issues/1319" target="_blank" rel="noopener">âŒ</a></td><td align="center"><a href="https://about.gitlab.com/handbook/support/workflows/500_errors.html#searching-sentry" target="_blank" rel="noopener">âœ…</a></td></tr><tr><td align="left"><a href="https://docs.gitlab.com/ee/development/architecture.html#jaeger" target="_blank" rel="noopener">GitLab self-monitoring: Jaeger</a></td><td align="left">View traces generated by the GitLab instance</td><td align="center"><a href="https://gitlab.com/gitlab-org/omnibus-gitlab/issues/4104" target="_blank" rel="noopener">âŒ</a></td><td align="center"><a href="https://gitlab.com/gitlab-org/charts/gitlab/issues/1320" target="_blank" rel="noopener">âŒ</a></td><td align="center"><a href="https://gitlab.com/gitlab-org/omnibus-gitlab/issues/4104" target="_blank" rel="noopener">âŒ</a></td></tr><tr><td align="left"><a href="https://docs.gitlab.com/ee/development/architecture.html#redis-exporter" target="_blank" rel="noopener">Redis Exporter</a></td><td align="left">Prometheus endpoint with Redis metrics</td><td align="center"><a href="https://docs.gitlab.com/ee/administration/monitoring/prometheus/redis_exporter.html" target="_blank" rel="noopener">âœ…</a></td><td align="center"><a href="https://docs.gitlab.com/charts/charts/redis/" target="_blank" rel="noopener">âœ…</a></td><td align="center"><a href="https://about.gitlab.com/handbook/engineering/monitoring/" target="_blank" rel="noopener">âœ…</a></td></tr><tr><td align="left"><a href="https://docs.gitlab.com/ee/development/architecture.html#postgresql-exporter" target="_blank" rel="noopener">PostgreSQL Exporter</a></td><td align="left">Prometheus endpoint with PostgreSQL metrics</td><td align="center"><a href="https://docs.gitlab.com/ee/administration/monitoring/prometheus/postgres_exporter.html" target="_blank" rel="noopener">âœ…</a></td><td align="center"><a href="https://github.com/helm/charts/tree/master/stable/postgresql" target="_blank" rel="noopener">âœ…</a></td><td align="center"><a href="https://about.gitlab.com/handbook/engineering/monitoring/" target="_blank" rel="noopener">âœ…</a></td></tr><tr><td align="left"><a href="https://docs.gitlab.com/ee/development/architecture.html#pgbouncer-exporter" target="_blank" rel="noopener">PgBouncer Exporter</a></td><td align="left">Prometheus endpoint with PgBouncer metrics</td><td align="center"><a href="https://docs.gitlab.com/ee/administration/monitoring/prometheus/pgbouncer_exporter.html" target="_blank" rel="noopener">âš™</a></td><td align="center"><a href="https://docs.gitlab.com/charts/installation/deployment.html#postgresql" target="_blank" rel="noopener">âŒ</a></td><td align="center"><a href="https://about.gitlab.com/handbook/engineering/monitoring/" target="_blank" rel="noopener">âœ…</a></td></tr><tr><td align="left"><a href="https://docs.gitlab.com/ee/development/architecture.html#gitlab-exporter" target="_blank" rel="noopener">GitLab Exporter</a></td><td align="left">Generates a variety of GitLab metrics</td><td align="center"><a href="https://docs.gitlab.com/ee/administration/monitoring/prometheus/gitlab_exporter.html" target="_blank" rel="noopener">âœ…</a></td><td align="center"><a href="https://docs.gitlab.com/charts/charts/gitlab/gitlab-exporter/index.html" target="_blank" rel="noopener">âœ…</a></td><td align="center"><a href="https://about.gitlab.com/handbook/engineering/monitoring/" target="_blank" rel="noopener">âœ…</a></td></tr><tr><td align="left"><a href="https://docs.gitlab.com/ee/development/architecture.html#node-exporter" target="_blank" rel="noopener">Node Exporter</a></td><td align="left">Prometheus endpoint with system metrics</td><td align="center"><a href="https://docs.gitlab.com/ee/administration/monitoring/prometheus/node_exporter.html" target="_blank" rel="noopener">âœ…</a></td><td align="center"><a href="https://gitlab.com/gitlab-org/charts/gitlab/issues/1332" target="_blank" rel="noopener">N/A</a></td><td align="center"><a href="https://about.gitlab.com/handbook/engineering/monitoring/" target="_blank" rel="noopener">âœ…</a></td></tr><tr><td align="left"><a href="https://docs.gitlab.com/ee/development/architecture.html#mattermost" target="_blank" rel="noopener">Mattermost</a></td><td align="left">Open-source Slack alternative</td><td align="center"><a href="https://docs.gitlab.com/omnibus/gitlab-mattermost/" target="_blank" rel="noopener">âš™</a></td><td align="center"><a href="https://docs.mattermost.com/install/install-mmte-helm-gitlab-helm.html" target="_blank" rel="noopener">â¤“</a></td><td align="center"><a href="https://docs.gitlab.com/ee/user/project/integrations/mattermost.html" target="_blank" rel="noopener">â¤“</a></td></tr><tr><td align="left"><a href="https://docs.gitlab.com/ee/development/architecture.html#minio" target="_blank" rel="noopener">MinIO</a></td><td align="left">Object storage service</td><td align="center"><a href="https://min.io/download" target="_blank" rel="noopener">â¤“</a></td><td align="center"><a href="https://docs.gitlab.com/charts/charts/minio/" target="_blank" rel="noopener">âœ…</a></td><td align="center"><a href="https://about.gitlab.com/handbook/engineering/infrastructure/production/architecture/#storage-architecture" target="_blank" rel="noopener">âœ…</a></td></tr><tr><td align="left"><a href="https://docs.gitlab.com/ee/development/architecture.html#gitlab-runner" target="_blank" rel="noopener">Runner</a></td><td align="left">Executes GitLab CI/CD jobs</td><td align="center"><a href="https://docs.gitlab.com/runner/" target="_blank" rel="noopener">â¤“</a></td><td align="center"><a href="https://docs.gitlab.com/runner/install/kubernetes.html" target="_blank" rel="noopener">âœ…</a></td><td align="center"><a href="https://docs.gitlab.com/ee/user/gitlab_com/index.html#shared-runners" target="_blank" rel="noopener">âœ…</a></td></tr><tr><td align="left"><a href="https://docs.gitlab.com/ee/development/architecture.html#database-migrations" target="_blank" rel="noopener">Database Migrations</a></td><td align="left">Database migrations</td><td align="center"><a href="https://docs.gitlab.com/omnibus/settings/database.html#disabling-automatic-database-migration" target="_blank" rel="noopener">âœ…</a></td><td align="center"><a href="https://docs.gitlab.com/charts/charts/gitlab/migrations/" target="_blank" rel="noopener">âœ…</a></td><td align="center">âœ…</td></tr><tr><td align="left"><a href="https://docs.gitlab.com/ee/development/architecture.html#certificate-management" target="_blank" rel="noopener">Certificate Management</a></td><td align="left">TLS Settings, Letâ€™s Encrypt</td><td align="center"><a href="https://docs.gitlab.com/omnibus/settings/ssl.html" target="_blank" rel="noopener">âœ…</a></td><td align="center"><a href="https://docs.gitlab.com/charts/installation/tls.html" target="_blank" rel="noopener">âœ…</a></td><td align="center"><a href="https://about.gitlab.com/handbook/engineering/infrastructure/production/architecture/#secrets-management" target="_blank" rel="noopener">âœ…</a></td></tr><tr><td align="left"><a href="https://docs.gitlab.com/ee/development/architecture.html#gitlab-geo" target="_blank" rel="noopener">GitLab Geo Node</a></td><td align="left">Geographically distributed GitLab nodes</td><td align="center"><a href="https://docs.gitlab.com/ee/administration/geo/replication/index.html#setup-instructions" target="_blank" rel="noopener">âš™</a></td><td align="center"><a href="https://gitlab.com/gitlab-org/charts/gitlab/issues/8" target="_blank" rel="noopener">âŒ</a></td><td align="center">âœ…</td></tr><tr><td align="left"><a href="https://docs.gitlab.com/ee/development/architecture.html#ldap-authentication" target="_blank" rel="noopener">LDAP Authentication</a></td><td align="left">Authenticate users against centralized LDAP directory</td><td align="center"><a href="https://docs.gitlab.com/ee/administration/auth/ldap.html" target="_blank" rel="noopener">â¤“</a></td><td align="center"><a href="https://docs.gitlab.com/charts/charts/globals.html#ldap" target="_blank" rel="noopener">â¤“</a></td><td align="center"><a href="https://about.gitlab.com/pricing/#gitlab-com" target="_blank" rel="noopener">âŒ</a></td></tr><tr><td align="left"><a href="https://docs.gitlab.com/ee/development/architecture.html#outbound-email" target="_blank" rel="noopener">Outbound email (SMTP)</a></td><td align="left">Send email messages to users</td><td align="center"><a href="https://docs.gitlab.com/omnibus/settings/smtp.html" target="_blank" rel="noopener">â¤“</a></td><td align="center"><a href="https://docs.gitlab.com/charts/installation/command-line-options.html#outgoing-email-configuration" target="_blank" rel="noopener">â¤“</a></td><td align="center"><a href="https://docs.gitlab.com/ee/user/gitlab_com/index.html#mail-configuration" target="_blank" rel="noopener">âœ…</a></td></tr><tr><td align="left"><a href="https://docs.gitlab.com/ee/development/architecture.html#inbound-email" target="_blank" rel="noopener">Inbound email (SMTP)</a></td><td align="left">Receive messages to update issues</td><td align="center"><a href="https://docs.gitlab.com/ee/administration/incoming_email.html" target="_blank" rel="noopener">â¤“</a></td><td align="center"><a href="https://docs.gitlab.com/charts/installation/command-line-options.html#incoming-email-configuration" target="_blank" rel="noopener">â¤“</a></td><td align="center"><a href="https://docs.gitlab.com/ee/user/gitlab_com/index.html#mail-configuration" target="_blank" rel="noopener">âœ…</a></td></tr><tr><td align="left"><a href="https://docs.gitlab.com/ee/development/architecture.html#elasticsearch" target="_blank" rel="noopener">Elasticsearch</a></td><td align="left">Improved search within GitLab</td><td align="center"><a href="https://docs.gitlab.com/ee/integration/elasticsearch.html" target="_blank" rel="noopener">â¤“</a></td><td align="center"><a href="https://docs.gitlab.com/ee/integration/elasticsearch.html" target="_blank" rel="noopener">â¤“</a></td><td align="center"><a href="https://gitlab.com/groups/gitlab-org/-/epics/153" target="_blank" rel="noopener">âŒ</a></td></tr><tr><td align="left"><a href="https://docs.gitlab.com/ee/development/architecture.html#sentry" target="_blank" rel="noopener">Sentry integration</a></td><td align="left">Error tracking for deployed apps</td><td align="center"><a href="https://docs.gitlab.com/ee/user/project/operations/error_tracking.html" target="_blank" rel="noopener">â¤“</a></td><td align="center"><a href="https://docs.gitlab.com/ee/user/project/operations/error_tracking.html" target="_blank" rel="noopener">â¤“</a></td><td align="center"><a href="https://docs.gitlab.com/ee/user/project/operations/error_tracking.html" target="_blank" rel="noopener">â¤“</a></td></tr><tr><td align="left"><a href="https://docs.gitlab.com/ee/development/architecture.html#jaeger" target="_blank" rel="noopener">Jaeger integration</a></td><td align="left">Distributed tracing for deployed apps</td><td align="center"><a href="https://docs.gitlab.com/ee/user/project/operations/tracing.html" target="_blank" rel="noopener">â¤“</a></td><td align="center"><a href="https://docs.gitlab.com/ee/user/project/operations/tracing.html" target="_blank" rel="noopener">â¤“</a></td><td align="center"><a href="https://docs.gitlab.com/ee/user/project/operations/tracing.html" target="_blank" rel="noopener">â¤“</a></td></tr><tr><td align="left"><a href="https://docs.gitlab.com/ee/development/architecture.html#gitlab-managed-apps" target="_blank" rel="noopener">GitLab Managed Apps</a></td><td align="left">Deploy <a href="https://helm.sh/docs/" target="_blank" rel="noopener">Helm</a>, <a href="https://kubernetes.io/docs/concepts/services-networking/ingress/" target="_blank" rel="noopener">Ingress</a>, <a href="https://docs.cert-manager.io/en/latest/" target="_blank" rel="noopener">Cert-Manager</a>, <a href="https://prometheus.io/docs/introduction/overview/" target="_blank" rel="noopener">Prometheus</a>, a <a href="https://docs.gitlab.com/runner/" target="_blank" rel="noopener">Runner</a>, <a href="https://jupyter.org/" target="_blank" rel="noopener">JupyterHub</a>, <a href="https://cloud.google.com/knative/" target="_blank" rel="noopener">Knative</a> to a cluster</td><td align="center"><a href="https://docs.gitlab.com/ee/user/project/clusters/index.html#installing-applications" target="_blank" rel="noopener">â¤“</a></td><td align="center"><a href="https://docs.gitlab.com/ee/user/project/clusters/index.html#installing-applications" target="_blank" rel="noopener">â¤“</a></td><td align="center"><a href="https://docs.gitlab.com/ee/user/project/clusters/index.html#installing-applications" target="_blank" rel="noopener">â¤“</a></td></tr></tbody></table><h2 id="å®‰è£…-Gitlab"><a href="#å®‰è£…-Gitlab" class="headerlink" title="å®‰è£… Gitlab"></a>å®‰è£… Gitlab</h2><p>å’±éµä»å®˜æ–¹çš„å»ºè®®ï¼Œä½¿ç”¨ Omnibus åŒ…çš„æ–¹å¼æ¥éƒ¨ç½² Gitlab å®ä¾‹ã€‚</p><h3 id="Ubuntu-1804"><a href="#Ubuntu-1804" class="headerlink" title="Ubuntu 1804"></a>Ubuntu 1804</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install openssh-server</span><br><span class="line">curl https://packages.gitlab.com/gpg.key 2&gt; /dev/null | sudo apt-key add - &amp;&gt;/dev/null</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ æ¸…åå¤§å­¦çš„é•œåƒç«™æº bionicæ˜¯ Ubuntu18.04 xenialæ˜¯16.04ï¼Œæ ¹æ®è‡ªå·±çš„ Ubuntu å‘è¡Œç‰ˆæœ¬ä¿®æ”¹ä¸€ä¸‹ä¸‹</span></span><br><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/gitlab-ce/ubuntu bionic main</span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install gitlab-ce</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¹Ÿå¯ä»¥è€ƒè™‘ä½¿ç”¨ wget çš„æ–¹å¼æŠŠ deb åŒ…ä¸‹è½½ä¸‹æ¥</span></span><br><span class="line">wget https://mirrors.tuna.tsinghua.edu.cn/gitlab-ce/ubuntu/pool/bionic/main/g/gitlab-ce/gitlab-ce_12.3.5-ce.0_amd64.deb</span><br><span class="line"></span><br><span class="line">opkg -i gitlab-ce/gitlab-ce_12.3.5-ce.0_amd64.deb</span><br></pre></td></tr></table></figure><h3 id="CentOS7"><a href="#CentOS7" class="headerlink" title="CentOS7"></a>CentOS7</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®‰è£…ä¾èµ–</span></span><br><span class="line">sudo yum install -y curl policycoreutils-python openssh-server</span><br><span class="line"></span><br><span class="line"><span class="comment"># é…ç½®é˜²ç«å¢™</span></span><br><span class="line">sudo firewall-cmd --permanent --add-service=http</span><br><span class="line">sudo systemctl reload firewalld</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨æ¸…åå¤§å­¦é•œåƒç«™çš„æºï¼Œä¸‹è½½é€Ÿåº¦ä¼šå¿«äº›ã€‚</span></span><br><span class="line">sudo cat &gt; /etc/yum.repos.d/gitlab-ce.repo &lt;&lt;EOF</span><br><span class="line">[gitlab-ce]</span><br><span class="line">name=Gitlab CE Repository</span><br><span class="line">baseurl=https://mirrors.tuna.tsinghua.edu.cn/gitlab-ce/yum/el7/</span><br><span class="line">gpgcheck=0</span><br><span class="line">enabled=1</span><br><span class="line">Ece</span><br><span class="line"></span><br><span class="line">sudo yum makecache</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹å¯ç”¨çš„ç‰ˆæœ¬neng'b</span></span><br><span class="line">yum list gitlab-ce --showduplicates</span><br><span class="line"><span class="comment"># ç„¶åå®‰è£…æœ€æ–°çš„ç‰ˆæœ¬</span></span><br><span class="line">yum install -y gitlab-ce</span><br><span class="line"><span class="comment"># å®‰è£…æŒ‡å®šç‰ˆæœ¬ 12.3.5</span></span><br><span class="line">yum install gitlab-ce-12.3.5-ce.0.el7.x86_64.rpm</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¹Ÿå¯ä»¥ä½¿ç”¨ wget çš„æ–¹å¼æŠŠ rpm åŒ…ä¸‹è½½ä¸‹æ¥å®‰è£…</span></span><br><span class="line">wget https://mirrors.tuna.tsinghua.edu.cn/gitlab-ce/yum/el7/gitlab-ce-12.8.2-ce.0.el7.x86_64.rpm</span><br><span class="line">yum install gitlab-ce-12.8.2-ce.0.el7.x86_64.rpm</span><br></pre></td></tr></table></figure><p>å®‰è£…æˆåŠŸä¹‹åä¼šå‡ºç° Gitlab çš„ Logo</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">       *.                  *.</span><br><span class="line">      ***                 ***</span><br><span class="line">     *****               *****</span><br><span class="line">    .******             *******</span><br><span class="line">    ********            ********</span><br><span class="line">   ,,,,,,,,,***********,,,,,,,,,</span><br><span class="line">  ,,,,,,,,,,,*********,,,,,,,,,,,</span><br><span class="line">  .,,,,,,,,,,,*******,,,,,,,,,,,,</span><br><span class="line">      ,,,,,,,,,*****,,,,,,,,,.</span><br><span class="line">         ,,,,,,,****,,,,,,</span><br><span class="line">            .,,,***,,,,</span><br><span class="line">                ,*,.</span><br><span class="line"></span><br><span class="line">     _______ __  __          __</span><br><span class="line">    / ____(_) /_/ /   ____ _/ /_</span><br><span class="line">   / / __/ / __/ /   / __ `/ __ \</span><br><span class="line">  / /_/ / / /_/ /___/ /_/ / /_/ /</span><br><span class="line">  \____/_/\__/_____/\__,_/_.___/</span><br><span class="line"></span><br><span class="line">Thank you for installing GitLab!</span><br><span class="line">GitLab was unable to detect a valid hostname for your instance.</span><br><span class="line">Please configure a URL for your GitLab instance by setting `external_url`</span><br><span class="line">configuration in /etc/gitlab/gitlab.rb file.</span><br><span class="line">Then, you can start your GitLab instance by running the following command:</span><br><span class="line">  sudo gitlab-ctl reconfigure</span><br></pre></td></tr></table></figure><h3 id="2-æ‰“è¡¥ä¸ï¼Œè¡¥å……æ±‰åŒ–çš„è¡¥ä¸"><a href="#2-æ‰“è¡¥ä¸ï¼Œè¡¥å……æ±‰åŒ–çš„è¡¥ä¸" class="headerlink" title="2.æ‰“è¡¥ä¸ï¼Œè¡¥å……æ±‰åŒ–çš„è¡¥ä¸"></a>2.æ‰“è¡¥ä¸ï¼Œè¡¥å……æ±‰åŒ–çš„è¡¥ä¸</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://gitlab.com/xhang/gitlab.git</span><br><span class="line"><span class="built_in">cd</span> gitlab</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–å½“å‰å®‰è£…çš„ç‰ˆæœ¬</span></span><br><span class="line">gitlab_version=$(cat /opt/gitlab/embedded/service/gitlab-rails/VERSION)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”Ÿæˆå¯¹åº”ç‰ˆæœ¬è¡¥ä¸æ–‡ä»¶</span></span><br><span class="line">git diff v<span class="variable">$&#123;gitlab_version&#125;</span> v<span class="variable">$&#123;gitlab_version&#125;</span>-zh &gt; ../<span class="variable">$&#123;gitlab_version&#125;</span>-zh.diff</span><br><span class="line"></span><br><span class="line">gitlab-ctl stop</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰“è¡¥ä¸çš„æ—¶å€™ä¼šæç¤ºä¸€äº›è¡¥ä¸æ–‡ä»¶ä¸å­˜åœ¨ï¼Œä¸€å®šè¦è·³è¿‡è¿™äº›æ–‡ä»¶ï¼Œä¸ç„¶åé¢reconfigçš„æ—¶å€™ä¼šæŠ¥é”™çš„ã€‚</span></span><br><span class="line">patch -d /opt/gitlab/embedded/service/gitlab-rails -p1 &lt; <span class="variable">$&#123;gitlab_version&#125;</span>-zh.diff</span><br></pre></td></tr></table></figure><h3 id="3-ä¿®æ”¹é»˜è®¤é…ç½®"><a href="#3-ä¿®æ”¹é»˜è®¤é…ç½®" class="headerlink" title="3. ä¿®æ”¹é»˜è®¤é…ç½®"></a>3. ä¿®æ”¹é»˜è®¤é…ç½®</h3><p>ä¿®æ”¹ gitlab çš„é…ç½®æ–‡ä»¶ <code>/etc/gitlab/gitlab.rb</code></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¿®æ”¹ä¸ºä½ è‡ªå·±çš„åŸŸåæˆ–è€… IPï¼Œæ˜¯å•å¼•å·ï¼Œè€Œä¸”å‰é¢çš„ http ä¸è¦æ”¹</span></span><br><span class="line">external_url  'http://gitlab.domain'</span><br><span class="line"></span><br><span class="line"><span class="comment"># é‚®ä»¶é…ç½®ï¼Œæ²¡æœ‰é‚®ä»¶æœåŠ¡å™¨å¯ä»¥å…³é—­é‚®ä»¶æœåŠ¡åŠŸèƒ½</span></span><br><span class="line">gitlab_rails['smtp_enable'] = false</span><br><span class="line">gitlab_rails['smtp_address'] = ""</span><br><span class="line">gitlab_rails['smtp_port'] =  587</span><br><span class="line">gitlab_rails['smtp_user_name'] = ""</span><br><span class="line">gitlab_rails['smtp_password'] = ""</span><br><span class="line">gitlab_rails['smtp_authentication'] = ""</span><br><span class="line">gitlab_rails['smtp_enable_starttls_auto'] =</span><br><span class="line">gitlab_rails['smtp_tls'] =</span><br><span class="line">gitlab_rails['gitlab_email_from'] = ''</span><br></pre></td></tr></table></figure><h3 id="4-åˆå§‹åŒ–è®¾ç½®"><a href="#4-åˆå§‹åŒ–è®¾ç½®" class="headerlink" title="4. åˆå§‹åŒ–è®¾ç½®"></a>4. åˆå§‹åŒ–è®¾ç½®</h3><p>ä¿®æ”¹å®Œæˆé…ç½®ä¹‹åä½¿ç”¨ <code>gitlab-ctl reconfigure</code> é‡æ–°æ›´æ–°ä¸€ä¸‹ gitlab æœåŠ¡çš„é…ç½®ï¼Œæ›´æ–°å®Œæˆé…ç½®ä¹‹åä½¿ç”¨<br><code>gitlab-ctl restart</code> æ¥é‡æ–°å¯åŠ¨ gitlab ã€‚å¦‚æœ reconfigure å¤±è´¥ï¼Œåˆ™éœ€è¦ <code>systemctl enable gitlab- runsvdir &amp;&amp; systemctl restart gitlab- runsvdir</code> é‡å¯ä¸€ä¸‹  <code>gitlab-runsvdir</code> æœåŠ¡ã€‚</p><p>æ‰“å¼€æµè§ˆå™¨è¿›è¡Œåˆå§‹åŒ–è´¦æˆ·è®¾å®šå¯†ç ï¼Œè¿™ä¸ªå¯†ç ä¸º root ç®¡ç†å‘˜è´¦æˆ·çš„å¯†ç ã€‚è®¾ç½®å®Œå¯†ç ä¹‹åä¼šè‡ªåŠ¨è·³è½¬åˆ°ç™»å½•é¡µé¢ã€‚username ä¸º <code>root</code> å¯†ç ä¸ºåˆšåˆšè®¾ç½®çš„å¯†ç ã€‚</p><h2 id="å®‰è£…-gitlab-runner"><a href="#å®‰è£…-gitlab-runner" class="headerlink" title="å®‰è£… gitlab-runner"></a>å®‰è£… gitlab-runner</h2><h3 id="Debian-Ubuntu"><a href="#Debian-Ubuntu" class="headerlink" title="Debian/Ubuntu"></a>Debian/Ubuntu</h3><p>é¦–å…ˆä¿¡ä»» GitLab çš„ GPG å…¬é’¥:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl https://packages.gitlab.com/gpg.key 2&gt; /dev/null | sudo apt-key add - &amp;&gt;/dev/null</span><br></pre></td></tr></table></figure><p>å†é€‰æ‹©ä½ çš„ Debian/Ubuntu ç‰ˆæœ¬ï¼Œæ–‡æœ¬æ¡†ä¸­å†…å®¹å†™è¿› <code>/etc/apt/sources.list.d/gitlab-runner.list</code></p><h4 id="Debian"><a href="#Debian" class="headerlink" title="Debian"></a>Debian</h4><p>æ ¹æ®è‡ªå·±çš„å‘è¡Œç‰ˆä»£å·ä¿®æ”¹ä¸€ä¸‹ <code>stretch</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">deb http://mirrors.tuna.tsinghua.edu.cn/gitlab-runner/debian stretch main</span><br></pre></td></tr></table></figure><h4 id="Ubuntu"><a href="#Ubuntu" class="headerlink" title="Ubuntu"></a>Ubuntu</h4><p>æ ¹æ®è‡ªå·±çš„å‘è¡Œç‰ˆä»£å·ä¿®æ”¹ä¸€ä¸‹ <code>bionic</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/gitlab-runner/ubuntu bionic main</span><br></pre></td></tr></table></figure><p>é…ç½®å¥½ deb æºä¹‹åå†æ‰§è¡Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt uodate</span><br><span class="line">apt install gitlab-runner -y</span><br></pre></td></tr></table></figure><h3 id="CentOS7-1"><a href="#CentOS7-1" class="headerlink" title="CentOS7"></a>CentOS7</h3><p>æ–°å»º <code>/etc/yum.repos.d/gitlab-runner.repo</code>ï¼Œå†…å®¹ä¸º</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[gitlab-runner]</span><br><span class="line">name=gitlab-runner</span><br><span class="line">baseurl=https://mirrors.tuna.tsinghua.edu.cn/gitlab-runner/yum/el7</span><br><span class="line">repo_gpgcheck=0</span><br><span class="line">gpgcheck=0</span><br><span class="line">enabled=1</span><br><span class="line">gpgkey=https://packages.gitlab.com/gpg.key</span><br></pre></td></tr></table></figure><p>å†æ‰§è¡Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo yum makecache</span><br><span class="line">sudo yum install gitlab-runner -y</span><br><span class="line"><span class="comment"># å®‰è£…æŒ‡å®šç‰ˆæœ¬ å…¶ä¸­ 12.3.5 å³ä¸ºæŒ‡å®šçš„ç‰ˆæœ¬å·</span></span><br><span class="line">yum install gitlab-runner-12.3.5-1.x86_64 -y</span><br></pre></td></tr></table></figure><h3 id="æ³¨å†Œ-gitlab-runner"><a href="#æ³¨å†Œ-gitlab-runner" class="headerlink" title="æ³¨å†Œ gitlab-runner"></a>æ³¨å†Œ gitlab-runner</h3><p>ä½¿ç”¨ root ç”¨æˆ·ä» web ç«¯ç™»å½•åˆ° gitlab ç®¡ç†ä¸­å¿ƒã€‚åœ¨ <code>æ¦‚è§ˆ</code> â€“&gt; <code>Runner</code> ã€‚åœ¨å³ä¸Šè§’ä¼šæœ‰ä»¥ä¸‹ï¼Œç¨åä¼šç”¨åˆ°ã€‚</p><ul><li>åœ¨ Runner è®¾ç½®æ—¶æŒ‡å®šä»¥ä¸‹ URL</li><li>åœ¨å®‰è£…è¿‡ç¨‹ä¸­ä½¿ç”¨ä»¥ä¸‹æ³¨å†Œä»¤ç‰Œï¼š</li></ul><p>å®‰è£…å¥½ gitlab-runner ä¹‹åå¦‚æœç›´æ¥å‘ gitlab æ³¨å†Œåˆ™ä¼šæç¤ºå¤±è´¥ï¼Œæç¤º <code>ERROR: Registering runner... failed   runner=qRGh2M86 status=500 Internal Server Error</code> ã€‚è¿™æ˜¯å› ä¸º Gitlab é»˜è®¤ç¦æ­¢äº†ç§æœ‰ç½‘æ®µ IP é‡Œçš„ API è¯·æ±‚ï¼Œéœ€è¦æ‰‹åŠ¨å¼€å¯æ‰è¡Œã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">â•­â”€root@gitlab ~</span><br><span class="line">â•°â”€<span class="comment"># gitlab-runner register</span></span><br><span class="line">Runtime platform   arch=amd64 os=linux pid=6818 revision=1b659122 version=12.8.0</span><br><span class="line">Running <span class="keyword">in</span> system-mode.</span><br><span class="line">Please enter the gitlab-ci coordinator URL (e.g. https://gitlab.com/):</span><br><span class="line">http://10.10.107.216/</span><br><span class="line">Please enter the gitlab-ci token <span class="keyword">for</span> this runner:</span><br><span class="line">qRGh2M86iTasjBn1dU8L</span><br><span class="line">Please enter the gitlab-ci description <span class="keyword">for</span> this runner:</span><br><span class="line">[gitlab]: runner-centos</span><br><span class="line">Please enter the gitlab-ci tags <span class="keyword">for</span> this runner (comma separated):</span><br><span class="line">centos</span><br><span class="line">ERROR: Registering runner... failed   runner=qRGh2M86 status=500 Internal Server Error</span><br><span class="line">PANIC: Failed to register this runner. Perhaps you are having network problems</span><br></pre></td></tr></table></figure><h3 id="ä¿®æ”¹-gitlab-é»˜è®¤ç½‘ç»œè®¾ç½®"><a href="#ä¿®æ”¹-gitlab-é»˜è®¤ç½‘ç»œè®¾ç½®" class="headerlink" title="ä¿®æ”¹ gitlab é»˜è®¤ç½‘ç»œè®¾ç½®"></a>ä¿®æ”¹ gitlab é»˜è®¤ç½‘ç»œè®¾ç½®</h3><p>ä½¿ç”¨ root ç”¨æˆ·ä» web ç«¯ç™»å½•åˆ° gitlab ç®¡ç†ä¸­å¿ƒ http://${ip}/admin ã€‚ç®¡ç†ä¸­å¿ƒ â€“&gt; è®¾ç½® â€“&gt; ç½‘ç»œ â€“&gt; å¤–å‘è¯·æ±‚ â€“&gt; å…è®¸æ¥è‡ªé’©å­å’ŒæœåŠ¡çš„å¯¹æœ¬åœ°ç½‘ç»œçš„è¯·æ±‚ã€‚ä»¥ä¸‹é€‰é¡¹å…¨éƒ¨å…è®¸ï¼Œæ‰èƒ½é€šè¿‡å¤–éƒ¨è¯·æ±‚çš„æ–¹å¼æ³¨å†Œ gitlab-runnerã€‚</p><ul><li>Allow requests to the local network from web hooks and services</li><li>Allow requests to the local network from system hooks</li></ul><p><strong>ä¸ºäº†å®‰å…¨èµ·è§</strong>ï¼Œä¹Ÿå¯ä»¥åœ¨ Whitelist to allow requests to the local network from hooks and services ä¸‹æ–¹çš„é‚£ä¸ªæ¡†æ¡†é‡Œæ·»åŠ ä¸Šç™½åå•ï¼Œå…è®¸æˆæƒçš„ IP ã€‚ä¿®æ”¹å¥½ä¹‹åä¸è¦å¿˜è®°ç‚¹å‡»åº•éƒ¨é‚£ä¸ªç»¿è‰²æŒ‰é’® <code>ä¿å­˜ä¿®æ”¹</code> ã€‚</p><h4 id="500-é”™è¯¯"><a href="#500-é”™è¯¯" class="headerlink" title="500 é”™è¯¯"></a>500 é”™è¯¯</h4><p>å¦‚æœç‚¹å‡» <code>ä¿å­˜ä¿®æ”¹</code> ä¹‹åå°±è·³è½¬åˆ° Gitlab 500 é”™è¯¯çš„é¡µé¢ã€‚å°è¯•åœ¨ç®¡ç†ä¸­å¿ƒä¿®æ”¹å…¶ä»–è®¾ç½®ä¿å­˜æ—¶ï¼Œä¹Ÿä¼šå‡ºç° 500 çš„æƒ…å†µã€‚åœ¨å®‰è£… gitlab çš„æœºå™¨ä¸ŠæŸ¥çœ‹ä¸€ä¸‹æ—¥å¿—ã€‚è¿è¡Œ <code>gitlab-ctl tail</code> æŸ¥çœ‹å®æ—¶çš„æ—¥å¿—ã€‚æ­¤æ—¶ç­‰åˆ°æ—¥å¿—è¾“å‡ºå‡æ…¢çš„æ—¶å€™æˆ‘ä»¬å¤šæŒ‰å‡ ä¸‹å›è½¦ï¼Œç„¶åå°±ç«‹å³å»ç‚¹å‡»<code>ä¿å­˜ä¿®æ”¹</code>  æŒ‰é’®ï¼Œè¿™æ ·å°±èƒ½æ•æ‰åˆ°æ­¤åˆ»çš„é”™è¯¯æ—¥å¿—ã€‚</p><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">==&gt; /<span class="keyword">var</span>/log/gitlab/gitlab-rails/production<span class="variable">.log</span> &lt;==</span><br><span class="line">Started PATCH <span class="string">"/admin/application_settings/network"</span> <span class="keyword">for</span> <span class="number">10</span><span class="variable">.0</span><span class="variable">.30</span><span class="variable">.2</span> at <span class="number">2020</span>-<span class="number">03</span>-<span class="number">10</span> <span class="number">11</span>:<span class="number">08</span>:<span class="number">20</span> +<span class="number">0000</span></span><br><span class="line">Processing by Admin::ApplicationSettingsController#network as HTML</span><br><span class="line">  Parameters: &#123;<span class="string">"utf8"</span>=&gt;<span class="string">"âœ“"</span>, <span class="string">"authenticity_token"</span>=&gt;<span class="string">"[FILTERED]"</span>, <span class="string">"application_setting"</span>=&gt;&#123;<span class="string">"allow_local_requests_from_web_hooks_and_services"</span>=&gt;<span class="string">"[FILTERED]"</span>, <span class="string">"allow_local_requests_from_system_hooks"</span>=&gt;<span class="string">"[FILTERED]"</span>, <span class="string">"outbound_local_requests_whitelist_raw"</span>=&gt;<span class="string">""</span>, <span class="string">"dns_rebinding_protection_enabled"</span>=&gt;<span class="string">"1"</span>&#125;&#125;</span><br><span class="line">Completed <span class="number">500</span> Internal Server Error in <span class="number">40</span>ms (ActiveRecord: <span class="number">14</span><span class="variable">.5ms</span> | Elasticsearch: <span class="number">0</span><span class="variable">.0ms</span>)</span><br><span class="line">OpenSSL::Cipher::CipherError ():</span><br><span class="line">lib/gitlab/crypto_helper<span class="variable">.rb</span>:<span class="number">27</span>:in <span class="meta">`aes256_gcm_decrypt'</span></span><br></pre></td></tr></table></figure><p>å…¶ä¸­é”™è¯¯çš„è¾“å‡ºæ˜¯åœ¨ <code>OpenSSL::Cipher::CipherError ():</code></p><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Processing by Admin::ApplicationSettingsController#network as HTML</span><br><span class="line">  Parameters: &#123;<span class="string">"utf8"</span>=&gt;<span class="string">"âœ“"</span>, <span class="string">"authenticity_token"</span>=&gt;<span class="string">"[FILTERED]"</span>, <span class="string">"application_setting"</span>=&gt;&#123;<span class="string">"allow_local_requests_from_web_hooks_and_services"</span>=&gt;<span class="string">"[FILTERED]"</span>, <span class="string">"allow_local_requests_from_system_hooks"</span>=&gt;<span class="string">"[FILTERED]"</span>, <span class="string">"outbound_local_requests_whitelist_raw"</span>=&gt;<span class="string">""</span>, <span class="string">"dns_rebinding_protection_enabled"</span>=&gt;<span class="string">"1"</span>&#125;&#125;</span><br><span class="line">Completed <span class="number">500</span> Internal Server Error in <span class="number">40</span>ms (ActiveRecord: <span class="number">14</span><span class="variable">.5ms</span> | Elasticsearch: <span class="number">0</span><span class="variable">.0ms</span>)</span><br><span class="line">OpenSSL::Cipher::CipherError ():</span><br></pre></td></tr></table></figure><blockquote><p>æœç´¢äº†ä¸€ä¸‹ï¼Œå‘ç°ç½‘ä¸Šè¯´æ˜¯ç”±äºè¿ç§»å¯¼å…¥é¡¹ç›®åï¼Œæ²¡æœ‰å¯¼å…¥åŸæ¥çš„åŠ å¯†ä¿¡æ¯<code>/etc/gitlab/gitlab-secrets.json</code>ï¼Œ ä½†æ˜¯åŸæ¥çš„åŠ å¯†ä¿¡æ¯æ–‡ä»¶æˆ‘å·²ç»æ‰¾ä¸åˆ°äº†ï¼Œåé¢å‘ç°å¯ä»¥ç›´æ¥é‡ç½®å°±è¡Œäº†</p><p>å‚è€ƒ <a href="https://hihozhou.com/blog/2019/08/01/gitlab-500.html" target="_blank" rel="noopener">è‡ªæ­gitlabæŠ¥500é”™è¯¯</a></p></blockquote><p>å‘½ä»¤è¡Œè¾“å…¥<code>gitlab-rails console</code>ï¼Œç„¶åè¾“å…¥</p><p><code>ApplicationSetting.current.reset_runners_registration_token!</code>å³å¯ï¼Œè¿™æ ·åœ¨ä¿å­˜ä¿®æ”¹çš„æ—¶å€™å°±ä¸ä¼šå†æŠ¥ 500 çš„é—®é¢˜äº†ã€‚åº”è¯¥æ˜¯é‡æ–°å®‰è£… Gitlab ä¹‹åçš„åŠ å¯†ä¿¡æ¯ä¸å¯¹æ‰€è‡´ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">â•­â”€root@gitlab ~</span><br><span class="line">â•°â”€<span class="comment"># gitlab-rails console</span></span><br><span class="line">--------------------------------------------------------------------------------</span><br><span class="line"> GitLab:       12.3.5 (2417d5becc7)</span><br><span class="line"> GitLab Shell: 10.0.0</span><br><span class="line"> PostgreSQL:   10.9</span><br><span class="line">--------------------------------------------------------------------------------</span><br><span class="line">Loading production environment (Rails 5.2.3)</span><br><span class="line">irb(main):001:0&gt; ApplicationSetting.current.reset_runners_registration_token!</span><br><span class="line">=&gt; <span class="literal">true</span></span><br><span class="line">irb(main):002:0&gt; <span class="built_in">exit</span></span><br></pre></td></tr></table></figure><h3 id="åœ¨é¡¹ç›®ä¸­æ³¨å†Œ-Runner"><a href="#åœ¨é¡¹ç›®ä¸­æ³¨å†Œ-Runner" class="headerlink" title="åœ¨é¡¹ç›®ä¸­æ³¨å†Œ Runner"></a>åœ¨é¡¹ç›®ä¸­æ³¨å†Œ Runner</h3><p>ä»¥ä¸Šå·²ç»å®‰è£…å¥½å¹¶ä¿®æ”¹é»˜è®¤çš„ç½‘ç»œè®¾ç½®å…è®¸ runner æ‰€åœ¨çš„ IP å‘ gitlab å‘èµ·å¤–éƒ¨è¯·æ±‚ã€‚è¿è¡Œ <code>gitlab-runner register</code> æ ¹æ®ç›¸åº”çš„æç¤ºè¾“å…¥ <code>URL</code> å’Œ <code>token</code> å³å¯ã€‚æœ€åæ ¹æ®æœºå™¨çš„ç±»å‹é€‰æ‹©å¥½ runner çš„ç±»å‹ï¼Œè¿™ä¸ªä¹Ÿæ˜¯è·‘ CI ä»»åŠ¡æ—¶çš„ç¯å¢ƒï¼Œåˆ°æ—¶å€™å¯ä»¥åœ¨é¡¹ç›®çš„è®¾ç½®ä¸­é€‰æ‹©å¯åŠ¨ç›¸åº”çš„ runner ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">â•­â”€root@runner ~</span><br><span class="line">â•°â”€<span class="comment"># gitlab-runner register</span></span><br><span class="line">Runtime platform   arch=amd64 os=linux pid=7501 revision=1b659122 version=12.8.0</span><br><span class="line">Running <span class="keyword">in</span> system-mode.</span><br><span class="line">Please enter the gitlab-ci coordinator URL (e.g. https://gitlab.com/):</span><br><span class="line">http://10.10.107.216/</span><br><span class="line">Please enter the gitlab-ci token <span class="keyword">for</span> this runner:</span><br><span class="line">4hjjA7meRGuxEm3LyMjq</span><br><span class="line">Please enter the gitlab-ci description <span class="keyword">for</span> this runner:</span><br><span class="line">[runner]:</span><br><span class="line">Please enter the gitlab-ci tags <span class="keyword">for</span> this runner (comma separated):</span><br><span class="line">centos</span><br><span class="line">Registering runner... succeeded                     runner=4hjjA7me</span><br><span class="line">Please enter the executor: shell, ssh, virtualbox, docker-ssh+machine, kubernetes, docker, docker-ssh, parallels, docker+machine, custom:</span><br><span class="line">[shell]: shell</span><br><span class="line">Runner registered successfully. Feel free to start it, but <span class="keyword">if</span> it<span class="string">'s running already the config should be automatically reloaded!</span></span><br></pre></td></tr></table></figure><ul><li>æç¤ºæˆåŠŸä¹‹åç„¶ååœ¨ <code>ç®¡ç†ä¸­å¿ƒ</code>â€“&gt; <code>æ¦‚è§ˆ</code> â€“&gt; <code>Runner</code> å¯ä»¥æŸ¥çœ‹åˆ°ç›¸åº”çš„ Runner äº†ã€‚ä¹Ÿå¯ä»¥æ‰‹åŠ¨ç¼–è¾‘ <code>/etc/gitlab-runner/config.toml</code> æ¥æ³¨å†Œç›¸åº”ç±»å‹çš„  Runner</li></ul><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">concurrent</span> = <span class="number">1</span></span><br><span class="line"><span class="attr">check_interval</span> = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="section">[session_server]</span></span><br><span class="line">  session_timeout = 1800</span><br><span class="line"></span><br><span class="line"><span class="section">[[runners]]</span></span><br><span class="line">  name = "runner"</span><br><span class="line">  url = "http://10.10.107.216/"</span><br><span class="line">  token = "ZTSAQ3q6x_upW9toyKTY"</span><br><span class="line">  executor = "shell"</span><br><span class="line">  <span class="section">[runners.custom_build_dir]</span></span><br><span class="line">  <span class="section">[runners.cache]</span></span><br><span class="line">    <span class="section">[runners.cache.s3]</span></span><br><span class="line">    <span class="section">[runners.cache.gcs]</span></span><br><span class="line"></span><br><span class="line"><span class="section">[[runners]]</span></span><br><span class="line">  name = "docker-runner"</span><br><span class="line">  url = "http://10.10.107.216/"</span><br><span class="line">  token = "Cf1cy6yx4Y-bGjVnRf8m"</span><br><span class="line">  executor = "docker"</span><br><span class="line">  <span class="section">[runners.custom_build_dir]</span></span><br><span class="line">  <span class="section">[runners.cache]</span></span><br><span class="line">    <span class="section">[runners.cache.s3]</span></span><br><span class="line">    <span class="section">[runners.cache.gcs]</span></span><br><span class="line">  <span class="section">[runners.docker]</span></span><br><span class="line">  <span class="comment"># åœ¨è¿™é‡Œéœ€è¦æ·»åŠ ä¸Š harbor çš„åœ°å€ï¼Œæ‰èƒ½å…è®¸ pull ç§æœ‰ registry çš„é•œåƒ</span></span><br><span class="line">    allowed_images = ["10.10.107.217/*:*"]</span><br><span class="line">    tls_verify = false</span><br><span class="line">    image = "golang:latest"</span><br><span class="line">    privileged = true</span><br><span class="line">    disable_entrypoint_overwrite = false</span><br><span class="line">    oom_kill_disable = false</span><br><span class="line">    disable_cache = false</span><br><span class="line">    volumes = ["/cache"]</span><br><span class="line">    shm_size = 0</span><br></pre></td></tr></table></figure><h2 id="éƒ¨ç½²-Harbor"><a href="#éƒ¨ç½²-Harbor" class="headerlink" title="éƒ¨ç½² Harbor"></a>éƒ¨ç½² Harbor</h2><ul><li>åœ¨ harbor é¡¹ç›®çš„ release é¡µé¢ä¸‹è½½ç¦»çº¿å®‰è£…åŒ… <a href="https://github.com/goharbor/harbor/releases/download/v1.9.4/harbor-offline-installer-v1.9.4.tgz" target="_blank" rel="noopener">harbor-offline-installer-v1.9.4.tgz</a> åˆ°éƒ¨ç½²çš„æœºå™¨ä¸Šã€‚éƒ¨ç½²ä¹‹å‰éœ€è¦å®‰è£…å¥½ <code>docker</code> å’Œ <code>docker-compose</code> ã€‚ä¹‹åå†ä¿®æ”¹ <code>harbor.yml</code> é…ç½®æ–‡ä»¶ä¸­çš„ä»¥ä¸‹å†…å®¹ï¼š</li></ul><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># hostname éœ€è¦ä¿®æ”¹ä¸ºç›¸åº”çš„åŸŸåæˆ–è€… IP</span></span><br><span class="line"><span class="attr">hostname:</span> <span class="number">10.10</span><span class="number">.107</span><span class="number">.217</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># http related config</span></span><br><span class="line"><span class="attr">http:</span></span><br><span class="line">  <span class="comment"># port for http, default is 80. If https enabled, this port will redirect to https port</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">80</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é¦–æ¬¡ç™»å½•æ—¶è®¾å®šçš„ admin è´¦æˆ·å¯†ç </span></span><br><span class="line"><span class="attr">harbor_admin_password:</span> <span class="string">Harbor12345</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ•°æ®å­˜å‚¨çš„ç›®å½•</span></span><br><span class="line"><span class="attr">data_volume:</span> <span class="string">/data</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># clair CVE æ¼æ´æ•°æ®åº“æ›´æ–°ï¼Œè¿™é‡Œå»ºè®®è®¾ç½®ä¸º 1h</span></span><br><span class="line"><span class="comment"># ç”±äº clair æ•°æ®åº“åœ¨å›½å†…ç½‘ç»œè®¿é—®é—®é¢˜ï¼Œéœ€è¦è®¾ç½® http ä»£ç†</span></span><br><span class="line"><span class="attr">clair:</span></span><br><span class="line">  <span class="comment"># The interval of clair updaters, the unit is hour, set to 0 to disable the updaters.</span></span><br><span class="line">  <span class="attr">updaters_interval:</span> <span class="number">1</span></span><br><span class="line"><span class="attr">proxy:</span></span><br><span class="line">  <span class="attr">http_proxy:</span> <span class="number">10.20</span><span class="number">.172</span><span class="number">.106</span><span class="string">:2080</span></span><br><span class="line">  <span class="attr">https_proxy:</span></span><br><span class="line">  <span class="attr">no_proxy:</span></span><br><span class="line">  <span class="attr">components:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">clair</span></span><br></pre></td></tr></table></figure><ul><li>ä¿®æ”¹å®Œé…ç½®æ–‡ä»¶ä¹‹åå†è¿è¡Œ <code>./install.sh --with-clair --with-chartmuseum</code> å°† clair é›†æˆåˆ° harbor ä¸­ã€‚</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">â•­â”€root@harbor /opt/harbor</span><br><span class="line">â•°â”€# ./install.sh --with-clair --with-chartmuseum</span><br><span class="line">[Step 0]: checking installation environment ...</span><br><span class="line">[Step 1]: loading Harbor images ...</span><br><span class="line">[Step 2]: preparing environment ...</span><br><span class="line">[Step 3]: starting Harbor ...</span><br><span class="line">Creating network "harbor_harbor" with the default driver</span><br><span class="line">Creating network "harbor_harbor-clair" with the default driver</span><br><span class="line">Creating network "harbor_harbor-chartmuseum" with the default driver</span><br><span class="line">Creating harbor-log ... done</span><br><span class="line">Creating harbor-db     ... done</span><br><span class="line">Creating registryctl   ... done</span><br><span class="line">Creating harbor-portal ... done</span><br><span class="line">Creating chartmuseum   ... done</span><br><span class="line">Creating registry      ... done</span><br><span class="line">Creating redis         ... done</span><br><span class="line">Creating clair         ... done</span><br><span class="line">Creating harbor-core   ... done</span><br><span class="line">Creating harbor-jobservice ... done</span><br><span class="line">Creating nginx             ... done</span><br><span class="line"></span><br><span class="line">âœ” ----Harbor has been installed and started successfully.----</span><br><span class="line"></span><br><span class="line">Now you should be able to visit the admin portal at http://10.20.172.236.</span><br><span class="line">For more details, please visit https://github.com/goharbor/harbor .</span><br></pre></td></tr></table></figure><ul><li>ä½¿ç”¨ <code>docker-compose ps</code> æ£€æŸ¥ harbor ç›¸å…³å®¹å™¨æ˜¯å¦æ­£å¸¸ã€‚</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">â•­â”€root@harbor /opt/harbor</span><br><span class="line">â•°â”€# docker-compose ps</span><br><span class="line">      Name                     Command                  State                 Ports</span><br><span class="line">---------------------------------------------------------------------------------------------</span><br><span class="line">chartmuseum         /docker-entrypoint.sh            Up (healthy)   9999/tcp</span><br><span class="line">clair               /docker-entrypoint.sh            Up (healthy)   6060/tcp, 6061/tcp</span><br><span class="line">harbor-core         /harbor/harbor_core              Up (healthy)</span><br><span class="line">harbor-db           /docker-entrypoint.sh            Up (healthy)   5432/tcp</span><br><span class="line">harbor-jobservice   /harbor/harbor_jobservice  ...   Up (healthy)</span><br><span class="line">harbor-log          /bin/sh -c /usr/local/bin/ ...   Up (healthy)   127.0.0.1:1514-&gt;10514/tcp</span><br><span class="line">harbor-portal       nginx -g daemon off;             Up (healthy)   8080/tcp</span><br><span class="line">nginx               nginx -g daemon off;             Up (healthy)   0.0.0.0:80-&gt;8080/tcp</span><br><span class="line">redis               redis-server /etc/redis.conf     Up (healthy)   6379/tcp</span><br><span class="line">registry            /entrypoint.sh /etc/regist ...   Up (healthy)   5000/tcp</span><br><span class="line">registryctl         /harbor/start.sh                 Up (healthy)</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/image-20200326163733610.png" alt="image-20200326163733610"></p><h3 id="è®¾ç½®-insecure-registry"><a href="#è®¾ç½®-insecure-registry" class="headerlink" title="è®¾ç½® insecure registry"></a>è®¾ç½® insecure registry</h3><ul><li>åœ¨ runner æœåŠ¡å™¨ä¸Šè®¾ç½®ä¸€ä¸‹ <code>/etc/docker/daemon.json</code> å°†ç§æœ‰ registry çš„ IP åœ°å€å¡«å…¥åˆ° <code>insecure-registries</code> æ•°ç»„ä¸­ã€‚è¿™æ ·æ‰å¯ä»¥æ¨é€å’Œæ‹‰å–é•œåƒ</li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"insecure-registries"</span> : [<span class="string">"10.10.107.217"</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ä½¿ç”¨ <code>docker login</code> æµ‹è¯•æ˜¯å¦èƒ½ç™»å½•æˆåŠŸï¼š</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">â•­â”€root@docker-230 /opt</span><br><span class="line">â•°â”€# docker login 10.10.107.217</span><br><span class="line">Username: admin</span><br><span class="line">Password:</span><br><span class="line">WARNING! Your password will be stored unencrypted in /root/.docker/config.json.</span><br><span class="line">Configure a credential helper to remove this warning. See</span><br><span class="line">https://docs.docker.com/engine/reference/commandline/login/#credentials-store</span><br><span class="line">Login Succeeded</span><br></pre></td></tr></table></figure><ul><li>ç™»å½•åˆ° harbor æ–°å»ºä¸€ä¸ªé¡¹ç›®ä»“åº“ï¼Œå¹¶æŒ‰ç…§ <code>docker tag SOURCE_IMAGE[:TAG] 10.20.172.236/ciest/IMAGE[:TAG]</code> æ ¼å¼ç»™æœ¬åœ° docker é•œåƒæ‰“ä¸Š tag å¹¶æµ‹è¯•æ¨é€åˆ° harbor æ˜¯å¦æˆåŠŸã€‚</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">â•­â”€root@docker-230 /opt</span><br><span class="line">â•°â”€# docker tag openjdk:8-jdk-alpine 10.10.107.217/ops/openjdk:8-jdk-alpine</span><br><span class="line">â•­â”€root@docker-230 /opt</span><br><span class="line">â•°â”€# docker push !$</span><br><span class="line">â•­â”€root@docker-230 /opt</span><br><span class="line">â•°â”€# docker push 10.10.107.217/ops/openjdk:8-jdk-alpine</span><br><span class="line">The push refers to repository [10.10.107.217/ops/openjdk]</span><br><span class="line">ceaf9e1ebef5: Mounted from ops/ci-test</span><br><span class="line">9b9b7f3d56a0: Mounted from ops/ci-test</span><br><span class="line">f1b5933fe4b5: Mounted from ops/ci-test</span><br><span class="line">8-jdk-alpine: digest: sha256:44b3cea369c947527e266275cee85c71a81f20fc5076f6ebb5a13f19015dce71 size: 947</span><br></pre></td></tr></table></figure><ul><li>åœ¨ harbor é¡¹ç›®çš„é¡µé¢æŸ¥çœ‹æ˜¯å¦æ¨é€æˆåŠŸ</li></ul><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/image-20200326170403918.png" alt="image-20200326170403918"></p><h2 id="æµ‹è¯•-CI-CD-é¡¹ç›®"><a href="#æµ‹è¯•-CI-CD-é¡¹ç›®" class="headerlink" title="æµ‹è¯• CI/CD é¡¹ç›®"></a>æµ‹è¯• CI/CD é¡¹ç›®</h2><ul><li>åœ¨ Gitlab ä¸­ä½¿ç”¨ Spring æ¨¡æ¿æ–°å»ºä¸€ä¸ªé¡¹ç›®ï¼Œå¹¶æ·»åŠ  <code>.gitlab-ci.yaml</code> é…ç½®æ–‡ä»¶ã€‚</li></ul><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/image-20200326170523433.png" alt="image-20200326170523433"></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">stages:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">build</span></span><br><span class="line"><span class="attr">build-master:</span></span><br><span class="line">  <span class="comment"># Official docker image.</span></span><br><span class="line">  <span class="attr">image:</span> <span class="string">docker:latest</span></span><br><span class="line">  <span class="attr">tags:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">maven-runner</span></span><br><span class="line">  <span class="attr">stage:</span> <span class="string">build</span></span><br><span class="line">  <span class="attr">services:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">docker:dind</span></span><br><span class="line">  <span class="attr">before_script:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">docker</span> <span class="string">login</span> <span class="string">-u</span> <span class="string">"$CI_REGISTRY_USER"</span> <span class="string">-p</span> <span class="string">"$CI_REGISTRY_PASSWORD"</span> <span class="string">$CI_REGISTRY</span></span><br><span class="line">  <span class="attr">script:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">docker</span> <span class="string">info</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">docker</span> <span class="string">build</span> <span class="string">--pull</span> <span class="string">-t</span> <span class="string">"$CI_REGISTRY_IMAGE"</span> <span class="string">.</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">docker</span> <span class="string">push</span> <span class="string">"$CI_REGISTRY_IMAGE"</span></span><br><span class="line">  <span class="attr">allow_failure:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="attr">build:</span></span><br><span class="line">  <span class="comment"># Official docker image.</span></span><br><span class="line">  <span class="attr">image:</span> <span class="string">docker:latest</span></span><br><span class="line">  <span class="attr">stage:</span> <span class="string">build</span></span><br><span class="line">  <span class="attr">services:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">docker:dind</span></span><br><span class="line">  <span class="attr">before_script:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">docker</span> <span class="string">login</span> <span class="string">-u</span> <span class="string">"$CI_REGISTRY_USER"</span> <span class="string">-p</span> <span class="string">"$CI_REGISTRY_PASSWORD"</span> <span class="string">$CI_REGISTRY</span></span><br><span class="line">  <span class="attr">script:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">docker</span> <span class="string">build</span> <span class="string">--pull</span> <span class="string">-t</span> <span class="string">"$CI_REGISTRY_IMAGE:$CI_COMMIT_REF_SLUG"</span> <span class="string">.</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">docker</span> <span class="string">push</span> <span class="string">"$CI_REGISTRY_IMAGE:$CI_COMMIT_REF_SLUG"</span></span><br><span class="line">  <span class="attr">except:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">master</span></span><br></pre></td></tr></table></figure><h3 id="gitlab-ci-yaml"><a href="#gitlab-ci-yaml" class="headerlink" title=".gitlab-ci.yaml"></a>.gitlab-ci.yaml</h3><p><code>.gitlab-ci.yaml</code> æ–‡ä»¶çš„é…ç½®é«˜åº¦ä¾èµ–äºé¡¹ç›®æœ¬èº«ï¼Œä»¥åŠ CI/CD æµæ°´çº¿çš„éœ€æ±‚ã€‚å…¶é…ç½®æ–‡ä»¶ä¸»è¦ç”±ä»¥ä¸‹éƒ¨åˆ†ç»„æˆï¼š</p><h4 id="Pipeline"><a href="#Pipeline" class="headerlink" title="Pipeline"></a>Pipeline</h4><p>ä¸€æ¬¡ Pipeline å…¶å®ç›¸å½“äºä¸€æ¬¡æ„å»ºä»»åŠ¡ï¼Œé‡Œé¢å¯ä»¥åŒ…å«å¾ˆå¤šä¸ªæµç¨‹ï¼Œå¦‚å®‰è£…ä¾èµ–ã€è¿è¡Œæµ‹è¯•ã€ç¼–è¯‘ã€éƒ¨ç½²æµ‹è¯•æœåŠ¡å™¨ã€éƒ¨ç½²ç”Ÿäº§æœåŠ¡å™¨ç­‰æµç¨‹ã€‚ä»»ä½•æäº¤æˆ–è€… Merge Request çš„åˆå¹¶éƒ½å¯ä»¥è§¦å‘ Pipeline æ„å»ºï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">+------------------+           +----------------+</span><br><span class="line">|                  |  trigger  |                |</span><br><span class="line">|   Commit &#x2F; MR    +----------&gt;+    Pipeline    |</span><br><span class="line">|                  |           |                |</span><br><span class="line">+------------------+           +----------------+</span><br></pre></td></tr></table></figure><h4 id="Stages"><a href="#Stages" class="headerlink" title="Stages"></a>Stages</h4><p>Stages è¡¨ç¤ºä¸€ä¸ªæ„å»ºé˜¶æ®µï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢æåˆ°çš„ä¸€ä¸ªæµç¨‹ã€‚æˆ‘ä»¬å¯ä»¥åœ¨ä¸€æ¬¡ Pipeline ä¸­å®šä¹‰å¤šä¸ª Stagesï¼Œè¿™äº› Stages ä¼šæœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p><ul><li>æ‰€æœ‰ Stages ä¼šæŒ‰ç…§é¡ºåºè¿è¡Œï¼Œå³å½“ä¸€ä¸ª Stage å®Œæˆåï¼Œä¸‹ä¸€ä¸ª Stage æ‰ä¼šå¼€å§‹</li><li>åªæœ‰å½“æ‰€æœ‰ Stages å®Œæˆåï¼Œè¯¥æ„å»ºä»»åŠ¡ (Pipeline) æ‰ä¼šæˆåŠŸ</li><li>å¦‚æœä»»ä½•ä¸€ä¸ª Stage å¤±è´¥ï¼Œé‚£ä¹ˆåé¢çš„ Stages ä¸ä¼šæ‰§è¡Œï¼Œè¯¥æ„å»ºä»»åŠ¡ (Pipeline) å¤±è´¥</li></ul><p>Stages å’Œ Pipeline çš„å…³ç³»å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">+--------------------------------------------------------+</span><br><span class="line">|                                                        |</span><br><span class="line">|  Pipeline                                              |</span><br><span class="line">|                                                        |</span><br><span class="line">|  +-----------+     +------------+      +------------+  |</span><br><span class="line">|  |  Stage 1  |----&gt;|   Stage 2  |-----&gt;|   Stage 3  |  |</span><br><span class="line">|  +-----------+     +------------+      +------------+  |</span><br><span class="line">|                                                        |</span><br><span class="line">+--------------------------------------------------------+</span><br></pre></td></tr></table></figure><h4 id="Jobs"><a href="#Jobs" class="headerlink" title="Jobs"></a>Jobs</h4><p>Jobs è¡¨ç¤ºæ„å»ºå·¥ä½œï¼Œè¡¨ç¤ºæŸä¸ª Stage é‡Œé¢æ‰§è¡Œçš„å·¥ä½œã€‚æˆ‘ä»¬å¯ä»¥åœ¨ Stages é‡Œé¢å®šä¹‰å¤šä¸ª Jobsï¼Œè¿™äº› Jobs ä¼šæœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p><ul><li>ç›¸åŒ Stage ä¸­çš„ Jobs ä¼šå¹¶è¡Œæ‰§è¡Œ</li><li>ç›¸åŒ Stage ä¸­çš„ Jobs éƒ½æ‰§è¡ŒæˆåŠŸæ—¶ï¼Œè¯¥ Stage æ‰ä¼šæˆåŠŸ</li><li>å¦‚æœä»»ä½•ä¸€ä¸ª Job å¤±è´¥ï¼Œé‚£ä¹ˆè¯¥ Stage å¤±è´¥ï¼Œå³è¯¥æ„å»ºä»»åŠ¡ (Pipeline) å¤±è´¥</li></ul><p>Jobs å’Œ Stage çš„å…³ç³»å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">+------------------------------------------+</span><br><span class="line">|                                          |</span><br><span class="line">|  Stage 1                                 |</span><br><span class="line">|                                          |</span><br><span class="line">|  +---------+  +---------+  +---------+   |</span><br><span class="line">|  |  Job 1  |  |  Job 2  |  |  Job 3  |   |</span><br><span class="line">|  +---------+  +---------+  +---------+   |</span><br><span class="line">|                                          |</span><br><span class="line">+------------------------------------------+</span><br></pre></td></tr></table></figure><p>ä¸‹é¢æ˜¯ä¸€ä¸ª<code>.gitlab-ci.yaml</code>  æ ·ä¾‹ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">stages:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">analytics</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">test</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">build</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">package</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">deploy</span></span><br><span class="line"></span><br><span class="line"><span class="attr">build:</span></span><br><span class="line">  <span class="attr">stage:</span> <span class="string">analytics</span></span><br><span class="line">  <span class="attr">only:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">master</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">tags</span></span><br><span class="line">  <span class="attr">tags:</span></span><br><span class="line">    <span class="bullet">-</span></span><br><span class="line">  <span class="attr">script:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">echo</span> <span class="string">"=============== å¼€å§‹ä»£ç è´¨é‡æ£€æµ‹ ==============="</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">echo</span> <span class="string">"=============== ç»“æŸä»£ç è´¨é‡æ£€æµ‹ ==============="</span></span><br><span class="line"></span><br><span class="line"><span class="attr">build:</span></span><br><span class="line">  <span class="attr">stage:</span> <span class="string">build</span></span><br><span class="line">  <span class="attr">only:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">master</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">tags</span></span><br><span class="line">  <span class="attr">tags:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">runner-tag</span></span><br><span class="line">  <span class="attr">script:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">echo</span> <span class="string">"=============== å¼€å§‹ç¼–è¯‘ä»»åŠ¡ ==============="</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">echo</span> <span class="string">"=============== ç»“æŸç¼–è¯‘ä»»åŠ¡ ==============="</span></span><br><span class="line"></span><br><span class="line"><span class="attr">package:</span></span><br><span class="line">  <span class="attr">stage:</span> <span class="string">package</span></span><br><span class="line">  <span class="attr">tags:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">runner-tag</span></span><br><span class="line">  <span class="attr">script:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">echo</span> <span class="string">"=============== å¼€å§‹æ‰“åŒ…ä»»åŠ¡  ==============="</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">echo</span> <span class="string">"=============== ç»“æŸæ‰“åŒ…ä»»åŠ¡  ==============="</span></span><br><span class="line"></span><br><span class="line"><span class="attr">build:</span></span><br><span class="line">  <span class="attr">stage:</span> <span class="string">test</span></span><br><span class="line">  <span class="attr">only:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">master</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">tags</span></span><br><span class="line">  <span class="attr">tags:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">runner-tag</span></span><br><span class="line">  <span class="attr">script:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">echo</span> <span class="string">"=============== å¼€å§‹æµ‹è¯•ä»»åŠ¡ ==============="</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">echo</span> <span class="string">"=============== ç»“æŸæµ‹è¯•ä»»åŠ¡ ==============="</span></span><br><span class="line"></span><br><span class="line"><span class="attr">deploy_test:</span></span><br><span class="line">  <span class="attr">stage:</span> <span class="string">deploy</span></span><br><span class="line">  <span class="attr">tags:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">runner-tag</span></span><br><span class="line">  <span class="attr">script:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">echo</span> <span class="string">"=============== è‡ªåŠ¨éƒ¨ç½²åˆ°æµ‹è¯•æœåŠ¡å™¨  ==============="</span></span><br><span class="line">  <span class="attr">environment:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">test</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">https://staging.example.com</span></span><br><span class="line"></span><br><span class="line"><span class="attr">deploy_test_manual:</span></span><br><span class="line">  <span class="attr">stage:</span> <span class="string">deploy</span></span><br><span class="line">  <span class="attr">tags:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">runner-tag</span></span><br><span class="line">  <span class="attr">script:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">echo</span> <span class="string">"=============== æ‰‹åŠ¨éƒ¨ç½²åˆ°æµ‹è¯•æœåŠ¡å™¨  ==============="</span></span><br><span class="line">  <span class="attr">environment:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">test</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">https://staging.example.com</span></span><br><span class="line">  <span class="attr">when:</span> <span class="string">manual</span></span><br><span class="line"></span><br><span class="line"><span class="attr">deploy_production_manual:</span></span><br><span class="line">  <span class="attr">stage:</span> <span class="string">deploy</span></span><br><span class="line">  <span class="attr">tags:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">runner-tag</span></span><br><span class="line">  <span class="attr">script:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">echo</span> <span class="string">"=============== æ‰‹åŠ¨éƒ¨ç½²åˆ°ç”Ÿäº§æœåŠ¡å™¨  ==============="</span></span><br><span class="line">  <span class="attr">environment:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">production</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">https://staging.example.com</span></span><br><span class="line">  <span class="attr">when:</span> <span class="string">manual</span></span><br></pre></td></tr></table></figure><ul><li>ä¿®æ”¹å¥½ <code>.gitlab-ci.yaml</code> ä¹‹åï¼Œå°† CI/CD è¿‡ç¨‹ä¸­ä½¿ç”¨åˆ°çš„ä¸€äº›æ•æ„Ÿä¿¡æ¯ï¼Œä½¿ç”¨å˜é‡çš„æ–¹å¼å¡«å…¥åœ¨ é¡¹ç›® <code>è®¾ç½®</code> â€”&gt; <code>CI/CD</code> â€”&gt; <code>å˜é‡</code> é‡Œã€‚æ¯”å¦‚ Harbor ä»“åº“çš„ç”¨æˆ·åå¯†ç ã€ssh å¯†é’¥ä¿¡æ¯ã€æ•°æ®åº“é…ç½®ä¿¡æ¯ç­‰æœºå¯†ä¿¡æ¯ã€‚</li></ul><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">CI_REGISTRY: # Harbor é•œåƒä»“åº“çš„åœ°å€</span><br><span class="line">CI_REGISTRY_USER: # Harbor ç”¨æˆ·å</span><br><span class="line">CI_REGISTRY_PASSWORD: # Harbor å¯†ç </span><br><span class="line">CI_REGISTRY_IMAGE: # æ„å»ºé•œåƒçš„åç§°</span><br><span class="line">SSH_PASSWORD: # éƒ¨ç½²æµ‹è¯•æœåŠ¡å™¨ ssh å¯†ç </span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/image-20200327102511419.png" alt="image-20200327102511419"></p><ul><li>è®¾ç½®å¥½ç›¸å…³å˜é‡ä¹‹ååœ¨ï¼Œåœ¨é¡¹ç›®é¡µé¢çš„ <code>CI/CD</code> â€”â€“&gt; <code>æµæ°´çº¿</code> é¡µé¢ç‚¹å‡» <code>è¿è¡Œæµæ°´çº¿</code>æ‰‹åŠ¨è§¦å‘æµæ°´çº¿ä»»åŠ¡è¿›è¡Œæµ‹è¯•ã€‚</li></ul><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/image-20200325163138089.png" alt="image-20200325163138089"></p><ul><li>å¦‚æœæµæ°´çº¿ä»»åŠ¡æ„å»ºæˆåŠŸçš„è¯ï¼Œä¼šæ˜¾ç¤º <code>å·²é€šè¿‡</code> çš„è¡¨ç¤º</li></ul><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/image-20200325163254316.png" alt="image-20200325163254316"></p><ul><li>ç™»å½•åˆ° Harbor <a href="http://10.10.107.217" target="_blank" rel="noopener">http://10.10.107.217</a> æŸ¥çœ‹é•œåƒæ˜¯å¦æ„å»ºæˆåŠŸ</li></ul><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/image-20200325163400519.png" alt="image-20200325163400519"></p><h2 id="å‚è€ƒ-æ¨è"><a href="#å‚è€ƒ-æ¨è" class="headerlink" title="å‚è€ƒ/æ¨è"></a>å‚è€ƒ/æ¨è</h2><ul><li><p><a href="https://docs.gitlab.com/runner/" target="_blank" rel="noopener">GitLab Runner Docs</a></p></li><li><p><a href="https://docs.gitlab.com/ee/README.html" target="_blank" rel="noopener">GitLab Docs</a></p></li><li><p><a href="https://nicksors.cc/2019/07/12/kubernetesç³»åˆ—ä¹‹ã€Šæ„å»ºä¼ä¸šçº§CICDå¹³å°-ä¸€-ã€‹.html" target="_blank" rel="noopener">kubernetesç³»åˆ—ä¹‹ã€Šæ„å»ºä¼ä¸šçº§CICDå¹³å°(ä¸€)ã€‹</a></p></li><li><p><a href="https://notes.mengxin.science/2018/09/02/gitlab-ci-cd-question-and-answer/" target="_blank" rel="noopener">GitLabçš„CI/CDä½¿ç”¨é—®é¢˜æ±‡æ€»</a></p></li><li><p><a href="https://moelove.info/2018/08/05/%E5%9F%BA%E4%BA%8E-GitLab-%E7%9A%84-CI-%E5%AE%9E%E8%B7%B5/" target="_blank" rel="noopener">åŸºäº GitLab çš„ CI å®è·µ</a></p></li><li><p><a href="https://blog.fleeto.us/courses/gitlab-notes/" target="_blank" rel="noopener">gitlab-notes</a></p></li><li><p><a href="https://xiaogenban1993.github.io/18.5/xiaomi_gitlabrunner.html" target="_blank" rel="noopener">gitlab runneréƒ¨ç½²ç»†èŠ‚ä¼˜åŒ–</a></p></li><li><p><a href="https://tech.meituan.com/2018/08/02/erp-cd-jenkins-pipeline.html" target="_blank" rel="noopener">Jenkinsçš„Pipelineè„šæœ¬åœ¨ç¾å›¢é¤é¥®SaaSä¸­çš„å®è·µ</a></p></li><li><p><a href="https://laogen.site/gitlab-ci/example-docker-ssh-deploy/" target="_blank" rel="noopener">GitLab CI ç¤ºä¾‹ï¼šDocker é•œåƒæ‰“åŒ…å‘å¸ƒ &amp; SSH éƒ¨ç½²</a></p></li><li><p><a href="https://theviper.xyz/gitlab-ci-cd-optimize.html" target="_blank" rel="noopener">gitlab CI/CDä¼˜åŒ–</a></p></li><li><p><a href="http://zacksleo.top/2017/04/22/GitLab-CI%E4%BD%BF%E7%94%A8Docker%E8%BF%9B%E8%A1%8C%E6%8C%81%E7%BB%AD%E9%83%A8%E7%BD%B2/" target="_blank" rel="noopener">GitLab-CIä½¿ç”¨Dockerè¿›è¡ŒæŒç»­éƒ¨ç½²</a></p></li><li><p><a href="https://furur.xyz/2019/11/03/docker-gitlab-ci-deploy-springboot-project/" target="_blank" rel="noopener">Docker Gitlab CI éƒ¨ç½² Spring Boot é¡¹ç›®</a></p></li><li><p><a href="https://wsgzao.github.io/post/gitlab/" target="_blank" rel="noopener">RHEL7/CentOS7 åœ¨çº¿å’Œç¦»çº¿å®‰è£… GitLab é…ç½®ä½¿ç”¨å®è·µ</a></p></li><li><p><a href="https://wayjam.me/post/how-gitlab-shell-works-with-ssh.md" target="_blank" rel="noopener">GitLab Shellå¦‚ä½•é€šè¿‡SSHå·¥ä½œ</a></p></li><li><p><a href="https://websoft9.gitbook.io/gitlab-image-guide/" target="_blank" rel="noopener">GitLabé•œåƒæ‰‹å†Œ</a></p></li><li><p><a href="https://xuanwo.io/2016/04/13/gitlab-install-intro/" target="_blank" rel="noopener">Gitlabéƒ¨ç½²å’Œæ±‰åŒ–ä»¥åŠç®€å•è¿ç»´</a></p></li></ul><h2 id="ç¤¾ç¾¤é—®ç­”-QA-CI-CD-ç›¸å…³"><a href="#ç¤¾ç¾¤é—®ç­”-QA-CI-CD-ç›¸å…³" class="headerlink" title="ç¤¾ç¾¤é—®ç­” QA | CI/CD ç›¸å…³"></a>ç¤¾ç¾¤é—®ç­” QA | CI/CD ç›¸å…³</h2><p>ä»¥ä¸‹å†…å®¹æ˜¯æ•´ç†æ‘˜è‡ª <a href="https://blog.k8s.li/K8s-QA.html">ã€Š(2000+) kubernetes ç¤¾ç¾¤åˆ†äº« QA æ±‡æ€»ã€‹</a>ï¼Œä¸­æœ‰å…³ CI/CD ç›¸å…³çš„é—®ç­”ï¼Œä» 2000 å¤šä¸ª QA é‡Œä½¿ç”¨å…³é”®å­—æœç´¢ Gitlabã€CI/CDã€Jenkins ç­‰ï¼Œç„¶åå°†ä¸€äº›ç›¸å…³çš„é—®é¢˜è¿›è¡Œæ±‡æ€»ã€‚æ–¹ä¾¿é—®é¢˜è‡ªæŸ¥å’Œä»ä¸­å¸å–ç»éªŒã€‚</p><h3 id="2019-04-03ï¼šå®¹å™¨ç¯å¢ƒä¸‹çš„æŒç»­é›†æˆæœ€ä½³å®è·µ"><a href="#2019-04-03ï¼šå®¹å™¨ç¯å¢ƒä¸‹çš„æŒç»­é›†æˆæœ€ä½³å®è·µ" class="headerlink" title="2019-04-03ï¼šå®¹å™¨ç¯å¢ƒä¸‹çš„æŒç»­é›†æˆæœ€ä½³å®è·µ"></a>2019-04-03ï¼šå®¹å™¨ç¯å¢ƒä¸‹çš„æŒç»­é›†æˆæœ€ä½³å®è·µ</h3><blockquote><p>Qï¼šKubernetes ä¸Šä¸»æµçš„ CI/CD æ–¹æ¡ˆæ˜¯å•¥ï¼Ÿ</p></blockquote><p>Aï¼šå…¶å®è¿™æ— å…³Kubernetesï¼Œä»å¸‚åœºå æœ‰ç‡æ¥çœ‹ï¼Œå‰ä¸‰ååˆ†åˆ«æ˜¯ Jenkinsã€JetBrains TeamCityã€CircleCIã€‚<a href="https://www.datanyze.com/market-share/ci" target="_blank" rel="noopener">æ¥æºï¼š</a></p><blockquote><p>Qï¼šGitLab è‡ªå¸¦çš„ CI ä¸Jenkins å’Œ GitLab ç»“åˆçš„ CIï¼Œè¯¥å¦‚ä½•é€‰æ‹©ï¼Ÿæƒ³çŸ¥é“æ›´æ·±å±‚æ¬¡çš„ç†è§£ã€‚</p></blockquote><p>Aï¼šè¿˜æ˜¯è¦ç»“åˆè‡ªå·±å›¢é˜Ÿçš„å®é™…æƒ…å†µåšé€‰æ‹©ã€‚ä»æˆç†Ÿåº¦æ¥è¯´ï¼Œè‚¯å®šæ˜¯ Jenkinsç”¨æˆ·æœ€å¤šï¼Œæˆç†Ÿåº¦æœ€é«˜ï¼Œç¼ºç‚¹æ˜¯ä¾§é‡ Javaï¼Œé…ç½®ç›¸å¯¹ç¹çã€‚GitLab è‡ªå¸¦çš„ CIç›¸å¯¹ç®€å•ï¼Œå¯ä»¥ç”¨ yamlï¼Œå’Œ GitLab ç»“åˆçš„æœ€å¥½ï¼Œä½†åŠŸèƒ½è‚¯å®šæ²¡æœ‰ Jenkinså…¨é¢ã€‚å¦‚æœæ˜¯å°å›¢é˜Ÿæ–°é¡¹ç›®ï¼ŒGitLab CI åˆå·²ç»å¯ä»¥æ»¡è¶³éœ€æ±‚çš„è¯ï¼Œå¹¶ä¸éœ€è¦ä¸ŠJenkinsï¼Œå¦‚æœæ˜¯è¾ƒå¤§çš„å›¢é˜Ÿï¼Œåˆæ˜¯å Java çš„ï¼Œä¸ªäººæ›´åå‘ Jenkinsã€‚</p><blockquote><p>Qï¼šJenkins å¦‚æœä¸æƒ³è¿è¡Œåœ¨ Kubernetes é‡Œé¢ï¼Œè¯¥æ€ä¹ˆå’Œ Kubernetes é›†æˆï¼Ÿ</p></blockquote><p>Aï¼šä» CI çš„æµç¨‹æ¥è¯´ï¼ŒCI åº”ç”¨æ˜¯ä¸æ˜¯è·‘åœ¨ Kubernetes çš„å¹¶ä¸é‡è¦ï¼ŒCIåªè¦èƒ½è®¿é—®ä»£ç åº“ï¼Œæœ‰æƒé™åœ¨ç”Ÿäº§ç¯å¢ƒå‘å¸ƒï¼Œæ˜¯ä¸æ˜¯è·‘åœ¨å®¹å™¨é‡Œä»æ•ˆæœæ¥è¯´å…¶å®æ²¡æœ‰åŒºåˆ«ï¼Œåªæ˜¯ç”¨Kubernetes éƒ¨ç½² Jenkinsçš„è¯ï¼Œè¿ç»´çš„ä¸€è‡´æ€§æ¯”è¾ƒå¥½ï¼Œè¿ç»´å›¢é˜Ÿä¸ç”¨é¢å¤–èŠ±æ—¶é—´ç»´æŠ¤ä¸€å¥—ç‰©ç†æœºçš„éƒ¨ç½²æ–¹æ¡ˆã€‚</p><blockquote><p>Qï¼šKubernetesçš„å›æ»šæ–¹æ¡ˆæ˜¯å›æ»šä»£ç ï¼Œé‡åšé•œåƒï¼Œè¿˜æ˜¯å…ˆåˆ‡æµé‡ï¼Œååšä¿®æ”¹ï¼Ÿ</p></blockquote><p>Aï¼šä»£ç ä¸€å®šæ˜¯æ‰“åŒ…åˆ°é•œåƒé‡Œçš„ï¼Œé•œåƒçš„ç‰ˆæœ¬å°±æ˜¯ä»£ç çš„ç‰ˆæœ¬ï¼Œæ‰€ä»¥ä¸€å®šæ˜¯åˆ‡é•œåƒã€‚è‡³äºå›æ»šæ“ä½œæœ¬èº«ï¼ŒKuberneteså·²ç»å†…ç½®äº†å¾ˆå¤šæ»šåŠ¨å‘å¸ƒï¼ˆRollingupdateï¼‰çš„ç­–ç•¥ï¼Œæ— è®ºæ˜¯å‘æ–°ç‰ˆæœ¬è¿˜æ˜¯å›æ»šç‰ˆæœ¬ï¼Œéƒ½å¯ä»¥åšåˆ°ç”¨æˆ·æ— æ„ŸçŸ¥ã€‚</p><blockquote><p>Qï¼šé•œåƒå¤§åˆ°å‡  G çš„è¯å¦‚ä½•æ›´æ–°éƒ¨ç½²ï¼Œæœ‰ä»€ä¹ˆå¥½çš„å®è·µå‘¢ï¼Œä»¥åŠå¦‚ä½•å›æ»šï¼Ÿ</p></blockquote><p>Aï¼šå‡ ä¸ªè¦ç‚¹ï¼š&gt; Qï¼šDrone å¼€æ”¾ API æœåŠ¡å—ï¼Ÿè¿™æ ·æ–¹ä¾¿å…¶ä»–ç³»ç»Ÿé›†æˆã€‚</p><p>Aï¼šå¯ä»¥è°ƒæ•´ä¸€ä¸‹æ€è·¯ï¼Œç›´æ¥æŠŠéœ€è¦çš„åŠŸèƒ½åšæˆé•œåƒåœ¨ Drone é‡Œè°ƒç”¨å°±å¥½äº†ã€‚</p><blockquote><p>Qï¼šå¦‚æœæœ‰ Drone çš„ Serveræ€ä¹ˆåšé«˜å¯ç”¨ï¼Ÿ</p></blockquote><p>Aï¼šDrone serve rç”¨ Kuberneteséƒ¨ç½²çš„è¯æœ¬èº«åªèµ·åˆ°äº†ä¸€ä¸ªä»»åŠ¡è°ƒåº¦çš„ä½œç”¨ï¼Œå¾ˆéš¾ä¼šé‡åˆ°æ€§èƒ½ç“¶é¢ˆã€‚çœŸçš„æœ‰æ€§èƒ½é—®é¢˜å¯ä»¥å°è¯•æ°´å¹³æ‰©å±•Drone serverï¼Œå…±äº«åŒä¸€æ•°æ®åº“ã€‚</p><h3 id="åŸºäº-GitLab-çš„-CI-å®è·µ"><a href="#åŸºäº-GitLab-çš„-CI-å®è·µ" class="headerlink" title="åŸºäº GitLab çš„ CI å®è·µ"></a><a href="https://moelove.info/2018/08/05/åŸºäº-GitLab-çš„-CI-å®è·µ/" target="_blank" rel="noopener">åŸºäº GitLab çš„ CI å®è·µ</a></h3><blockquote><p>Qï¼šæ‚¨æåˆ°æŠŠå„ç§ä¾èµ–éƒ½ä»¥ Service çš„æä¾›ï¼Œè¯·é—®æ˜¯ä»¥å“ªç§æ–¹å¼å‘¢ï¼Ÿ æ¯”å¦‚Pythonçš„ä¾èµ–ï¼Œæ€ä¹ˆåšæˆServiceå‘¢ï¼Ÿ</p></blockquote><p>Aï¼šService åŒ–çš„ä¾èµ–ï¼Œä¸»è¦æ˜¯æŒ‡ç±»ä¼¼ DB / MySQL/ Reids ä¹‹ç±»çš„ã€‚ æˆ–è€…æ˜¯ dind å…¶å®å®ƒæä¾›çš„æ˜¯ 2375 ç«¯å£çš„TCPæœåŠ¡ã€‚ Python çš„ä¾èµ–ï¼Œæˆ‘æ¨èçš„åšæ³•æ˜¯ï¼Œ æ„å»ºä¸€ä¸ªæ¢äº†æºçš„ Python é•œåƒã€‚ å®‰è£…ä¾èµ–çš„æ—¶å€™ï¼Œè€—æ—¶ä¼šå°‘å¾ˆå¤šã€‚ æˆ–è€…è¯´ï¼Œ å¯ä»¥åœ¨å®šä¹‰ Pipeline çš„æ—¶å€™ï¼Œ å°†è™šæ‹Ÿç¯å¢ƒçš„ venv æ–‡ä»¶å¤¹ä½œä¸º cache ï¼Œä¹‹åçš„å®‰è£…ä¹Ÿä¼šæ£€æŸ¥è¿™ä¸ªï¼Œé¿å…ä¸å¿…è¦çš„å®‰è£…ã€‚</p><blockquote><p>Qï¼šè¯·é—®ï¼Œä½ ä»¬ä¸ºä»€ä¹ˆä¸ç”¨Jenkins Pipelineï¼Œè€Œä½¿ç”¨GitLab CIï¼Ÿ</p></blockquote><p>Aï¼šä¸»è¦åŸå› æ˜¯æˆ‘æåˆ°çš„é‚£å‡ ä¸ªæ–¹é¢ã€‚ é›†æˆè¾ƒå¥½ï¼Œ ç•Œé¢ç¾è§‚ä¼˜é›…ï¼Œ ä½¿ç”¨ç®€å•ï¼ˆæ‰€æœ‰æœ‰ä»“åº“å†™æƒé™çš„äºº éƒ½å¯ä»¥ä½¿ç”¨ï¼Œ åªè¦åˆ›å»º .gitlab-ci.yml å¹¶ä¸”é…ç½®äº† Runner å³å¯ä½¿ç”¨ï¼‰ ã€‚æ¢ä¸ªè§’åº¦ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹ä½¿ç”¨Jenkins çš„é—®é¢˜ï¼Œ Jenkins å¯¹äºé¡¹ç›®çš„é…ç½®å…¶å®å’Œ GitLab çš„ä»£ç æ˜¯åˆ†ç¦»çš„ï¼Œ ä¸¤éƒ¨åˆ†çš„ï¼Œ ç”¨æˆ·ï¼ˆæˆ–è€…è¯´æˆ‘ä»¬çš„å¼€å‘è€…ï¼‰åœ¨ä½¿ç”¨çš„æ—¶å€™ï¼Œ éœ€è¦æœ‰ä¸¤ä¸ªå¹³å°ï¼Œ å¹¶ä¸”ï¼Œå¤§å¤šæ•°æ—¶å€™ï¼Œ Jenkins çš„æƒé™æ˜¯ä¸æ”¾å¼€çš„ã€‚ å¯¹ç”¨æˆ·æ¥è®²ï¼Œ é‚£ç›¸å½“äºæ˜¯ä¸ªé»‘ç›’ã€‚ é‚£å¯èƒ½çš„é—®é¢˜æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ é‡åˆ°æ„å»ºå¤±è´¥äº†ï¼Œ ä½†æ˜¯åªæœ‰è¿ç»´çŸ¥é“å‘ç”Ÿäº†ä»€ä¹ˆï¼Œä½†æ˜¯ç ”å‘æ— èƒ½ä¸ºåŠ›ï¼Œå› ä¸ºæ²¡æœ‰æƒé™ã€‚ ä½¿ç”¨GItLabçš„å¥½å¤„ï¼Œè¿™ä¸ªæ—¶å€™å°±æ›´åŠ çªå‡ºäº†ï¼Œ é…ç½®å°±åœ¨ä»£ç ä»“åº“é‡Œé¢ï¼Œå¹¶ä¸”ä½¿ç”¨ YAML çš„é…ç½®ï¼Œå¾ˆç®€å•ã€‚ æœ‰å•¥é—®é¢˜ï¼Œç›´æ¥æŸ¥ï¼Œç›´æ¥æ”¹ã€‚</p><blockquote><p>Qï¼šå…³äº Runner çš„æ¸…ç†çš„é—®é¢˜ï¼Œåœ¨é•¿æ—¶é—´ä½¿ç”¨åï¼ŒRunner æœºå™¨ä¸Šå›äº§ç”Ÿå¾ˆå¤šçš„ Cache å®¹å™¨ï¼Œå¦‚ä½•æ¸…ç†å‘¢ã€‚èƒ½å¤Ÿåœ¨ä»»åŠ¡ä¸­è‡ªåŠ¨æ¸…é™¤å—ï¼Ÿ</p></blockquote><p>Aï¼šè¿™ä¸ªå°±ç›¸å¯¹ç®€å•äº†ï¼Œé¦–å…ˆï¼Œ å¦‚æœä½ çš„ Cache å®¹å™¨ç¡®è®¤æ²¡ç”¨äº†ï¼Œ æ¯ä¸ª Cache å®¹å™¨å…¶å®éƒ½æœ‰åå­—çš„ï¼Œ ç›´æ¥æŒ‰ Cache çš„åå­—è¿‡ç•¥ï¼Œ æ‰¹é‡åˆ æ‰ã€‚ å¦‚æœä½ ä¸ç¡®å®šå®ƒæ˜¯å¦æœ‰ç”¨ï¼Œé‚£ä½ ç›´æ¥åˆ æ‰ä¹Ÿæ˜¯ä¸å½±å“çš„ï¼Œ å› ä¸º Docker Excutor çš„æ‰§è¡Œæœºåˆ¶æ˜¯åˆ›å»ºå®Œ Service å®¹å™¨åï¼Œ åˆ›å»º Cache å®¹å™¨ã€‚ è¦æ˜¯åˆ æ‰äº†ï¼Œå®ƒåªæ˜¯ä¼šå†åˆ›å»ºä¸€æ¬¡ã€‚ å¦‚æœä½ æƒ³åœ¨ä»»åŠ¡ä¸­æ¸…é™¤ï¼Œ ç›®å‰è¿˜æ²¡åšç›¸å…³çš„å®è·µï¼Œå¾…æˆ‘å®è·µåï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰å¾ˆä¼˜é›…çš„æ–¹å¼ã€‚</p><blockquote><p>Qï¼šè¯·é—®ä¸‹Mavençš„settings.xmlæ€ä¹ˆå¤„ç†ï¼Ÿæœ¬åœ°Mavenä»“åº“å‘¢ï¼Ÿ</p></blockquote><p>Aï¼šæˆ‘ä»¬æ„å»ºäº†ç§æœ‰çš„ Maven é•œåƒï¼Œ ç§æœ‰é•œåƒä¸­æ˜¯é»˜è®¤ä½¿ç”¨äº†æˆ‘ä»¬çš„ç§æœ‰æºã€‚ å¯¹äºé¡¹ç›®ä¸­ç”¨æˆ·æ— éœ€å…³æ³¨ settings.xml ä¸­æ˜¯å¦é…ç½®repoã€‚</p><blockquote><p>Qï¼šåœ¨GitLabçš„CDæ–¹æ¡ˆä¸­ï¼Œåœ¨éƒ¨ç½²çš„æ—¶å€™ï¼Œéœ€è¦åœ¨å˜é‡ä¸­é…ç½®è·³æ¿æœºçš„ç§é’¥ï¼Œå¦‚æœè¿™ä¸ªé¡¹ç›®æ˜¯å¯¹å…¬å¸æ•´éƒ¨é—¨å¼€å‘ï¼Œé‚£ä¹ˆå¦‚ä½•ä¿æŠ¤è¿™ä¸ªç§é’¥å‘¢ï¼Ÿ</p></blockquote><p>Aï¼šå¯ä»¥ä½¿ç”¨ secret variable å°†ç§é’¥å†™å…¥å…¶ä¸­ï¼Œ ï¼ˆä½†æ˜¯é¡¹ç›®çš„ç®¡ç†å‘˜ï¼Œå…·å¤‡æŸ¥çœ‹è¯¥ variable çš„æƒé™ï¼‰å¼€å‘ä¸€ä¸ª web server ï¼ˆå…¶å®åªè¦æš´éœ² IP ç«¯å£ä¹‹ç±»çš„å°±å¯ä»¥ï¼‰ åœ¨ CI æ‰§è¡Œçš„è¿‡ç¨‹ä¸­å»è¯·æ±‚ï¼Œ server å¯¹æ¥æºåšåˆ¤æ–­ ï¼ˆæ¯”å¦‚ æ‰§è¡ŒCI çš„æ—¶å€™ï¼Œä¼šæœ‰ä¸€äº›ç‰¹å®šçš„å˜é‡ï¼Œä»¥æ­¤æ¥åˆ¤æ–­ï¼Œæ˜¯å¦çœŸçš„æ˜¯ CI åœ¨è¯·æ±‚ï¼‰ç„¶åè¿”å›ç§é’¥ã€‚</p><blockquote><p>Qï¼šGitLab CIé€‚åˆä»€ä¹ˆç±»å‹çš„é¡¹ç›®å‘¢ï¼Ÿå›½å†…ç›®å‰è¿˜æ¯”è¾ƒå°ä¼—å§ï¼Ÿ</p></blockquote><p>Aï¼šå›½å†…ç›®å‰è¿˜è¾ƒä¸ºå°ä¼—ï¼ˆç›¸æ¯” Jenkins æ¥è¯´ï¼‰å…¶å®åªè¦éœ€è¦ CI çš„é¡¹ç›®ï¼Œå®ƒéƒ½é€‚åˆã€‚</p><h2 id="2015-09-23ï¼šåŸºäºDockerå’ŒJavaçš„æŒç»­é›†æˆå®è·µ"><a href="#2015-09-23ï¼šåŸºäºDockerå’ŒJavaçš„æŒç»­é›†æˆå®è·µ" class="headerlink" title="2015-09-23ï¼šåŸºäºDockerå’ŒJavaçš„æŒç»­é›†æˆå®è·µ"></a>2015-09-23ï¼šåŸºäºDockerå’ŒJavaçš„æŒç»­é›†æˆå®è·µ</h2><blockquote><p>Qï¼šCIè¿‡ç¨‹ä¸­testéœ€è¦è¿æ¥æ•°æ®åº“çš„ä»£ç æ—¶ï¼Œæ‚¨åœ¨å†™æµ‹è¯•æ¡ˆä¾‹æ–¹é¢æœ‰å“ªäº›ç»éªŒåˆ†äº«ï¼Ÿ</p></blockquote><p>Aï¼šå•å…ƒæµ‹è¯•ä¸èƒ½ä¾èµ–å¤–éƒ¨èµ„æºï¼Œç”¨mockï¼Œæˆ–è€…ç”¨h2ç­‰å†…å­˜æ•°æ®åº“æ›¿ä»£ã€‚é›†æˆæµ‹è¯•çš„æ—¶å€™æ˜¯ä»æ¥å£å±‚ç›´æ¥è°ƒç”¨æµ‹è¯•çš„ï¼Œæµ‹è¯•ç”¨ä¾‹å¯¹æ•°æ®åº“æ— æ„ŸçŸ¥ã€‚</p><blockquote><p>Qï¼šè¯·é—®éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒæ˜¯è‡ªåŠ¨è§¦å‘è¿˜æ˜¯éœ€è¦æ‰‹åŠ¨å®¡æ‰¹ï¼ŸSQLæ‰§è¡Œæˆ–å›æ»šæ˜¯å¦è‡ªåŠ¨åŒ–ï¼Ÿ</p></blockquote><p>Aï¼šå½“å‰æ˜¯éœ€è¦æ‰‹åŠ¨è§¦å‘ã€‚SQLæ›´æ–°å½“å‰æ²¡åšåˆ°è‡ªåŠ¨åŒ–ï¼Œè¿™å—æ­£åœ¨æ”¹è¿›ï¼Œå› ä¸ºéƒ¨ç½²ç§æœ‰ç¯å¢ƒéœ€è¦ã€‚SQLä¸æ”¯æŒå›æ»šï¼Œä»£ç åšå…¼å®¹ã€‚Dockeré•œåƒå›æ»šæ²¡æœ‰è‡ªåŠ¨åŒ–ã€‚</p><blockquote><p>Qï¼š é—®ä¸€ä¸‹ä½ ä»¬çš„Rediså†…å­˜ç‰ˆæ˜¯ç”¨çš„ä»€ä¹ˆï¼Ÿ</p></blockquote><p>Aï¼šæˆ‘ä»¬ç”¨çš„å†…å­˜ç‰ˆçš„redisæ˜¯ <a href="https://github.com/spullara/redis-protocol" target="_blank" rel="noopener">spullara/redis-protocol</a>ä¸­çš„serverå®ç°ã€‚ä¸è¿‡è¿™ä¸ªå®ç°éƒ¨åˆ†åŠŸèƒ½æ²¡æ”¯æŒï¼Œæ¯”å¦‚luaè„šæœ¬ï¼Œæˆ‘ä»¬è‡ªå·±åšäº†æ”¹è¿›ã€‚</p><blockquote><p>Qï¼šä»‹ç»ä¸‹workflowå¸¦æ¥çš„å¥½å¤„ã€‚</p></blockquote><p>Aï¼šworkflowçš„å¥½å¤„æˆ‘é‚£ç¯‡æ–‡ç« ä¸­æœ‰è¯´æ˜ï¼Œå¦‚æœæ²¡æœ‰workflowï¼Œæ‰€æœ‰çš„æ­¥éª¤éƒ½åœ¨åŒä¸€ä¸ªé…ç½®çš„ä¸åŒstepå®ç°ï¼Œå¦‚æœåé¢çš„å¤±è´¥ï¼Œè¦é‡æ–°ä»å¤´å¼€å§‹ã€‚workflowå¯ä»¥ä¸­é€”å¼€å§‹ï¼Œå¹¶ä¸”æ¯ä¸€æ­¥éª¤å®Œæˆéƒ½ä¼šè§¦å‘é€šçŸ¥ã€‚</p><blockquote><p>Qï¼šh2å¹¶ä¸å®Œå…¨å…¼å®¹MySQLè„šæœ¬ï¼Œä½ ä»¬å¦‚ä½•å¤„ç†çš„ï¼Ÿ</p></blockquote><p>Aï¼šæˆ‘ä»¬é€šè¿‡ä¸€äº›hackçš„åŠæ³•ï¼Œä¼šæ¢æµ‹ä¸‹æ•°æ®åº“æ˜¯ä»€ä¹ˆç±»å‹çš„ï¼Œæ›¿æ¢æ‰ä¸€äº›ä¸å…¼å®¹çš„SQLï¼Œè¿›è¡Œå®¹é”™ã€‚</p><blockquote><p>Qï¼šè¯·é—®ä½ ä»¬åœ¨æ„å»ºçš„æ—¶å€™ï¼Œä½ è¯´æœ‰äº›éœ€è¦åŠä¸ªå°æ—¶å·¦å³ï¼Œé‚£ä¹ˆæ„å»ºè¿‡ç¨‹çš„è¿›åº¦ç›‘æ§å’Œå¥åº·ç›‘æ§ä½ ä»¬æ€ä¹ˆåšçš„å‘¢ï¼Œå¦‚æœæœ‰buildå¤±è´¥äº†æ€ä¹ˆå¤„ç†å‘¢ï¼Ÿ</p></blockquote><p>Aï¼šCIçš„æ¯ä¸€æ­¥éƒ½æœ‰è¿›åº¦çš„ï¼Œå¹¶ä¸”æˆ‘ä»¬çš„å›¢é˜Ÿé€šè®¯å·¥å…·å¯ä»¥å’ŒCIé›†æˆï¼Œå¦‚æœå¤±è´¥ä¼šå‘æ¶ˆæ¯åˆ°ç¾¤é‡Œé€šçŸ¥å¤§å®¶ã€‚</p><blockquote><p>Qï¼šcleanupè„šæœ¬åšå“ªäº›ï¼Ÿ</p></blockquote><p>Aï¼šä¸»è¦æ˜¯æ¸…ç†æ—§çš„Dockeré•œåƒï¼Œä»¥åŠæ¸…ç†è‡ªåŠ¨åŒ–æµ‹è¯•äº§ç”Ÿçš„åƒåœ¾æ•°æ®ã€‚</p><blockquote><p>Qï¼šè¯·é—®ä½ ä»¬æ–‡ä»¶å­˜å‚¨æ€ä¹ˆè§£å†³çš„å‘¢ï¼Œä½¿ç”¨è‡ªå·±çš„ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿè¿˜æ˜¯äº‘æœåŠ¡ï¼Ÿ</p></blockquote><p>Aï¼šæ–‡ä»¶ç³»ç»Ÿæ”¯æŒå¤šç§storageé…ç½®ï¼Œå¯ä»¥æ˜¯æœ¬åœ°ç›®å½•ï¼ˆä¾¿äºæµ‹è¯•ï¼‰ï¼Œä¹Ÿå¯ä»¥ä½¿äº‘æœåŠ¡ï¼ˆæ¯”å¦‚s3ï¼‰ã€‚</p><blockquote><p>Qï¼šåˆšæ‰è¯´ä½ ä»¬èƒ½é€šè¿‡ä¸€é”®éƒ¨ç½²ï¼Œä½†æ˜¯ä¸­é—´æ— æ³•ç›‘æ§ï¼Œæµ‹è¯•ç¯å¢ƒå¯ä»¥è¿™ä¹ˆç©ï¼Œé‚£ç”Ÿäº§ç¯å¢ƒä½ ä»¬æ˜¯æ€ä¹ˆåšçš„å‘¢ï¼Ÿè¿˜æœ‰ä½ ä»¬åç»­çš„æ”¹é€ æ–¹å‘æ˜¯è‡ªå·±å¼€å‘ï¼Ÿè¿˜æ˜¯é‡‡ç”¨é›†æˆç¬¬ä¸‰æ–¹è½¯ä»¶ï¼Ÿ</p></blockquote><p>Aï¼šç”Ÿäº§ç¯å¢ƒshellå½“å‰åªèƒ½æ˜¯å¤šåŠ é”™è¯¯åˆ¤æ–­ã€‚è¿™å—æˆ‘ä»¬åœ¨æ”¹è¿›ï¼Œæ¯”å¦‚é€šè¿‡ansibleç­‰å·¥å…·ï¼Œä»¥åŠä½¿ç”¨Kuberneteså†…ç½®çš„rolling-updateã€‚è‡ªåŠ¨åŒ–éƒ¨ç½²è¿™å—è¿˜æ²¡æœ‰å¥½çš„å¼€æºå·¥å…·ã€‚</p><blockquote><p>Qï¼šä½ ä»¬çš„æµ‹è¯•ç”¨äº†å¾ˆå¤šä»£æ›¿æ–¹æ¡ˆã€å¦‚h2ä»£MySQLï¼Œè¦ä¿è¯æµ‹è¯•æ•ˆæœï¼Œé™¤äº†ä½ ä»¬ç”¨çš„hackæ–¹æ³•ä¹‹å¤–ï¼Œæ˜¯ä¸æ˜¯ä»å†™ä»£ç çš„æ—¶å€™å°±å¼€å§‹åšäº†æ–¹ä¾¿æµ‹è¯•çš„è®¾è®¡ï¼Ÿ</p></blockquote><p>Aï¼šå¯¹ã€‚è¿™ä¹Ÿæ˜¯æˆ‘æ–‡ç« ä¸­åˆ†äº«çš„è§‚ç‚¹ä¹‹ä¸€ã€‚æµ‹è¯•ç”¨ä¾‹çš„ç¼–å†™äººå‘˜è¦æœ‰ä¸šåŠ¡ä»£ç çš„ä¿®æ”¹æƒé™ï¼Œæœ€å¥½æ˜¯åŒä¸€ä¸ªäººã€‚è¦åšè‡ªåŠ¨åŒ–æµ‹è¯•ï¼Œä¸šåŠ¡ä»£ç å¿…é¡»è¦ç»™æµ‹è¯•ç•™å„ç§é’©å­ä»¥åŠåé—¨ã€‚</p><blockquote><p>Qï¼šè¯·é—®ä½ ä»¬çš„é›†ç¾¤åº”ç”¨ç¼–æ’æ€ä¹ˆåšçš„ï¼Ÿ</p></blockquote><p>Aï¼šä¸Šé¢è¯´äº†ï¼Œè¿˜æ²¡ç”¨åˆ°ç¼–æ’ã€‚ä¸€ç›´ç­‰ç¼–æ’å·¥å…·çš„æˆç†Ÿã€‚æ­£åœ¨æµ‹è¯•k8sã€‚</p><blockquote><p>Qï¼šä½ ä»¬åšè¿™ä¸ªé¡¹ç›®é€‰å‹æ˜¯å‡ºäºä»€ä¹ˆè€ƒè™‘çš„ï¼Œä»‹ç»é‡Œæœ‰æåˆ°ä½¿ç”¨ä¸€äº›è„šæœ¬æ¥ç®¡ç†å®¹å™¨è§£å†³å¼€å‘å’Œæµ‹è¯•å„ç§é—®é¢˜ï¼Œæ„Ÿè§‰è¿™ç§ç®¡ç†å®¹å™¨æ–¹å¼è¿‡äºç®€å•ä¼šå¸¦æ¥ç®¡ç†é—®é¢˜ï¼Œä¸ºä½•ä¸ç”¨ç¬¬ä¸‰æ–¹å¼€æºé¡¹ç›®æ¥åšäºŒæ¬¡å¼€å‘ï¼Œå¦‚ï¼šKubernetesï¼›å¦ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œä¸‹ä¸€æ­¥æœ‰æ²¡æœ‰è€ƒè™‘å¦‚ä½•è®©ä½ çš„Dockerå’Œäº‘æœåŠ¡å¹³å°ç»“åˆï¼Œè¦è§£å†³è¿è¥æˆæœ¬é—®é¢˜ï¼ˆDockeræœ€å¤§å¸å¼•åŠ›åœ¨è¿™é‡Œï¼‰ï¼Œè€Œä¸åªæ˜¯è§£å†³å¼€å‘æµ‹è¯•é—®é¢˜ï¼Ÿ</p></blockquote><p>Aï¼šå› ä¸ºæˆ‘ä»¬æœ€æ—©ç”¨çš„æ—¶å€™k8s 1.0 è¿˜æ²¡æœ‰ï¼Œå˜åŒ–å¤ªå¤§ï¼Œåˆ›ä¸šå›¢é˜Ÿæ²¡ç²¾åŠ›è·Ÿè¿›ï¼Œè„šæœ¬æ˜¯ç²—æš´ç®€å•çš„åŠæ³•ã€‚ä¸€ç›´åœ¨ç­‰å¾…å„ç§åŸºäºDockerçš„äº‘è§£å†³æ–¹æ¡ˆå‘€ï¼Œè‚¯å®šè€ƒè™‘ç»“åˆã€‚</p><blockquote><p>Qï¼šå¯¹äºDocker storageåˆ†åŒºç”¨å®Œé—®é¢˜ï¼Œæˆ‘æƒ³é—®ä¸€ä¸‹ï¼Œä½ ä»¬æ˜¯ä½¿ç”¨Dockerå®˜æ–¹æä¾›çš„Registryä»“åº“å—ï¼Œå¦‚ä½•è§£å†³ä»“åº“å•ç‚¹é—®é¢˜ï¼Œè¿™æœºå™¨è¦æ˜¯æ•…éšœäº†æ€ä¹ˆåŠï¼Ÿ</p></blockquote><p>Aï¼šRegistryç”¨çš„æ˜¯å®˜æ–¹çš„ï¼Œåç«¯å­˜å‚¨æ˜¯æŒ‚è½½åˆ°s3ä¸Šçš„ã€‚æ²¡æœ‰s3,æ¨èä½¿ç”¨äº¬ä¸œç”°çªå›¢é˜Ÿå¼€æºçš„<a href="https://github.com/jcloudpub/speedy" target="_blank" rel="noopener">Speedy</a>ï¼Œå®ç°äº†åˆ†å¸ƒå¼å­˜å‚¨ã€‚</p><blockquote><p>Qï¼šé™¤äº†ä»‹ç»çš„Javaç›¸å…³çš„CIæ–¹æ¡ˆï¼Œå¯¹äºC/C++å¼€å‘è¯­è¨€æœ‰æ²¡æœ‰æ¨èçš„CIæ–¹æ¡ˆï¼Ÿ</p></blockquote><p>Aï¼šTeamcity/Jenkinsç­‰CIå·¥å…·æ”¯æŒä»»ä½•è¯­è¨€çš„ã€‚å…¶å®ä»»ä½•è¯­è¨€çš„CIéƒ½å·®ä¸å¤šï¼Œå•å…ƒæµ‹è¯•ï¼Œé›†æˆæµ‹è¯•ã€‚å…³é”®è¿˜åœ¨äºä¾èµ–ç¯å¢ƒçš„å‡†å¤‡ä»¥åŠé›†æˆæµ‹è¯•ç”¨ä¾‹çš„ç®¡ç†ã€‚</p><blockquote><p>Qï¼šæˆ‘çœ‹åˆ°ä½ ä»¬ä¸ºäº†æ–¹ä¾¿æµ‹è¯•å’Œè°ƒè¯•ä¼šæœ‰ç‹¬ç«‹çš„é›†åˆDockerç¯å¢ƒï¼Œè¿™ç§ç¯å¢ƒå’Œä¸Šçº¿ç¯å¢ƒå…¶å®æ˜¯æœ‰å·®åˆ«çš„ï¼Œè¿™æ ·æµ‹è¯•çš„ç»“æœèƒ½å¤Ÿä»£è¡¨çº¿ä¸Šç¯å¢ƒå—ï¼Ÿè¿™ç§é—®é¢˜æ€ä¹ˆçœ‹å¾…ï¼Ÿ</p></blockquote><p>Aï¼šæ‰€ä»¥æˆ‘ä»¬æœ‰å¤šä¸ªæµç¨‹ã€‚æ¸…ç†æ•°æ®çš„æµ‹è¯•ç¯å¢ƒï¼Œä»¥åŠä¸æ¸…ç†ç¯å¢ƒçš„æ²™ç®±ç¯å¢ƒã€‚ä½†è¿™ä¹Ÿä¸èƒ½é¿å…ä¸€éƒ¨åˆ†çº¿ä¸Šç¯å¢ƒçš„æ•°æ®å¯¼è‡´çš„bugã€‚å¦å¤–å°±æ˜¯é…åˆç°åº¦ä¸Šçº¿æœºåˆ¶ã€‚å½“å‰æˆ‘ä»¬çš„ç°åº¦æ˜¯é€šè¿‡ä»£ç ä¸­çš„å¼€å…³å®ç°çš„ï¼Œä½¿ç”¨è¿™ç§æ–¹æ¡ˆçš„ä¹Ÿå¾ˆå¤šï¼Œæ¯”å¦‚facebookçš„Gatekeeperã€‚</p><blockquote><p>Qï¼šè¯·é—®Groukæœ‰æ¶‰åŠå‰ç«¯ï¼ˆNode.jsæ–¹é¢çš„ï¼‰å¹¶ç»“åˆDockerçš„CI/CDç»å†å—ï¼Œå¯ä»¥åˆ†äº«ä¸‹å—ï¼Ÿ</p></blockquote><p>Aï¼šè¿™æˆ‘ä»¬ä¹Ÿåœ¨å°è¯•ã€‚å½“å‰jsçš„æµ‹è¯•ä¸»è¦è¿˜æ˜¯åŸºäº<a href="https://github.com/ariya/phantomjs" target="_blank" rel="noopener">ariya/phantomjs</a>ï¼Œçº¯ç²¹çš„jsåº“æ¯”è¾ƒæ–¹ä¾¿æµ‹è¯•ï¼Œä½†å¦‚æœç‰µæ‰¯åˆ°ç•Œé¢ï¼Œå°±æ¯”è¾ƒå¤æ‚äº›äº†ã€‚</p><h2 id="2015-12-22ï¼šåŸºäºDockerå’ŒGitçš„æŒç»­é›†æˆå·¥ä½œæµ"><a href="#2015-12-22ï¼šåŸºäºDockerå’ŒGitçš„æŒç»­é›†æˆå·¥ä½œæµ" class="headerlink" title="2015-12-22ï¼šåŸºäºDockerå’ŒGitçš„æŒç»­é›†æˆå·¥ä½œæµ"></a>2015-12-22ï¼šåŸºäºDockerå’ŒGitçš„æŒç»­é›†æˆå·¥ä½œæµ</h2><blockquote><p>Qï¼šå¼€å‘æ¯æäº¤ä¸€ä¸ªbugfixï¼Œéƒ½ä¼šè§¦å‘jinkenså»æ„å»ºé•œåƒï¼Œé‚£ä¹ˆå¤šçš„å¼€å‘è€…ï¼Œå²‚ä¸æ˜¯è¦æ„å»ºå¾ˆå¤šé•œåƒï¼Ÿ</p></blockquote><p>Aï¼šæ²¡æœ‰é”™ï¼Œæˆ‘ä»¬æ˜¯æ¯æ¬¡éƒ½è§¦å‘æ„å»º imageï¼Œç”±äºimageæ˜¯åˆ†å±‚çš„ï¼Œåº•å±‚å·²ç»å­˜åœ¨çš„çˆ¶å¯¹è±¡ï¼Œæ˜¯ä¸ç”¨å­˜å‚¨ï¼Œåªå­˜å‚¨å˜åŒ–çš„éƒ¨åˆ†æ‰€ä»¥å†ç”¨çš„ç£ç›˜ç©ºé—´å¾ˆä½ï¼Œåœ¨ç³»ç»Ÿå¼€å§‹åˆï¼Œæˆ‘åšè¿‡ç»Ÿè®¡ï¼Œ1000ä¸ª image ä¹Ÿä¸åˆ° 9Gï¼Œè¿™å…¶ä¸­è¿˜æœ‰å¾ˆå¤šåŸºç¡€é•œåƒã€‚</p><blockquote><p>Qï¼šæƒ³é—®ä¸€ä¸ªé›†ç¾¤ç›¸å…³çš„ï¼ŒåƒDockeréƒ¨ç½²è¿™éƒ¨æ˜¯ç›´æ¥è°ƒç”¨Dockeréƒ¨ç½²å®¹å™¨ï¼Œè¿˜æ˜¯é€šè¿‡Ansibleæˆ–å…¶ä»–å·¥å…·ï¼Ÿ</p></blockquote><p>Aï¼šæœ‰äº† Kubernetes ç®¡ç†é›†ç¾¤åï¼Œå‘å¸ƒçš„å·¥ä½œå°±æ¯”è¾ƒç®€å•äº†ï¼Œç”¨ä¸ä¸Š Ansibleã€‚ä½†æ˜¯ Ansible è¿˜æ˜¯æœ‰å®ƒçš„ç”¨å¤„çš„ï¼Œæ¯”å¦‚æ¸…ç†é›†ç¾¤ä¸­è¿‡æ—¶çš„ imageï¼Œå’Œå·²ç»é€€å‡ºçš„ Containerç­‰ã€‚</p><blockquote><p>Qï¼šä½ å¥½ï¼Œä»¥å‰ä¹Ÿåšè¿‡ç±»ä¼¼çš„æœåŠ¡â€ç¬¬ä¸‰æ­¥ï¼šJenkins ä¼šæŠŠç›¸åº”çš„ imageéƒ¨ç½²åˆ°æœåŠ¡å™¨é›†ç¾¤ä¸­ï¼Œå¼€å‘è€…å°±å¯ä»¥é€šè¿‡ iss001.kingdeeè¿™ä¸ªåŸŸåè®¿é—®åˆšåˆšå¯¹åº”åˆ†æ”¯çš„æœåŠ¡äº†â€ï¼Œå•ç‹¬ä¸€ä¸ªåˆ†æ”¯è§£å†³äº†å¯¹åº”çš„bugï¼Œä½†å®é™…ç”Ÿäº§ä¸­éå¸¸å®¹æ˜“ä¿®æ”¹ä¸€ä¸ªbugå¼•èµ·å…¶ä»–çš„bugï¼Œä½ ä»¬æ˜¯æ€ä¹ˆå»æŠŠæ§æ•´ä½“çš„ç¨³å®šæ€§ï¼Ÿå¦‚ä½•æé«˜è¿™ç§å•ä¸ªbugåˆ†æ”¯å•ä¸ªæµ‹è¯•ç¯å¢ƒçš„æ„ä¹‰ï¼Ÿ</p></blockquote><p>Aï¼šè¿™ä¸ª pull-request çš„å·¥ä½œæ–¹å¼æ˜¯åº”å¯¹åŠŸèƒ½å¼€å‘çš„ï¼Œå¦‚åƒé•¿æœŸå¼€å‘æŸä¸ª new featureï¼Œä½ åˆšåˆšè¯´çš„ä¸€ä¸ª bug äº§ç”Ÿå¦å¤–ä¸€ä¸ªbugï¼Œæˆ‘ä»¬çš„åšæ³•æ˜¯æœ‰å›å½’æµ‹è¯•ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ª smoke åˆ†æ”¯ï¼ŒæŒç»­ä¸æ–­çš„å¯¹å…¶åšåŠŸèƒ½å›å½’æµ‹è¯•ï¼Œåªæœ‰é€šè¿‡çš„æ‰èƒ½ cherry pick åˆ°release ä¸Šã€‚</p><blockquote><p>Qï¼šæµ‹è¯•ç¯å¢ƒä¾èµ–çš„redis/MQä¹‹ç±»çš„å¤–éƒ¨æœåŠ¡å¦‚ä½•åšçš„éš”ç¦»?æ¯æ¬¡æµ‹è¯•å•ç‹¬æ‹‰èµ·æ¥ä¸€å¥—å¤–éƒ¨ä¾èµ–çš„æœåŠ¡å—ï¼Ÿ</p></blockquote><p>Aï¼šæˆ‘ä»¬é€šè¿‡å¤šä¸ªæ‰‹æ®µæ¥å®ç°å…±äº«æ•°æ®ï¼šmasterã€smokeã€release åˆ†æ”¯æµ‹è¯•éƒ½æœ‰è‡ªå·±ç‹¬ç«‹çš„ä¸­é—´ä»¶ï¼Œè¦æ˜¯ä¸ç”¨è®¿é—®å…±äº«çš„æ•°æ®ï¼Œå¯ä»¥éƒ¨ç½²å¦‚ MQ imageï¼Œä»£ç å±‚é¢çš„ï¼Œå¦‚ MQ key çš„åç§°åŠ ä¸Šæœºå™¨çš„ IPã€‚</p><blockquote><p>Qï¼šæœ‰æ²¡æœ‰ç”¨åˆ°Mesosï¼Ÿæ˜¯å¦å®¹æ˜“é‡åˆ°é—®é¢˜ï¼Ÿè¿™æ–¹é¢çš„æ–‡æ¡£å¥½åƒå¹¶ä¸å¤šã€‚</p></blockquote><p>Aï¼šMesos æ˜¯ä¸ªäºŒçº§è°ƒåº¦ï¼Œé€‚ç”¨äºåƒå­˜åœ¨å¤šå¥—é›†ç¾¤çš„æƒ…å†µï¼Œæ¥å‡è¡¡èµ„æºï¼Œå¦‚ï¼šéƒ¨ç½²äº† Hadoop å’Œ storm ï¼Œä¸€èˆ¬ä¼šä½¿ç”¨ storm æ¥å¤„ç†å®æ—¶çš„è¯·æ±‚ï¼ŒHadoop åšç¦»çº¿å·¥ä½œã€‚æ™šä¸Šå’Œç™½å¤©å°±å­˜åœ¨ä¸€ç§å¯èƒ½å°±æ˜¯ Hadoop é—²ç½®ï¼Œä½†æ˜¯ storm å¯èƒ½å¾ˆå¿™ï¼Œè¿™æ—¶ Mesos è¿™æ ·çš„äºŒçº§è°ƒåº¦å°±å¯ä»¥å¹³è¡¡èµ„æºï¼ŒèŠ‚çº¦æˆæœ¬ï¼Œæˆ‘ä»¬æš‚æ—¶æ²¡æœ‰è¿™æ ·çš„éœ€æ±‚ã€‚è‡³äºæ–‡æ¡£æ–¹é¢æˆ‘ä¹Ÿæ²¡æœ‰æ·±å…¥ç ”ç©¶ï¼Œå»ºè®®çœ‹å®˜æ–¹æ–‡æ¡£ã€‚</p><blockquote><p>Qï¼šè¯·é—®ä½ ä»¬åœ¨æ„å»ºçš„æ—¶å€™ï¼Œä½ è¯´æœ‰äº›éœ€è¦åŠä¸ªå°æ—¶å·¦å³ï¼Œé‚£ä¹ˆæ„å»ºè¿‡ç¨‹çš„è¿›åº¦ç›‘æ§å’Œå¥åº·ç›‘æ§ä½ ä»¬æ€ä¹ˆåšçš„å‘¢ï¼Œå¦‚æœæœ‰buildå¤±è´¥äº†æ€ä¹ˆå¤„ç†å‘¢ï¼Ÿ</p></blockquote><p>Aï¼šCIçš„æ¯ä¸€æ­¥éƒ½æœ‰è¿›åº¦çš„ï¼Œå¹¶ä¸”æˆ‘ä»¬çš„å›¢é˜Ÿé€šè®¯å·¥å…·å¯ä»¥å’ŒCIé›†æˆï¼Œå¦‚æœå¤±è´¥ä¼šå‘æ¶ˆæ¯åˆ°ç¾¤é‡Œé€šçŸ¥å¤§å®¶ã€‚</p><h2 id="QA-Gitlab"><a href="#QA-Gitlab" class="headerlink" title="QA Gitlab"></a>QA Gitlab</h2><blockquote><p>Q9ï¼šgitlabæ¥æ”¶ä¸€ä¸ªpush eventè§¦å‘æ„å»ºï¼Œè¿™ä¸ªæ˜¯ç›‘æ§æ‰€æœ‰çš„åˆ†æ”¯å—ï¼Œåˆ†æ”¯æ¨¡å‹æ˜¯æ€ä¹ˆæ ·çš„</p></blockquote><p>Aï¼šä¸æ˜¯çš„ï¼ŒæŒ‰éœ€ã€‚æˆ‘ä»¬å†…éƒ¨åˆ†æ”¯æ¨¡å‹å¤§æ¦‚æœ‰å››ç§ï¼Œdevâ€”â€”&gt;testâ€”â€”&gt;releaseâ€”â€”&gt;masterã€‚masterä»¥å¤–çš„ä¸ºäº†æ•ˆç‡éƒ½ä¼šåšè‡ªåŠ¨è§¦å‘</p><blockquote><p>Q11ï¼šä¸ºä»€ä¹ˆä¸ç›´æ¥ç”¨gitlab-runner è€Œæ¥jenkins</p></blockquote><p>Aï¼šgitlab-runner éœ€è¦æ¯ä¸ªä»“åº“éƒ½é…ç½®æ„å»ºä¿¡æ¯ï¼Œå½“éœ€è¦ç»Ÿä¸€ä¿®æ”¹æ„å»ºçš„æ—¶å€™å¾ˆéº»çƒ¦</p><blockquote><p>Qï¼šæŒç»­é›†æˆç³»ç»Ÿå…·ä½“çš„ç»†èŠ‚å¯ä»¥é€éœ²ä¸‹å—ï¼ŸåŸºäºgitlab ciï¼Œjekinsï¼Ÿæˆ–è€…å°å…¬å¸å¯ä»¥ç›´æ¥ç”¨Spinnaker è¿™äº›å—ï¼Ÿ</p></blockquote><p>Aï¼šci cdçš„è¯å› ä¸ºæˆ‘ä»¬æœ‰è‡ªå·±ç°æœ‰çš„å‘å¸ƒå¹³å°ï¼ŒèƒŒåçš„åŸç†å®é™…ä¸Šè¿˜æ˜¯è°ƒç”¨jenkinså»å¤„ç†</p><blockquote><p>Qï¼šå’Œgitlab ciç›¸æ¯”æœ‰ä»€ä¹ˆä¼˜åŠ¿</p></blockquote><p>Aï¼š å’Œ gitlab ci ç›¸æ¯”çš„ä¼˜åŠ¿å¯ä»¥å‚è€ƒä¸‹ jenkins ä¸ jenkins xçš„å¯¹æ¯”ã€‚åœ¨ç”¨æˆ·è§’åº¦æ¥è¯´ï¼Œä»¥åº”ç”¨ä¸ºè§†è§’ä½¿ç”¨èµ·æ¥ä¼šæ›´åŠ æ–¹ä¾¿ï¼Œä¹Ÿæ–¹ä¾¿åˆ©ç”¨ç¤¾åŒºèµ„æºã€‚ä»æ¶æ„å’Œå¯ç»´æŠ¤æ€§æ¥è¯´ï¼ŒJenkins X çš„æ¶æ„ä¼šç›¸å¯¹æ›´åŠ å…ˆè¿›ï¼ˆä¸è¯ç”Ÿå¹´ä»£æœ‰ç›´æ¥å…³ç³»)ã€‚</p><blockquote><p>Qï¼š ç›®å‰æˆ‘ä»¬ä½¿ç”¨çš„gitlab-ci-runner éƒ¨ç½²äºk8sä¹‹å¤–å®ç°ci/cdã€‚å‘ç°gitlab-ciåœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œç»å¸¸ä¼šé‡åˆ°å¡æ­»æŠ¥é”™ã€‚è¯·é—®ä¸‹ï¼Œç›¸æ¯”jenkins åšci/cd æ˜¯ä¼šæœ‰ä»€ä¹ˆä¼˜åŠ¿ï¼Œä¹‹å‰å¹¶æ²¡æœ‰ä½¿ç”¨è¿‡jenkins.</p></blockquote><p>Aï¼šgitlab-ciç”Ÿäº§ç¯å¢ƒä¸­ï¼Œæˆ‘ä»¬ä¹Ÿæ²¡æœ‰ä½¿ç”¨ï¼Œæˆ‘ä»¬è°ƒç ”çš„ç»“æœæ˜¯1ã€æœ‰ä¾µå…¥æ€§ 2ã€pipelineåŠŸèƒ½è¾ƒå¼±ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªå¥½å¤„æ˜¯é‡åˆ°é”™è¯¯å¥½åƒè¿˜å¯ä»¥ç»§ç»­æ‰§è¡Œã€‚jenkinsé‡åˆ°é”™è¯¯ä¼šä¸­æ–­æµç¨‹ã€‚</p><blockquote><p>Qï¼šè¯·é—®Jenkinswebhooké‚£äº›æ„å»ºå‚æ•°å¦‚ä½•ä¼ å…¥GitLabè§¦å‘ï¼Ÿ</p></blockquote><p>Aï¼šwebhookçš„è§¦å‘å’Œç•Œé¢å‚æ•°ä¼šæœ‰ä¸€äº›åŒºåˆ«ï¼Œæˆ‘ä»¬åœ¨è„šæœ¬é‡Œé¢åšäº†å¤„ç†ã€‚</p><blockquote><p>Qï¼šç¦»çº¿éƒ¨ç½²ï¼Œæ˜¯ä¸æ˜¯é€šè¿‡æ‰“å‡ºé•œåƒå‹ç¼©åŒ…ï¼Œç„¶åå¸¦ç€é•œåƒåŒ…åˆ°ç°åœºéƒ¨ç½²çš„å®¹å™¨äº‘å¹³å°ä¸Šï¼Œä¸Šä¼ éƒ¨ç½²çš„æ–¹å¼ï¼Ÿ</p></blockquote><p>Aï¼šæ˜¯åœ¨å®¶é‡Œæ‰“å‡ºé•œåƒå‹ç¼©åŒ…ï¼Œç„¶ååˆ°ç°åœºè§£å‹å‡ºæ¥ï¼Œæ ¹æ®é•œåƒç±»å‹è¿›è¡Œå¤„ç†ï¼Œæ¯”å¦‚ä¸€äº›åŸºç¡€é•œåƒï¼Œä¼šç›´æ¥ä¸Šä¼ åˆ°èŠ‚ç‚¹ï¼Œä¸šåŠ¡çš„é•œåƒä¼šåœ¨éƒ¨ç½²å®Œæˆåä¸Šä¼ åˆ°Harborï¼Œç„¶åèŠ‚ç‚¹ä»Harborå»æ‹‰å–ã€‚</p><blockquote><p>Qï¼šGitLab è‡ªå¸¦çš„ CI ä¸Jenkins å’Œ GitLab ç»“åˆçš„ CIï¼Œè¯¥å¦‚ä½•é€‰æ‹©ï¼Ÿæƒ³çŸ¥é“æ›´æ·±å±‚æ¬¡çš„ç†è§£ã€‚</p></blockquote><p>Aï¼šè¿˜æ˜¯è¦ç»“åˆè‡ªå·±å›¢é˜Ÿçš„å®é™…æƒ…å†µåšé€‰æ‹©ã€‚ä»æˆç†Ÿåº¦æ¥è¯´ï¼Œè‚¯å®šæ˜¯ Jenkinsç”¨æˆ·æœ€å¤šï¼Œæˆç†Ÿåº¦æœ€é«˜ï¼Œç¼ºç‚¹æ˜¯ä¾§é‡ Javaï¼Œé…ç½®ç›¸å¯¹ç¹çã€‚GitLab è‡ªå¸¦çš„ CIç›¸å¯¹ç®€å•ï¼Œå¯ä»¥ç”¨ yamlï¼Œå’Œ GitLab ç»“åˆçš„æœ€å¥½ï¼Œä½†åŠŸèƒ½è‚¯å®šæ²¡æœ‰ Jenkinså…¨é¢ã€‚å¦‚æœæ˜¯å°å›¢é˜Ÿæ–°é¡¹ç›®ï¼ŒGitLab CI åˆå·²ç»å¯ä»¥æ»¡è¶³éœ€æ±‚çš„è¯ï¼Œå¹¶ä¸éœ€è¦ä¸ŠJenkinsï¼Œå¦‚æœæ˜¯è¾ƒå¤§çš„å›¢é˜Ÿï¼Œåˆæ˜¯å Java çš„ï¼Œä¸ªäººæ›´åå‘ Jenkinsã€‚</p><blockquote><p>Qï¼šæœ‰äº†Gerritï¼Œä¸ºä»€ä¹ˆè¿˜è¦GitLabï¼ŒGerritä¹Ÿå¯ä»¥æ‰˜ç®¡ä»£ç å•Šï¼Ÿ</p></blockquote><p>Aï¼šè¿™ä¸ªæ˜¯æœ‰å†å²èƒŒæ™¯çš„ï¼Œæˆ‘ä»¬æ˜¯å…ˆé€‰æ‹©ä½¿ç”¨GitLabåšä»£ç æ‰˜ç®¡ï¼ŒåæœŸæ‰åŠ å…¥Gerritåšcode reviewã€‚Gerritåœ¨ä»£ç reviewæ–¹é¢æ¯”GitLabçš„merge requestè¦æ–¹ä¾¿è®¸å¤šï¼Œæ›´é€‚åˆä¼ä¸šå†…éƒ¨ä½¿ç”¨ã€‚å…³äºè¿™ä¸ªï¼Œæˆ‘çš„æƒ³æ³•æ˜¯ï¼Œè¦ä¹ˆå°†GitLabè¿ç§»åˆ°Gerritï¼Œè¦ä¹ˆä¸ç”¨Gerritï¼Œå¯ä»¥ä½¿ç”¨GitLabçš„merge requestæ¥è¿›è¡Œreviewï¼Œé‚£GitLabå…¶å®æ˜¯å¯ä»¥ä¸è¦çš„ã€‚</p><blockquote><p>Qï¼šå…¬å¸ç¯å¢ƒè¾ƒå¤æ‚ï¼šåŒ…å«Javaé¡¹ç›®ã€PHPé¡¹ç›®ï¼ŒJavaé¡¹ç›®ç›®å‰å¤§å¤šæ˜¯SpringBootæ¡†æ¶ï¼ŒPHPæ˜¯ThinkPHPæ¡†æ¶ï¼Œé¡¹ç›®æ¶æ„å¹¶ä¸å¤æ‚ï¼Œæœ‰å°‘è®¸Javaé¡¹ç›®éœ€è¦ç”¨Redisåˆ°Memcachedã€ç¼“å­˜æœºåˆ¶ã€‚æœ€å¤§é—®é¢˜çš„æ˜¯å¤šï¼Œé¡¹ç›®åº”è¯¥å¦‚ä½•è¾ƒå¥½çš„ä¾æ‰˜Kubernetesé¡ºåˆ©æ¶æ„ï¼Œå°†é¡¹ç›®å¯æŒç»­é›†æˆï¼Ÿ</p></blockquote><p>Aï¼šæˆ‘ä»¬çš„Redisè¿™ä¸€ç±»ä¸­é—´ä»¶è¿˜æ”¾åœ¨VMä¸Šï¼Œç›®å‰å°šæœªæ‰“ç®—æ¬ç§»åˆ°Kubernetesä¸Šï¼ŒKubernetes+Dockerå¤©ç„¶æ˜¯è·¨å¹³å°çš„ï¼ŒPHPä¹Ÿå¯ä»¥æ”¯æŒï¼Œå¹¶ä¸”å¯¹å®¹å™¨é›†ç¾¤ï¼ˆæ—¢åº”ç”¨é›†ç¾¤ï¼‰ç®¡ç†éå¸¸å‡ºè‰²ï¼ŒåŒ…å«éƒ¨åˆ†è‡ªåŠ¨åŒ–è¿ç»´ï¼Œå¹¶ä¸ä¼šå› å¤šç§å¼€å‘è¯­è¨€è€Œå¢åŠ è´Ÿæ‹…ï¼ŒæŒç»­é›†æˆæ˜¯å¦å¤–ä¸€å—ï¼Œç›®å‰å„å¤§CIå·¥å…·å‚å•†ä¹Ÿéƒ½æ”¯æŒKubernetesï¼Œæ¯”è¾ƒå‹å¥½ï¼Œæˆ‘ä»¬é‡‡ç”¨çš„æ˜¯GitLab-CIã€‚</p><blockquote><p>Qï¼šSonarQubeçš„æƒé™æ§åˆ¶åŠæ€§èƒ½å½“é¢ï¼Ÿ</p></blockquote><p>Aï¼šæƒé™æ§åˆ¶ä½¿ç”¨SonarQubeæä¾›çš„APIï¼Œå°†é¡¹ç›®è·ŸGitLabä¸­ç›¸åº”é¡¹ç›®æƒé™åŒ¹é…èµ·æ¥ï¼ŒGitLabä¸­å¯ä»¥æŸ¥çœ‹è¿™ä¸ªé¡¹ç›®ä»£ç ï¼Œé‚£ä¹ˆSonarQubeä¸­å°±èƒ½çœ‹åˆ°è¿™ä¸ªé¡¹ç›®ç»“æœå’ŒCodeã€‚</p><blockquote><p>Q: ä½ ä»¬æ˜¯ç›´æ¥å°†SonarQubeã€GitLab/Jenkinsçš„æƒé™æ§åˆ¶åˆ°ä¸€èµ·äº†ï¼Ÿæ€æ ·åšçš„ç»Ÿä¸€ï¼Ÿ</p></blockquote><p>Aï¼šä½¿ç”¨LDAPè®¤è¯ã€‚</p><blockquote><p>Qï¼šGit Checkoutçš„æ—¶å€™ï¼Œä½ ä»¬çš„Git SCMæ²¡æœ‰è€ƒè™‘éšç§å®‰å…¨çš„äº‹æƒ…å—ï¼Œæ¯”å¦‚ä»£ç æƒé™å—é™ï¼Ÿ</p></blockquote><p>Aï¼šJenkinsä½¿ç”¨äº†ä¸€ä¸ªæœ€å°æƒé™ç”¨æˆ·å»GitLabä¸Šæ‹‰ä»£ç ã€‚å®‰å…¨æ–¹é¢ï¼ŒJenkinsæ‰€æœ‰èŠ‚ç‚¹éƒ½æ˜¯å¯æ§çš„ã€‚</p><blockquote><p>Qï¼šJenkinsçš„æŒç»­é›†æˆæ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿæ¯”å¦‚ä¸åŒçš„æºç ä»“åº“çš„æäº¤è§¦å‘ï¼Œå¦‚GitHubã€GitLabç‰ˆæœ¬å·æ€ä¹ˆæ§åˆ¶çš„ï¼Ÿ</p></blockquote><p>Aï¼šJenkinsçš„CIæµç¨‹è§¦å‘å¯ä»¥æœ‰å¾ˆå¤šç§ï¼Œä»£ç æäº¤è§¦å‘ï¼Œå®šæ—¶è§¦å‘ï¼Œæ‰‹åŠ¨è§¦å‘ã€‚ç‰ˆæœ¬å·çš„æ§åˆ¶ä¹Ÿå¯ä»¥æœ‰å¾ˆå¤šæ–¹æ¡ˆï¼Œæ¯”å¦‚ä½¿ç”¨jobçš„ç¼–å·ï¼Œä½¿ç”¨Gitçš„commitå·ï¼Œä½¿ç”¨æ—¶é—´æˆ³ç­‰ç­‰ã€‚</p><blockquote><p>Qï¼šè¯·é—®ï¼Œæˆ‘ä»¬æ˜¯javaé¡¹ç›®ï¼Œåœ¨ä¸šåŠ¡ä»£ç æ‰“æˆwaråŒ…åï¼ŒwaråŒ…å¾ˆå¤§çš„æƒ…å†µä¸‹ï¼Œåœ¨å‘å¸ƒæµç¨‹ä¸­ï¼Œå¦‚ä½•å®Œæˆpodä¸­çš„å®¹å™¨çš„ä»£ç æ›´æ–°ï¼Œæ˜¯é‡‡ç”¨æŒ‚è½½ä»£ç åé‡å¯å®¹å™¨æ–¹å¼ï¼Œè¿˜æ˜¯é‡‡ç”¨æ¯æ¬¡é‡æ–°æ„å»ºä»£ç é•œåƒï¼Œç›´æ¥æ›´æ–°å®¹å™¨ï¼Œæˆ–è€…æœ‰ä»€ä¹ˆæ›´å¥½çš„å»ºè®®å—</p></blockquote><p>Aï¼šé…ç½®åˆ†ç¦»ï¼ˆä¸Šé…ç½®ä¸­å¿ƒ)ï¼Œå‚æ•°é€šè¿‡å¯åŠ¨é‰´æƒä¸‹è½½é…ç½®æ–‡ä»¶å¯åŠ¨ï¼Œè¿™æ ·å­ç¯å¢ƒçš„æ›´æ–°åªéœ€è¦åŸºäºé€šè¿‡ä¸€ä¸ªåŒ…å³å¯ã€‚</p><blockquote><p>Qï¼šä¸€ä¸ªJobç”Ÿæˆæ‰€æœ‰çš„Dockeré•œåƒï¼Œå¦‚æœæ„å»ºé‡åˆ°é—®é¢˜ï¼Œæ€ä¹ˆå»è¿½è¸ªè¿™äº›è®°å½•ï¼Ÿ</p></blockquote><p>Aï¼šåœ¨é¡¹ç›®å‰æœŸæ¥å…¥æ—¶ï¼Œç”Ÿæˆé•œåƒçš„æµç¨‹éƒ½ä½œäº†å®£ä¼ å’Œæ¨å¹¿ã€‚æ ‡å‡†åŒ–çš„æµç¨‹ï¼Œä¼šå‡å°‘äº§ç”Ÿé—®é¢˜çš„æœºç‡ã€‚å¦‚æœåœ¨æ„å»ºä¸­é‡åˆ°é—®é¢˜ï¼ŒPrism4kçš„ç•Œé¢ä¸­ï¼Œä¼šç›´æ¥æœ‰é“¾æ¥åˆ°æœ¬æ¬¡å»ºçš„æ¬¡åºå·ã€‚ç‚¹å‡»é“¾æ¥ï¼Œå¯ç›´æ¥å®šä½åˆ°Consoleè¾“å‡ºã€‚</p><blockquote><p>Qï¼šJobå’Œdindå¦‚ä½•é…åˆå»å®ç°æ‰“åŒ…é•œåƒçš„å‘¢ï¼Ÿ</p></blockquote><p>Aï¼šé¦–å…ˆæ˜¯dindæŠ€æœ¯ï¼Œé€šè¿‡æŒ‚è½½å®¿ä¸»æœºçš„docker clientå’Œdockersockï¼Œå¯ä»¥å®ç°åœ¨å®¹å™¨å†…è°ƒç”¨å®¿ä¸»æœºçš„Dockeræ¥åšä¸€äº›äº‹æƒ…ï¼Œè¿™é‡Œæˆ‘ä»¬ä¸»è¦å°±ç”¨äºbuildã€‚Kubernetesçš„Jobåˆ™æ˜¯ç”¨äºæ‰§è¡Œè¿™ä¸ªæ„å»ºworkerçš„æ–¹å¼ï¼Œåˆ©ç”¨Kubernetesçš„Jobæ¥è°ƒåº¦æ„å»ºä»»åŠ¡ï¼Œå……åˆ†åˆ©ç”¨æµ‹è¯•é›†ç¾¤çš„ç©ºé—²èµ„æºã€‚</p><blockquote><p>Qï¼šè¯·é—®ä¸‹Mavençš„settings.xmlæ€ä¹ˆå¤„ç†ï¼Ÿæœ¬åœ°Mavenä»“åº“å‘¢ï¼Ÿ</p></blockquote><p>Aï¼šæˆ‘ä»¬æ„å»ºäº†ç§æœ‰çš„ Maven é•œåƒï¼Œ ç§æœ‰é•œåƒä¸­æ˜¯é»˜è®¤ä½¿ç”¨äº†æˆ‘ä»¬çš„ç§æœ‰æºã€‚ å¯¹äºé¡¹ç›®ä¸­ç”¨æˆ·æ— éœ€å…³æ³¨ settings.xml ä¸­æ˜¯å¦é…ç½®repoã€‚</p><blockquote><p>Qï¼šç”Ÿæˆæ–°çš„é•œåƒæ€ä¹ˆè‡ªåŠ¨æ‰“æ–°çš„tagï¼Ÿ</p></blockquote><p>Aï¼šæˆ‘ä»¬é•œåƒTagä½¿ç”¨æœ¬æ¬¡æ„å»ºé€‰å®šçš„Gitç‰ˆæœ¬ï¼Œå¦‚åˆ†æ”¯åç§°æˆ–è€…Tagã€‚</p><blockquote><p>Qï¼š å¦‚ä½•åŠ¨æ€ç”ŸæˆDockerfileï¼Œå¦‚ä½•åœ¨Dockeré•œåƒé‡Œé…ç½®JVMå‚æ•°ï¼Ÿ</p></blockquote><p>Aï¼šDockerfileæ–‡ä»¶ï¼šæˆ‘ä»¬æ˜¯ä½¿ç”¨shè„šæœ¬ç”Ÿæˆçš„ï¼Œå°†å†…å®¹ &gt;&gt; Dockerfileä¸­ï¼›JVMå‚æ•°æ˜¯åœ¨åº”ç”¨ä¸­é…ç½®çš„ï¼Œå‘é€æ„å»ºæ¶ˆæ¯æ—¶ï¼Œä½œä¸ºæ¶ˆæ¯å†…å®¹é€è¿‡å»ã€‚</p><blockquote><p>Qï¼šDocker çš„æ­£ç¡®çš„ä½¿ç”¨å§¿åŠ¿ï¼Œåœ¨æœ¬åœ°ç¯å¢ƒå·²ç»æ„å»ºäº†ä¼ä¸šç§æœ‰ Registry Harborï¼Œé‚£ä¹ˆæˆ‘è¦æ„å»ºåŸºäºä¸šåŠ¡çš„åº”ç”¨æ—¶ï¼Œæ˜¯å…ˆä» Linux ç³»åˆ—çš„åƒ Ubuntu æˆ– CentOS çš„ Base çš„ Docker é•œåƒå¼€å§‹ï¼Œç„¶åé€šè¿‡ Dockerfile å®šåˆ¶ä¸šåŠ¡éœ€æ±‚ï¼Œæ¥ä½¿ç”¨å—ï¼Ÿ</p></blockquote><p>Aï¼šæˆ‘ä»¬åŸºç¡€é•œåƒç»Ÿä¸€é‡‡ç”¨ CentOS 6.8ï¼Œä¸åŒçš„ä¸šåŠ¡æœ‰ä¸åŒçš„ Dockerfile æ¨¡æ¿ï¼Œç”Ÿæˆé•œåƒçš„è¿‡ç¨‹ä¸šåŠ¡å¯¹ Dockerfile æ˜¯é€æ˜çš„ã€‚</p><blockquote><p>Qï¼šä½¿ç”¨Pipelineå…ˆæ„å»ºç¼–è¯‘ç¯å¢ƒé•œåƒï¼Œå†ç¼–è¯‘ï¼Œæ˜¯å¦ä¼šå¯¼è‡´æ•´ä¸ªæµç¨‹éœ€è¦å¾ˆé•¿æ—¶é—´ï¼Ÿæ˜¯å¦æœ‰ä¼˜åŒ–æ–¹æ¡ˆï¼Ÿ</p></blockquote><p>Aï¼šç¼–è¯‘é•œåƒç”±äºä¸ä¼šç»å¸¸å˜åŠ¨ï¼Œå› æ­¤è¿™ä¸ªé•œåƒçš„æ„å»ºé€šå¸¸ä½¿ç”¨cacheå°±èƒ½ç›´æ¥å®Œæˆï¼Œå¦å¤–æˆ‘ä»¬ä¹ŸæŠŠç¼–è¯‘ç¯å¢ƒé•œåƒæ‰“åŒ…è¿™ä¸ªæ­¥éª¤æŠ½å‡ºæ¥å•ç‹¬ä½œä¸ºjobæ‰§è¡Œäº†ï¼Œè¿™æ ·åœ¨å®é™…ç¼–è¯‘æµç¨‹ä¸­å°±æ— éœ€å†è¿›è¡Œç¼–è¯‘ç¯å¢ƒæ„å»ºã€‚</p><blockquote><p>Qï¼šDockerå­˜å‚¨è€ƒè™‘è¿‡Overlayå½“æ—¶å—ï¼Ÿæ®è¯´è¿™ç§æ„å»ºé•œåƒæ¯”è¾ƒå¿«ã€‚</p></blockquote><p>Aï¼šè€ƒè™‘è¿‡ï¼Œå½“æ—¶ä¹Ÿåšè¿‡å„ä¸ªæ–¹é¢çš„æµ‹è¯•ï¼Œè¿™ç§å¢é‡å¼çš„æ„å»ºï¼Œè‚¯å®šæœ€å¿«ï¼Œä½†æ˜¯æˆ‘ä»¬éœ€è¦æœ‰ä¸“äººä»æºç çº§åˆ«å¯¹å…¶è¿›è¡Œç»´æŠ¤ï¼Œæˆæœ¬å¯¹äºæˆ‘ä»¬è¿˜æ˜¯æœ‰ç‚¹é«˜ï¼Œæˆ‘ä»¬åæœŸæ‰“ç®—é‡‡ç”¨ç¯å¢ƒå’Œä»£ç åˆ†ç¦»çš„æ–¹å¼ï¼Œå³ç¯å¢ƒéƒ¨ç½²ä¸€æ¬¡ï¼Œä»£ç å¤šæ¬¡éƒ¨ç½²æ¥æå‡æ•ˆç‡ã€‚</p><blockquote><p>Qï¼šæ‚¨æåˆ°ä¸è¿‡åˆ†å¼ºè°ƒæµ‹è¯•è‡ªåŠ¨åŒ–ï¼Œå°½é‡ä¸æ”¹å˜æµ‹è¯•æµç¨‹ï¼Œé‚£ä¹ˆå¯¹äºè‡ªåŠ¨æ„å»ºå’Œå•å…ƒæµ‹è¯•çš„è‡ªåŠ¨åŒ–æœ‰æ²¡æœ‰è€ƒè™‘å‘¢ï¼Ÿæ¯•ç«Ÿè¿™äº›æ˜¯æ¯”è¾ƒæ¶ˆè€—äººåŠ›çš„éƒ¨åˆ†ã€‚</p></blockquote><p>Aï¼šè‡ªåŠ¨æ„å»ºæˆ‘è®¤ä¸ºæ¯”è¾ƒç°å®ï¼Œå•å…ƒæµ‹è¯•æœ‰è€ƒè™‘ã€‚ä¸è¿‡æˆ‘ä»¬æµ‹è¯•æ¡ˆä¾‹è¿‡äºå¤æ‚ï¼Œç›®å‰çœ‹çŸ­æœŸå®ç°ä¸å¤ªç°å®ã€‚è€Œä¸”æ€§èƒ½ä¹Ÿæ˜¯ä¸ªé—®é¢˜ï¼Œå¦‚æœä¸‹ä¸€æ­¥è¦åšæˆ‘ä»¬ä¼šæ›´å¤šè€ƒè™‘ä¸€äº›ç‰¹å®šåœºæ™¯ã€‚æ¯”å¦‚äº§å“å‘å¸ƒåçš„å›å½’æµ‹è¯•ï¼Œè¿™ä¸ªæœ‰å¯èƒ½ï¼Œä½†ä¸ä¼šæ˜¯æ™®éåº”ç”¨ã€‚</p><blockquote><p>Qï¼šè‡ªåŠ¨åŒ–æ„å»ºè¿‡ç¨‹ä¸­ï¼Œå¯¹åº”ç”¨çš„æµ‹è¯•æ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿ</p></blockquote><p>Aï¼šå•å…ƒæµ‹è¯•å¯ä»¥åœ¨ç¼–è¯‘çš„æ—¶å€™å®Œæˆï¼ŒåŠŸèƒ½æµ‹è¯•éœ€è¦å¯åŠ¨éƒ¨ç½²ã€‚</p><blockquote><p>Qï¼šé€šè¿‡é•œåƒçš„æ„å»ºè„šæœ¬æ˜¯æ€ä¹ˆç”Ÿæˆé•œåƒçš„ï¼Ÿåœ¨åŸºç¡€é•œåƒä¸Šæ‰§è¡Œç›¸å…³è„šæœ¬ä¹ˆï¼Ÿä¸€äº›ç«¯å£å­˜å‚¨å·ç¯å¢ƒå˜é‡è¿™äº›é•œåƒä¸­çš„ä¿¡æ¯æ˜¯æ€ä¹ˆè§£å†³çš„ï¼Ÿ</p></blockquote><p>Aï¼šæˆ‘ä»¬å¯¹Dockerfileè¿›è¡Œäº†å°è£…ï¼Œä¸šåŠ¡å’Œå¼€å‘äººå‘˜ä¸éœ€è¦å…³å¿ƒDockerfileè¯­æ³•ï¼Œç›´æ¥å†™ä¸€ä¸ªé•œåƒæ„å»ºè„šæœ¬ï¼Œæœ€åæ ¹æ®ä¸€å®šçš„è§„åˆ™ç”±Harborç”ŸæˆDockerfileï¼Œä¹‹åè°ƒç”¨docker buildå»ç”Ÿæˆé•œåƒã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œ é•œåƒçš„åç§°ï¼Œç‰ˆæœ¬éƒ½å·²ç»æ ¹æ®è§„åˆ™ç”Ÿæˆ</p><blockquote><p>Qï¼šåœ¨æ„å»ºæ—¶å€™ï¼Œè¿™äº›ç¯å¢ƒå¯ä»¥æå‰å®‰è£…å¥½ï¼Ÿ</p></blockquote><p>Aï¼šåº”ç”¨é‡Œéƒ½æœ‰è‡ªå·±çš„ç‰ˆæœ¬æ¦‚å¿µï¼Œæ¯ä¸ªåº”ç”¨ç‰ˆæœ¬é‡Œæœ‰ï¼šé•œåƒç‰ˆæœ¬ï¼Œç¯å¢ƒå˜é‡ã€ exportã€Volmueç­‰ä¿¡æ¯ï¼Œæ‰€ä»¥åœ¨å›é€€æˆ–è€…å‡çº§æ—¶å€™ï¼Œæœ€ç»ˆçš„è¡¨ç°å½¢å¼å°±æ˜¯æ€æ‰æ—§å®¹å™¨ï¼Œæ ¹æ®ç‰ˆæœ¬çš„å‚æ•°åˆ›å»ºæ–°å®¹å™¨ã€‚</p><blockquote><p>Qï¼šè¯·é—®æ„å»ºä¸€æ¬¡å¹³å‡è¦å¤šé•¿æ—¶é—´ï¼Ÿ</p></blockquote><p>Aï¼šç°åœ¨Javaã€Dubboã€Pythonã€goçš„å¤šï¼Œ ä¸€èˆ¬2åˆ†é’Ÿï¼Œè€Œä¸”æœ‰çš„é•œåƒç”¨æˆ·å¼€å¯äº†è‡ªåŠ¨æ„å»ºåï¼Œåœ¨ä»–ä»¬æ²¡æ„è¯†çš„è¿‡ç¨‹ä¸­ï¼Œéƒ½å·²ç»æ„å»ºå®Œæˆã€‚ åˆ°æ—¶å€™å‡çº§æ—¶å€™ï¼Œé€‰æ‹©å¯¹åº”çš„é•œåƒç‰ˆæœ¬å³å¯ã€‚</p><blockquote><p>Qï¼šAppçš„æ¯ä¸€æ¬¡æäº¤éƒ½æ˜¯ä¸€ä¸ªversionå—ï¼Œæ˜¯ä¸æ˜¯æ¯æ¬¡æ„å»ºå®Œæµ‹è¯•å®Œæˆï¼Œå°±å¯ä»¥å‘å¸ƒäº†ï¼Ÿ</p></blockquote><p>Aï¼šApp æ²¡æœ‰æäº¤çš„æ¦‚å¿µï¼Œæ‚¨è¯´çš„åº”è¯¥æ˜¯é•œåƒï¼Œæˆ‘ä»¬è®¾è®¡çš„æ˜¯ä¸€ä¸ªé•œåƒå¯¹åº”ä¸€ä¸ªGitä»“åº“ä»¥åŠåˆ†æ”¯ã€‚å½“æœ‰pushæˆ–è€…tagæ“ä½œåï¼Œä¼šè‡ªåŠ¨è§¦å‘æ„å»ºï¼Œæ„å»ºçš„è¡Œä¸ºæ˜¯æ ¹æ®ç”¨æˆ·å†™çš„é•œåƒæ„å»ºshellè„šæœ¬æ¥å†³å®šçš„ã€‚ ä¸€èˆ¬æˆ‘ä»¬å»ºè®®ä¸šåŠ¡éƒ¨é—¨åšå‡ºçš„é•œåƒè·Ÿæµ‹è¯•ç¯å¢ƒå’Œç”Ÿæˆç¯å¢ƒæ²¡å…³ç³»ã€‚ é•œåƒå°±æ˜¯é•œåƒï¼Œåªæœ‰åº”ç”¨æœ‰æµ‹è¯•ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        
        
          &lt;p&gt;å¯¹äº
        
      
    
    </summary>
    
    
      <category term="æŠ€æœ¯" scheme="https://blog.k8s.li/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="gitlab" scheme="https://blog.k8s.li/tags/gitlab/"/>
    
      <category term="CI/CD" scheme="https://blog.k8s.li/tags/CI-CD/"/>
    
      <category term="harbor" scheme="https://blog.k8s.li/tags/harbor/"/>
    
  </entry>
  
  <entry>
    <title>æ˜¥å­£è¯»ä¹¦ç¬”è®°</title>
    <link href="https://blog.k8s.li/spring-reading-note.html"/>
    <id>https://blog.k8s.li/spring-reading-note.html</id>
    <published>2020-03-27T16:00:00.000Z</published>
    <updated>2020-03-29T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>äººä¸æ”¿æƒçš„æ–—äº‰ï¼Œå°±æ˜¯è®°å¿†ä¸é—å¿˜çš„æ–—äº‰ã€‚</p></blockquote><p>è½¬çœ¼é—´ä¸‰æœˆå°±ç»“æŸäº†ï¼Œä¸€å¹´èµ°å®Œäº†å››åˆ†ä¹‹ä¸€ã€‚å› ä¸ºç–«æƒ…çš„å½±å“ï¼Œè‡ªå·±ç‹¬è‡ªä¸€äººå®…åœ¨ä½çš„åœ°æ–¹ä¸€ä¸ªå¤šæœˆï¼ŒåŠ ä¸Šä¸¤å‘¨çš„æ˜¥èŠ‚å‡æœŸï¼Œè¿™æœŸé—´ç©ºé—²çš„æ—¶é—´ç‰¹åˆ«å¤šï¼Œæ‰€ä»¥é˜…è¯»çš„æ—¶é—´ä¹Ÿæ¯”è¾ƒå¤šï¼Œä¹Ÿæ­£å¥½å‘¨æœ«æœ‰ç©ºå°±æ›´æ–°ä¸€ä¸‹åšå®¢ï¼Œè®°å½•ä¸€ä¸‹ã€‚</p><h2 id="é˜…è¯»è®°å½•"><a href="#é˜…è¯»è®°å½•" class="headerlink" title="é˜…è¯»è®°å½•"></a>é˜…è¯»è®°å½•</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line">â•­â”€debian@debian ~/Kindle</span><br><span class="line">â•°â”€$ tree -d</span><br><span class="line">â”œâ”€â”€ 2020-01-01-ç¤¾ä¼šä¸»ä¹‰ï¼šç»æµå­¦ä¸ç¤¾ä¼šå­¦çš„åˆ†æ</span><br><span class="line">â”œâ”€â”€ 2020-01-01-è‡ªç”±ä¸ç¹è£çš„å›½åº¦</span><br><span class="line">â”œâ”€â”€ 2020-01-01-è®ºäººç±»ä¸å¹³ç­‰çš„èµ·æºå’ŒåŸºç¡€</span><br><span class="line">â”œâ”€â”€ 2020-01-02-å¨±ä¹è‡³æ­»</span><br><span class="line">â”œâ”€â”€ 2020-01-02-æŠ€æœ¯å„æ–­ï¼šæ–‡åŒ–å‘æŠ€æœ¯æŠ•é™</span><br><span class="line">â”œâ”€â”€ 2020-01-02-ç«¥å¹´çš„æ¶ˆé€</span><br><span class="line">â”œâ”€â”€ 2020-01-03-å¿ƒé‡Œæµ‹é‡è€…</span><br><span class="line">â”œâ”€â”€ 2020-01-04-è®ºé©å‘½</span><br><span class="line">â”œâ”€â”€ 2020-01-06-æ¶ˆé€çš„å¾®ç”Ÿç‰©</span><br><span class="line">â”œâ”€â”€ 2020-01-07-é£é™©ç¤¾ä¼šï¼šæ–°çš„ç°ä»£æ€§ä¹‹è·¯</span><br><span class="line">â”œâ”€â”€ 2020-01-10-äººçš„å¢ƒå†µ</span><br><span class="line">â”œâ”€â”€ 2020-01-10-åº·å¾·çš„æ”¿æ²»å“²å­¦</span><br><span class="line">â”œâ”€â”€ 2020-01-10-è‡ªç„¶å²</span><br><span class="line">â”œâ”€â”€ 2020-01-11-Booklist</span><br><span class="line">â”œâ”€â”€ 2020-01-12-å“ˆè€¶å…‹æ³•å¾‹å“²å­¦</span><br><span class="line">â”œâ”€â”€ 2020-01-12-æš—æ€æ•™å®¤</span><br><span class="line">â”œâ”€â”€ 2020-01-12-è®ºæ³•çš„ç²¾ç¥</span><br><span class="line">â”œâ”€â”€ 2020-01-15-å¤§å›½å´›èµ·</span><br><span class="line">â”œâ”€â”€ 2020-01-15-æ–°å¸¸è¯†ï¼šä¸€å…šä¸“æ”¿çš„æ€§è´¨ä¸åæœ</span><br><span class="line">â”œâ”€â”€ 2020-01-17-Happy-Suger-Life</span><br><span class="line">â”œâ”€â”€ 2020-01-17-å“ˆè€¶å…‹ç¤¾ä¼šç†è®º</span><br><span class="line">â”œâ”€â”€ 2020-01-17-åœ°çƒè„‰åŠ¨ï¼šå‰æ‰€æœªè§çš„è‡ªç„¶ä¹‹ç¾</span><br><span class="line">â”œâ”€â”€ 2020-01-17-å¤§å›½çš„å´©æºƒï¼šè‹è”è§£ä½“çš„å°å‰å¹•å</span><br><span class="line">â”œâ”€â”€ 2020-01-18-é€šå¾€å¥´å½¹ä¹‹è·¯</span><br><span class="line">â”œâ”€â”€ 2020-01-19-è®ºå›½å®¶çš„ä½œç”¨</span><br><span class="line">â”œâ”€â”€ 2020-01-23-å¢æ¢­</span><br><span class="line">â”œâ”€â”€ 2020-01-27-ä¸­å›½å›½å®¶æ²»ç†çš„åˆ¶åº¦é€»è¾‘ï¼šä¸€ä¸ªç»„ç»‡å­¦ç ”ç©¶</span><br><span class="line">â”œâ”€â”€ 2020-01-27-ç›—ç«è€…ï¼šä¸­å›½æ•™è‚²ä½“åˆ¶æ”¹é©è°ƒæŸ¥</span><br><span class="line">â”œâ”€â”€ 2020-01-28-ç—…æ¯’æ˜Ÿçƒ</span><br><span class="line">â”œâ”€â”€ 2020-01-28-ç—…æ¯’æ¥è¢­</span><br><span class="line">â”œâ”€â”€ 2020-01-28-è¡€ç–«ï¼šåŸƒåšæ‹‰çš„æ•…äº‹</span><br><span class="line">â”œâ”€â”€ 2020-01-30-å“ˆè€¶å…‹ä¼ </span><br><span class="line">â”œâ”€â”€ 2020-02-05-è¿œå¤çš„è‘±èŒï¼šå¤æ¤ç‰©ç‹å›½</span><br><span class="line">â”œâ”€â”€ 2020-02-06-Carton</span><br><span class="line">â”œâ”€â”€ 2020-02-06-å¤ç”Ÿç‰©å­¦ç®€æ˜æ•™ç¨‹</span><br><span class="line">â”œâ”€â”€ 2020-02-06-æ”¿æ²»ç§©åºçš„èµ·æº</span><br><span class="line">â”œâ”€â”€ 2020-02-06-æœ±é’¦å£«çš„ä¸ªäººåšå®¢</span><br><span class="line">â”œâ”€â”€ 2020-02-07-ä¸Šå¸é€ äººæœ‰å¤šéš¾ï¼šç”Ÿå‘½çš„å¯†é’¥</span><br><span class="line">â”œâ”€â”€ 2020-02-08-æˆ‘çš„é’æ˜¥æ‹çˆ±ç‰©è¯­</span><br><span class="line">â”œâ”€â”€ 2020-02-09-å¤æ‹‰æ ¼ä¹‹æ‹ï¼šä¸€ä¸ªçˆ±æƒ…ä¸æ±‚ç”Ÿçš„çœŸæ˜¯æ•…äº‹</span><br><span class="line">â”œâ”€â”€ 2020-02-09-å¤æ‹‰æ ¼ç¾¤å²›</span><br><span class="line">â”œâ”€â”€ 2020-02-09-è‘›å‰‘é›„æ–‡é›†å…­ï¼šå²è¿¹è®°è¸ª</span><br><span class="line">â”œâ”€â”€ 2020-02-10-é²è¿…å…¨é›†</span><br><span class="line">â”œâ”€â”€ 2020-02-12-æ°¸ä¹…è®°å½•</span><br><span class="line">â”œâ”€â”€ 2020-02-12-å¤§ç­ç»æ—¶ä»£ï¼šä¸€éƒ¨åå¸¸çš„è‡ªç„¶å²</span><br><span class="line">â”œâ”€â”€ 2020-02-13-ç‰›æ´¥é€šè¯†è¯»æœ¬ï¼šåœ°çƒ</span><br><span class="line">â”œâ”€â”€ 2020-02-13-è¿œå¤çš„è¾‰ç…Œï¼šç”Ÿç‰©å¤§å¹…å°„</span><br><span class="line">â”œâ”€â”€ 2020-02-14-å›½å®¶å»ºè®¾ä¸æ”¿åºœè¡Œä¸º</span><br><span class="line">â”œâ”€â”€ 2020-02-14-åœ°çƒçš„æ•…äº‹</span><br><span class="line">â”œâ”€â”€ 2020-02-16-ç”Ÿå‘½æ´»åŠ¨çš„æ‘‡ç¯®ï¼šç»†èƒ</span><br><span class="line">â”œâ”€â”€ 2020-02-19-åšå®¢æ–‡ç« </span><br><span class="line">â”œâ”€â”€ 2020-02-20-è‡ªç§çš„åŸºå› </span><br><span class="line">â”œâ”€â”€ 2020-02-21-çº¢å¤ªé˜³</span><br><span class="line">â”œâ”€â”€ 2020-02-24-åœ°çƒè„‰åŠ¨2ï¼šå¥‡è¿¹ä¸–ç•Œ</span><br><span class="line">â”œâ”€â”€ 2020-02-26-ç‰›æ´¥é€šè¯†è¯»æœ¬ï¼šç¦æŸ¯</span><br><span class="line">â”œâ”€â”€ 2020-02-29-J</span><br><span class="line">â”œâ”€â”€ 2020-03-03-å†å²çš„ç»ˆç»“</span><br><span class="line">â”œâ”€â”€ 2020-03-04-ææƒä¸»ä¹‰çš„èµ·æº</span><br><span class="line">â”œâ”€â”€ 2020-03-06-ä¸­å›½å®˜åƒšæ”¿æ²»ç ”ç©¶</span><br><span class="line">â”œâ”€â”€ 2020-03-07-ä¸€æƒ³åˆ°è¿˜æœ‰~</span><br><span class="line">â”œâ”€â”€ 2020-03-07-åæ°451</span><br><span class="line">â”œâ”€â”€ 2020-03-11-è¿™æ‰æ˜¯å¥½è¯»çš„æ•°å­¦å²</span><br><span class="line">â”œâ”€â”€ 2020-03-12-å¯¹æœ¬æ¬¡ç–«æƒ…çš„åæ€</span><br><span class="line">â”œâ”€â”€ 2020-03-12-å¼ åƒå¸†ï¼šææƒä¸»ä¹‰çš„æ„å»º</span><br><span class="line">â”œâ”€â”€ 2020-03-12-å¾è´²ï¼šä¸­å›½çš„â€œæ–°ææƒä¸»ä¹‰â€åŠå…¶æœ«ä¸–æ™¯è±¡</span><br><span class="line">â”œâ”€â”€ 2020-03-13-æˆ‘ç„¡ç½ªï¼šåŠ‰æ›‰æ³¢å‚³</span><br><span class="line">â”œâ”€â”€ 2020-03-13-æ—æ„ˆéœ</span><br><span class="line">â”œâ”€â”€ 2020-03-14-Age of Ambition</span><br><span class="line">â”œâ”€â”€ 2020-03-14-Amusing Ourselves to Death</span><br><span class="line">â”œâ”€â”€ 2020-03-14-Permanent Record</span><br><span class="line">â”œâ”€â”€ 2020-03-15-ä¸èƒ½æ‰¿å—çš„ç”Ÿå‘½ä¹‹è½»</span><br><span class="line">â”œâ”€â”€ 2020-03-20-è€é’±æ–‡é›†ï¼šç¡…è°·ä¼ å¥‡</span><br><span class="line">â”œâ”€â”€ 2020-03-22-ç¬‘å¿˜ä¹¦</span><br><span class="line">â”œâ”€â”€ 2020-03-25-ç¥å¥‡çš„ç”Ÿç‰©åŒ–å­¦</span><br><span class="line">â”œâ”€â”€ 2020-03-26-è´¹é©¬æœ€ç»ˆå®šç†</span><br><span class="line">â”œâ”€â”€ 2020-03-28-è¢«è®¨åŒçš„å‹‡æ°”</span><br><span class="line">â”œâ”€â”€ 2020-03-29-è‰¾å¸Œæ›¼åœ¨è€¶è·¯æ’’å†·</span><br><span class="line">â”œâ”€â”€ 2020-03-30-ä»ä¸€åˆ°æ— ç©·å¤§</span><br><span class="line">â””â”€â”€ 2020-03-30-å¦‚æœå†å²æ˜¯ä¸€ç¾¤è‚¥å–µ</span><br><span class="line"></span><br><span class="line">79 directories, 1181 files</span><br></pre></td></tr></table></figure><p>è‡ªä»å…ƒæ—¦çš„æ—¶å€™çŸ¥é“äº† kindle çš„æˆªå±æ–¹æ³•ä¹‹åå°±ä¸€ç›´å°†é˜…è¯»è¿‡ç¨‹ä¸­ä¸€äº›ç²¾å½©çš„ç‰‡æ®µæˆªå±ä¸‹æ¥ï¼Œç„¶åå†ç§»åŠ¨åˆ°æœ¬åœ°ç£ç›˜è¿›è¡Œåˆ†ç±»å’Œæ•´ç†ã€‚æ¯ä¸€ä¸ªæ–‡ä»¶å¯¹åº”ä¸€æœ¬ä¹¦ï¼Œå‰é¢åœ¨åŠ ä¸Šæˆªå±æ—¶çš„æ—¶é—´ï¼Œè¿™æ ·å°±èƒ½è®°å½•ä¸‹æ•´ä¸ªé˜…è¯»çš„æ—¶é—´çº¿ã€‚åŸæœ¬åªæ˜¯å°†æˆªå±çš„å›¾ç‰‡æŒ‰ç…§ä¹¦ååˆ†ç±»å¥½ï¼Œå¹¶æ²¡æœ‰åŠ ä¸Šæ—¥æœŸã€‚åæ¥å°±å†™äº†ä¸ªè„šæœ¬è‡ªåŠ¨åŠ ä¸Šäº†æ—¥æœŸğŸ˜‚ã€‚è¿™æ ·è¿˜å¥½ï¼Œæœ‰ä¸ªæ—¶é—´çº¿æ¥åšå‚è€ƒ~</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">set -xue</span><br><span class="line">for dir in $(ls | grep -v "\." | grep -Ev  "2019|2020")</span><br><span class="line">do</span><br><span class="line">    date=$(ls $&#123;dir&#125;/*.png |grep -Eo "[0-9][0-9][0-9][0-9]_[0-9][0-9]_[0-9][0-9]" | sed 's/_/-/g' | head -n1)</span><br><span class="line">    title=$(echo $&#123;dir&#125; | sed 's/ /-/g')</span><br><span class="line">    dir_name=$&#123;date&#125;-$&#123;title&#125;</span><br><span class="line">    mv $&#123;dir&#125; $&#123;dir_name&#125;</span><br><span class="line">done</span><br></pre></td></tr></table></figure><h2 id="è¯»ä¹¦è¿›åº¦"><a href="#è¯»ä¹¦è¿›åº¦" class="headerlink" title="è¯»ä¹¦è¿›åº¦"></a>è¯»ä¹¦è¿›åº¦</h2><h3 id="è¯»å®Œ"><a href="#è¯»å®Œ" class="headerlink" title="è¯»å®Œ"></a>è¯»å®Œ</h3><table><thead><tr><th align="center">ä¹¦å</th><th align="center">ä½œè€…</th><th align="center">æ—¥æœŸ</th><th align="center">æ—¶é•¿</th><th align="center">è¿›åº¦</th></tr></thead><tbody><tr><td align="center">ç¤¾ä¼šä¸»ä¹‰ï¼šç»æµå­¦ä¸ç¤¾ä¼šå­¦çš„åˆ†æ</td><td align="center">[å¥¥] è·¯å¾·ç»´å¸ŒÂ·å†¯Â·ç±³ç‘Ÿæ–¯</td><td align="center">01-01</td><td align="center">10h</td><td align="center">100%</td></tr><tr><td align="center">è®ºäººç±»ä¸å¹³ç­‰çš„èµ·æºå’ŒåŸºç¡€</td><td align="center">[æ³•]è®©-é›…å…‹Â·å¢æ¢­</td><td align="center">01-01</td><td align="center">5h</td><td align="center">100%</td></tr><tr><td align="center">å¿ƒç†æµ‹é‡è€…</td><td align="center">[æ—¥]æ·±çœŸè§</td><td align="center">01-03</td><td align="center">6h</td><td align="center">100%</td></tr><tr><td align="center">æ–°å¸¸è¯†ï¼šä¸€å…šä¸“æ”¿çš„æ€§è´¨å’Œåæœ</td><td align="center">å¼ é›ªå¿ </td><td align="center">01-15</td><td align="center">4h</td><td align="center">100%</td></tr><tr><td align="center">åœ°çƒè„‰åŠ¨ï¼šå‰æ‰€æœªè§çš„è‡ªç„¶ä¹‹ç¾</td><td align="center">[è‹±]é˜¿æ‹‰æ–¯æ³°å°”Â·ç¦ç‘Ÿå‰å°”</td><td align="center">01-22</td><td align="center">4h</td><td align="center">100%</td></tr><tr><td align="center">è®ºç§‘å­¦ä¸è‰ºæœ¯</td><td align="center">è®©-é›…å…‹Â·å¢æ¢­</td><td align="center">01-21</td><td align="center">2h</td><td align="center">100%</td></tr><tr><td align="center">ç¤¾ä¼šå¥‘çº¦è®º (è¯‘æ—äººæ–‡ç²¾é€‰)</td><td align="center">è®©-é›…å…‹Â·å¢æ¢­</td><td align="center">01-23</td><td align="center">4h</td><td align="center">100%</td></tr><tr><td align="center">ä¸­å›½å›½å®¶æ²»ç†çš„åˆ¶åº¦é€»è¾‘ï¼šä¸€ä¸ªç»„ç»‡å­¦ç ”ç©¶</td><td align="center">å‘¨é›ªå…‰</td><td align="center">01-28</td><td align="center">8h</td><td align="center">100%</td></tr><tr><td align="center">ç—…æ¯’æ˜Ÿçƒ</td><td align="center">[ç¾]å¡å°”Â·é½é»˜</td><td align="center">01-28</td><td align="center">4h</td><td align="center">100%</td></tr><tr><td align="center">ç—…æ¯’æ¥è¢­</td><td align="center">[ç¾]å†…æ£®â€¢æ²ƒå°”å¤«</td><td align="center">01-29</td><td align="center">2h</td><td align="center">100%</td></tr><tr><td align="center">è¿œå¤çš„è‘±èŒï¼šå¤æ¤ç‰©ç‹å›½</td><td align="center">å‘¨å¿—ç‚</td><td align="center">02-05</td><td align="center">4h</td><td align="center">100%</td></tr><tr><td align="center">å¤ç”Ÿç‰©å­¦ç®€æ˜æ•™ç¨‹</td><td align="center">æœ±æ‰ä¼</td><td align="center">02-06</td><td align="center">3h</td><td align="center">100%</td></tr><tr><td align="center">ä¸Šå¸é€ äººæœ‰å¤šéš¾ï¼šç”Ÿå‘½çš„å¯†é’¥</td><td align="center">æœ±é’¦å£«</td><td align="center">02-07</td><td align="center">6h</td><td align="center">100%</td></tr><tr><td align="center">æœ±é’¦å£«çš„ä¸ªäººåšå®¢</td><td align="center">æœ±é’¦å£«</td><td align="center">02-08</td><td align="center">8h</td><td align="center">100%</td></tr><tr><td align="center">è¿œå¤çš„è¾‰ç…Œï¼šç”Ÿç‰©å¤§å¹…å°„</td><td align="center">æˆå˜‰ä½™</td><td align="center">02-13</td><td align="center">6h</td><td align="center">100%</td></tr><tr><td align="center">ç‰›æ´¥é€šè¯†è¯»æœ¬ï¼šåœ°çƒ</td><td align="center">[è‹±]é©¬ä¸Â·é›·å¾·èŠ¬</td><td align="center">02-13</td><td align="center">6h</td><td align="center">100%</td></tr><tr><td align="center">ç”Ÿå‘½æ´»åŠ¨çš„æ‘‡ç¯®ï¼šç»†èƒ</td><td align="center">ç‹è€€å‘</td><td align="center">02-16</td><td align="center">4h</td><td align="center">100%</td></tr><tr><td align="center">åœ°çƒè„‰åŠ¨2ï¼šå¥‡è¿¹ä¸–ç•Œ</td><td align="center">èƒ¡Â·ç§‘é‡Œ</td><td align="center">02-24</td><td align="center">3h</td><td align="center">100%</td></tr><tr><td align="center">ä¸€æƒ³åˆ°è¿˜æœ‰ç™¾åˆ†ä¹‹ä¹åäº”çš„é—®é¢˜~</td><td align="center">è±ªå°”èµ«â€¢é™ˆ</td><td align="center">03-07</td><td align="center">4h</td><td align="center">100%</td></tr><tr><td align="center">å†å²çš„ç»ˆç»“åŠæœ€åä¹‹äºº</td><td align="center">[ç¾]å¼—æœ—è¥¿æ–¯Â·ç¦å±±</td><td align="center">03-03</td><td align="center">10h</td><td align="center">100%</td></tr><tr><td align="center">æˆ‘ç„¡ç½ªï¼šåŠ‰æ›‰æ³¢å‚³</td><td align="center">ä½™æ°</td><td align="center">03-13</td><td align="center">8h</td><td align="center">100%</td></tr><tr><td align="center">ç¥å¥‡çš„ç”Ÿç‰©åŒ–å­¦</td><td align="center">ç¥å¥‡çš„ç”Ÿç‰©åŒ–å­¦</td><td align="center">03-23</td><td align="center">4h</td><td align="center">100%</td></tr><tr><td align="center">è´¹é©¬æœ€ç»ˆå®šç†</td><td align="center">[æ—¥]æ—¥å†²æ¨±çš®</td><td align="center">03-26</td><td align="center">3h</td><td align="center">100%</td></tr><tr><td align="center">è¢«è®¨åŒçš„å‹‡æ°”</td><td align="center">å²¸è¦‹ä¸€éƒ</td><td align="center">03-28</td><td align="center">4h</td><td align="center">100%</td></tr></tbody></table><h3 id="åœ¨è¯»"><a href="#åœ¨è¯»" class="headerlink" title="åœ¨è¯»"></a>åœ¨è¯»</h3><table><thead><tr><th align="center">ä¹¦å</th><th align="center">ä½œè€…</th><th align="center">æ—¥æœŸ</th><th align="center">æ—¶é•¿</th><th align="center">è¿›åº¦</th></tr></thead><tbody><tr><td align="center">Age of Ambition</td><td align="center">Evan Osnos</td><td align="center">03-13</td><td align="center">4h</td><td align="center">8%</td></tr><tr><td align="center">ä»ä¸€åˆ°æ— ç©·å¤§</td><td align="center">ä¹”æ²»Â·ä¼½è«å¤«</td><td align="center">03-30</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">ææƒä¸»ä¹‰çš„èµ·æº</td><td align="center">[å¾·] æ±‰å¨œÂ·é˜¿ä¼¦ç‰¹</td><td align="center"></td><td align="center"></td><td align="center"></td></tr><tr><td align="center">è‡ªç”±ç§©åºåŸç†</td><td align="center">å¼—é‡Œå¾·é‡Œå¸ŒÂ·å“ˆè€¶å…‹</td><td align="center"></td><td align="center"></td><td align="center"></td></tr></tbody></table><h3 id="æš‚æ—¶å¼ƒå‘"><a href="#æš‚æ—¶å¼ƒå‘" class="headerlink" title="æš‚æ—¶å¼ƒå‘"></a>æš‚æ—¶å¼ƒå‘</h3><table><thead><tr><th align="center">ä¹¦å</th><th align="center">ä½œè€…</th><th align="center">æ—¥æœŸ</th><th align="center">è¿›åº¦</th><th></th></tr></thead><tbody><tr><td align="center">ç”Ÿå‘½ä¸­ä¸èƒ½æ‰¿å—ä¹‹è¼•</td><td align="center">ç±³è˜­Â·æ˜†å¾·æ‹‰</td><td align="center">03-15</td><td align="center">40%</td><td></td></tr><tr><td align="center">ç¬‘å¿˜ä¹¦</td><td align="center">ç±³è˜­Â·æ˜†å¾·æ‹‰</td><td align="center">03-22</td><td align="center">40%</td><td></td></tr><tr><td align="center">è¡€ç–«ï¼šåŸƒåšæ‹‰çš„æ•…äº‹</td><td align="center">ç†æŸ¥å¾·Â·æ™®é›·æ–¯é¡¿</td><td align="center">02-01</td><td align="center">20%</td><td></td></tr><tr><td align="center">åæ°451</td><td align="center">é›·Â·å¸ƒé›·å¾·ä¼¯é‡Œ</td><td align="center">04-07</td><td align="center">30%</td><td></td></tr><tr><td align="center">æ¶ˆå¤±çš„å¾®ç”Ÿç‰©ï¼šæ»¥ç”¨æŠ—ç”Ÿç´ å¼•å‘çš„å±æœº</td><td align="center">ï¼»ç¾ï¼½é©¬ä¸â€¢å¸ƒè±æ³½</td><td align="center">01-06</td><td align="center">10%</td><td></td></tr><tr><td align="center">å¤æ‹‰æ ¼ä¹‹æ‹</td><td align="center">å¥¥å…°å¤šÂ·è´¹å‰æ–¯</td><td align="center">02-09</td><td align="center">10%</td><td></td></tr><tr><td align="center">è®ºå›½å®¶çš„ä½œç”¨</td><td align="center">æ´ªå ¡</td><td align="center">01-19</td><td align="center">30%</td><td></td></tr><tr><td align="center">é²è¿…å…¨é›†</td><td align="center">é²è¿…</td><td align="center">02-10</td><td align="center">5%</td><td></td></tr><tr><td align="center">è‡ªç§çš„åŸºå› </td><td align="center">ç†æŸ¥å¾·Â·é“é‡‘æ–¯</td><td align="center">02-20</td><td align="center">30%</td><td></td></tr><tr><td align="center">å›½å®¶å»ºè®¾ä¸æ”¿åºœè¡Œä¸º</td><td align="center">å‘¨é›ªå…‰</td><td align="center">02-14</td><td align="center">40%</td><td></td></tr><tr><td align="center">ç›—ç«è€…ï¼šä¸­å›½æ•™è‚²é©å‘½é™æ‚„æ‚„</td><td align="center">é‚“åº·å»¶ æ¢ç½—å…´</td><td align="center">01-23</td><td align="center">20%</td><td></td></tr><tr><td align="center">å¤§å›½å´›èµ·</td><td align="center">å”æ™‹</td><td align="center">01-16</td><td align="center">50%</td><td></td></tr></tbody></table><h2 id="ç¬”è®°"><a href="#ç¬”è®°" class="headerlink" title="ç¬”è®°"></a>ç¬”è®°</h2><h3 id="ç¤¾ä¼šä¸»ä¹‰ï¼šç»æµå­¦ä¸ç¤¾ä¼šå­¦çš„åˆ†æ"><a href="#ç¤¾ä¼šä¸»ä¹‰ï¼šç»æµå­¦ä¸ç¤¾ä¼šå­¦çš„åˆ†æ" class="headerlink" title="ç¤¾ä¼šä¸»ä¹‰ï¼šç»æµå­¦ä¸ç¤¾ä¼šå­¦çš„åˆ†æ"></a>ç¤¾ä¼šä¸»ä¹‰ï¼šç»æµå­¦ä¸ç¤¾ä¼šå­¦çš„åˆ†æ</h3><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/screenshot_2020_01_01T12_33_41+0800.png" alt="img"></p><p>è¿™æœ¬ä¹¦æ˜¯ä»Šå¹´è¯»çš„ç¬¬ä¸€æœ¬ä¹¦ï¼Œè¿™æœ¬ä¹¦å¯ä»¥å’Œå“ˆè€¶å…‹çš„ã€Šé€šå¾€å¥´å½¹ä¹‹è·¯ã€‹ç»“åˆç€è¯»ã€‚æœ¬ä¹¦å‡ºç‰ˆäº 1922 å¹´ï¼Œåˆ†åˆ«ä»å¤šä¸ªé¢†åŸŸï¼ˆæ”¿æ²»ã€ç»æµã€æ–‡åŒ–ã€ä¼¦ç†ã€å®—æ•™â€¦ï¼‰è®ºè¿°äº†ç¤¾ä¼šä¸»ä¹‰å¿…å®šå¤±è´¥çš„æ‚²æƒ¨ç»“å±€ï¼Œå¯¹å½“æ—¶çš„ç¤¾ä¼šå°¤å…¶é’å¹´å­¦ç”Ÿæ¥è®²å†²å‡»ç›¸å½“çš„å¤§ï¼Œé‚£æ—¶å€™ CCP åˆšåˆšæˆç«‹æ‰ 1 å¹´å“¦ã€‚</p><p>å…ˆè¯´ä¸€ä¸‹ä½œè€…ï¼Œè·¯å¾·ç»´å¸ŒÂ·å†¯Â·ç±³å¡æ–¯ä½œä¸ºâ€œ<a href="https://zh.wikipedia.org/wiki/å¥§åœ°åˆ©ç¶“æ¿Ÿå­¸æ´¾" target="_blank" rel="noopener">å¥¥åœ°åˆ©ç»æµå­¦æ´¾</a>çš„é™¢é•¿â€ï¼Œç°ä»£<a href="https://zh.wikipedia.org/wiki/è‡ªç”±æ„å¿—ä¸»ç¾©" target="_blank" rel="noopener">è‡ªç”±æ„å¿—ä¸»ä¹‰</a>è¿åŠ¨çš„ä¸»è¦é¢†å¯¼äººï¼Œä¹Ÿæ˜¯<a href="https://zh.wikipedia.org/wiki/å¤å…¸è‡ªç”±ä¸»ç¾©" target="_blank" rel="noopener">å¤å…¸è‡ªç”±ä¸»ä¹‰</a>ç¬¬ä¸€æŠŠäº¤æ¤…ï¼Œå…¶å½±å“åŠ›ä¸è¨€è€Œå–»ã€‚ä»–çš„å­¦ç”Ÿæ›´æ˜¯é’å‡ºäºè“èƒœäºè“ï¼šå¼—é‡Œå¾·é‡Œå¸ŒÂ·å†¯Â·å“ˆè€¶å…‹ã€å¼—é‡ŒèŒ¨Â·é©¬å…‹å¢æ™®ã€æˆˆç‰¹å¼—é‡Œå¾·Â·å†¯Â·å“ˆä¼¯å‹’ã€å¥¥æ–¯å¡Â·æ‘©æ ¹æ–¯å¦ã€å¨å»‰Â·å‹’æ™®å…‹ã€ç†æŸ¥å¾·Â·å†¯Â·æ–½ç‰¹é‡Œæˆˆå°”ã€è‰¾å°”å¼—é›·å¾·Â·èˆ’èŒ¨ã€è´¹é‡Œå…‹æ–¯Â·è€ƒå¤«æ›¼ã€åŸƒé‡Œå…‹Â·æ²ƒæ ¼æ—ã€æ ¼å¥¥å°”æ ¼Â·å“ˆå°”å§†ã€ä¿ç½—Â·ç½—æ£®æ–¯å¦-ç½—ä¸¹ã€è±æ˜‚å†…å°”Â·ç½—å®¾æ–¯ã€‚åœ¨ä»–çš„å­¦ç”Ÿå½“ä¸­ï¼Œå“ˆè€¶å…‹è·è¯ºè´å°”ç»æµå­¦å¥–ï¼Œå¼—é‡ŒèŒ¨Â·é©¬å…‹å¢æ™®ã€æˆˆç‰¹å¼—é‡Œå¾·Â·å†¯Â·å“ˆä¼¯å‹’æ›¾å…ˆåä»»ç¾å›½ç»æµå­¦ä¼šä¼šé•¿ã€‚</p><blockquote><p>æˆ‘ä»¬æ„Ÿåˆ°ï¼Œæˆ‘ä»¬æˆé•¿äºå…¶ä¸­çš„é‚£ä¸ªæ–‡æ˜å·²ç»å´©æºƒã€‚æˆ‘ä»¬ç«‹å¿—å»ºè®¾ä¸€ä¸ªæ›´ç¾å¥½çš„ä¸–ç•Œï¼Œè€Œæ­£æ˜¯è¿™ç§å†é€ ç¤¾ä¼šçš„æ¸´æœ›ï¼Œé­ç­–æˆ‘ä»¬æŠ•èº«ç»æµå­¦ç ”ç©¶ã€‚ç¤¾ä¼šä¸»ä¹‰è®¸è¯ºç»™æˆ‘ä»¬ä¸€ä¸ªæ›´åŠ ç†æ€§ã€æ›´åŠ å…¬æ­£çš„ä¸–ç•Œã€‚æ­¤æ—¶ï¼Œã€Šç¤¾ä¼šä¸»ä¹‰ã€‹é—®ä¸–äº†ï¼Œæˆ‘ä»¬çš„ä¿¡å¿µåå¡Œäº†ã€‚ã€Šç¤¾ä¼šä¸»ä¹‰ã€‹å¯¹æˆ‘ä»¬è¯´ï¼Œæˆ‘ä»¬çš„æ–¹å‘é”™äº†ã€‚</p></blockquote><p>å¯ä»¥ç»“åˆç€å“ˆè€¶å…‹çš„ä¹¦æ¥è¯»ï¼Œè¿™æœ¬ä¹¦å‘Šè¯‰æˆ‘ä»¬çš„æ˜¯ï¼š<strong>ç¤¾ä¼šä¸»ä¹‰æ˜¯é€šå¾€å¥´å½¹ä¹‹è·¯</strong> ã€‚</p><p><code>æ‘˜æŠ„</code> <a href="https://t.co/mSj0qay7jW" target="_blank" rel="noopener">ç¤¾ä¼šä¸»ä¹‰ï¼šç»æµå­¦ä¸ç¤¾ä¼šå­¦çš„åˆ†æ</a></p><blockquote><p>ç±³å¡æ–¯åœ¨ä¹¦ä¸­åˆ†åˆ«ä»å¤šä¸ªé¢†åŸŸï¼ˆæ”¿æ²»ã€ç»æµã€æ–‡åŒ–ã€ä¼¦ç†ã€å®—æ•™â€¦ï¼‰å¯¹ã€å„ç§æµæ´¾ã€‘çš„ç¤¾ä¼šä¸»ä¹‰è¿›è¡ŒçŒ›çƒˆæ‰¹åˆ¤ã€‚å…¶æŠ¨å‡»çš„ç«åŠ›ä¹‹çŒ›ï¼Œå®å±ç½•è§ã€‚</p></blockquote><p>å¦å¤–æ¨èè¯»ä¸€ä¸‹ <a href="https://program-think.blogspot.com/2018/09/Book-Review-The-Errors-of-Marxism-Leninism.html" target="_blank" rel="noopener">ä¸ºä»€ä¹ˆé©¬å…‹æ€æ˜¯é”™çš„ï¼Ÿâ€”â€”å…¨é¢æ‰¹åˆ¤é©¬åˆ—ä¸»ä¹‰çš„çŸ¥åè‘—ä½œå¯¼è¯»</a> ã€‚</p><blockquote><p>ä½œè€…<a href="https://zh.wikipedia.org/wiki/è·¯å¾·ç¶­å¸ŒÂ·é¦®Â·ç±³å¡æ–¯" target="_blank" rel="noopener">è·¯å¾·ç»´å¸ŒÂ·å†¯Â·ç±³å¡æ–¯</a>æ˜¯å¥¥åœ°åˆ©å­¦æ´¾çš„å¹²å°†ï¼Œå¹¶å¯¹åŒä¸€å­¦æ´¾çš„å“ˆè€¶å…‹æœ‰é‡å¤§å½±å“ã€‚åœ¨å“ˆè€¶å…‹çš„å¾ˆå¤šè‘—ä½œå’Œç†è®ºä¸­ï¼Œéƒ½å¯ä»¥çœ‹åˆ°ç±³å¡æ–¯çš„å½±å­ã€‚<br>ã€€ã€€ç±³å¡æ–¯çš„æˆå°±é•¿æœŸè¢«å­¦æœ¯ç•Œå¿½è§†ï¼ˆç”šè‡³æ˜¯æ’æ–¥ï¼‰ã€‚ä¸€æ–¹é¢æ˜¯ä»–çš„ç†è®ºå¤ªè¶…å‰ï¼Œå¦ä¸€æ–¹é¢æ˜¯ä»–çš„æ€§æ ¼å¤ªæ¿€çƒˆâ€”â€”ä¸äººäº¤æµæ—¶æ€»æ˜¯ä¸€é’ˆè§è¡€ï¼Œä¸ç•™æƒ…é¢ï¼Œæ¯«ä¸é¡¾å¿Œä»–äººæ„Ÿå—ã€‚<br>ã€€ã€€è¯´åˆ°ã€è¶…å‰æ€§ã€‘ï¼Œä»–å¯èƒ½æ˜¯ç»æµå­¦ç•Œæœ€æ—©æ„è¯†åˆ°â€œã€åšå¼ˆè®ºã€‘é‡è¦æ€§â€çš„é‚£ä¸ªäººï¼ˆæ—¶é—´æ˜¯20ä¸–çºªåˆæœŸï¼‰ã€‚å‡ åå¹´åï¼Œä¸å†¯Â·è¯ºä¾æ›¼å…±åŒå‘è¡¨åˆ’æ—¶ä»£è®ºæ–‡ã€Šåšå¼ˆè®ºä¸ç»æµè¡Œä¸ºã€‹çš„é‚£ä¸ªæ‘©æ ¹æ–¯å¦ï¼ˆå‰é¢ä¿ºæè¿‡æ­¤äººï¼‰ï¼Œå°±æ˜¯ç±³å¡æ–¯çš„å­¦ç”Ÿã€‚</p></blockquote><h3 id="è®ºäººç±»ä¸å¹³ç­‰çš„èµ·æºå’ŒåŸºç¡€"><a href="#è®ºäººç±»ä¸å¹³ç­‰çš„èµ·æºå’ŒåŸºç¡€" class="headerlink" title="è®ºäººç±»ä¸å¹³ç­‰çš„èµ·æºå’ŒåŸºç¡€"></a>è®ºäººç±»ä¸å¹³ç­‰çš„èµ·æºå’ŒåŸºç¡€</h3><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/screenshot_2020_01_01T18_23_18+0800.png" alt="img"></p><p>è¿™æœ¬ä¹¦æ˜¯æˆ‘åœ¨çœ‹å¿ƒç†æµ‹é‡è€…åŠ¨ç”»çš„æ—¶å€™æåˆ°çš„ï¼Œåœ¨çœ‹å°è¯´çš„æ—¶å€™ä¹Ÿè§åˆ°è¿‡ã€‚äºæ˜¯å°±æ‹¿æ¥è¯»äº†ä¸€ä¸‹ï¼Œ<code>Kindle Unlimited</code>  çš„ä¼šå‘˜å¯ä»¥åœ¨ Amazon å•†åº—å…è´¹å€Ÿé˜…åˆ°ã€‚ã€Šè®ºäººç±»ä¸å¹³ç­‰èµ·æºå’ŒåŸºç¡€ã€‹æ˜¯å¢æ¢­åº”æ³•å›½ç¬¬æˆç§‘å­¦é™¢çš„å¾æ–‡è€Œæ’°å†™çš„ç¬¬äºŒè®ºæ–‡ï¼Œç¬¬ä¸€ç¯‡è®ºæ–‡æ˜¯ã€Šè®ºç§‘å­¦ä¸è‰ºæœ¯çš„å¤å…´æ˜¯å¦æœ‰åŠ©äºä½¿é£ä¿—æ—¥è¶‹çº¯æœ´ã€‹ã€‚</p><p>åœ¨ä¹¦ä¸­ï¼Œå¢æ¢­é˜å‘äº†è‡ªèº«çš„æ”¿æ²»å“²å­¦ï¼Œä¸ºã€Šç¤¾ä¼šå¥‘çº¦è®ºã€‹çš„å†™ä½œå¥ å®šäº†åŸºç¡€ã€‚å¢æ¢­å°†äººç±»å†å²çš„å‘å±•è¿‡ç¨‹è§†ä½œè¿›æ­¥ä¸é€€åŒ–çš„çŸ›ç›¾ç»Ÿä¸€ä½“ã€‚ä»–ä¸€æ–¹é¢å€ŸåŠ©å½“æ—¶æœ‰å…³è‡ªç„¶çŠ¶æ€ä¸‹äººçš„äººç±»å­¦ææ–™ï¼Œä¸€æ–¹é¢å±•å¼€è¾©è¯çš„æƒ³è±¡ï¼Œå›é¡¾äº†äººç±»ç”±è‡ªç„¶çŠ¶æ€å‘ç¤¾ä¼šçŠ¶æ€è¿‡æ¸¡çš„å†å²è¿›ç¨‹ï¼ŒæŒ‡å‡ºäººç±»çš„è¿›æ­¥å²åŒæ—¶ä¹Ÿæ˜¯äººç±»çš„å •è½å²ï¼Œå› ä¸ºäººç±»æ¯å‘å‰å‘å±•ä¸€æ­¥ï¼Œä¸å¹³ç­‰çš„ç¨‹åº¦å³åŠ æ·±ä¸€æ­¥ã€‚è€Œç§æœ‰åˆ¶çš„ç¡®ç«‹ï¼Œæ˜¯é€ æˆäººç±»ä¸å¹³ç­‰åŠå…¶åæœçš„å…³é”®ç¯èŠ‚ã€‚</p><p>æ­£æ˜¯è¿™æ ·çš„å‡è®¾ï¼Œä½¿äººä»¬å¾—ä»¥æ˜ç™½â€œæˆ‘ä»¬å¹¶éç”Ÿæ¥å¦‚æ­¤â€ï¼Œåªæ˜¯â€œå·²ç„¶å¦‚æ­¤â€ã€‚æ—¢ç„¶å¤„äºè‡ªç„¶çŠ¶æ€ä¸‹çš„äººç±»åªæ˜¯ä¸€ä¸ªæŠ½è±¡åŒ–çš„å½¢è±¡ï¼Œå³ä¸€ç§â€œæ— â€çš„å¢ƒç•Œï¼Œé‚£ä¹ˆæˆ‘ä»¬å½“ç„¶ä¸èƒ½è¯´å¢æ¢­çš„ç›®çš„æ˜¯è®©äººç±»å›åˆ°è¿™ä¸ªæœ¬å°±ä¸å­˜åœ¨çš„å½¢è±¡äº†ã€‚ä»–åªæ˜¯ä¼å›¾ä»¥è¿™ä¸ªâ€œæ— â€çš„å¢ƒç•Œä¸ºèµ·ç‚¹ï¼Œå‘äººä»¬å±•ç¤ºå‡ºäººç±»æ˜¯å¦‚ä½•ä¸€æ­¥æ­¥å˜æˆç°åœ¨çš„æ ·å­ï¼Œä»è€Œè¿›ä¸€æ­¥æ€è€ƒï¼Œè¦æƒ³æ‘†è„±ç°åœ¨çš„å›°å¢ƒï¼Œæˆ‘ä»¬æ‰€éœ€è¦åšå‡ºçš„åŠªåŠ›ã€‚æœ¬æ–‡ä¸ºæˆ‘ä»¬æä¾›çš„åæ€å°±åƒé‚£é«˜é€Ÿè·¯ä¸Šçš„ç¼“å†²å¸¦ï¼Œåªæœ‰åœç•™åœ¨ç¼“å†²å¸¦ä¸Šçš„é‚£ä¸€ç§’é’Ÿï¼Œäººç±»æ‰ç»ˆäºçœŸæ­£åœ°æ€è€ƒã€‚</p><p><img src="https://blog.k8s.lhttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/image-20200106182021903.png" alt="image-20200106182021903"></p><p><code>æ‘˜æŠ„</code> <a href="https://t.co/oTmpnrHLKS" target="_blank" rel="noopener">è®ºäººç±»ä¸å¹³ç­‰çš„èµ·æºå’ŒåŸºç¡€</a></p><h3 id="å¿ƒé‡Œæµ‹é‡è€…"><a href="#å¿ƒé‡Œæµ‹é‡è€…" class="headerlink" title="å¿ƒé‡Œæµ‹é‡è€…"></a>å¿ƒé‡Œæµ‹é‡è€…</h3><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/screenshot_2020_01_03T10_49_43+0800.png" alt="img"></p><p>è¯»åæ„Ÿå¯ä»¥å‚è§ <a href="https://blog.k8s.li/PSYCHO-PASS-booklist.html">PSYCHO-PASS å¿ƒç†æµ‹é‡è€…å°è¯´è¯»åæ„Ÿ</a>ï¼Œå¼ƒå‘ä¸¤ä¸ªæœˆäº†æ‰å†™äº†ä¸€ç‚¹ğŸ˜ã€‚</p><p>è¿™éƒ¨æ”¹ç¼–è‡ªåŠ¨æ¼«çš„å°è¯´åŸºæœ¬ä¸Šè¿˜åŸäº†æ•´ä¸ªç¬¬ä¸€éƒ¨åŠ¨ç”»å®Œæ•´çš„å‰§æƒ…ï¼Œæ€»ä¹‹ä¹Ÿæ˜¯å…³äºä¸€ä¸ªå¦‚ä½•æ„å»ºäººç±»ç¤¾ä¼šé¢˜æçš„å°è¯´ã€‚å°è¯´ä¸­ä¹Ÿæåˆ°äº†å¾ˆå¤šä¹¦ç±ï¼Œä¹Ÿæœ‰ç½‘å‹æ€»ç»“äº†ä¸€ä»½å¿ƒç†æµ‹é‡è€…ä¸­æåˆ°çš„ä¹¦ç±ï¼Œä¹¦å•å¦‚ä¸‹:</p><p><strong>æ”¿æ²»/å“²å­¦/å¿ƒç†å­¦/ç¤¾ä¼šå­¦</strong></p><table><thead><tr><th>ä¹¦å</th><th>ä½œè€…</th></tr></thead><tbody><tr><td>ã€Šè®ºé“å¾·çš„è°±ç³» å–„æ¶ä¹‹å½¼å²¸ã€‹</td><td>å¼—é‡Œå¾·é‡Œå¸ŒÂ·å°¼é‡‡</td></tr><tr><td>ã€Šæ‚²å‰§çš„è¯ç”Ÿã€‹</td><td>å¼—é‡Œå¾·é‡Œå¸ŒÂ·å°¼é‡‡</td></tr><tr><td>ã€ŠæŸ¥æ‹‰å›¾æ–¯ç‰¹æ‹‰å¦‚æ˜¯è¯´ã€‹</td><td>å¼—é‡Œå¾·é‡Œå¸ŒÂ·å°¼é‡‡</td></tr><tr><td>ã€Šè®ºäººä¸äººä¹‹é—´ä¸å¹³ç­‰çš„èµ·å› å’ŒåŸºç¡€ã€‹</td><td>è®©Â·é›…å…‹Â·å¢æ¢­</td></tr><tr><td>ã€Šç¤¾ä¼šå¥‘çº¦è®ºã€‹</td><td>è®©Â·é›…å…‹Â·å¢æ¢­</td></tr><tr><td>ã€Šæ€æƒ³å½•ã€‹</td><td>å¸ƒè±å…¹Â·å¸•æ–¯å¡å°”</td></tr><tr><td>ã€Šå¤§ä¼—çš„åå›ã€‹</td><td>å¥¥å°”ç‰¹åŠ Â·åŠ å¡ç‰¹</td></tr><tr><td>ã€Šç»æµä¸ç¤¾ä¼šã€‹</td><td>é©¬å…‹æ€Â·éŸ¦ä¼¯</td></tr><tr><td>ã€Šé“å¾·ä¸ç«‹æ³•åŸç†å¯¼è®ºã€‹</td><td>æ°é‡Œç±³Â·è¾¹æ²</td></tr><tr><td>ã€Šæ¢æ±‚çœŸç†çš„æŒ‡å¯¼åŸåˆ™ã€‹</td><td>å‹’å†…Â·ç¬›å¡å°”</td></tr><tr><td>ã€Šå“²å­¦åŸç†ã€‹</td><td>å‹’å†…Â·ç¬›å¡å°”</td></tr><tr><td>ã€Šè‡´æ­»çš„ç–¾ç—…ã€‹</td><td>ç´¢ä¼¦Â·å…‹å°”å‡¯éƒ­å°”</td></tr><tr><td>ã€Šéæ­¤å³å½¼ã€‹</td><td>ç´¢ä¼¦Â·å…‹å°”å‡¯éƒ­å°”</td></tr><tr><td>ã€Šè¢«èƒŒå›çš„é©å‘½ã€‹</td><td>æ‰˜æ´›èŒ¨åŸº</td></tr><tr><td>ã€Šä¹Œåˆä¹‹ä¼—ã€‹</td><td>å¤æ–¯å¡”å¤«Â·å‹’åº</td></tr><tr><td>ã€Šçº¯ç²¹ç†æ€§æ‰¹åˆ¤ã€‹</td><td>ä¼Šæ›¼åŠªå°”Â·åº·å¾·</td></tr><tr><td>ã€Šè®ºæ³•çš„ç²¾ç¥ã€‹</td><td>å­Ÿå¾·æ–¯é¸ </td></tr><tr><td>ã€Šå½¢è€Œä¸Šå­¦ä¼¦ã€‹</td><td>ä¼å°”æ³°</td></tr><tr><td>ã€Šæ‹¿ç ´ä»‘æ³•å…¸ã€‹</td><td></td></tr><tr><td>ã€Šèµ„æœ¬è®ºã€‹</td><td>å¡å°”Â·é©¬å…‹æ€</td></tr><tr><td>ã€Šè§„è®­ä¸æƒ©ç½šï¼šç›‘ç‹±çš„è¯ç”Ÿã€‹</td><td>ç¦æŸ¯</td></tr><tr><td>ã€Šå½“å°¼é‡‡åœ¨å“­æ³£ã€‹</td><td>æ¬§æ–‡Â·äºšéš†</td></tr><tr><td>ã€Šæˆ˜äº‰è®ºã€‹</td><td>å¡å°”Â·å†¯Â·å…‹åŠ³å¡ç»´èŒ¨</td></tr><tr><td>ã€Šé»‘çš®è‚¤ï¼Œç™½é¢å…·ã€‹</td><td>å¼—æœ—èŒ¨Â·æ³•å†œ</td></tr><tr><td>ã€Šè¿½å¯»ç”Ÿå‘½çš„æ„ä¹‰ã€‹</td><td>ç»´å…‹å¤šÂ·EÂ·å¼—å…°å…‹å°”</td></tr></tbody></table><p><strong>åä¹Œæ‰˜é‚¦æ–‡å­¦</strong></p><table><thead><tr><th>ä¹¦å</th><th>ä½œè€…</th></tr></thead><tbody><tr><td>ã€Šä¸€ä¹å…«å››ã€‹</td><td>ä¹”æ²»Â·å¥¥å¨å°”</td></tr><tr><td>ã€ŠåŠ¨ç‰©å†œåœºã€‹</td><td>ä¹”æ²»Â·å¥¥å¨å°”</td></tr><tr><td>ã€Šç¾ä¸½æ–°ä¸–ç•Œã€‹</td><td>èµ«èƒ¥é»</td></tr><tr><td>ã€Šæˆ‘ä»¬ã€‹</td><td>æ‰ç±³äºšäº¬</td></tr><tr><td>ã€Šè¿™å®Œç¾çš„ä¸€å¤©ã€‹</td><td>è‰¾æ‹‰Â·è±æ–‡</td></tr></tbody></table><p><strong>æˆå‰§æ–‡å­¦</strong></p><table><thead><tr><th>ã€Šç¬¬åäºŒå¤œã€‹</th><th>èå£«æ¯”äºš</th></tr></thead><tbody><tr><td>ã€Šæ³°ç‰¹æ–¯Â·å®‰å¾·æ´›å°¼å…‹æ–¯ã€‹</td><td>èå£«æ¯”äºš</td></tr><tr><td>ã€Šéº¦å…‹ç™½ã€‹</td><td>èå£«æ¯”äºš</td></tr><tr><td>ã€Šæ–å¤šç¯‡ã€‹</td><td>æŸæ‹‰å›¾</td></tr><tr><td>ã€Šé»‘æš—çš„å¿ƒã€‹</td><td>åº·æ‹‰å¾·</td></tr><tr><td>ã€Šé¢„å…ˆè¢«èƒŒå›çš„é©å‘½ã€‹</td><td>å²©ä¸Šå®‰èº« ï¼ˆæ— ä¸­æ–‡ç‰ˆï¼‰</td></tr><tr><td>ã€Šå°‘æ•°æ´¾æŠ¥å‘Šã€‹</td><td>è²åˆ©æ™®Â·è¿ªå…‹</td></tr><tr><td>ã€Šæœºå™¨äººä¼šæ¢¦è§ç”µå­ç¾Šå—ã€‹</td><td>è²åˆ©æ™®Â·è¿ªå…‹</td></tr><tr><td>ã€Šç¥ç»æ¼«æ¸¸è€…ã€‹</td><td>å¨å»‰Â·å‰å¸ƒæ£®</td></tr><tr><td>ã€Šæå«æœºå¯†ã€‹</td><td>å¨å»‰Â·å‰å¸ƒæ£®</td></tr><tr><td>ã€Šæ ¼åˆ—ä½›æ¸¸è®°ã€‹</td><td>ä¹”çº³æ£®Â·æ–¯å¨å¤«ç‰¹</td></tr><tr><td>ã€Šè¿½å¿†ä¼¼æ°´å¹´åã€‹</td><td>é©¬å¡å°”Â·æ™®é²æ–¯ç‰¹</td></tr><tr><td>ã€Šå…‹è‹é²ç¥è¯ã€‹</td><td>æ´›å¤«å…‹æ‹‰å¤«ç‰¹</td></tr><tr><td>ã€Šå…‹è‹é²ç¥è¯IIã€‹</td><td>æ´›å¤«å…‹æ‹‰å¤«ç‰¹</td></tr><tr><td>ã€Šå†è§äº†ï¼Œç”µå½±ã€‹</td><td>å¯ºå±±ä¿®å¸</td></tr><tr><td>ã€Šå¹»æƒ³å›¾ä¹¦é¦†ã€‹</td><td>å¯ºå±±ä¿®å¸</td></tr><tr><td>ã€Šé“æ—æ ¼é›·çš„ç”»åƒã€‹</td><td>å¥¥æ–¯å¡Â·ç‹å°”å¾·</td></tr><tr><td>ã€Šé’¢çªŸã€‹</td><td>è‰¾è¨å…‹Â·é˜¿è¥¿è«å¤«</td></tr><tr><td>ã€Šå¯‚é™çš„æ˜¥å¤©ã€‹</td><td>è•¾åˆ‡å°”Â·å¡æ£®</td></tr><tr><td>ã€Šå¿æ‚”å½•ã€‹</td><td>è®©Â·é›…å…‹Â·å¢æ¢­</td></tr><tr><td>ã€Šç†æƒ³å›½ã€‹</td><td>æŸæ‹‰å›¾</td></tr><tr><td>ã€Šå’Œè°ã€‹</td><td>ä¼Šè—¤è®¡åˆ’</td></tr></tbody></table><p>å…¶ä¸­å¢æ¢­çš„ä¹¦ä¹Ÿæ˜¯æˆ‘çœ‹äº†è¿™éƒ¨å°è¯´ä¹‹åæ‰å¼€å§‹è¯»çš„ï¼Œè¿˜æœ‰ä¸€æœ¬æ˜¯ç¦æŸ¯çš„ã€Šè§„è®­ä¸æƒ©ç½šï¼šç›‘ç‹±çš„è¯ç”Ÿã€‹ï¼Œå‰©ä½™ä»·å€¼é‚£æœŸè¢«å°æ€çš„èŠ‚ç›®é‡Œç½—æ–°è€å¸ˆä¹Ÿæåˆ°è¿‡è¿™æœ¬ä¹¦ã€‚é©¬å…‹æ€Â·éŸ¦ä¼¯çš„ä¹¦åœ¨ã€Šä¸­å›½å›½å®¶æ²»ç†çš„åˆ¶åº¦é€»è¾‘ï¼šä¸€ä¸ªç»„ç»‡å­¦ç ”ç©¶ã€‹ä¸­æåˆ°ä¸å°‘ï¼Œå°¤å…¶æ˜¯å…³äºå®˜åƒšæ”¿æ²»çš„ï¼Œè€Œä¸”é©¬å…‹æ€Â·éŸ¦ä¼¯è¿˜å’Œå‰æ–‡æåˆ°çš„è·¯å¾·ç»´å¸ŒÂ·å†¯Â·ç±³å¡æ–¯ä¹Ÿæ˜¯ä¸€å¯¹å­¦æœ¯ä¸Šçš„å¥½åŸºå‹ã€‚</p><p><code>æ‘˜æŠ„</code> <a href="https://t.co/gp1upTv3IK" target="_blank" rel="noopener">å¿ƒé‡Œæµ‹é‡è€…</a></p><h3 id="æ–°å¸¸è¯†ï¼šä¸€å…šä¸“æ”¿çš„æ€§è´¨ä¸åæœ"><a href="#æ–°å¸¸è¯†ï¼šä¸€å…šä¸“æ”¿çš„æ€§è´¨ä¸åæœ" class="headerlink" title="æ–°å¸¸è¯†ï¼šä¸€å…šä¸“æ”¿çš„æ€§è´¨ä¸åæœ"></a>æ–°å¸¸è¯†ï¼šä¸€å…šä¸“æ”¿çš„æ€§è´¨ä¸åæœ</h3><p>è¿™æœ¬ä¹¦æ˜¯å¼ é›ªå¿ æ•™æˆå†™çš„ï¼Œå†™ä½œé£æ ¼å’Œå¼ åƒå¸†ã€è®¸ç« æ¶¦ã€å¼ ç»´è¿ä»–ä»¬ä¸€æ ·ã€‚æ¯”è¾ƒå–œæ¬¢è¿™æ ·çš„è€å¸ˆï¼Œå…³äºå¼ é›ªå¿ æ•™æˆï¼Œç»´åŸºç™¾ç§‘ä¸Šæœ‰ä¸€æ®µï¼š</p><blockquote><p>2013å¹´5æœˆï¼Œå¼ é›ªå¿ é¦–å…ˆåœ¨ç½‘ç»œå…¬å¼€ä¸€ä»½ä¸­å›½å®˜æ–¹çš„â€œ<a href="https://zh.wikipedia.org/wiki/ä¸ƒä¸è®²" target="_blank" rel="noopener">ä¸ƒä¸è®²</a>â€çš„å†…éƒ¨ææ–™çš„å†…å®¹ã€‚å…¶åå¾—åˆ°å…¶ä»–å­¦è€…å’Œæ•™æˆçš„è¯å®ã€‚â€œä¸ƒä¸è®²â€æ˜¯ä¸­å…±ä¸­å¤®åœ¨2013å¹´åœ¨æ„è¯†å½¢æ€é¢†åŸŸçš„æŒ‡ä»¤ï¼Œç¡®å®šä¸ƒä¸ªé¢†åŸŸä¸ºç¦åŒºï¼š<a href="https://zh.wikipedia.org/wiki/æ™®ä¸–ä»·å€¼" target="_blank" rel="noopener">æ™®ä¸–ä»·å€¼</a>ã€<a href="https://zh.wikipedia.org/wiki/æ–°é—»è‡ªç”±" target="_blank" rel="noopener">æ–°é—»è‡ªç”±</a>ã€<a href="https://zh.wikipedia.org/wiki/å…¬æ°‘ç¤¾ä¼š" target="_blank" rel="noopener">å…¬æ°‘ç¤¾ä¼š</a>ã€<a href="https://zh.wikipedia.org/wiki/å…¬æ°‘æƒåˆ©" target="_blank" rel="noopener">å…¬æ°‘æƒåˆ©</a>ã€ä¸­å›½å…±äº§å…šçš„å†å²é”™è¯¯ã€<a href="https://zh.wikipedia.org/wiki/æƒè´µèµ„äº§é˜¶çº§" target="_blank" rel="noopener">æƒè´µèµ„äº§é˜¶çº§</a>ã€<a href="https://zh.wikipedia.org/wiki/å¸æ³•ç¨ç«‹" target="_blank" rel="noopener">å¸æ³•ç‹¬ç«‹</a>ã€‚éšåâ€œä¸ƒä¸è®²â€æˆä¸ºç½‘ç»œç¦è¯ï¼Œå¼ çš„æ–°æµªå¾®åšå†æ¬¡è¢«åˆ å·ã€‚<a href="https://zh.wikipedia.org/wiki/å¼ é›ªå¿ #cite_note-rfa2-6" target="_blank" rel="noopener">[6]</a></p></blockquote><p>è¿™ä¸€ä»¶äº‹ä¸å¾—æŠ¥é“ã€é‚£ä¸€æœ¬ä¹¦ä¸å¾—å‡ºç‰ˆã€è¿™å¥è¯ä¸èƒ½è®²ï¼Œåˆ è´´å°å·ç­‰ï¼Œè¡¨é¢ä¸Šè¨€è®ºå®¡æŸ¥æ˜¯åœ¨ä¾µçŠ¯è¨€è®ºè‡ªç”±ï¼Œä½†å®è´¨ä¸Šå´æ˜¯åœ¨è´¬ä½å…¨ä½“å›½æ°‘çš„äººæ ¼å’Œå°Šä¸¥ã€‚è¨€è®ºå®¡æŸ¥å®Œå…¨æ˜¯åœ¨å‘å…¨ä½“å›½æ°‘å®£å‘Šï¼šâ€œä½ ä»¬è¿™å¸®å±æ°‘æ ¹æœ¬å°±æ²¡æœ‰èµ„æ ¼äº†è§£è¿™ä»¶äº‹æƒ…çš„çœŸç›¸ï¼Œä¹Ÿæ²¡æœ‰èµ„æ ¼å»æ€è€ƒå’Œè¾¨åˆ«ä¿¡æ¯çš„çœŸå‡ã€‚â€ï¼Œä»·å€¼åˆ¤æ–­çš„æ ‡å‡†ç”±çœŸç†éƒ¨è¯´äº†ç®—ã€‚ä¸€ä¸ªäººä¸ä¸€å¤´çŒªçš„æœ€å¤§åŒºåˆ«ï¼Œå°±åœ¨äºäººå…·æœ‰çŒªæ‰€æ²¡æœ‰çš„ç†æ™ºï¼Œè€Œè¨€è®ºå®¡æŸ¥æ°æ°æ˜¯åœ¨å‰¥å¤ºäººä»¬è‡ªç”±è¿ç”¨ç†æ™ºçš„èµ„æ ¼ï¼Œä¹Ÿå°±æ˜¯å°½é‡ç¼©å°äººä¸çŒªä¹‹é—´çš„å·®åˆ«ã€‚ä¸“åˆ¶ç»Ÿæ²»è€…ç¡®å®å¸Œæœ›å›½æ°‘å¿˜è®°è‡ªå·±æ˜¯æœ‰ç†æ™ºçš„åŠ¨ç‰©ï¼Œå¹¶èƒ½åƒçŒªä¸€æ ·å®¹æ˜“æ»¡è¶³ï¼Œåªéœ€æœ‰è¶³ä»¥æœè…¹çš„é£Ÿç‰©ï¼Œå°±ä¼šå¯¹ç»Ÿæ²»è€…æ„Ÿæ©æˆ´å¾·ã€‚</p><blockquote><p>å…¨ä½“å›½æ°‘ä½œä¸ºä¸»æƒè€…ç»„å»ºæ”¿åºœå¹¶é€‰ä»»æ‰§æ”¿è€…ï¼Œæœ¬æ˜¯ä¸ºäº†æ›´å¥½åœ°ä¿æŠ¤è‡ªå·±çš„ç”Ÿå‘½ã€è´¢äº§å’Œè‡ªç”±ã€‚æ”¿åºœçš„ç›®çš„å’Œæ‰§æ”¿è€…çš„ä½¿å‘½ï¼Œæ˜¯ä¿æŠ¤ä¸»æƒè€…æœ¬æ¥å°±äº«æœ‰çš„æƒåˆ©å’Œè‡ªç”±ï¼Œè€Œä¸æ˜¯èµäºˆä¸»æƒè€…æœ¬æ¥ä¸äº«æœ‰çš„æƒåˆ©å’Œè‡ªç”±ã€‚æ‰§æ”¿è€…è®¤ä¸ºå›½æ°‘çš„æƒåˆ©å’Œè¿½æ±‚å¹¸ç¦çš„æœºä¼šï¼Œæ˜¯æºäºè‡ªå·±çš„èµèµï¼Œå°±åƒå­å¥³è®¤ä¸ºçˆ¶æ¯çš„å­˜åœ¨æ˜¯å‡ºäºè‡ªå·±çš„æ„å¿—ä¸€æ ·è’è°¬å’Œæ‚–ç†ã€‚</p></blockquote><p>æ­¤æ¬¡ç–«æƒ…è¿˜å°šæœªç»“æŸï¼Œæ­ŒåŠŸèµå¾·çš„å·è§’å·²ç»å¹å“äº†ï¼Œå‘µå‘µï¼ŒçœŸä»–å¦ˆå¯ç¬‘ã€‚æ‰€ä»¥ï¼Œä¸ºä»€ä¹ˆæœ‰ä¸ªå°å­¦ç”Ÿåœ¨ç»™æ–¹èˆ±åŒ»é™¢å”±èµæ­Œï¼Œä¹Ÿå°±ä¸éš¾ç†è§£äº†ğŸ˜‚</p><blockquote><p><strong>å‰©ä½™ä»·å€¼ï¼š</strong> ææµ·é¹ä¹‹å‰å‘äº†ä¸€æ¡å¾®åšï¼Œå¤§æ¦‚æ˜¯è¯´ï¼Œä¸€ä¸ªä¸¾å›½ä½“åˆ¶çš„éšæ‚£åˆ°æœ€åå¯èƒ½åˆä¼šå˜æˆä¸€ä¸ªä¸¾å›½ä½“åˆ¶çš„èƒœåˆ©ã€‚<br><strong>ç½—æ–°ï¼š</strong>å†å²å­¦è€…è®¤ä¸ºï¼Œåœ¨è¥¿æ–¹ï¼Œä½ çœ‹åˆ°æ‰€æœ‰çš„æˆ˜äº‰ã€ç¾éš¾æ€§çš„é©å‘½æˆ–è€…æ˜¯ä½“åˆ¶æ€§çš„å´©æºƒï¼Œå…¶åæœå¯èƒ½æ˜¯å¼•èµ·äº†ä¸€æ³¢æ–°çš„å†å²ä¸Šå‡æœŸã€‚æ¯”å¦‚ç¾å›½åœ¨ç»æµå¤§è§æ¡ä¹‹åï¼Œç»æµåè€Œæœ‰æ‰€å›å‡ï¼Œåè€Œå¼€é€šäº†ä¸€æ¡å‘ä¸Šçˆ¬çš„æ–°çš„é“è·¯ã€‚ä½†æ˜¯ç ”ç©¶è€…ä¹Ÿå‘ç°ï¼Œåœ¨ä¸œæ–¹ä¸ä¸€å®šæ˜¯è¿™æ ·ï¼Œç¾éš¾ä¹‹åå¯èƒ½æ˜¯æ›´å¤§çš„ç¾éš¾ï¼Œæ›´å¤§çš„ç¾éš¾åé¢è¿˜æœ‰æ›´å¤§çš„ç¾éš¾ï¼Œå¼•å‘ç¾éš¾çš„é‚£äº›å› ç´ ä¸ä»…å¾—ä¸åˆ°ä¿®æ­£ï¼Œè¿˜å¾—åˆ°äº†åŠ å¼ºåŒ–ã€‚è¿™æ˜¯æˆ‘ä»¬è¦æ³¨æ„çš„ã€‚äººä»¬è¯´ï¼Œéƒ½å‘ç”Ÿäº†è¿™ä¹ˆå¤§çš„äº‹ï¼Œæˆ‘ä»¬è¯¥ä¸è¯¥åæ€äº†ï¼Ÿè¦å°å¿ƒï¼Œå¯èƒ½æ²¡æœ‰åæ€ï¼Œå¯èƒ½æ˜¯å¼ºåŒ–ã€‚</p></blockquote><p>åˆ°ç°åœ¨æ²¡æœ‰äº†è¿½ç©¶é—®è´£ï¼Œå°±è¿è¿›é©»æ­¦æ±‰å¯¹ææ–‡äº®åŒ»ç”Ÿäº‹ä»¶çš„è°ƒæŸ¥ç»“æœä¹Ÿæ˜¯ä¸€çº¸ç©ºæ–‡è‹ç™½æ— åŠ›ï¼Œç”šè‡³é‚£äº›çºªå¿µææ–‡äº®åŒ»ç”Ÿçš„äººä¹Ÿè¢«å–èŒ¶é—®å€™ã€‚ç›®å‰å­˜åœ¨çš„ä¹Ÿåªæœ‰åƒã€Šå¤§å›½æˆ˜ç–«ã€‹è¿™æ ·å¯¹æƒè´µæ­ŒåŠŸèµå¾·çš„å£°éŸ³ï¼Œå¯¹ç¾å¸å›½ä¸»ä¹‰çš„æ•Œå¿¾åŒä»‡â€¦â€¦å”‰ï¼Œä¸€åœºç¾éš¾å˜æˆäº†ä¸€åœºä¸¾å›½ä½“åˆ¶çš„èƒœåˆ©ï¼Œæ˜¯æˆ‘ä»¬çš„æ‚²å“€ä¹Ÿæ˜¯å…¨ä¸–ç•Œçš„æ‚²å“€ã€‚</p><p>æƒ³èµ·äº† ã€Š1984ã€‹ é‡Œçš„ä¸€æ®µè¯ï¼Œæˆ–è®¸ç”¨ææƒä¸»ä¹‰æ¥è§£é‡Šå½“ä¸‹æœ€é€‚åˆä¸è¿‡äº†ï¼š<strong>ææƒæœ€æœ‰æ•ˆçš„ç»Ÿæ²»æœ¯æ˜¯ä»‡æ¨æ•™è‚²ï¼Œå¡‘é€ ä¸€ä¸ªè¿œåœ¨å¤©è¾¹çš„å¤–åœ¨æ•Œäººï¼Œäººä»¬å°±ä¼šå¿˜è®°èº«è¾¹çš„ç—›è‹¦ã€‚</strong></p><p><code>æ‘˜æŠ„</code> <a href="https://t.co/1vyK1t0NMr" target="_blank" rel="noopener">æ–°å¸¸è¯†ï¼šä¸€å…šä¸“æ”¿çš„æ€§è´¨ä¸åæœ</a></p><h3 id="åœ°çƒè„‰åŠ¨ï¼šå‰æ‰€æœªè§çš„è‡ªç„¶ä¹‹ç¾"><a href="#åœ°çƒè„‰åŠ¨ï¼šå‰æ‰€æœªè§çš„è‡ªç„¶ä¹‹ç¾" class="headerlink" title="åœ°çƒè„‰åŠ¨ï¼šå‰æ‰€æœªè§çš„è‡ªç„¶ä¹‹ç¾"></a>åœ°çƒè„‰åŠ¨ï¼šå‰æ‰€æœªè§çš„è‡ªç„¶ä¹‹ç¾</h3><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/screenshot_2020_01_17T08_00_05+0800.png" alt="img"></p><p><code>æ‘˜æŠ„</code> <a href="https://t.co/gjRzZG1OqC" target="_blank" rel="noopener">åœ°çƒè„‰åŠ¨ï¼šå‰æ‰€æœªè§çš„è‡ªç„¶ä¹‹ç¾</a></p><h3 id="ã€Šç¤¾ä¼šå¥‘çº¦è®ºã€‹"><a href="#ã€Šç¤¾ä¼šå¥‘çº¦è®ºã€‹" class="headerlink" title="ã€Šç¤¾ä¼šå¥‘çº¦è®ºã€‹"></a>ã€Šç¤¾ä¼šå¥‘çº¦è®ºã€‹</h3><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/screenshot_2020_01_23T08_56_10+0800.png" alt="img"></p><p>æŒ‰ç…§å¢æ¢­çš„ç¬¬ä¸€ç¯‡è®ºæ–‡ã€Šè®ºç§‘å­¦ä¸è‰ºæœ¯çš„å¤å…´æ˜¯å¦æœ‰åŠ©äºä½¿é£ä¿—æ—¥è¶‹çº¯æœ´ã€‹å’Œç¬¬äºŒç¯‡è®ºæ–‡ã€Šè®ºäººç±»ä¸å¹³ç­‰çš„èµ·æºå’ŒåŸºç¡€ ã€‹çš„åˆ†æï¼Œäººæœ¬æ¥æ˜¯çº¯æœ´å–„è‰¯çš„ï¼Œç”±äºæœ‰ç¼ºé™·çš„ç¤¾ä¼šåˆ¶åº¦ï¼Œç”Ÿæ´»äºç¤¾ä¼šä¸­çš„äººæ‰å˜åï¼Œå¹¶å •å…¥ç½ªæ¶çš„æ·±æ¸Šã€‚ç”±æ–‡æ˜å¼•å‘çš„é—®é¢˜å¿…é¡»é€šè¿‡æ–°çš„æ”¿æ²»ç»„ç»‡å½¢å¼æ¥åŠ ä»¥å…‹æœã€‚ã€Šç¤¾ä¼šå¥‘çº¦è®ºã€‹è¦åšçš„å·¥ä½œæ˜¯ï¼Œé€šè¿‡å»ºç«‹ä¸€ä¸ªå¥å…¨çš„ç¤¾ä¼šæ”¿æ²»åˆ¶åº¦ï¼Œå¸®åŠ©äººä»¬æ¢å¤è‡ªç„¶è‰¯å–„ï¼ˆnatural goodnessï¼‰ã€‚</p><p>ä»€ä¹ˆæ ·çš„ç¤¾ä¼šæ”¿æ²»åˆ¶åº¦æ‰æ˜¯å¥å…¨çš„å‘¢ï¼Ÿè¿™å°±è¦è¿½é—®ä¸€ä¸ªæ ¸å¿ƒé—®é¢˜ï¼šæ­£ä¹‰ä¸åˆæ³•çš„æ”¿æ²»ç§©åºåŠå…¶åŸºç¡€æ˜¯ä»€ä¹ˆï¼Ÿã€Šç¤¾ä¼šå¥‘çº¦è®ºã€‹æ‰€æœ‰å…¶ä»–çš„é—®é¢˜å‡æ˜¯ä»è¿™é‡Œç”Ÿå‘å‡ºæ¥ï¼Œå¹¶ä¸ä¹‹å…³è”åœ¨ä¸€èµ·çš„ã€‚ã€Šç¤¾ä¼šå¥‘çº¦è®ºã€‹å…±æœ‰å››å·ï¼Œç¬¬ä¸€å·è®¨è®ºçš„æ˜¯åˆæ³•çš„æ”¿æ²»ç§©åºçš„åŸºç¡€ï¼›ç¬¬äºŒå·è®¨è®ºçš„ä¸»é¢˜æ˜¯æ³•å¾‹å’Œç«‹æ³•ï¼›ç¬¬ä¸‰å·çš„ä¸»é¢˜æ˜¯æ™®éæ„å¿—è¿ç”¨äºç‰¹å®šæƒ…å½¢å³æ”¿åºœçš„æœºåˆ¶ï¼›ç¬¬å››å·ï¼Œè¿™ä¸€å·ä»¥å¯¹ç½—é©¬çš„æ”¿æ²»åˆ¶åº¦çš„æè¿°ä¸ºæ ¸å¿ƒå†…å®¹ï¼Œä»¥æ­¤æ¥æ¢è®¨æ”¿æ²»å…±åŒä½“çš„å‡èšåŠ›é—®é¢˜ï¼Œæœ€åä»¥å…¬æ°‘å®—æ•™ç»“æŸå…¨ä¹¦ã€‚</p><p>ã€Šç¤¾ä¼šå¥‘çº¦è®ºã€‹çš„æ ¸å¿ƒæ€æƒ³å°±æ˜¯<strong>åˆæ³•çš„å›½å®¶å¿…é¡»æ ¹æ®æ™®éæ„å¿—æ¥è¿›è¡Œç®¡ç†ï¼Œå³å·²æå‡º</strong>ã€‚ã€Šçˆ±å¼¥å„¿ã€‹èƒŒåçš„ä¸€ä¸ªåŸºæœ¬é¢„è®¾æ˜¯ï¼šæ²¡æœ‰æ–‡åŒ–åšæ”¯æ’‘ï¼Œåˆ¶åº¦æ˜¯æ²¡æœ‰åŠæ³•æœ‰æ•ˆè¿è¡Œçš„ã€‚å› æ­¤ï¼Œæœ€é‡è¦çš„ä»»åŠ¡æ˜¯ï¼šé€šè¿‡æ•™è‚²ï¼Œå°†â€œäººâ€è½¬å˜ä¸ºâ€œå…¬æ°‘â€ï¼Œåƒçˆ±å¼¥å„¿ä¸€æ ·çš„å…¬æ°‘ã€‚å”¯å…¶å¦‚æ­¤ï¼Œæ™®éæ„å¿—æ‰æœ‰å¯èƒ½ï¼Œæ­£ä¹‰è€Œåˆæ³•çš„æ”¿æ²»ç§©åºæ‰æœ‰å¯èƒ½ã€‚</p><p>æ‰€ä»¥å¢æ¢­çš„è¿™å‡ æœ¬ä¹¦è¿è´¯æ€§å¾ˆå¼ºï¼Œæ¨èéƒ½è¯»å®Œæ‰èƒ½ç†è§£å¢æ¢­çš„æ”¿æ²»å“²å­¦æ€æƒ³ã€‚</p><p><code>æ‘˜æŠ„</code> <a href="https://kindle.502.li/" target="_blank" rel="noopener">ç¤¾ä¼šå¥‘çº¦è®º</a></p><h3 id="ä¸­å›½å›½å®¶æ²»ç†çš„åˆ¶åº¦é€»è¾‘ï¼šä¸€ä¸ªç»„ç»‡å­¦ç ”ç©¶"><a href="#ä¸­å›½å›½å®¶æ²»ç†çš„åˆ¶åº¦é€»è¾‘ï¼šä¸€ä¸ªç»„ç»‡å­¦ç ”ç©¶" class="headerlink" title="ä¸­å›½å›½å®¶æ²»ç†çš„åˆ¶åº¦é€»è¾‘ï¼šä¸€ä¸ªç»„ç»‡å­¦ç ”ç©¶"></a>ä¸­å›½å›½å®¶æ²»ç†çš„åˆ¶åº¦é€»è¾‘ï¼šä¸€ä¸ªç»„ç»‡å­¦ç ”ç©¶</h3><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/screenshot_2020_01_27T22_54_06+0800.png" alt="img"></p><p>è¿™æœ¬ä¹¦æ˜¯æ˜¥èŠ‚çš„æ—¶å€™åœ¨å®¶è¯»å®Œçš„ï¼Œè¾ƒä¹‹äºå¼ é›ªå¿ æ•™æˆçš„ã€Šæ–°å¸¸è¯†ï¼šä¸€å…šä¸“æ”¿çš„æ€§è´¨å’Œåæœã€‹ï¼Œå‘¨é›ªå…‰ä»ç»„ç»‡å­¦è§’åº¦æ¥è¿›è¡Œåˆ†æä¸­å…±å›½å®¶æ²»ç†å¾—é€»è¾‘ã€‚å¯¹äºè¿™æ¬¡å¾—ç–«æƒ…æ¥è®²ï¼Œå†ä¸€æ¬¡å°è¯äº†ä¹¦ä¸­æ‰€é˜é‡Šçš„å†…å®¹ã€‚<strong>å³ä¸€ç»Ÿä½“åˆ¶ä¸æœ‰æ•ˆæ²»ç†ï¼šä¸­å›½å›½å®¶æ²»ç†çš„ä¸€ä¸ªæ·±åˆ»çŸ›ç›¾</strong>ã€‚ä¸åšè¿‡å¤šè¯„è®ºï¼Œæ­¤ä¹¦å¦‚åŒæ¨ç‰¹ä¸Šçš„ä¸€äº›äººæ¨èä¸€æ ·ï¼Œå¾ˆé€‚åˆå½“ä¸‹å»çœ‹çœ‹ï¼Œå»åˆ†æä¸€ä¸‹è¿™ä¸ªå®˜åƒšä½“åˆ¶æ˜¯å¤šä¹ˆåœ°è…è´¥å’Œæ— èƒ½ã€‚å°±å¦‚ã€Šå¿ƒç†æµ‹é‡è€…ã€‹ä¸­æ‰€è¯´çš„ï¼Œ<strong>æˆ‘ä»¬å§‹ç»ˆæ‰¿æ‹…ç€æ”¿åºœå¼ºåŠ ç»™æˆ‘ä»¬çš„é£é™©</strong>ï¼Œè¿™æ˜¯æƒåŠ›é›†ä¸­åŒ–çš„å¿…ç„¶ç»“æœã€‚é‚£äº›å·²ç»é›†ä¸­èµ·æ¥çš„æƒåŠ›ç»å¯¹ä¸ä¼šå› ä¸ºä»–ç¾å¥½çš„æ„¿æ™¯è€Œå˜å¾—æ— å®³ã€‚é‚£äº›æ­»åœ¨æ­¦æ±‰è‚ºç‚ç—…æ¯’ä¹‹å¤–çš„äººä¸æ­£æ˜¯æˆ‘ä»¬æ¯ä¸ªäººéƒ½è¦æ‰¿æ‹…çš„é£é™©å—ï¼Ÿ</p><p>åœ¨ä¸“åˆ¶å›½å®¶ï¼ŒæƒåŠ›ä¸å—çº¦æŸçš„ç»Ÿæ²»è€…ï¼Œæ˜¯æ™®éçš„æ”¿åºœè…è´¥å’Œå„ç§ç¤¾ä¼šé—®é¢˜çš„æ ¹ç”±ï¼Œä¹Ÿæ˜¯äººç±»æ–‡æ˜ç¤¾ä¼šæœ€å¤§çš„<code>ç—…æ¯’</code> ã€‚ä¹Ÿæ­£æ˜¯æ­£æ˜¯è¿™ä¸ªè…è´¥æ— èƒ½çš„å®˜åƒšä½“åˆ¶æ¬ºä¸Šç’ä¸‹ã€åˆ å¸–å°å·ã€ç»´ç¨³æŠ“äººã€å°æ€è¨€è®ºã€æ‹˜ç•™è®°è€…ã€æŠ“æ•å¾‹å¸ˆã€é€ è°£å¼è¾Ÿè°£ç­‰ç­‰ä½œæ¶è¡Œä¸ºæ‰å¯¼è‡´çš„å…¨çƒç–«æƒ…å¤§çˆ†å‘ã€‚å…¶å®è¿™äº›æ—¶åˆ»ä¼´éšç€æˆ‘ä»¬ï¼Œåªä¸è¿‡æ˜¯è¿™æ¬¡çš„ç—…æ¯’å°†è¿™ä¸ªä½“åˆ¶çš„ä¸€ä¸ªé˜´æš—é¢æ­éœ²äº†å‡ºæ¥è€Œå·²ï¼Œå®ƒè…çƒ‚åˆ°æ ¹é‡Œå·²ç»å¾ˆä¹…å¾ˆä¹…â€¦â€¦</p><p>åœ¨ææƒä¸»ä¹‰ä½“åˆ¶ä¸‹ï¼Œå›½å®¶ä¸€æ–¹é¢ç”¨æ„è¯†å½¢æ€è›Šæƒ‘å’Œéº»é†‰äººæ°‘ï¼Œå¦ä¸€æ–¹é¢åˆç”¨åˆ©ç”¨å›½å®¶æœºå™¨é™åˆ¶ç¤¾ä¼šå†…éƒ¨çš„ç›´æ¥äº¤å¾€ï¼Œä½¿ä¹‹ä¿æŒæœ‰åˆ©äºå›½å®¶æ§åˆ¶çš„â€œåŸå­åŒ–â€çŠ¶æ€ã€‚åŸºäºå›½å®¶çš„ç»å¯¹æƒåŠ›å’Œæ•´ä¸ªç¤¾ä¼šçš„éç»“æ„åŒ–ï¼Œå›½å®¶èƒ½å¤Ÿæ ¹æ®è‡ªå·±çš„æ„å¿—å‘èµ·ä»»ä½•è¡ŒåŠ¨ï¼ŒåŒ…æ‹¬æ”¿æ²»æˆ–ç¤¾ä¼šè¿åŠ¨ã€‚è¿™æ¬¡çš„<code>ç–«æƒ…é˜²å«æˆ˜ç–«</code>ä¸å°±æ˜¯è¿™ä¸ªå®˜åƒšä½“åˆ¶å‘èµ·çš„æ”¿æ²»è¿åŠ¨å˜›ï¼Ÿæ„ŸæŸ“æ­»äº¡äººæ•°ä½œå‡ï¼Œå…¬ä¿¡åŠ›ä¸æ–­åœ°ä¸§å¤±ã€‚ä½ èƒ½åœ¨è¿™æœ¬ä¹¦é‡Œæ‰¾åˆ°å¾ˆå¥½çš„è§£é‡Šï¼Œä¹¦ä¸­ä¹Ÿæåˆ°è¿‡ä¸Šçº§æ¥è§†å¯Ÿçš„æ—¶å€™ï¼Œåœ°æ–¹æ”¿åºœå¦‚ä½•å¿½æ‚ ä¸­å¤®ï¼Œä»¥åŠå„ç§æƒåˆ©å…³ç³»ä¹‹é—´å¦‚ä½•å…±è°‹è¾¾åˆ°<strong>ä¸Šæœ‰æ”¿ç­–ä¸‹æœ‰å¯¹ç­–çš„</strong>ã€‚</p><p>ã€å¡ç†æ–¯ç›æƒå¨çš„æ ¸å¿ƒæ˜¯ï¼Œé¢†è¢–ä»¥å…¶è¶…å‡¡ç¦€èµ‹è€Œå¾—åˆ°è¿½éšè€…çš„æ‹¥æˆ´å’Œæœä»ï¼›è€Œé¢†è¢–åˆ™é€šè¿‡ä¸æ–­åœ°åˆ›é€ â€œå¥‡è¿¹â€æ¥æ˜¾ç¤ºå…¶è¶…å‡¡ç¦€èµ‹ï¼Œä»¥å»¶ç»­å’Œå¼ºåŒ–è¿™ä¸€åˆæ³•æ€§åŸºç¡€ã€‚ åœ¨ç»è¿‡äº†æˆ˜äº‰åŠ¨è¡ï¼Œæ°‘ç”Ÿå‡‹æ•ï¼Œä¸§æƒè¾±å›½çš„æ°‘æ—å±æœºä¹‹åï¼Œä¸­å›½å¤§åœ°æœ‰æœŸå†€å¥‡è¿¹ã€å´‡å°šä¼Ÿäººçš„å¡ç†æ–¯ç›æƒå¨çš„è‚¥æ²ƒåœŸå£¤ã€‚ã€</p><p>ã€ä»»ä½•æŒ‘æˆ˜å¡ç†æ–¯ç›æƒå¨çš„è¯è¯­éƒ½ä¼šå¼±åŒ–ç”šè‡³ç“¦è§£å…¶åˆæ³•æ€§åŸºç¡€ï¼Œå› æ­¤è¯è¯­å„æ–­æƒæ˜¯ç»´ç³»å¡ç†æ–¯ç›æƒå¨çš„å…³é”®æ‰€åœ¨ã€‚å»ºå›½ä»¥åï¼Œå›½å®¶é€æ­¥é€šè¿‡å®˜åƒšä½“åˆ¶ä»‹å…¥ã€æ§åˆ¶ä»¥è‡³å„æ–­æ„è¯†å½¢æ€ç›¸å…³çš„é¢†åŸŸï¼Œæœ‰æ•ˆåœ°æœç»äº†è´¨ç–‘æˆ–æŒ‘æˆ˜å¡ç†æ–¯ç›æƒå¨çš„æ½œåœ¨å¯èƒ½æ€§ã€ è¿™ä¹Ÿæ˜¯è¨€è®ºå®¡æŸ¥çš„æ ¹æœ¬åŸå› å§ï¼Œç»´æŠ¤ç»Ÿæ²»è€…çš„æƒåŠ›åˆæ³•æ€§ã€‚</p><p>åœ¨æ”¿æ²»è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¸éš¾çœ‹åˆ°åœ°æ–¹æ”¿åºœçš„å„ç§åšæ³•ï¼ˆå¦‚åœ¨æ‹†è¿ã€ä¸¥æ‰“ã€åŸç®¡ã€ä¿¡è®¿ç­‰ç­‰è¿‡ç¨‹ä¸­çš„å…·ä½“æ‰€ä¸ºï¼‰å¸¸å¸¸ä¸æ³•å¾‹æ¡æ–‡ç›¸æ‚–ã€‚åœ°æ–¹æ”¿åºœçš„è¿™äº›åšæ³•åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šå¢å¼ºäº†åŸºå±‚æ”¿åºœè§£å†³å®é™…é—®é¢˜çš„èƒ½åŠ›ï¼Œä½†ä¸æ­¤åŒæ—¶ï¼Œå®ƒä»¬ä¸æ–­åœ°ä¾µèš€å¼±åŒ–æ³•æ²»åŸºç¡€å’Œæ³•ç†è§‚å¿µã€‚</p><p><code>æ‘˜æŠ„</code> <a href="https://t.co/tl1mmh7z3t" target="_blank" rel="noopener">ä¸­å›½å›½å®¶æ²»ç†çš„åˆ¶åº¦é€»è¾‘ï¼šä¸€ä¸ªç»„ç»‡å­¦ç ”ç©¶</a></p><h3 id="ç—…æ¯’æ˜Ÿçƒ"><a href="#ç—…æ¯’æ˜Ÿçƒ" class="headerlink" title="ç—…æ¯’æ˜Ÿçƒ"></a>ç—…æ¯’æ˜Ÿçƒ</h3><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/screenshot_2020_01_28T22_03_02+0800.png" alt="img"></p><p>æä¸ºç®€çŸ­çš„ä¸€æœ¬ç§‘æ™®ï¼Œå¤§æ¦‚ç”¨äº†ä¸¤ä¸ªå°æ—¶çš„æ—¶é—´å°±è¯»å®Œäº†ã€‚ä¸»è¦ç§‘æ™®äº†ä¸€ä¸‹ç—…çš„æ€§è´¨ä»¥åŠå…¥ä¾µäººä½“ç»†èƒçš„æœºç†ç­‰ã€‚æ„Ÿè§‰è¯»èµ·æ¥æµ·æ˜Ÿå§ï¼Œæ²¡æœ‰å¤ªå¤šç²¾å½©çš„åœ°æ–¹ï¼Œå°±åƒå›é¡¾äº†ä¸€ä¸‹é«˜ä¸­ç”Ÿç‰©å­¦ã€‚</p><p><code>æ‘˜æŠ„</code> <a href="https://t.co/Op5GTfaOch" target="_blank" rel="noopener">ç—…æ¯’æ˜Ÿçƒ</a></p><h3 id="ç—…æ¯’æ¥è¢­"><a href="#ç—…æ¯’æ¥è¢­" class="headerlink" title="ç—…æ¯’æ¥è¢­"></a>ç—…æ¯’æ¥è¢­</h3><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/screenshot_2020_01_28T22_03_47+0800.png" alt="img"></p><p>æ„Ÿè§‰æ²¡ã€Šç—…æ¯’æ˜Ÿçƒã€‹è¦å¥½ä¸€äº›ï¼Œæ€»ä¹‹æ¨èå‰ä¸€æœ¬ã€‚</p><p><code>æ‘˜æŠ„</code> <a href="https://t.co/kfTZIY7Zt0" target="_blank" rel="noopener">ç—…æ¯’æ¥è¢­</a></p><h3 id="è¡€ç–«ï¼šåŸƒåšæ‹‰çš„æ•…äº‹"><a href="#è¡€ç–«ï¼šåŸƒåšæ‹‰çš„æ•…äº‹" class="headerlink" title="è¡€ç–«ï¼šåŸƒåšæ‹‰çš„æ•…äº‹"></a>è¡€ç–«ï¼šåŸƒåšæ‹‰çš„æ•…äº‹</h3><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/screenshot_2020_01_28T22_02_45+0800.png" alt="img"></p><p>çœ‹å®Œäº†çºªå½•ç‰‡ï¼Œä¹¦ç±å°±çœ‹äº† 20% ï¼Œæ¨èå…ˆçœ‹å®Œä¹¦å†å»çœ‹çºªå½•ç‰‡ã€‚</p><p><code>æ‘˜æŠ„</code> <a href="https://kindle.502.li/" target="_blank" rel="noopener">è¡€ç–«ï¼šåŸƒåšæ‹‰çš„æ•…äº‹</a></p><h3 id="è¿œå¤çš„è‘±èŒï¼šå¤æ¤ç‰©ç‹å›½"><a href="#è¿œå¤çš„è‘±èŒï¼šå¤æ¤ç‰©ç‹å›½" class="headerlink" title="è¿œå¤çš„è‘±èŒï¼šå¤æ¤ç‰©ç‹å›½"></a>è¿œå¤çš„è‘±èŒï¼šå¤æ¤ç‰©ç‹å›½</h3><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/screenshot_2020_02_05T20_28_57+0800.png" alt="img"></p><p>è¿™æœ¬ä¹¦ä¸»è¦è®²äº†æ¤ç‰©çš„èµ·æºã€å…‰åˆä½œç”¨ã€å¶ç»¿ä½“ã€å­¢å­ç”Ÿæ®–ä»¥åŠä¸€äº›è¿œå¤æ—¶æœŸçš„ç”Ÿæ€ç¯å¢ƒç­‰ã€‚æ€»ä¹‹å¯¹äºå’±è¿™ç§å¯¹å¤ç”Ÿç‰©å­¦æ„Ÿå…´è¶£çš„æ¥è¯´ç®—æ˜¯ä¸€é¡¿ç§‘æ™®ç››å®´ï¼Œå­¦åˆ°å¾ˆå¤šçŸ¥è¯†è€¶ï¼Œæå¤§å¾—æ»¡è¶³äº†å’±çš„å¥½å¥‡å¿ƒğŸ˜‚ã€‚</p><p><code>æ‘˜æŠ„</code> <a href="https://t.co/5KOfa96qlr" target="_blank" rel="noopener">è¿œå¤çš„è‘±èŒï¼šå¤æ¤ç‰©ç‹å›½</a></p><h3 id="å¤ç”Ÿç‰©å­¦ç®€æ˜æ•™ç¨‹"><a href="#å¤ç”Ÿç‰©å­¦ç®€æ˜æ•™ç¨‹" class="headerlink" title="å¤ç”Ÿç‰©å­¦ç®€æ˜æ•™ç¨‹"></a>å¤ç”Ÿç‰©å­¦ç®€æ˜æ•™ç¨‹</h3><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/screenshot_2020_02_06T13_52_57+0800.png" alt="img"></p><p>è¯¾æœ¬æ•™æï¼Œæ¯ç‡¥ã€åªæ˜¯äº†è§£äº†ä¸€ä¸‹åŸºæœ¬çš„æ¦‚å¿µï¼Œæ„Ÿè§‰æˆ‘ä¸é€‚åˆè¯»è¿™ç§æ¯ç‡¥çš„è¯¾æœ¬(ï¿£â–½ï¿£)â€</p><p><code>æ‘˜æŠ„</code> <a href="https://t.co/G6oMMnAAji" target="_blank" rel="noopener">å¤ç”Ÿç‰©å­¦ç®€æ˜æ•™ç¨‹</a></p><h3 id="æœ±é’¦å£«çš„ä¸ªäººåšå®¢"><a href="#æœ±é’¦å£«çš„ä¸ªäººåšå®¢" class="headerlink" title="æœ±é’¦å£«çš„ä¸ªäººåšå®¢"></a>æœ±é’¦å£«çš„ä¸ªäººåšå®¢</h3><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/screenshot_2020_02_17T23_10_27+0800.png" alt="img"></p><p>è¿™å¹¶ä¸æ˜¯ä¸€æœ¬ä¹¦ï¼Œè€Œæ˜¯æˆ‘åœ¨ <a href="http://blog.sciencenet.cn/home.php?mod=space&uid=582158" target="_blank" rel="noopener">æœ±é’¦å£« </a>åšå£«çš„ä¸ªäººåšå®¢ä¸Šå¤åˆ¶ä¸‹æ¥æ•´ç†æˆçš„ç”µå­ä¹¦ï¼Œåœ¨ kindle ä¸Šè¯»èµ·æ¥æ¯”è¾ƒæ–¹ä¾¿ã€‚å¯¹äºåªå…·å¤‡é«˜ä¸­ç”Ÿç‰©çŸ¥è¯†å¾—å’±æ¥è¯´ï¼Œè¯»èµ·æœ±é™¢å£«å†™çš„æ–‡ç« è¿˜æ˜¯æœ‰äº›åƒåŠ›çš„ï¼Œæ„Ÿè§‰è¿™åŸºæœ¬ä¸Šå°±æ˜¯è®ºæ–‡çš„æ³¨é‡Šç‰ˆã€‚é‡Œé¢çš„ä¸€äº›å­¦æœ¯ç”¨è¯­æœ‰å¾ˆå¤šéƒ½ä¸æ‡‚ï¼Œåªèƒ½è‡ªå·±æœç´¢äº†è§£ä¸€ä¸‹ã€‚è®²åˆ°äº†çœŸæ ¸ç”Ÿç‰©çš„èµ·æºï¼Œä»¥åŠåŠ¨ç‰©ç»†èƒå’Œæ¤ç‰©ç»†èƒçš„èµ·æºã€‚å’±ä»¬äººç±»ï¼ˆåŠ¨ç‰©ï¼‰æ˜¯ä»å•é­æ¯›çš„åŸç”Ÿç”Ÿç‰©é¢†é­æ¯›è™«ï¼ˆChoanoflagellateï¼‰æ¼”åŒ–è€Œæ¥ï¼Œè€Œæ¤ç‰©åˆ™ç”±åŒé­æ¯›åŸç”Ÿç”Ÿç‰©ä¸­çš„åŒæ˜Ÿè—»ï¼ˆZygmematalesï¼‰æ¼”åŒ–è€Œæ¥ï¼ŒåŸæ¥å’±çš„ç¥–å…ˆæ˜¯åªé­æ¯›è™«ğŸ˜‚ï¼Ÿ</p><p>çœŸæ ¸ç»†èƒæ˜¯æ€æ ·å½¢æˆçš„å‘¢ï¼Œæœ±é™¢å£«è§£é‡Šä¸ºï¼šçœŸæ ¸ç»†èƒæ˜¯å…ˆè·å¾—çº¿ç²’ä½“ï¼Œå†å‘å±•å‡ºç»†èƒæ ¸ã€‚çº¿ç²’ä½“çš„å‡ºç°ç»™çœŸæ ¸ç”Ÿç‰©å¸¦æ¥å……è¶³èƒ½æºçš„åŒæ—¶ï¼Œä¹Ÿå¸¦æ¥äº†å†…å«å­çš„å…¥ä¾µã€‚ä¸ºè›‹ç™½è´¨ç¼–ç çš„åŸºå› ä¸­å†…å«å­çš„å‡ºç°ï¼Œåˆè¿«ä½¿ç»†èƒå½¢æˆç»†èƒæ ¸ä»¥æŠŠDNAå’Œæ ¸ç³–ä½“åˆ†éš”å¼€æ¥ã€‚è¿™å¤§æ¦‚å°±æ˜¯çœŸæ ¸ç»†èƒå‡ºç°çš„æ ¹æœ¬åŸå› ã€‚å…¶å®ƒçš„æ”¹å˜éƒ½æ˜¯åœ¨è¿™ä¸ªåŸºç¡€ä¸Šè¿›è¡Œçš„ã€‚è½¬å½•å’Œè›‹ç™½è´¨åˆæˆå¿…é¡»åœ¨ç©ºé—´ä¸Šåˆ†å¼€ï¼Œè€Œè¿™æ­£æ˜¯ç»†èƒæ ¸çš„ä½œç”¨ã€‚ç»†èƒæ ¸çš„è†œèƒ½å¤Ÿé˜²æ­¢å®Œæ•´çš„æ ¸ç³–ä½“è¿›å…¥ç»†èƒï¼Œè€ŒmRNAåœ¨å‰ªæ¥å®Œæˆå‰ï¼Œåˆä¸ä¼šç¦»å¼€ç»†èƒæ ¸ï¼Œè¿™æ ·æ ¸ç³–ä½“èƒ½å¤Ÿæ¥è§¦çš„ï¼Œå°±åªèƒ½æ˜¯åŠ å·¥å®Œæ¯•çš„ mRNAã€‚</p><p>æ€»ä¹‹å¯¹äºç”Ÿå‘½ç§‘å­¦æ„Ÿå…´è¶£çš„å¯ä»¥å»è¯»è¯»æœ±é™¢å£«çš„åšå®¢ï¼Œå¦‚æœæ±æƒ³è¦å’±åˆ¶ä½œå¥½çš„ç”µå­ä¹¦ç§ä¿¡å’±å³å¯ã€‚</p><p><code>æ‘˜æŠ„</code> <a href="https://t.co/50HX5FvBPk" target="_blank" rel="noopener">æœ±é’¦å£«çš„ä¸ªäººåšå®¢</a></p><h3 id="ä¸Šå¸é€ äººæœ‰å¤šéš¾ï¼šç”Ÿå‘½çš„å¯†é’¥"><a href="#ä¸Šå¸é€ äººæœ‰å¤šéš¾ï¼šç”Ÿå‘½çš„å¯†é’¥" class="headerlink" title="ä¸Šå¸é€ äººæœ‰å¤šéš¾ï¼šç”Ÿå‘½çš„å¯†é’¥"></a>ä¸Šå¸é€ äººæœ‰å¤šéš¾ï¼šç”Ÿå‘½çš„å¯†é’¥</h3><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/screenshot_2020_02_07T11_54_34+0800.png" alt="img"></p><p>è¯»å®Œäº†æœ±é™¢å£«çš„åšå®¢ä¸Šçš„æ–‡ç« ï¼Œå°±åƒæ‰“å¼€äº†æˆ‘çš„å¥½å¥‡å¿ƒæ½˜å¤šæ‹‰é­”ç›’ï¼Œè¶Šæ¥è¶ŠåƒçŸ¥é“å…³äºç”Ÿå‘½ç§‘å­¦çš„çŸ¥è¯†ï¼Œå°±åœ¨ Amazon ä¸Šæœäº†ä¸€ä¸‹ä»–çš„ä¹¦ï¼Œè¿˜çœŸçš„æœ‰ä¸€æœ¬ï¼Œå°± get åˆ°å•¦ã€‚</p><blockquote><p>è¿™æ˜¯ä¸€æœ¬ä»åˆ†å­ç»†èƒå°ºåº¦ä¸Šè®²è§£ç”Ÿå‘½å¥¥ç§˜çš„ç§‘æ™®å°ä¹¦ã€‚ç”¨å¹³å®æµ…æ˜¾çš„è¯­è¨€è§£é‡Šäº†å¤æ‚ç”Ÿå‘½ç³»ç»Ÿçš„ä¸€äº›åŸºæœ¬çŸ¥è¯†ã€‚ è®©æˆ‘äº†è§£äº†äººä½“æ˜¯ç”±60ä¸‡äº¿ä¸ªç»†èƒç»„æˆçš„å¤æ‚ç³»ç»Ÿï¼Œè›‹ç™½è´¨å¯¹ç”Ÿå‘½ä½“çš„é‡è¦æ„ä¹‰ï¼Œäº†è§£äº†æ‰€æœ‰ç”Ÿç‰©ä»åˆ†å­å±‚é¢ä¸Šæ˜¯åŸºæœ¬ä¸€è‡´çš„ã€å…·æœ‰å…±åŒçš„ç¥–å…ˆã€‚ä¹¦ä¸­è§£é‡Šäº†å…ˆæœ‰è›‹å†æœ‰é¸¡çš„ç»“è®ºï¼Œè§£é‡Šäº†å¯¹ç‰›å¼¹ç´çš„ç§‘å­¦ä¾æ®ã€‚ç»™è¿™äº›â€œåƒå¤å¥‡æ¡ˆâ€ä»¥â€œç§‘å­¦å®šè®ºâ€ã€‚è¿˜æœ‰å¾ˆå¤šå¹³æ—¶æˆ‘ä»¬ä½“ä¼šåˆ°äº†ä½†æ˜¯æ²¡æœ‰æ·±æƒ³çš„ç”Ÿå‘½ç°è±¡ï¼Œä½œè€…éƒ½ç»™å‡ºäº†æœ‰æ„æ€çš„æè¿°å’Œè§£é‡Šã€‚ æœ€åä¸€ç« è§£é‡Šäº†ç¥ç»ç³»ç»Ÿçš„å¤æ‚ç¨‹åº¦ï¼Œè®©æˆ‘ä»ç”Ÿç‰©å­¦æ„ä¹‰ä¸Šäº†è§£äº†æ—¶ä¸‹å¤§çƒ­çš„äººå·¥æ™ºèƒ½æ·±åº¦å­¦ä¹ æŠ€æœ¯çš„ç”Ÿç‰©å­¦åŸºç¡€ã€‚ ä¸è¿‡ï¼Œæœ€åä¸€ç« åœ¨å…¨ä¹¦ä¸­å äº†å¤§çº¦å››åˆ†ä¹‹ä¸€çš„ç¯‡å¹…ï¼Œä¸ªäººæ„Ÿè§‰ç”¨åŠ›ä¸å‡ã€‚æˆ‘æ˜¯è·³ç€çœ‹äº†äº›ç‰‡æ®µã€‚ ç„¶è€Œç‘•ä¸æ©ç‘œï¼Œå¯¹äºç”Ÿç‰©å­¦å°ç™½æ¥è¯´ï¼Œä¼šè®©ä½ å…¥è¿·çš„ã€‚æ„Ÿè°¢ä½œè€…ï¼</p></blockquote><p>çœ‹è¿™æœ¬ä¹¦å’Œä»–çš„åšå®¢ä¸€æ ·ç²¾å½©ï¼Œå¦å¤–è¿˜å‡ºäº†å¦ä¸€æœ¬ä¹¦ã€Šç”Ÿå‘½é€šå²ã€‹ï¼Œçœ‹äº†ä¸€ä¸‹ç›®å½•å’Œä»–åšå®¢é‡Œå†™çš„å†…å®¹åŠå…¶ç›¸ä¼¼ï¼Œç­‰åˆ°ä»¥åå†ä¹°æœ¬çº¸è´¨ç‰ˆçš„çœ‹ã€‚æƒ³èµ·æ¥äº†å¤§å­¦æ—¶æ›¾è¯»è¿‡çš„ä¸€æœ¬ä¹¦ã€Šç”Ÿå‘½çš„è·ƒå‡ã€‹ï¼Œæˆ‘è§‰ç€äºŒè€…ä¹‹é—´æ¯”è¾ƒç›¸ä¼¼ã€‚</p><p><code>æ‘˜æŠ„</code> <a href="https://t.co/tjOSuGPhu7" target="_blank" rel="noopener">ä¸Šå¸é€ äººæœ‰å¤šéš¾ï¼šç”Ÿå‘½çš„å¯†é’¥</a></p><h3 id="ç‰›æ´¥é€šè¯†è¯»æœ¬ï¼šåœ°çƒ"><a href="#ç‰›æ´¥é€šè¯†è¯»æœ¬ï¼šåœ°çƒ" class="headerlink" title="ç‰›æ´¥é€šè¯†è¯»æœ¬ï¼šåœ°çƒ"></a>ç‰›æ´¥é€šè¯†è¯»æœ¬ï¼šåœ°çƒ</h3><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/screenshot_2020_02_13T16_03_07+0800.png" alt="img"></p><p>ç‰›æ´¥é€šè¯†è¯»æœ¬ç³»åˆ—çš„ä¹¦ç±å¤§æ¦‚æœ‰ä¸‰åå‡ æœ¬ï¼Œåœ¨ Amazon ä¸Š Kindle Unlimited ä¼šå‘˜æ˜¯å¯ä»¥å…è´¹å€Ÿé˜…ã€‚åŸºæœ¬ä¸Šéƒ½æ˜¯ä¸€äº›ä¸€ä¸¤ç™¾é¡µå­ã€‚è¿™æœ¬å…³äºåœ°çƒç§‘æ™®å°å†Œå­ç®€å•åœ°ä»‹ç»äº†ä¸€ä¸‹åœ°çƒçš„åœ°çƒçš„å½¢æˆã€å†…æ ¸ã€åœ°ç£åœºã€ç«å±±è¿åŠ¨ç­‰çŸ¥è¯†ã€‚æ€»ä¹‹è¯»èµ·æ¥å¯ä»¥æ»¡è¶³ä¸€ä¸‹è‡ªå·±çš„å¥½å¥‡å¿ƒå•¦ğŸ˜‹</p><p><code>æ‘˜æŠ„</code> <a href="https://t.co/ExJxAKtv8d" target="_blank" rel="noopener">ç‰›æ´¥é€šè¯†è¯»æœ¬ï¼šåœ°çƒ</a></p><h3 id="è¿œå¤çš„è¾‰ç…Œï¼šç”Ÿç‰©å¤§å¹…å°„"><a href="#è¿œå¤çš„è¾‰ç…Œï¼šç”Ÿç‰©å¤§å¹…å°„" class="headerlink" title="è¿œå¤çš„è¾‰ç…Œï¼šç”Ÿç‰©å¤§å¹…å°„"></a>è¿œå¤çš„è¾‰ç…Œï¼šç”Ÿç‰©å¤§å¹…å°„</h3><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/screenshot_2020_02_13T16_02_25+0800.png" alt="img"></p><p><code>æ‘˜æŠ„</code> <a href="https://t.co/zU8WXIDMKJ" target="_blank" rel="noopener">è¿œå¤çš„è¾‰ç…Œï¼šç”Ÿç‰©å¤§å¹…å°„</a></p><h3 id="å›½å®¶å»ºè®¾ä¸æ”¿åºœè¡Œä¸º"><a href="#å›½å®¶å»ºè®¾ä¸æ”¿åºœè¡Œä¸º" class="headerlink" title="å›½å®¶å»ºè®¾ä¸æ”¿åºœè¡Œä¸º"></a>å›½å®¶å»ºè®¾ä¸æ”¿åºœè¡Œä¸º</h3><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/screenshot_2020_02_14T23_23_38+0800.png" alt="img"></p><p>è¯»å®Œã€Šä¸­å›½å›½å®¶æ²»ç†çš„åˆ¶åº¦é€»è¾‘ï¼šä¸€ä¸ªç»„ç»‡å­¦ç ”ç©¶ã€‹ååœ¨ Amazon ä¸Šæœç´¢å‘¨é›ªå…‰ä½œè€…æ‰¾åˆ°çš„ä¹¦ã€‚ä¸å…¶è¯´æ˜¯ä¸€æœ¬ä¹¦ï¼Œå…¶å®æ›´åƒæ˜¯ä¸€å†Œç ”ç©¶ä¸­å›½å®˜åƒšä½“åˆ¶çš„è®ºæ–‡é›†ï¼Œä»å­¦æœ¯è§’åº¦æ¥åˆ†æä¸€äº›ä½“åˆ¶é—®é¢˜ã€‚</p><blockquote><p>ä½œä¸ºæ‰€æœ‰æƒåŠ›é›†äºä¸€èº«çš„ä¸­å¤®æ”¿åºœï¼Œä¸»è¦éœ€è¦å®Œæˆä¸¤é¡¹åŸºæœ¬ä»»åŠ¡ï¼šä¸€æ˜¯ä¸ºå¹¿å¤§ç™¾å§“æä¾›åŸºæœ¬çš„å…¬å…±æœåŠ¡ï¼Œç»´æŒæ”¿æƒçš„é•¿æœŸç¨³å®šï¼›äºŒæ˜¯ä¿è¯ä¸‹æ”¾ç»™è¡Œæ”¿ä»£ç†äººçš„æƒåŠ›ä¸è¢«æ»¥ç”¨ï¼Œä¸­å¤®çš„æ”¿ä»¤èƒ½å¤Ÿç•…é€šæ— é˜»ã€‚è¿™ä¸¤é¡¹ä»»åŠ¡æœ¬è´¨ä¸Šæ˜¯å†²çªçš„ï¼šä¸€æ–¹é¢ï¼Œä¸ºäº†ç»™å¹¿å¤§ç™¾å§“æ›´å¥½åœ°æä¾›å…¬å…±æœåŠ¡ï¼Œå°±å¿…é¡»å°½å¯èƒ½æŠŠæƒåŠ›ä¸‹æ”¾ç»™åŸºå±‚æ”¿åºœï¼Œå› ä¸ºåŸºå±‚æ”¿åºœç›¸å¯¹æ¥è¯´æ›´äº†è§£å½“åœ°æ°‘ä¼—å¯¹å…¬å…±æœåŠ¡çš„åå¥½ï¼Œæ›´äº†è§£å½“åœ°çš„å…·ä½“æ¡ä»¶ï¼›ä»å…¬å…±æœåŠ¡çš„è§’åº¦ï¼Œé›†æƒè€…åº”è¯¥å°½å¯èƒ½é€‰æ‹©åˆ†æƒã€‚å¦ä¸€æ–¹é¢ï¼Œç»™å®šä¸‹çº§æ”¿åºœçš„å®˜å‘˜ç›®æ ‡å’Œåˆ©ç›Šä¸åŒäºä¸­å¤®æ”¿åºœï¼Œä¸‹çº§å®˜å‘˜çš„è¡Œä¸ºä¸æ˜“ç›‘ç£ï¼ŒæƒåŠ›ä¸‹æ”¾å°±æ„å‘³ç€æƒåŠ›è¢«æ»¥ç”¨çš„å±é™©ï¼Œç”šè‡³è¢«æ¶ç©ºï¼Œè€Œä¸”æƒåŠ›ä¸‹æ”¾è¶Šæ˜¯åˆ°åŸºå±‚ï¼Œç›‘ç£å°±è¶Šå›°éš¾ï¼ŒæƒåŠ›è¢«æ»¥ç”¨çš„å¨èƒä¹Ÿå°±è¶Šå¤§ã€‚</p><p>å½“æ”¿åºœé»˜è®¸æˆ–é¼“åŠ±ä¸‹çº§æ”¿åºœå› åœ°åˆ¶å®œæ—¶ï¼Œåè€…å¯èƒ½æŒ‰è‡ªå·±æ„å›¾è§£è¯»å®æ–½æ”¿ç­–ï¼Œéšç€æ”¿ç­–å®æ–½è¿‡ç¨‹çš„å±•å¼€ï¼Œæ‰§è¡Œçµæ´»æ€§è¶Šæ¥è¶Šå¤§ï¼Œä¸è¿™ä¸€ä¸»çº¿çš„åå·®è·ç¦»è¶Šæ¥è¶Šå¤§ï¼Œå¯¼è‡´ä¸åŸæ”¿ç­–ç›¸å»ç”šè¿œçš„ç»“æœã€‚</p></blockquote><p>ç»“åˆè¿™æ¬¡ç–«æƒ…ï¼Œä¸éš¾ç†è§£ä¸ºä»€ä¹ˆåœ°æ–¹æ”¿åºœæ“…è‡ªå°è·¯å°åŸçš„ä¸¾æªï¼Œå³ä¾¿è¿™äº›ä¸¾æªå·²ç»æ˜æ˜¾åœ°è¿åäº†æ³•å¾‹ï¼ˆå›½åŠ¡é™¢é¢å¸ƒçš„è§„å®šï¼‰ï¼Œå³ä¾¿æ˜¯å› ä¸ºå°è·¯è€Œé€ æˆäººå‘˜æ„å¤–èº«äº¡ï¼Œå³ä¾¿æ˜¯ä¸€å®¶å››å£åœ¨å®¶æ‰“éº»å°†ä¹Ÿè¦è¢«æ‹‰ä¸Šè¡—è¢«<code>æ‰¹æ–—</code>â€¦â€¦ä¸­å¤®æ”¿åºœä¹Ÿä¸ä¼šå¤„ç½šåœ°æ–¹æ”¿åºœã€‚åœ¨è¿™æ¬¡ç–«æƒ…ä¸­ï¼Œåœ°æ–¹æ”¿åºœçš„ä¸€äº›è¡Œä¸ºå·²ç»è¿åäº†å®ªæ³•ï¼Œç®€ç§°è¿å®ªè¡Œä¸ºï¼Œè€Œæ‰€è°“çš„<code>çº¢è¢–ç« </code>ä»—ç€ç‚¹æ‰‹ä¸­çš„ç‰¹æƒè‚†æ„ä¾µçŠ¯ç€å…¬æ°‘çš„æƒåŠ›ã€‚å°±å¦‚å‰©ä½™ä»·å€¼è¢«å°æ€çš„é‚£æœŸä¸­ç½—æ–°è€å¸ˆæåˆ°çš„ï¼š</p><blockquote><p>æˆ‘ä»¬ç°åœ¨å¬å¾ˆå¤šäººå¤§è°ˆ<strong>æˆ˜æ—¶çŠ¶æ€</strong>ï¼Œä½†éšä¾¿ä¸€ä¸ªè¡Œæ”¿å®˜å‘˜å°±èƒ½å¤Ÿå®£å¸ƒâ€æˆ˜æ—¶çŠ¶æ€â€å—ï¼Ÿè¿™å¿…é¡»æ˜¯è¦ç»è¿‡æœ€é«˜ç«‹æ³•æœºæ„å†³å®šçš„ã€‚å°åŸæˆ–è€…è¯¸å¦‚æ­¤ç±»çš„æç«¯æªæ–½å¸¦æ¥çš„ä¼¤å®³ï¼Œä¸€å®šä¼šæ¯”ç—…æ¯’æœ¬èº«è¿˜è¦å¤§ã€‚</p></blockquote><p><code>æ‘˜æŠ„</code> <a href="https://t.co/7oYY1ZTdAL" target="_blank" rel="noopener">å›½å®¶å»ºè®¾ä¸æ”¿åºœè¡Œä¸º</a></p><h3 id="åœ°çƒè„‰åŠ¨2ï¼šå¥‡è¿¹ä¸–ç•Œ"><a href="#åœ°çƒè„‰åŠ¨2ï¼šå¥‡è¿¹ä¸–ç•Œ" class="headerlink" title="åœ°çƒè„‰åŠ¨2ï¼šå¥‡è¿¹ä¸–ç•Œ"></a>åœ°çƒè„‰åŠ¨2ï¼šå¥‡è¿¹ä¸–ç•Œ</h3><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/screenshot_2020_02_24T14_42_00+0800.png" alt="img"></p><p><code>æ‘˜æŠ„</code> <a href="https://t.co/qlnVJv7trg" target="_blank" rel="noopener">åœ°çƒè„‰åŠ¨2ï¼šå¥‡è¿¹ä¸–ç•Œ</a></p><h3 id="å†å²çš„ç»ˆç»“"><a href="#å†å²çš„ç»ˆç»“" class="headerlink" title="å†å²çš„ç»ˆç»“"></a>å†å²çš„ç»ˆç»“</h3><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/screenshot_2020_02_25T19_30_49+0800.png" alt="img"></p><p><code>æ‘˜æŠ„</code> <a href="https://t.co/OQfS3drfyk" target="_blank" rel="noopener">å†å²çš„ç»ˆç»“</a></p><h3 id="ä¸€æƒ³åˆ°è¿˜æœ‰ç™¾åˆ†ä¹‹ä¹åäº”çš„é—®é¢˜ç•™ç»™äººç±»-æˆ‘å°±æ”¾å¿ƒäº†"><a href="#ä¸€æƒ³åˆ°è¿˜æœ‰ç™¾åˆ†ä¹‹ä¹åäº”çš„é—®é¢˜ç•™ç»™äººç±»-æˆ‘å°±æ”¾å¿ƒäº†" class="headerlink" title="ä¸€æƒ³åˆ°è¿˜æœ‰ç™¾åˆ†ä¹‹ä¹åäº”çš„é—®é¢˜ç•™ç»™äººç±»,æˆ‘å°±æ”¾å¿ƒäº†"></a>ä¸€æƒ³åˆ°è¿˜æœ‰ç™¾åˆ†ä¹‹ä¹åäº”çš„é—®é¢˜ç•™ç»™äººç±»,æˆ‘å°±æ”¾å¿ƒäº†</h3><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/screenshot_2020_03_07T00_11_25+0800.png" alt="img"></p><p><code>æ‘˜æŠ„</code> <a href="https://t.co/HX1EXtz2oZ" target="_blank" rel="noopener">ä¸€æƒ³åˆ°è¿˜æœ‰ç™¾åˆ†ä¹‹ä¹åäº”çš„é—®é¢˜ç•™ç»™äººç±»,æˆ‘å°±æ”¾å¿ƒäº†</a></p><h3 id="æˆ‘ç„¡ç½ªï¼šåŠ‰æ›‰æ³¢å‚³"><a href="#æˆ‘ç„¡ç½ªï¼šåŠ‰æ›‰æ³¢å‚³" class="headerlink" title="æˆ‘ç„¡ç½ªï¼šåŠ‰æ›‰æ³¢å‚³"></a>æˆ‘ç„¡ç½ªï¼šåŠ‰æ›‰æ³¢å‚³</h3><p>è¿™æœ¬ä¹¦æ˜¯æˆ‘åœ¨ <a href="https://twitter.com/linyujing" target="_blank" rel="noopener">æ—æ„ˆéœ</a> ç«‹åœºæ–°é—»çš„æ–‡ç« é‡Œä¸Šå‘ç°çš„ã€‚ä¹‹å‰æˆ‘æ˜¯çŸ¥é“åˆ˜æ™“æ³¢æ˜¯è¯ºè´å°”å’Œå¹³å¥–å¾—ä¸»ï¼Œä¹ŸçŸ¥é“ä»–çš„ä¸€äº›äº‹è¿¹ï¼Œä½†é€šè¿‡è¿™æœ¬ä¼ è®°æ‰çœŸçœŸåˆ‡åˆ‡åœ°äº†è§£åˆ°åˆ˜æ™“æ³¢æ˜¯ä¸€ä½å¤šä¹ˆä¼Ÿå¤§è€Œåšå¼ºçš„çŸ¥è¯†ä»½å­ã€‚åŒ…æ‹¬ç‹¬ç«‹ä¸­æ–‡ç¬”ä¼šçš„å‘å±•ï¼Œéƒ½ç¦»ä¸å¼€åˆ˜æ™“æ³¢å…ˆç”Ÿçš„ä»˜å‡ºã€‚å‡„å‡„æƒ¨æƒ¨çš„åŠç”Ÿï¼Œåˆ«æ— å¯è¨€â€¦â€¦</p><blockquote><p>åŠ‰æ›‰æ³¢æ‰¿èªï¼šã€Œé¡ä¼¼çš„æ®˜å¿è¡Œç‚ºä»¥åŠå°æ®˜å¿çš„è‡ªå¾—å…¶æ¨‚ï¼Œæˆ‘å°æ™‚å€™æ²’å°‘å¹¹ã€‚é€™ç¨®è¡Œç‚ºèˆ‡å°ˆé–€æ‰“ç ¸æ¶ã€æªé¬¥åˆ¥äººçš„ç´…è¡›å…µæ²’æœ‰ä»€éº¼å¯¦è³ªçš„å€åˆ¥ã€‚æˆ‘å€‘é€™äº›äººï¼Œåœ¨ä¸€ç¨®é‡è »çš„åˆ¶åº¦å’Œæ•™è‚²ä¹‹ä¸‹é•·å¤§ï¼Œå®ƒå´‡å°šæš´åŠ›ã€åŸ¹é¤Šä»‡æ¨ã€é¼“å‹µæ®˜å¿ã€ç¸±å®¹ç„¡æƒ…ï¼Œæ•™çµ¦å­©å­å€‘ä¸€ç¨®å¾å¨˜èƒè£¡å¸¶å‡ºä¾†çš„ä¸æ‹¿äººç•¶äººçš„æ®˜æš´å…‡ç‹ ã€‚åœ¨è¦–ç”Ÿå‘½å¦‚è‰èŠ¥çš„å¹´ä»£ï¼Œæˆ‘å€‘éƒ½åœ¨ä¸åŒçš„ç¨‹åº¦ä¸Šå……ç•¶éåŠŠå­æ‰‹å’Œå¹«å…‡ï¼Œèª°ä¹Ÿè„«ä¸æ‰è²¬ä»»ï¼Œæ´—ä¸æ¸…è‡ªå·±ï¼ã€</p></blockquote><blockquote><p>æˆ‘çš„æ•´å€‹é’æ˜¥æœŸç”Ÿé•·æ–¼æ–‡åŒ–æ²™æ¼ ä¹‹ä¸­ï¼Œæˆ‘æ‰€è³´ä»¥å¯«ä½œçš„æ–‡åŒ–æ»‹é¤Šï¼Œé™¤äº†ä»‡æ¨ã€æš´åŠ›ã€ç‹‚å¦„ï¼Œå°±æ˜¯èªªè¬Šã€ç„¡è³´ã€çŠ¬å„’ï¼Œé€™äº›é»¨æ–‡åŒ–çš„æ¯’ç´ é¤µé¤Šäº†æ•´æ•´å¹¾ä»£äººï¼Œæˆ‘ä¾¿æ˜¯å…¶ä¸­ä¹‹ä¸€ï¼Œå³ä¾¿åœ¨æ€æƒ³è§£æ”¾çš„å…«â—‹å¹´ä»£ï¼Œä¹Ÿä¸¦æ²’æœ‰å®Œå…¨æ“ºè„«é»¨æ–‡åŒ–ã€‚</p></blockquote><p>è‡ªå…«ä¹å…­å››ä¹‹ååˆ° 2009 å¹´æœ«ï¼ŒäºŒåå¹´é—´ï¼Œåˆ˜æ™“æ³¢å…ˆç”Ÿå†™çš„æ–‡ç« åœ¨ <a href="http://www.liu-xiaobo.org" target="_blank" rel="noopener">åˆ˜æ™“æ³¢åˆ˜éœç½‘ç«™</a> ä¸Šï¼Œå¯ä»¥æ‰¾åˆ°ã€‚æˆ‘ç”¨è„šæœ¬çˆ¬äº†ä¸€ä¸‹ï¼Œåœ¨è¿™äºŒåå¹´é—´åˆ˜æ™“æ³¢å…ˆç”Ÿå†™ä¸‹äº†ä¸ä¸‹äº 1500 ç¯‡æ–‡ç« ï¼Œå¹³å‡æ¯å‘¨è‡³å°‘å†™ä¸€ç¯‡ã€‚äºŒåå¹´æ¥ï¼Œè¿˜æœ‰å“ªä¸ªçŸ¥è¯†ä»½å­è°èƒ½åšåˆ°ï¼Ÿ</p><blockquote><p><strong>æˆ‘å …å®ˆè‘—äºŒåå¹´å‰æˆ‘åœ¨ã€ˆã€Œå…­äºŒã€çµ•é£Ÿå®£è¨€ã€‰ä¸­æ‰€è¡¨é”çš„ä¿¡å¿µâ”€â”€æˆ‘æ²’æœ‰æ•µäººï¼Œä¹Ÿæ²’æœ‰ä»‡æ¨ã€‚</strong></p></blockquote><p>æˆ‘æƒ³è¯ºè´å°”å’Œå¹³å¥–æ˜¯å¯¹è¿™å¥è¯æœ€å®Œç¾çš„è¯ é‡Š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">http://www.liu-xiaobo.org/blog/archives/8696</span><br><span class="line">http://www.liu-xiaobo.org/blog/archives/8620</span><br><span class="line">http://www.liu-xiaobo.org/blog/archives/8091</span><br><span class="line">http://www.liu-xiaobo.org/blog/archives/8093</span><br><span class="line">http://www.liu-xiaobo.org/blog/archives/8625</span><br><span class="line">http://www.liu-xiaobo.org/blog/archives/8096</span><br><span class="line">http://www.liu-xiaobo.org/blog/archives/8098</span><br><span class="line">â•­â”€root@blog /home/ubuntu/page</span><br><span class="line">â•°â”€# cat url.log | wc</span><br><span class="line">   1502    1502   67907</span><br></pre></td></tr></table></figure><blockquote><p>åŠ‰æ›‰æ³¢å¼·èª¿äº†è¨€è«–è‡ªç”±çš„é‡è¦æ€§ï¼šã€Œä¸€å€‹æ”¿æ¬Šä¸å¯èƒ½é å£“æŠ‘ä¸åŒæ”¿è¦‹ä¾†å»ºç«‹åˆæ³•æ€§ï¼Œä¹Ÿä¸å¯èƒ½é æ–‡å­—ç„ä¾†é”æˆé•·æ²»ä¹…å®‰ã€‚ã€ä»–å‘¼ç±²ä¸­åœ‹æ—©æ—¥å‘Šåˆ¥æ–‡å­—ç„ï¼šã€Œåªæœ‰å¾åˆ¶åº¦ä¸Šæ ¹çµ•æ–‡å­—ç„ï¼Œæ†²æ³•æ‰€è¦å®šçš„è¨€è«–è‡ªç”±æ¬Šåˆ©æ‰èƒ½è½å¯¦åˆ°æ¯ä¸€ä½åœ‹æ°‘èº«ä¸Šï¼›åªæœ‰ç•¶åœ‹æ°‘çš„è¨€è«–è‡ªç”±æ¬Šåˆ©å¾—åˆ°åˆ¶åº¦åŒ–çš„ç¾å¯¦ä¿éšœï¼Œæ–‡å­—ç„æ‰æœƒåœ¨ä¸­åœ‹å¤§åœ°ä¸Šæ»…çµ•ã€‚ã€</p></blockquote><p><code>æ‘˜æŠ„</code> <a href="https://t.co/eefs4gZspV" target="_blank" rel="noopener">æˆ‘ç„¡ç½ªï¼šåŠ‰æ›‰æ³¢å‚³</a></p><h3 id="Age-of-Ambition"><a href="#Age-of-Ambition" class="headerlink" title="Age of Ambition"></a>Age of Ambition</h3><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/screenshot_2020_03_14T22_17_43+0800.png" alt="img"></p><p><code>æ‘˜æŠ„</code> <a href="https://t.co/uvCqxbUb0i" target="_blank" rel="noopener">Age of Ambition</a></p><h3 id="è´¹é©¬æœ€ç»ˆå®šç†"><a href="#è´¹é©¬æœ€ç»ˆå®šç†" class="headerlink" title="è´¹é©¬æœ€ç»ˆå®šç†"></a>è´¹é©¬æœ€ç»ˆå®šç†</h3><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/screenshot_2020_03_26T23_45_47+0800.png" alt="img"></p><p>æ—¥ç³»ç‹—ç²®å°è¯´ğŸ•ï¼Œç¬¬ä¸€æ¬¡è¯»è¿™æœ¬ä¹¦è¿˜æ˜¯å¤§ä¸‰çš„æ—¶å€™ï¼Œ<del>é‚£æ—¶å€™å’±åˆšåˆšå¼€å§‹äº†äººç”Ÿçš„ç¬¬ä¸€æ¬¡åˆæ‹ï¼Œå¹¶æŠŠè¿™æœ¬ä¹¦é€ç»™äº†å‰å¥³å‹</del>ğŸ¤£ã€‚åŒæ ·çš„å°è¯´è¿˜æœ‰ã€Šæ•°å­¦å¥³å­©ã€‹ï¼Œåè€…çš„è¯„ä»·å¾ˆé«˜ï¼Œä½†æƒ³è¦é€šè¿‡å°è¯´æ¥å­¦ä¹ æ•°å­¦æ˜¯ç—´å¿ƒå¦„æƒ³å•¦ã€‚å˜›ï¼Œå°è¯´å°±æ˜¯å…´è¶£è¯»ç‰©ï¼Œç»™è¿™äº›æ¯ç‡¥ä¼šè‰²çš„æ•°å­¦å…¬å¼å¢åŠ ä¸€ç‚¹è‰²å½©~~</p><p>è™½ç„¶å¯¹äºæ•°å­¦æ¥è®²ï¼Œå’±æœ¨å­ç®€ç›´æ˜¯ä¸ªå­¦è„†ğŸ˜­ï¼Œé«˜è€ƒæ•°å­¦è€ƒäº† 60 å‡ åˆ†ï¼Œè¿™ä¹Ÿè®©å’±ä¸åç‰Œå¤§å­¦å¤±ä¹‹äº¤è‡‚ï¼Œåªèƒ½å»è¯»ç¬¬å…­çº§æœ¬ç§‘é™¢æ ¡ğŸ˜‘ï¼Œå¤šå°‘æœ‰ç‚¹é—æ†¾å§ã€‚ä¸è¿‡çº³ï¼Œå¯¹äºé‚£äº›æ¯ç‡¥æ— æ¯”çš„è®¡ç®—å…¬å¼æ±‚ç§¯åˆ†è§£å¾®åˆ†æ–¹ç¨‹ç­‰ï¼Œå’±æ›´å–œæ¬¢çŸ¥é“æ•°å­¦è¿™æœ¬å­¦ç§‘èƒŒåçš„å†å²ï¼šæƒ³çŸ¥é“ç‰›é¡¿å’Œè±å¸ƒå°¼èŒ¨ä¹‹é—´çš„æ’•é€¼å¤§æˆ˜ï¼Œæƒ³çŸ¥é“ä¼¯åŠªåŠ›å®¶æ—çš„æ©ä»‡æ€¨æ¨ï¼Œæƒ³çŸ¥é“ç¬›å¡å°”ä¸å…¬ä¸»çš„çˆ±æƒ…æ•…äº‹ï¼Œæƒ³çŸ¥é“æ¬§æ‹‰å¥‹ç¬”ç–¾ä¹¦éå‡¡çš„ä¸€ç”Ÿï¼Œæƒ³çŸ¥é“åºåŠ è±çŒœæƒ³ä¸<code>å®‡å®™çš„å½¢çŠ¶</code>ç­‰ç­‰ã€‚è¿™ä¹Ÿæ˜¯å’±å³ä¾¿æ¯•ä¸šç¦»å¼€å¤§å­¦ä¹‹åï¼Œä¸å†æ˜¯ä¸€åå­¦ç”Ÿä½†ä¹Ÿæ˜¯åƒå­¦ç”Ÿæ—¶ä»£çš„è‡ªå·±é‚£æ ·å¥½å¥‡å¿ƒå¦‚æ­¤åœ°æ—ºç››ğŸ˜‚</p><blockquote><p>ã€æˆ‘ä¸€ç›´è§‰å¾—ï¼Œè´¹é©¬ã€æ¬§æ‹‰ã€å“¥å¾·å·´èµ«ç­‰äººä¸ç°ä»£äººç›¸æ¯”ï¼Œä»–ä»¬å…·æœ‰æ ¼å¤–æ—ºç››çš„å¥½å¥‡å¿ƒå’Œä¸°å¯Œçš„æƒ³è±¡åŠ›ï¼Œå¹¶ä¸”å……æ»¡äº†ç”Ÿæœºä¸æ´»åŠ›ã€‚éšç€ç¤¾ä¼šå‘å±•çš„æ—¥ç›Šæˆç†Ÿï¼Œå¥½å¥‡å¿ƒå’Œæƒ³è±¡åŠ›ä¸å¯é¿å…åœ°ä¸æ–­é™ä½ï¼Œä½†å¹¶ä¸ä»£è¡¨ç°ä»£ç¤¾ä¼šä¸å†éœ€è¦å¥½å¥‡å¿ƒå’Œæƒ³è±¡åŠ›ã€‚ã€</p></blockquote><p><code>æ‘˜æŠ„</code> <a href="https://t.co/UqDfbYRjs7" target="_blank" rel="noopener">è´¹é©¬æœ€ç»ˆå®šç†</a></p><h3 id="è¢«è®¨åŒçš„å‹‡æ°”"><a href="#è¢«è®¨åŒçš„å‹‡æ°”" class="headerlink" title="è¢«è®¨åŒçš„å‹‡æ°”"></a>è¢«è®¨åŒçš„å‹‡æ°”</h3><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/screenshot_2020_03_28T01_28_04+0800.png" alt="img"></p><p>æ— æ„é—´åœ¨ <a href="https://sanshiliuxiao.top/talkSelf/20191212/" target="_blank" rel="noopener">æ¤å’²è‰¯ç”°|æƒ³ä¸åˆ°å•¥æ ‡é¢˜</a> å‘ç°äº†è¿™æœ¬ä¹¦ã€‚</p><blockquote><p>ä¹¦é‡Œé¢æœ‰å¾ˆå¤šçš„è§‚ç‚¹ä¸€å¼€å§‹éƒ½æŒºè®©äººéš¾ä»¥æ¥å—çš„ï¼Œå°±åƒé‚£ä½å»å¯»æ±‚å“²äººå¸®åŠ©çš„é’å¹´ï¼Œä¸å»æ¥å—å“²äººçš„è§‚ç‚¹ï¼Œå¿ƒé‡Œæƒ³ç€æ ¹æœ¬å°±ä¸æ˜¯å“²äººè¯´çš„é‚£æ ·ï¼Œå†³å®šè¦å»å¥½å¥½åé©³ä»–ã€‚å¯æ˜¯ä»”ç»†æƒ³æƒ³ï¼Œå“²äººè¯´çš„è¯ä¹Ÿç®—æ˜¯è›®æœ‰é“ç†çš„ã€‚æ•´æœ¬ä¹¦ä¸­å“²äººè¯´çš„ä¸€äº›è¨€è®ºï¼Œå¦‚æœå•å•åªæ‹†å‡ºä¸€æ®µæˆ–ä¸€å¥ï¼Œå°±ä¼šè§‰å¾—è¿™ä¸ªå“²äººæ˜¯åœ¨å¼ºè¯å¤ºç†ï¼Œå¯æ˜¯ä»–çš„è¯é‡Œé¢æœ‰ç€æ˜¯æœ‰å¾ˆå¤šçš„å‰ç½®æ¡ä»¶ï¼Œå¦‚ä½•ç»“åˆç€ä¸€èµ·çœ‹ï¼Œé‚£å°±ä¼šæ„Ÿè§‰ä¸ä¸€æ ·ã€‚</p></blockquote><p>å…ˆè¯´ä¸€ä¸‹æˆ‘è‡ªå·±çš„æ„Ÿå—å§ï¼Œè¯»å®Œè¿™æœ¬ä¹¦ç¡®å®æ”¹å˜äº†æˆ‘ä¸€äº›æ ¹æ·±è’‚å›ºçš„è§‚å¿µã€‚æˆ‘æ‰¿è®¤æˆ‘æœ‰ç‚¹æç«¯å¿ƒç†ï¼Œå¹¶ä¸”æˆ‘å¾ˆé•¿æ—¶é—´æŠŠå®ƒå½’å› äºç«¥å¹´æ—¶æœŸçš„å®¶åº­æš´åŠ›ï¼Œæˆ‘è§‰ç€æ˜¯è€çˆ¸çš„æš´è„¾æ°”å½±å“äº†æˆ‘çš„æ€§æ ¼ï¼Œä»¥è‡³äºæ€§æ ¼åæ¿€ã€å¯¡è¨€å°‘è¯­ã€ä¸å–„ç¤¾äº¤ã€è‡ªå‘å†…å‘ç­‰ã€‚å¾ˆé•¿å¾ˆé•¿ä¸€æ®µæ—¶é—´æˆ‘éƒ½æŠŠè¿™ä¸€åˆ‡å½’è´£äºè€çˆ¸å¯¹æˆ‘çš„å®¶åº­æš´åŠ›ï¼Œé•¿ä¹…ä¸èƒ½é‡Šæ€€ã€‚å°±åœ¨ä»Šå¹´è¿‡å¹´æ—¶åœ¨å®¶è¿˜å’Œè€çˆ¸äº‰åµæ€ªä»–å°æ—¶å€™æ‰“æˆ‘æ‰å¯¼è‡´æˆ‘æ€§æ ¼åæ¿€ã€‚</p><p>ç›´åˆ°è¯»å®Œè¿™æœ¬ä¹¦ï¼Œæˆ‘æ‰æ”¹å˜äº†è¿™ç§å¹¼ç¨šçš„æƒ³æ³•ã€‚<strong>æˆ‘ä»¬å¹¶éå› ä¸ºè‡ªèº«ç»å†ä¸­çš„åˆºæ¿€â€”â€”æ‰€è°“çš„å¿ƒç†åˆ›ä¼¤â€”â€”è€Œç—›è‹¦ï¼Œäº‹å®ä¸Šæˆ‘ä»¬ä¼šä»ç»å†ä¸­å‘ç°ç¬¦åˆè‡ªå·±ç›®çš„çš„å› ç´ ã€‚å†³å®šæˆ‘ä»¬è‡ªèº«çš„ä¸æ˜¯è¿‡å»çš„ç»å†ï¼Œè€Œæ˜¯æˆ‘ä»¬è‡ªå·±èµ‹äºˆç»å†çš„æ„ä¹‰ã€‚</strong>ç»å†æœ¬èº«ä¸ä¼šå†³å®šä»€ä¹ˆã€‚æˆ‘ä»¬ç»™è¿‡å»çš„ç»å†â€œèµ‹äºˆäº†ä»€ä¹ˆæ ·çš„æ„ä¹‰â€ï¼Œè¿™ç›´æ¥å†³å®šäº†æˆ‘ä»¬çš„ç”Ÿæ´»ã€‚ä¸å¯ä»¥ä»è¿‡å»ä¸­æ‰¾åŸå› ï¼›è¦å¦å®šç²¾ç¥åˆ›ä¼¤ï¼›äººä¸æ˜¯å—è¿‡å»åŸå› æ”¯é…çš„å­˜åœ¨ï¼Œäººæ˜¯ä¸ºäº†è¾¾æˆæŸç§ç›®çš„è€Œé‡‡å–è¡ŒåŠ¨çš„ã€‚</p><p><code>æ‘˜æŠ„</code> <a href="https://t.co/o6cc1csJI2" target="_blank" rel="noopener">è¢«è®¨åŒçš„å‹‡æ°”</a></p><h2 id="ç»“æŸ"><a href="#ç»“æŸ" class="headerlink" title="ç»“æŸ"></a>ç»“æŸ</h2><blockquote><p>æ­£å¦‚é–‹ç¯‡æ˜†å¾·æ‹‰å°±ä¸€èªé©šäººçš„å¯«é“ï¼šäººèˆ‡æ”¿æ¬Šçš„é¬¥çˆ­ï¼Œå°±æ˜¯è¨˜æ†¶èˆ‡éºå¿˜çš„é¬¥çˆ­ ã€‚é€™å€‹è«–æ–·æ˜¯å¦‚æ­¤æº–ç¢ºåˆå¦‚æ­¤ä»¤äººçµ•æœ›ï¼Œå°±ç›®å‰ä¾†çœ‹ï¼Œæ­·å²è»Šè¼ªæ»¾æ»¾å‘å‰ï¼Œæˆ‘å€‘å¿˜è¨˜äº†å¾ˆå¤šäººï¼Œå¾ˆå¤šäº‹ï¼Œåœ¨è¨˜æ†¶èˆ‡éºå¿˜çš„é¬¥çˆ­ä¸­ï¼Œäººé¡å¾¹åº•å¤±æ•—äº†ã€‚</p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        
        
          &lt;blockquote&gt;
&lt;p&gt;äººä¸æ”¿æƒçš„æ–—äº‰ï¼Œå°±æ˜¯è®°å¿†ä¸é—å¿˜çš„
        
      
    
    </summary>
    
    
      <category term="é˜…è¯»" scheme="https://blog.k8s.li/categories/%E9%98%85%E8%AF%BB/"/>
    
    
      <category term="è¯»ä¹¦ç¬”è®°" scheme="https://blog.k8s.li/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/"/>
    
      <category term="ä¹¦å•" scheme="https://blog.k8s.li/tags/%E4%B9%A6%E5%8D%95/"/>
    
  </entry>
  
  <entry>
    <title>ä½¿ç”¨ CloudFlare WorkersÂ æ­å»º telegram é¢‘é“é•œåƒç«™</title>
    <link href="https://blog.k8s.li/cloudflare-worker-build-mirror-website.html"/>
    <id>https://blog.k8s.li/cloudflare-worker-build-mirror-website.html</id>
    <published>2020-03-25T16:00:00.000Z</published>
    <updated>2020-03-26T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ä¸€æ¬¡å¶é‡"><a href="#ä¸€æ¬¡å¶é‡" class="headerlink" title="ä¸€æ¬¡å¶é‡"></a>ä¸€æ¬¡å¶é‡</h2><p>æ˜¨å¤©åœ¨å’±çš„ <a href="https://blog.k8s.li/oh-my-webpsh.html">è®©å›¾ç‰‡é£èµ·æ¥ oh-my-webp.sh ï¼</a> æ”¶åˆ°äº† <a href="https://ichr.me/" target="_blank" rel="noopener">ChrAlpha</a> å¤§ä½¬çš„å›å¤ï¼Œå’±å°±æ‹œè®¿äº†ä¸€ä¸‹å¤§ä½¬çš„åšå®¢ğŸ˜‚ï¼Œæ— æ„é—´å‘ç° <a href="https://blog.ichr.me/post/cloudflare-worker-build-mirror-website/" target="_blank" rel="noopener">Cloudflare Worder å…è´¹æ­å»ºé•œåƒç«™</a> è¿™ç¯‡åšå®¢ã€‚äºæ˜¯å‘ï¼Œå’±ä¹Ÿæƒ³ç€èƒ½ä¸èƒ½ç©ä¸€ç©è¿™ä¸ª Workers ã€‚è™½ç„¶ä¹‹å‰å¬è¯´è¿‡æœ‰ç”¨ Workers åšå¾ˆå¤šå¥½ç©çš„äº‹å„¿ï¼Œæ¯”å¦‚åŠ é€Ÿç½‘ç«™ã€ä»£ç† Google é•œåƒç«™ä»€ä¹ˆçš„ã€‚ä¸è¿‡è¿™äº›å¯¹äºå’±æ¥è¯´ä¸æ˜¯å¾ˆåˆšéœ€å°±æ²¡æœ‰æŠ˜è…¾ã€‚åˆšå¥½å’±çš„ telegram ç”µæŠ¥é¢‘é“ <a href="https://t.me/rss_kubernetes" target="_blank" rel="noopener">RSS Kubernetes</a> äººä¹Ÿæ¯”è¾ƒå¤šäº†ï¼Œä¸ºäº†æé«˜ä¸€ç‚¹å½±å“åŠ›ï¼Œå’±å°±æƒ³ç€èƒ½ä¸èƒ½æŠŠé¢‘é“çš„é¢„è§ˆç•Œé¢ <a href="https://t.me/s/rss_kubernetes" target="_blank" rel="noopener">t.me/s/rss_kubernetes</a> åä»£åˆ°å’±åŸŸåä¸Šã€‚è™½ç„¶ä¹‹å‰å°è¯•ä½¿ç”¨ nginx è¿›è¡Œåä»£ï¼Œä½†æ˜¯æ•ˆæœä¸å°½äººæ„ï¼Œäºæ˜¯å½“æ—¶å°±å¼ƒå‘äº†ã€‚åœ¨æ˜¥èŠ‚çš„æ—¶å€™å’±ä¹Ÿçœ‹åˆ°è¿‡æœ‰äººåä»£ <a href="https://t.me/nCoV2019" target="_blank" rel="noopener">2019-nCoVç–«æƒ…å®æ—¶æ’­æŠ¥ğŸ…¥</a> ï¼Œæ¯”å¦‚ <a href="https://2019ncov.ga/" target="_blank" rel="noopener">2019ncov.ga</a>ï¼Œä¸è¿‡å½“æ—¶é‚£ä¸ªé¡¹ç›®æŠ˜è…¾èµ·æ¥ä¹Ÿæ˜¯å¾ˆéº»çƒ¦ï¼Œå’±è¿™ç§èœé¸¡è¿˜æ˜¯æºœäº†æºœäº†ğŸ˜‚ã€‚ç›´åˆ°ä»Šå¤©çœ‹åˆ° <a href="https://blog.ichr.me/post/cloudflare-worker-build-mirror-website/" target="_blank" rel="noopener">Cloudflare Worder å…è´¹æ­å»ºé•œåƒç«™</a> è¿™ç¯‡åšå®¢åå°±å¿ƒè¡€æ¥æ½®ï¼Œå°±æä¸€æå§ğŸ˜‚</p><h2 id="åŠé€€ä¸‰ä¸€è¿"><a href="#åŠé€€ä¸‰ä¸€è¿" class="headerlink" title="åŠé€€ä¸‰ä¸€è¿"></a>åŠé€€<del>ä¸‰</del>ä¸€è¿</h2><p>é¦–å…ˆä½ è¦æœ‰ä¸ª Cloudflare è´¦æˆ·ï¼Œè¿™æ˜¯å¿…é¡»çš„ã€‚å…³äº Cloudflare çš„æ³¨å†Œå’±å°±ä¸å¤šè¯´å•¦ï¼Œä¸è¿‡å’±å€’æ˜¯å»ºè®®å¤§å®¶ä¼™æŠŠåŸŸåçš„ DNS è§£ææ”¾åˆ° Cloudflare ä¸Šæ¥ï¼Œå¥½å¤„å¤šå¤šï¼šæœ‰æŠŠ https å°ç»¿é”ã€å…è´¹çš„ <del>åŠ é€Ÿ</del> å‡é€Ÿ CDN ï¼ˆå¢™å†…ï¼‰ã€åŸŸåè®¿é—®ç»Ÿè®¡ç­‰ç­‰å¯ç©æ€§æ¯”è¾ƒé«˜ğŸ˜‹ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ Cloudflare çš„ Worker ä¸€å¤© 10 ä¸‡æ¬¡å…è´¹é¢åº¦ï¼Œä¹Ÿå¤Ÿå’±å–ä¸€å£¶çš„å•¦ï¼Œä¸ç”¨æ‹…å¿ƒä¸å¤Ÿç”¨ã€‚</p><h2 id="æ–°å»º-Worker"><a href="#æ–°å»º-Worker" class="headerlink" title="æ–°å»º Worker"></a>æ–°å»º Worker</h2><p>ç™»å½•åˆ° <a href="https://dash.cloudflare.com" target="_blank" rel="noopener">Cloudflare</a>çš„<del>å¤§ç›˜</del>é¢æ¿ï¼Œç‚¹å‡»å·¦ä¸Šè§’çš„ <code>Menu</code> â€”-&gt; <code>Workers</code> è¿›å…¥åˆ° Workers é¡µé¢ã€‚æ–°æ³¨å†Œçš„ç”¨æˆ·ä¼šæç¤ºè®¾ç½®ä¸€ä¸ª <code>workers.dev</code> é¡¶çº§åŸŸåä¸‹çš„äºŒçº§å­åŸŸåï¼Œè¿™ä¸ªå­åŸŸåè®¾ç½®å¥½ä¹‹åæ˜¯ä¸å¯æ›´æ”¹çš„ï¼Œä¹‹åä½ æ–°åˆ›å»ºçš„ Worker å°±ä¼šä½¿ä»¥è¿™ä¸ªåŸŸåè€ŒäºŒçº§å­åŸŸåå¼€å§‹çš„ï¼Œç±»ä¼¼äº  <code>WorkerName.yousetdomain.workers.dev</code> ã€‚<code>yousetdomain</code> å°±æ˜¯ä½ è¦è®¾ç½®çš„äºŒçº§å­åŸŸåï¼Œ<code>WorkerName</code> å¯ä»¥è‡ªå®šä¹‰ï¼Œé»˜è®¤æ˜¯éšæœºç”Ÿæˆçš„ã€‚ä¹Ÿå¯ä»¥ç»™è‡ªå·±çš„åŸŸåæ·»åŠ ä¸€æ¡ CNAME åˆ° <code>WorkerName.yousetdomain.workers.dev</code> ï¼Œè¿™æ ·ä½¿ç”¨è‡ªå·±çš„åŸŸåå°±å¯ä»¥è®¿é—®åˆ° <code>Worker</code> äº†ã€‚</p><p>è®¾ç½®å¥½äºŒçº§å­åŸŸåä¹‹åé€‰æ‹© free å¥—é¤è®¡åˆ’ï¼Œç„¶åè¿›å…¥åˆ° Worker ç®¡ç†ç•Œé¢ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„ <code>Worker</code>  ç„¶ååœ¨ <code>Script</code> è¾“å…¥æ¡†é‡Œå¡«å…¥ä»¥ä¸‹ä»£ç ã€‚<strong>ä¿—è¯è¯´ä»£ç å†™å¾—å¥½ï¼ŒåŒè¡ŒæŠ„åˆ°è€</strong>ï¼Œå’±çš„ <code>worker.js</code> ä»£ç æ˜¯å‚è€ƒè‡ª <a href="https://github.com/Siujoeng-Lau/Workers-Proxy" target="_blank" rel="noopener">Workers-Proxy</a> ï¼Œä¸è¿‡å’±å»æ‰äº†ä¸€äº›æ— å…³ç´§è¦çš„ä»£ç ï¼ŒåŸä»£ç æ˜¯åŠ å…¥äº†è¾¨åˆ«ç§»åŠ¨è®¾å¤‡é€‚é…åŸŸåã€å±è”½æŸäº› IP å’Œå›½å®¶çš„åŠŸèƒ½ã€‚å¯¹äºå’±çš„ telegram é¢‘é“é•œåƒç«™æ¥è¯´ï¼Œè¿™éƒ½æ˜¯å¤šä½™çš„ï¼Œäºæ˜¯å°±å»æ‰äº†ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/image-20200326184802562.png" alt="image-20200326184802562"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Website you intended to retrieve for users.</span></span><br><span class="line"><span class="keyword">const</span> upstream = <span class="string">'t.me'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Custom pathname for the upstream website.</span></span><br><span class="line"><span class="keyword">const</span> upstream_path = <span class="string">'/s/rss_kubernetes'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Whether to use HTTPS protocol for upstream address.</span></span><br><span class="line"><span class="keyword">const</span> https = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">addEventListener(<span class="string">'fetch'</span>, event =&gt; &#123;</span><br><span class="line">    event.respondWith(fetchAndApply(event.request));</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">fetchAndApply</span>(<span class="params">request</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> response = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">let</span> url = <span class="keyword">new</span> URL(request.url);</span><br><span class="line">    <span class="keyword">let</span> url_hostname = url.hostname;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (https == <span class="literal">true</span>) &#123;</span><br><span class="line">        url.protocol = <span class="string">'https:'</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        url.protocol = <span class="string">'http:'</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> upstream_domain = upstream;</span><br><span class="line">    url.host = upstream_domain;</span><br><span class="line">    <span class="keyword">if</span> (url.pathname == <span class="string">'/'</span>) &#123;</span><br><span class="line">        url.pathname = upstream_path;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        url.pathname = upstream_path + url.pathname;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> method = request.method;</span><br><span class="line">    <span class="keyword">let</span> request_headers = request.headers;</span><br><span class="line">    <span class="keyword">let</span> new_request_headers = <span class="keyword">new</span> Headers(request_headers);</span><br><span class="line"></span><br><span class="line">    new_request_headers.set(<span class="string">'Host'</span>, url.hostname);</span><br><span class="line">    new_request_headers.set(<span class="string">'Referer'</span>, url.hostname);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> original_response = <span class="keyword">await</span> fetch(url.href, &#123;</span><br><span class="line">        method: method,</span><br><span class="line">        headers: new_request_headers</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> original_response_clone = original_response.clone();</span><br><span class="line">    <span class="keyword">let</span> original_text = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">let</span> response_headers = original_response.headers;</span><br><span class="line">    <span class="keyword">let</span> new_response_headers = <span class="keyword">new</span> Headers(response_headers);</span><br><span class="line">    <span class="keyword">let</span> status = original_response.status;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> content_type = new_response_headers.get(<span class="string">'content-type'</span>);</span><br><span class="line">    <span class="keyword">if</span> (content_type.includes(<span class="string">'text/html'</span>) &amp;&amp; content_type.includes(<span class="string">'UTF-8'</span>)) &#123;</span><br><span class="line">        original_text = <span class="keyword">await</span> replace_response_text(original_response_clone, upstream_domain, url_hostname);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        original_text = original_response_clone.body</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    response = <span class="keyword">new</span> Response(original_text, &#123;</span><br><span class="line">        status,</span><br><span class="line">        headers: new_response_headers</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">let</span> text = <span class="keyword">await</span> response.text()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> modified = text.replace(<span class="regexp">/telegram.org/g</span>, <span class="string">"telegram.k8srss.workers.dev"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Response(modified, &#123;</span><br><span class="line">        status: response.status,</span><br><span class="line">        statusText: response.statusText,</span><br><span class="line">        headers: response.headers</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> response;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåƒ <code>t.me</code> åŸŸåä¸‹çš„ç«™ç‚¹ï¼Œæ¯”å¦‚æˆ‘çš„ <code>https://t.me/s/rss_kubernetes</code> ï¼Œå®ƒçš„ js å’Œ css æ ·å¼æ–‡ä»¶æ˜¯ä½¿ç”¨çš„ telegram.org åŸŸåã€‚<del>æ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨ <code>replace_dict</code> é‚£é‡Œå®šä¹‰å¥½æ›¿æ¢çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œ</del>å°†  <code>https://t.me/s/rss_kubernetes</code>é¡µé¢é‡Œçš„  <code>telegram.org</code> åŒæ ·è¿›è¡Œåä»£æ‰è¡Œï¼Œè¿™éœ€è¦ä¸º telegram å»ºä¸€ä¸ªå•ç‹¬çš„ Worker ğŸ˜‘ã€‚è¿™ä¹Ÿæ˜¯è¯„è®ºåŒº  <a href="https://ichr.me/" target="_blank" rel="noopener">ChrAlpha</a> å°ä¼™ä¼´æåˆ°çš„åŠæ³•ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ubuntu@blog:~$ curl https://t.me/s/rss_kubernetes | grep "<span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"</span></span></span><br><span class="line"><span class="tag"><span class="string">  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current</span></span></span><br><span class="line"><span class="tag"><span class="string">                                 Dload  Upload   Total   Spent    Left  Speed</span></span></span><br><span class="line"><span class="tag"><span class="string">100  141k  100  141k    0     0  85287      0  0:00:01  0:00:01 --:--:-- 85237</span></span></span><br><span class="line"><span class="tag"><span class="string">    &lt;script src="</span>//<span class="attr">telegram.org</span>/<span class="attr">js</span>/<span class="attr">jquery.min.js</span>"&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"//telegram.org/js/jquery-ui.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"//telegram.org/js/widget-frame.js?29"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"//telegram.org/js/telegram-web.js?8"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ä¿®æ”¹ä¸‹å¤„ä»£ç ä¸ºï¼Œå°†<code>https://t.me/s/rss_kubernetes</code>é¡µé¢é‡Œçš„  <code>telegram.org</code> åŒæ ·è¿›è¡Œä¸€æ¬¡åä»£ã€‚è¿™æ ·è®¿é—®åˆ° <code>https://t.me/s/rss_kubernetes</code>é¡µé¢æ—¶ï¼ŒæŠŠçš„ telegram.org æ›¿æ¢ä¸ºå¦ä¸€ä¸ª Worker çš„åŸŸåï¼Œæ¯”å¦‚æˆ‘çš„ <code>telegram.k8srss.workers.dev</code>  ã€‚ä¸è¿‡åƒé¢‘é“é‡Œçš„å›¾ç‰‡ã€æ–‡ä»¶ã€è§†é¢‘ç­‰èµ„æº telegram æ˜¯ä½¿ç”¨çš„ CDN ï¼Œè€Œä¸”æœ‰å¥½å‡ ä¸ªåŸŸåâ€¦â€¦è¿™ç‚¹å¾ˆåƒµç¡¬ï¼Œæš‚æ—¶æ‰¾ä¸åˆ°åˆé€‚çš„åŠæ³•ã€‚è²Œä¼¼ä¸€ä¸ª Worker åªèƒ½åä»£ä¸€ä¸ªåŸŸåï¼Ÿå¦‚æœæ±æœ‰åˆé€‚çš„åŠæ³•ï¼Œæ¬¢è¿ä¸å’±äº¤æµï¼Œå’±æ„Ÿæ¿€ä¸å°½ğŸ˜‹</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> modified = text.replace(<span class="regexp">/telegram.org/g</span>, <span class="string">"telegram.k8srss.workers.dev"</span>)</span><br></pre></td></tr></table></figure><p>è¿™æ ·å†ä½¿ç”¨ curl è®¿é—®æµ‹è¯•ä¸€ä¸‹ï¼ŒåŸæ¥çš„ telegram.org å·²ç»å…¨éƒ¨æ›¿æ¢æˆ telegram.k8srss.workers.dev äº†ğŸ˜‚ã€‚ç°åœ¨å¢™å†…ç”¨æˆ·ä¹Ÿå¯ä»¥æ— ç—›è®¿é—®å•¦ã€‚åœ¨æ­¤æ„Ÿè°¢  <a href="https://ichr.me/" target="_blank" rel="noopener">ChrAlpha</a>  å°ä¼™ä¼´ğŸ˜‚æå‡ºå®è´µçš„å»ºè®®ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">main</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"//telegram.k8srss.workers.dev/js/jquery.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"//telegram.k8srss.workers.dev/js/jquery-ui.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"//telegram.k8srss.workers.dev/js/widget-frame.js?29"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"//telegram.k8srss.workers.dev/js/telegram-web.js?8"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">   </span><br><span class="line"><span class="comment">&lt;!-- page generated in 121.26ms --&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ–‡æœ¬æ›¿æ¢åŠŸèƒ½å¾ˆå¥½ç©å„¿ï¼Œåœ¨ Cloudflare å®˜æ–¹çš„åšå®¢é‡Œè¿˜æœ‰ä¸ª demo <a href="https://cloudflareworkers.com/#c62c6c0002cb236166b794c440870cca:https://blog.cloudflare.com/introducing-cloudflare-workers" target="_blank" rel="noopener">introducing-cloudflare-workers</a> ã€‚ä½¿ç”¨è¿™ä¸ªåŠŸèƒ½å’±æœ‰è§£é”äº†ä¸€ä¸ªç©å…·ï¼Œç¨åå†è®²ğŸ˜‚ã€‚</p><blockquote><p>Here is a worker which performs a site-wide search-and-replace, replacing the word â€œWorkerâ€ with â€œMinionâ€. <a href="https://cloudflareworkers.com/#c62c6c0002cb236166b794c440870cca:https://blog.cloudflare.com/introducing-cloudflare-workers" target="_blank" rel="noopener">Try it out on this blog post.</a></p></blockquote><p><del>å‰½çªƒ</del>ä¿®æ”¹å¥½ä»£ç ä¹‹åç‚¹å‡»å·¦ä¸‹è§’çš„ <code>Save and Deploy</code> ç„¶å Preview çœ‹çœ‹é¡µé¢æ˜¯å¦æ˜¾ç¤ºæ­£å¸¸ï¼Œå¦‚æœæ˜¾ç¤ºæ­£å¸¸æ­å–œä½ æˆåŠŸå•¦ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/image-20200326190914520.png" alt="image-20200326190914520"></p><p>å¦‚æœä½ æƒ³ä½¿ç”¨è¿™ç§åŠæ³•åä»£å…¶ä»–é¢‘é“ï¼Œåªéœ€è¦æŠŠ <code>const upstream_path = &#39;/s/rss_kubernetes&#39;</code> åçš„  rss_kubernetes æ›¿æ¢ä¸ºä½ æƒ³è¦ä»£ç†çš„ telegram é¢‘é“ username å³å¯ã€‚ä¹‹æ‰€ä»¥åŠ ä¸Š <code>upstream_path</code>  è€Œä¸åä»£æ•´ä¸ª <code>t.me</code> æ˜¯ä¸ºäº†é˜²æ­¢åˆ«äººæ»¥ç”¨ï¼Œæ¯•ç«Ÿ 10W æ¬¡ä¸ç»è–…ğŸ˜‚</p><h3 id="æ”¹è¿›"><a href="#æ”¹è¿›" class="headerlink" title="æ”¹è¿›"></a>æ”¹è¿›</h3><p>å‘¨å››æ™šä¸Šç¡è§‰å‰åœ¨æ¨ç‰¹ä¸Šå‘äº†ä¸ªæ¨æ–‡ï¼Œå‘å¤§å®¶è¯·æ•™äº†ä¸€ä¸‹ä¹‹å‰ä¸€ä¸ª Worker é‡Œåªèƒ½åä»£ä¸€ä¸ªåŸŸåçš„é—®é¢˜ã€‚ç¬¬äºŒå¤© <a href="https://twitter.com/Echowxsy" target="_blank" rel="noopener">@Echowxsy</a> å°±å›å¤å’±äº†ï¼Œè€Œä¸”è¿˜ç‰¹æ„æ³¨å†Œäº† CouldFare è´¦å·ä½¿ç”¨ Workers å¸®å’±æµ‹è¯•äº†ä¸€ä¸‹ã€‚åœ¨æ­¤éå¸¸æ„Ÿè°¢ <a href="https://twitter.com/Echowxsy" target="_blank" rel="noopener">@Echowxsy</a>  å¸®å’±ã€‚æŒ‰ç…§  <a href="https://twitter.com/Echowxsy" target="_blank" rel="noopener">@Echowxsy</a> å°ä¼™ä¼´æ‰€è¯´çš„ï¼š</p><blockquote><p>æˆ‘æ²¡ç”¨è¿‡ CloudFlareï¼Œä¸è¿‡æˆ‘çœ‹äº†ä¸€ä¸‹ä½ çš„blogï¼Œè²Œä¼¼å¯ä»¥ç”¨ä¸¤ä¸ªupstreamå®ç°è¿™ä¸ªåŠŸèƒ½ã€‚ åœ¨modifiedé‚£é‡Œæ›¿æ¢ä¸ºå½“å‰workerçš„åœ°å€ï¼Œç„¶ååœ¨åé¢åŠ ä¸Šä¸€ä¸ªä¸ä¼šé‡å¤çš„è·¯å¾„ï¼Œä¾‹å¦‚xxxã€‚ ç„¶ååœ¨fetchAndApplyé‡Œé¢åˆ¤æ–­ï¼Œå¦‚æœå½“å‰è¯·æ±‚çš„pathname=/xxxï¼Œä½¿ç”¨upstream2ï¼Œå¦åˆ™ä½¿ç”¨upstream1ã€‚ ç†è®ºä¸Šæ˜¯å¯ä»¥å®ç°çš„ã€‚</p><p>å°±æ˜¯ä¸€ä¸ª Workers å¯ä»¥åšå¾ˆå¤šäº‹æƒ…ï¼Œä»–å®é™…ä¸Šå°±æ˜¯ Node.js ä»£ç ã€‚ ç„¶åè¿™é‡Œæ˜¯å°† <a href="https://t.co/wTGzY4U6sD?amp=1" target="_blank" rel="noopener">http://telegram.org/xxxx</a> æ˜ å°„åˆ° <a href="https://t.co/yQwEY2mzCP?amp=1" target="_blank" rel="noopener">http://tg.k8s.li/static/xxxx</a> ã€‚ ç„¶ååœ¨ Workers é‡Œé¢åˆ¤æ–­ï¼Œå¦‚æœæœ‰ <code>/static</code> åˆ™ä» <a href="https://t.co/VYm4zCfwPr?amp=1" target="_blank" rel="noopener">http://telegram.org</a> è·å–ï¼Œå¦åˆ™ä» <a href="https://t.co/N4Ahg0VLN1?amp=1" target="_blank" rel="noopener">http://t.me</a> è·å–ã€‚</p></blockquote><p><code>æ­¤å¤„å¼•ç”¨</code> <a href="https://twitter.com/Echowxsy" target="_blank" rel="noopener">@Echowxsy</a> çš„ <a href="https://twitter.com/Echowxsy/status/1243407321989967874" target="_blank" rel="noopener">æ¨æ–‡</a></p><p>Woerker é¦–å…ˆæˆ‘ä»¬è·å–å®Œè¦åä»£çš„ <code>https://t.me/s/rss_kubernetes</code> é¡µé¢ html æºç ï¼Œç„¶åä½¿ç”¨ replace å‡½æ•°æŠŠ telegram.org ä»¥åŠcdn[1-5].telesco.pe ç­‰åŸŸåè¿›è¡Œæ›¿æ¢ï¼Œæ›¿æ¢ä¸º /static ã€/cdn[1-5] ç­‰ä¸åŒçš„ url è·¯å¾„ã€‚ç„¶åå°†ä¿®æ”¹åçš„ html é¡µé¢è¿”å›ç»™å®¢æˆ·ç«¯ã€‚å®¢æˆ·ç«¯å®¢æˆ·ç«¯åœ¨è¯·æ±‚ <code>/static</code>  æ—¶ Worker å°±ä¼šå» <a href="https://t.co/VYm4zCfwPr?amp=1" target="_blank" rel="noopener">http://telegram.org</a> è·å–ç›¸åº”çš„èµ„æºè¿”å›ç»™ç”¨æˆ·ã€‚è¿™æ ·å°±å®ç°äº†ä¸€ä¸ª Worker åä»£å¤šä¸ªåŸŸåéªšæ“ä½œã€‚ä¿®æ”¹åçš„ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> upstream_me = <span class="string">'t.me'</span>;</span><br><span class="line"><span class="keyword">const</span> upstream_org = <span class="string">'telegram.org'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Custom pathname for the upstream website.</span></span><br><span class="line"><span class="keyword">const</span> upstream_path = <span class="string">'/s/rss_kubernetes'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Whether to use HTTPS protocol for upstream address.</span></span><br><span class="line"><span class="keyword">const</span> https = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Replace texts.</span></span><br><span class="line"><span class="keyword">const</span> replace_dict = &#123;</span><br><span class="line">  $upstream: <span class="string">'$custom_domain'</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">addEventListener(<span class="string">'fetch'</span>, event =&gt; &#123;</span><br><span class="line">  event.respondWith(fetchAndApply(event.request));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">fetchAndApply</span>(<span class="params">request</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> response = <span class="literal">null</span>;</span><br><span class="line">  <span class="keyword">let</span> url = <span class="keyword">new</span> URL(request.url);</span><br><span class="line">  <span class="keyword">let</span> url_hostname = url.hostname;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (https == <span class="literal">true</span>) &#123;</span><br><span class="line">    url.protocol = <span class="string">'https:'</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    url.protocol = <span class="string">'http:'</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> upstream_domain = upstream_me;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Check telegram.org</span></span><br><span class="line">  <span class="keyword">let</span> pathname = url.pathname;</span><br><span class="line">  <span class="built_in">console</span>.log(pathname);</span><br><span class="line">  <span class="keyword">if</span> (pathname.startsWith(<span class="string">'/static'</span>)) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'here'</span>);</span><br><span class="line">    upstream_domain = upstream_org;</span><br><span class="line">    url.pathname = pathname.replace(<span class="string">'/static'</span>, <span class="string">''</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (pathname == <span class="string">'/'</span>) &#123;</span><br><span class="line">      url.pathname = upstream_path;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      url.pathname = upstream_path + url.pathname;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  url.host = upstream_domain;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> method = request.method;</span><br><span class="line">  <span class="keyword">let</span> request_headers = request.headers;</span><br><span class="line">  <span class="keyword">let</span> new_request_headers = <span class="keyword">new</span> Headers(request_headers);</span><br><span class="line"></span><br><span class="line">  new_request_headers.set(<span class="string">'Host'</span>, url.hostname);</span><br><span class="line">  new_request_headers.set(<span class="string">'Referer'</span>, url.hostname);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> original_response = <span class="keyword">await</span> fetch(url.href, &#123;</span><br><span class="line">    method: method,</span><br><span class="line">    headers: new_request_headers</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> original_response_clone = original_response.clone();</span><br><span class="line">  <span class="keyword">let</span> original_text = <span class="literal">null</span>;</span><br><span class="line">  <span class="keyword">let</span> response_headers = original_response.headers;</span><br><span class="line">  <span class="keyword">let</span> new_response_headers = <span class="keyword">new</span> Headers(response_headers);</span><br><span class="line">  <span class="keyword">let</span> status = original_response.status;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> content_type = new_response_headers.get(<span class="string">'content-type'</span>);</span><br><span class="line">  <span class="keyword">if</span> (content_type.includes(<span class="string">'text/html'</span>) &amp;&amp; content_type.includes(<span class="string">'UTF-8'</span>)) &#123;</span><br><span class="line">    original_text = <span class="keyword">await</span> replace_response_text(</span><br><span class="line">      original_response_clone,</span><br><span class="line">      upstream_domain,</span><br><span class="line">      url_hostname</span><br><span class="line">    );</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    original_text = original_response_clone.body;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  response = <span class="keyword">new</span> Response(original_text, &#123;</span><br><span class="line">    status,</span><br><span class="line">    headers: new_response_headers</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">let</span> text = <span class="keyword">await</span> response.text();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Modify it.</span></span><br><span class="line">  <span class="keyword">let</span> modified = text.replace(<span class="regexp">/telegram.org/g</span>,<span class="string">'tg.k8s.li/static'</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Return modified response.</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> Response(modified, &#123;</span><br><span class="line">    status: response.status,</span><br><span class="line">    statusText: response.statusText,</span><br><span class="line">    headers: response.headers</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="è‡ªå®šä¹‰åŸŸå"><a href="#è‡ªå®šä¹‰åŸŸå" class="headerlink" title="è‡ªå®šä¹‰åŸŸå"></a>è‡ªå®šä¹‰åŸŸå</h2><p>å›åˆ° Workers çš„ç®¡ç†é¡µé¢ï¼Œç‚¹å‡» <code>rename</code> å³å¯ä¿®æ”¹ Worker çš„ä¸‰çº§å­åŸŸåã€‚ä¸è¿‡å’±è¿˜æ˜¯ä¸å¤ªå–œæ¬¢ <code>WorkerName.yousetdomain.workers.dev</code> è¿™ä¹ˆé•¿çš„åŸŸåï¼Œæƒ³ä½¿ç”¨å’±è‡ªå·±çš„äºŒçº§å­åŸŸåè®¿é—®ã€‚</p><p>é¦–å…ˆå›åˆ°åŸŸåç®¡ç†çš„é¡µé¢ï¼Œè¿›å…¥åˆ°è‡ªå·±åŸŸåé¡¶éƒ¨é‚£ä¸€æ é‡Œçš„ <code>Workers</code> ï¼Œåœ¨é‚£é‡Œæ·»åŠ ç›¸åº”çš„è·¯ç”±å³å¯ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/image-20200326191340166.png" alt="image-20200326191340166"></p><p>ç‚¹å‡» <code>Add Route</code> ï¼Œåœ¨ Route é‚£ä¸€æ è¾“å…¥å¥½è‡ªå·±çš„åŸŸåï¼Œæ³¨æ„æœ€åçš„ <code>/*</code> ä¹Ÿè¦åŠ ä¸Šï¼Œç„¶å Worker é€‰æ‹©åˆšåˆšåˆ›å»ºçš„é‚£ä¸ªå³å¯ã€‚æ¥ç€å†æ·»åŠ  <code>CNAME</code> è®°å½•åˆ°è‡ªå·±çš„ <code>WorkerName.yousetdomain.workers.dev</code> ï¼Œè¿™æ ·å°±èƒ½ä½¿ç”¨è‡ªå·±çš„åŸŸåè®¿é—®å•¦ğŸ˜‹</p><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/image-20200326191435923.png" alt="image-20200326191435923"></p><h2 id="æ–‡æœ¬æ›¿æ¢"><a href="#æ–‡æœ¬æ›¿æ¢" class="headerlink" title="æ–‡æœ¬æ›¿æ¢"></a>æ–‡æœ¬æ›¿æ¢</h2><p>å‰æ–‡æåˆ°çš„æ–‡æœ¬æ›¿æ¢åŠŸèƒ½å¸®å’±è§£å†³äº†ä¸€ä¸ªå°é—®é¢˜ã€‚å’±å‹é“¾å…³æ³¨çš„ä¸€ä¸ªåšå®¢ <a href="https://chanshiyu.com/#/" target="_blank" rel="noopener">chanshiyu.com</a> æ²¡æœ‰æä¾› RSS ï¼Œä»–æ˜¯å°†åšå®¢å†…å®¹æ”¾åœ¨ GitHub issue ä¸Šï¼Œæ‰€ä»¥åªèƒ½é€šè¿‡ RSSHUB æ¥è®¢é˜… GitHub çš„ issue æ¥è·å–åšå®¢çš„æ›´æ–°ã€‚ä½† RSSHUB è·å–çš„æ˜¯ GitHub issue çš„é“¾æ¥è€ŒéåŸåšå®¢çš„é“¾æ¥ï¼Œäºæ˜¯å’±æƒ³äº†æƒ³å°±ç”¨ <code>Worker</code> è¿›è¡Œæ›¿æ¢ä¸å¾—äº†ã€‚</p><p>é€šè¿‡ RSSHUB è·å–åˆ°çš„ RSS æ•°æ®å¦‚ä¸‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">rss</span> <span class="attr">xmlns:atom</span>=<span class="string">"http://www.w3.org/2005/Atom"</span> <span class="attr">version</span>=<span class="string">"2.0"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">channel</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span></span><br><span class="line">&lt;![CDATA[ chanshiyucx/blog Issues ]]&gt;</span><br><span class="line"><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span>&gt;</span>https://github.com/chanshiyucx/blog/issues<span class="tag">&lt;/<span class="name">link</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">atom:link</span> <span class="attr">href</span>=<span class="string">"http://rsshub.app/github/issue/chanshiyucx/blog"</span> <span class="attr">rel</span>=<span class="string">"self"</span> <span class="attr">type</span>=<span class="string">"application/rss+xml"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">description</span>&gt;</span></span><br><span class="line">&lt;![CDATA[</span><br><span class="line">chanshiyucx/blog Issues - Made with love by RSSHub(https://github.com/DIYgod/RSSHub)</span><br><span class="line">]]&gt;</span><br><span class="line"><span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">generator</span>&gt;</span>RSSHub<span class="tag">&lt;/<span class="name">generator</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">webMaster</span>&gt;</span>i@diygod.me (DIYgod)<span class="tag">&lt;/<span class="name">webMaster</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">language</span>&gt;</span>zh-cn<span class="tag">&lt;/<span class="name">language</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">lastBuildDate</span>&gt;</span>Thu, 26 Mar 2020 11:00:06 GMT<span class="tag">&lt;/<span class="name">lastBuildDate</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ttl</span>&gt;</span>60<span class="tag">&lt;/<span class="name">ttl</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">item</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span></span><br><span class="line">&lt;![CDATA[ Telegram ç”µæŠ¥æœºå™¨äºº ]]&gt;</span><br><span class="line"><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">description</span>&gt;</span></span><br><span class="line">&lt;![CDATA[</span><br><span class="line">]]&gt;</span><br><span class="line"><span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">pubDate</span>&gt;</span>Wed, 25 Mar 2020 03:54:04 GMT<span class="tag">&lt;/<span class="name">pubDate</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">guid</span> <span class="attr">isPermaLink</span>=<span class="string">"false"</span>&gt;</span>https://github.com/chanshiyucx/blog/issues/108<span class="tag">&lt;/<span class="name">guid</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span>&gt;</span>https://github.com/chanshiyucx/blog/issues/108<span class="tag">&lt;/<span class="name">link</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å…¶ä¸­çš„ <code>&lt;guid isPermaLink=&quot;false&quot;&gt;</code> å’Œ <code>&lt;link&gt;</code> ä¸­çš„é“¾æ¥ github.com/chanshiyucx/blog/issues/ æ›¿æ¢ä¸º chanshiyu.com/#/post/ å³å¯ã€‚äºæ˜¯è¿˜æ˜¯åŒæ ·çš„æ–¹æ³•æ–°å»ºä¸€ä¸ª Workerï¼Œç„¶åä¿®æ”¹ä¸€ä¸‹ <code>worker.js</code> çš„ä»£ç å°±å¯ä»¥å•¦ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Website you intended to retrieve for users.</span></span><br><span class="line"><span class="keyword">const</span> upstream = <span class="string">'rsshub.app'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Custom pathname for the upstream website.</span></span><br><span class="line"><span class="keyword">const</span> upstream_path = <span class="string">'/github/issue/chanshiyucx/blog'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Whether to use HTTPS protocol for upstream address.</span></span><br><span class="line"><span class="keyword">const</span> https = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">addEventListener(<span class="string">'fetch'</span>, event =&gt; &#123;</span><br><span class="line">    event.respondWith(fetchAndApply(event.request));</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">fetchAndApply</span>(<span class="params">request</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> response = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">let</span> url = <span class="keyword">new</span> URL(request.url);</span><br><span class="line">    <span class="keyword">let</span> url_hostname = url.hostname;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (https == <span class="literal">true</span>) &#123;</span><br><span class="line">        url.protocol = <span class="string">'https:'</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        url.protocol = <span class="string">'http:'</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> upstream_domain = upstream;</span><br><span class="line">    url.host = upstream_domain;</span><br><span class="line">    <span class="keyword">if</span> (url.pathname == <span class="string">'/'</span>) &#123;</span><br><span class="line">        url.pathname = upstream_path;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        url.pathname = upstream_path + url.pathname;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> method = request.method;</span><br><span class="line">    <span class="keyword">let</span> request_headers = request.headers;</span><br><span class="line">    <span class="keyword">let</span> new_request_headers = <span class="keyword">new</span> Headers(request_headers);</span><br><span class="line"></span><br><span class="line">    new_request_headers.set(<span class="string">'Host'</span>, url.hostname);</span><br><span class="line">    new_request_headers.set(<span class="string">'Referer'</span>, url.hostname);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> original_response = <span class="keyword">await</span> fetch(url.href, &#123;</span><br><span class="line">        method: method,</span><br><span class="line">        headers: new_request_headers</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> original_response_clone = original_response.clone();</span><br><span class="line">    <span class="keyword">let</span> original_text = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">let</span> response_headers = original_response.headers;</span><br><span class="line">    <span class="keyword">let</span> new_response_headers = <span class="keyword">new</span> Headers(response_headers);</span><br><span class="line">    <span class="keyword">let</span> status = original_response.status;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> content_type = new_response_headers.get(<span class="string">'content-type'</span>);</span><br><span class="line">    <span class="keyword">if</span> (content_type.includes(<span class="string">'text/html'</span>) &amp;&amp; content_type.includes(<span class="string">'UTF-8'</span>)) &#123;</span><br><span class="line">        original_text = <span class="keyword">await</span> replace_response_text(original_response_clone, upstream_domain, url_hostname);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        original_text = original_response_clone.body</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    response = <span class="keyword">new</span> Response(original_text, &#123;</span><br><span class="line">        status,</span><br><span class="line">        headers: new_response_headers</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">let</span> text = <span class="keyword">await</span> response.text()</span><br><span class="line"></span><br><span class="line"><span class="comment">// Modify it.</span></span><br><span class="line">    <span class="keyword">let</span> modified = text.replace(<span class="regexp">/github.com\/chanshiyucx\/blog\/issues\//g</span>, <span class="string">"chanshiyu.com\/#\/post\/"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Return modified response.</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Response(modified, &#123;</span><br><span class="line">        status: response.status,</span><br><span class="line">        statusText: response.statusText,</span><br><span class="line">        headers: response.headers</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> response;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>éƒ¨ç½²å¥½ Worker ä¹‹åå°±å¯ä»¥ä½¿ç”¨ RSS æ¥è®¢é˜…å•¦ğŸ˜‹</p><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/image-20200326193643610.png" alt="image-20200326193643610"></p><h2 id="è§£é”æ›´å¤šå¥½ç©å„¿çš„ğŸ˜‹"><a href="#è§£é”æ›´å¤šå¥½ç©å„¿çš„ğŸ˜‹" class="headerlink" title="è§£é”æ›´å¤šå¥½ç©å„¿çš„ğŸ˜‹"></a>è§£é”æ›´å¤šå¥½ç©å„¿çš„ğŸ˜‹</h2><p>å…³äº Cloudflare çš„ Workers è¿˜æœ‰æ›´å¤šå¥½ç©çš„ç­‰å¾…ä½ å»å‘ç°ï¼Œå’±å°±æ¨èä¸€ä¸‹å•¦ï¼š</p><ul><li><a href="https://blog.ichr.me/post/cloudflare-worker-build-mirror-website/" target="_blank" rel="noopener">Cloudflare Worker å…è´¹æ­å»ºé•œåƒç«™</a></li><li><a href="https://blog.cloudflare.com/zh/cloudflare-workers-unleashed-zh/" target="_blank" rel="noopener">ä»ç°åœ¨èµ·ï¼Œä»»ä½•äººéƒ½å¯ä»¥åœ¨Cloudflareä¸Šä½¿ç”¨Workersè¿è¡ŒJavaScriptï¼</a></li><li><a href="https://blog.cloudflare.com/zh/just-write-code-improving-developer-experience-for-cloudflare-workers-zh/" target="_blank" rel="noopener">å°½æƒ…ç¼–å†™ä»£ç å§ï¼šæ”¹å–„å¼€å‘äººå‘˜ä½¿ç”¨Cloudflare Workersçš„ä½“éªŒ</a></li><li><a href="https://blog.skk.moe/post/cloudflare-workers-cfga" target="_blank" rel="noopener">ä½¿ç”¨ Cloudflare Workers åŠ é€Ÿ Google Analytics</a></li><li><a href="https://blog.meow.page/2019/09/24/free-personal-image-hosting-with-backblaze-b2-and-cloudflare-workers" target="_blank" rel="noopener">ä½¿ç”¨ Backblaze B2 å’Œ Cloudflare Workers æ­å»ºå¯ä»¥è‡ªå®šä¹‰åŸŸåçš„å…è´¹å›¾åºŠ</a></li><li><a href="https://free.com.tw/cloudflare-workers-wordpress/" target="_blank" rel="noopener">ä½¿ç”¨ Cloudflare Workers æé«˜ WordPress é€Ÿåº¦å’Œæ•ˆèƒ½æ•™å­¸</a></li><li><a href="https://yojigen.tech/archives/post19/" target="_blank" rel="noopener">ä½¿ç”¨Cloudflare Workersåå¸¦Pç«™å›¾ç‰‡</a></li></ul><p>æœ€åå®£ä¼ ä¸€ä¸‹å’±çš„<a href="https://t.me/rss_kubernetes" target="_blank" rel="noopener">@rss_kubernetes</a> é¢‘é“ï¼Œå›½å†…ç”¨æˆ·å¯ä»¥è®¿é—® <a href="https://tg.k8s.li" target="_blank" rel="noopener">tg.k8s.li</a>ï¼Œå¦‚æœä½ å¯¹ docker ã€K8sã€äº‘åŸç”Ÿç­‰æ„Ÿå…´è¶£ï¼Œå°±åˆ°å’±ç¢—é‡Œæ¥å§ğŸ˜‚ã€‚ä¸è®¢é˜…å’±çš„é¢‘é“ä¹Ÿå¯ä»¥é€šè¿‡å’±çš„ <a href="https://tg.k8s.li" target="_blank" rel="noopener">tg.k8s.li</a> é•œåƒç«™æ¥æŸ¥çœ‹ RSS æ¨é€ä¿¡æ¯ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/image-20200327003346742.png" alt="image-20200327003346742"></p><p>GitHub page åˆè¢«å¢™ä¸€æ³¢ï¼Œrsshub.app ä¹Ÿè¢«å¢™æ‰äº†ã€‚å¢™è¶Šæ¥è¶Šé«˜äº†ï¼Œè¿™ä¸ªç¤¾ä¼šä¹Ÿæ¥è¶Šå¯ç¬‘äº†â€¦â€¦ä¸çŸ¥é“æœªæ¥çš„äº’è”ç½‘ä¼šå˜æˆä»€ä¹ˆæ ·å­ï¼Œä½†æˆ‘ä»¬ä½œä¸ºä¸€åªå±æ°‘èƒ½åšçš„å°±æ˜¯<strong>ä¸ä¸ºå¢™æ·»ç –åŠ ç“¦ï¼Œä¸ä¸ºææƒä¸“åˆ¶ç‹¬è£æš´æ”¿å”±èµæ­Œ</strong>ã€‚æœ€åä¸€å¼ è‡ªå·±åˆ¶ä½œ kindle ç”µå­ä¹¦æ—¶å–œæ¬¢ä½¿ç”¨çš„å°é¢å›¾ç‰‡é€ç»™å¤§å®¶ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/image-20200326200247868.png" alt="image-20200326200247868"></p>]]></content>
    
    <summary type="html">
    
      
      
        
        
          &lt;h2 id=&quot;ä¸€æ¬¡å¶é‡&quot;&gt;&lt;a href=&quot;#ä¸€æ¬¡å¶é‡&quot;
        
      
    
    </summary>
    
    
      <category term="æŠ€æœ¯" scheme="https://blog.k8s.li/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="telegram" scheme="https://blog.k8s.li/tags/telegram/"/>
    
      <category term="GFW" scheme="https://blog.k8s.li/tags/GFW/"/>
    
      <category term="CloudFlare" scheme="https://blog.k8s.li/tags/CloudFlare/"/>
    
  </entry>
  
  <entry>
    <title>Linux çš„å°ä¼™ä¼´ systemd è¯¦è§£</title>
    <link href="https://blog.k8s.li/systemd.html"/>
    <id>https://blog.k8s.li/systemd.html</id>
    <published>2020-03-18T16:00:00.000Z</published>
    <updated>2020-03-18T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å°æ’æ›²"><a href="#å°æ’æ›²" class="headerlink" title="å°æ’æ›²"></a>å°æ’æ›²</h2><p>æœ€è¿‘ <a href="https://www.bennythink.com/" target="_blank" rel="noopener">åœŸè±†å“¥</a> åœ¨æ£é¼“ <a href="https://github.com/webp-sh/webp_server_go" target="_blank" rel="noopener">Webp Server Go</a> çš„æ—¶å€™å‘å’±ä¸€å¼  <code>systemctl status webp</code> çš„ä¿¡æ¯ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/image-20200318080736564.png" alt="image-20200318080736564"></p><p>å’¦ï¼Ÿå’±çš„ <code>systemctl status webp</code> ä¸ºå•¥å­æ²¡å¾— CPU å’Œ Memory ä¿¡æ¯å‘ï¼Ÿ</p><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/image-20200318080903595.png" alt="image-20200318080903595"></p><p>ç„¶åå’ŒåœŸè±†å“¥è¯·æ•™äº†ä¸€ä¸‹ï¼Œå’±ä¹Ÿæƒ³è¦ã€‚äºæ˜¯åœŸè±†å“¥å‘å’±ä¸€ç¯‡ <a href="https://www.bennythink.com/systemd-accounting.html" target="_blank" rel="noopener">systemd â€“ systemctl ä¸æ˜¾ç¤ºå†…å­˜ CPU ä¿¡æ¯</a> åšå®¢ï¼Œäºæ˜¯æ‹œå¸ˆå­¦è‰ºå°± get åˆ°å•¦ğŸ˜‹ã€‚åªéœ€è¦åœ¨ systemd çš„é…ç½®æ–‡ä»¶ä¸­ <code>/etc/systemd/system.conf</code> è¿½åŠ </p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">DefaultCPUAccounting</span>=<span class="literal">yes</span></span><br><span class="line"><span class="attr">DefaultMemoryAccounting</span>=<span class="literal">yes</span></span><br><span class="line"><span class="attr">DefaultTasksAccounting</span>=<span class="literal">yes</span></span><br></pre></td></tr></table></figure><p>ç„¶åå† <code>systemctl daemon-reload</code> ä¸€æŠŠæ¢­å°±å¯ä»¥å•¦ğŸ˜‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">â•­â”€root@blog /home/ubuntu</span><br><span class="line">â•°â”€# systemctl status webps</span><br><span class="line">â— webps.service - WebP Server</span><br><span class="line">   Loaded: loaded (/opt/webps/webps.service; enabled; vendor preset: enabled)</span><br><span class="line">   Active: active (running) since Sat 2020-03-14 10:32:31 UTC; 4 days ago</span><br><span class="line">     Docs: https://github.com/n0vad3v/webp_server_go</span><br><span class="line"> Main PID: 20691 (webp-server)</span><br><span class="line">    Tasks: 36 (limit: 684)</span><br><span class="line">   Memory: 9.1M</span><br><span class="line">      CPU: 20.421s</span><br><span class="line">   CGroup: /system.slice/webps.service</span><br><span class="line">           â””â”€20691 /opt/webps/webp-server --config /opt/webps/config.json</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/image-20200318211715509.png" alt="image-20200318211715509"></p><p>ä¸è¿‡ï¼Œå’±è¿˜æ˜¯è¦æ·±å…¥åœ°å­¦ä¹ ä¸€ä¸‹ <code>systemd</code> ï¼Œäºæ˜¯å°±æ°´äº†è¿™ç¯‡åšå®¢ğŸ˜‚</p><h2 id="Linux-å¯åŠ¨æµç¨‹"><a href="#Linux-å¯åŠ¨æµç¨‹" class="headerlink" title="Linux å¯åŠ¨æµç¨‹"></a>Linux å¯åŠ¨æµç¨‹</h2><p>æåˆ° systemd ä¸å¾—ä¸æä¸€ä¸‹ Linux çš„å¯åŠ¨æµç¨‹ï¼Œè¿™æ ·æ‰èƒ½æ¸…æ¥š  systemd åœ¨ Linux ç³»ç»Ÿä¸­çš„åœ°ä½å’Œä½œç”¨ğŸ˜‹ã€‚æ‰€ä»¥å°±ç®€æ˜æ‰¼è¦ç¬¬ä»‹ç»ä¸€ä¸‹ Linux å¯åŠ¨çš„æµç¨‹ã€‚</p><p>Linux ä»æŒ‰ä¸‹ç”µæºé”®åˆ°è¿›å…¥ç”¨æˆ·äº¤äº’ç•Œé¢æ•´ä¸ªå¯åŠ¨æµç¨‹å¤§è‡´å¯ä»¥åˆ†ä¸ºå››ä¸ªé˜¶æ®µï¼š</p><ul><li><p>BIOS é˜¶æ®µ</p></li><li><p>BootLoader é˜¶æ®µ</p></li><li><p>kernel åŠ è½½é˜¶æ®µ</p></li><li><p>initï¼šsystemd/sysvinit åˆå§‹åŒ–é˜¶æ®µ</p></li></ul><h3 id="BIOS-EFI-é˜¶æ®µ"><a href="#BIOS-EFI-é˜¶æ®µ" class="headerlink" title="BIOS/EFI é˜¶æ®µ"></a>BIOS/EFI é˜¶æ®µ</h3><p>BIOS æƒ³å¿…å¤§å®¶éƒ½ç†Ÿæ‚‰ï¼Œä¹Ÿå°±æ˜¯åšä¸€äº›åŸºæœ¬çš„ç¡¬ä»¶è‡ªæ£€å‡†å¤‡ä»¥åŠåŠ è½½ bootloader ç¨‹åºã€‚åœ¨æŒ‰ä¸‹ç”µæºç”µæºé”®ï¼ˆå†·å¯åŠ¨ï¼‰åï¼Œ CPU çš„ç¨‹åºè®¡æ•°å™¨è¢«åˆå§‹åŒ–ä¸ºä¸€ä¸ªç‰¹å®šçš„å…§å­˜åœ°å€ï¼Œå­˜å‚¨åœ¨åªè¯»å­˜å‚¨å™¨ï¼ˆROMï¼‰ä¸­çš„ BIOS å°±æ˜¯ä»è¿™ä¸ªç‰¹å®šçš„å…§å­˜åœ°å€å¼€å§‹æ‰§è¡Œã€‚<strong>æ‰€ä»¥æ²¡æœ‰ CPU æ˜¯æ— æ³•å¯åŠ¨ä¸»æ¿ä¸Šçš„ BIOS çš„</strong> ï¼Œåº”è¯¥ï¼ˆå°å£°ã€‚æ³¨æ„ï¼šå¯¹äºåµŒå…¥å¼ç³»ç»Ÿä¸­çš„ CPU ï¼Œå°†ä¼šåŠ è½½å¼•å¯¼åŒºå»å¯åŠ¨ flash/ROM ä¸­å·²çŸ¥åœ°å€çš„ç¨‹åºã€‚</p><p>BIOS å¯åŠ¨åå°±å¼€å§‹æ‰§è¡Œç¡¬ä»¶çš„åŸºæœ¬åˆå§‹åŒ–ä¹Ÿç§°ä¹‹ä¸ºï¼ˆPOST: ä¸Šç”µè‡ªæ£€ï¼‰ï¼Œå¹¶æ ¹æ®å¼•å¯¼è®¾å¤‡çš„ä¼˜å…ˆçº§å°†ç³»ç»Ÿæ§åˆ¶æƒäº¤ç»™ç¡¬ä»¶å¯åŠ¨é¡¹ï¼ˆæ¯”å¦‚ç¡¬ç›˜/ç½‘ç»œ/Uç›˜ç­‰ï¼‰ã€‚ä¹Ÿå°±æ˜¯æˆ‘ä»¬ BIOS ä¸Šçš„å¯åŠ¨èœå•ï¼Œè¿™ä¸€æ­¥æ˜¯å¯ä»¥è¢«æ‰“æ–­çš„ã€‚å½“æˆ‘ä»¬æŒ‰ä¸‹ F12 æˆ–è€… ESC é”®ï¼ˆæ ¹æ®ä¸»æ¿èŠ¯ç‰‡ç»„è€Œå¼‚ï¼‰å°±ä¼šå¼¹å‡ºé€‰æ‹©å¯åŠ¨é¡¹çš„ç•Œé¢ï¼Œè€Œä¸”è¿™äº›æŒ‰é”®é«˜åº¦ä¾èµ–ç¡¬ä»¶ã€‚</p><p>BIOS é€‰æ‹©å¥½ç¡¬ä»¶å¯åŠ¨é¡¹ä¹‹åå°±å¼€å§‹æ‰§è¡Œç¡¬ä»¶è®¾å¤‡ä¸Šçš„åˆçº§å¼•å¯¼ç¨‹åºä»£ç ï¼Œå¯¹äº MBR ç¡¬ç›˜æ¥è®²æ˜¯æœ€å¼€å§‹çš„ä¸€ä¸ªæ‰‡åŒºï¼ˆ512å­—èŠ‚ï¼‰å°‡è¢«åŠ è½½åˆ°å…§å­˜ï¼Œä¸¦æ‰§è¡Œè¡Œå…¶ä¸­çš„åˆå§‹åŒ–ä»£ç æ¥åŠ è½½ä¸‹ä¸€é˜¶æ®µçš„ Bootloader ã€‚</p><p>PSï¼šMBR <strong>ä¸»å¼•å¯¼è®°å½•</strong>æ˜¯ä¸€ä¸ª 512 å­—èŠ‚çš„æ‰‡åŒºï¼Œä½äºç¡¬ç›˜çš„ç¬¬ä¸€æ‰‡åŒºï¼ˆ0é“0æŸ±1æ‰‡åŒºï¼‰ã€‚å¯¹äº GPT/EFI æ¥è®²~~ï¼Œæœ‰ç‚¹å¤´å¤§ï¼Œæš‚ä¸”å…ˆä¸è°ˆğŸ˜‚ã€‚</p><p>å¯ä»¥ä½¿ç”¨ dd å‘½ä»¤è¯»å– MBR é‡Œçš„å†…å®¹ <code>dd if=/dev/sda of=mbr.bin bs=512 count=1</code></p><p>ä½¿ç”¨ od å‘½ä»¤æ¥æŸ¥çœ‹ <code>od -xa mbr.bin</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> od -xa mbr.bin</span></span><br><span class="line">0000000    63eb    0090    0000    0000    0000    0000    0000    0000</span><br><span class="line">          k   c dle nul nul nul nul nul nul nul nul nul nul nul nul nul</span><br><span class="line">0000020    0000    0000    0000    0000    0000    0000    0000    0000</span><br><span class="line">        nul nul nul nul nul nul nul nul nul nul nul nul nul nul nul nul</span><br><span class="line">*</span><br><span class="line">0000120    0000    0000    0000    0000    0000    8000    0800    0000</span><br><span class="line">        nul nul nul nul nul nul nul nul nul nul nul nul nul  bs nul nul</span><br><span class="line">0000140    0000    0000    faff    9090    c2f6    7480    f605    70c2</span><br><span class="line">        nul nul nul nul del   z dle dle   v   B nul   t enq   v   B   p</span><br><span class="line">0000160    0274    80b2    79ea    007c    3100    8ec0    8ed8    bcd0</span><br><span class="line">          t stx   2 nul   j   y   | nul nul   1   @  so   X  so   P   &lt;</span><br><span class="line">0000200    2000    a0fb    7c64    ff3c    0274    c288    bb52    0417</span><br><span class="line">        nul  sp   &#123;  sp   d   |   &lt; del   t stx  bs   B   R   ; etb eot</span><br><span class="line">0000220    07f6    7403    be06    7d88    17e8    be01    7c05    41b4</span><br><span class="line">          v bel etx   t ack   &gt;  bs   &#125;   h etb soh   &gt; enq   |   4   A</span><br><span class="line">0000240    aabb    cd55    5a13    7252    813d    55fb    75aa    8337</span><br><span class="line">â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦</span><br></pre></td></tr></table></figure><h3 id="BootLoader-é˜¶æ®µ"><a href="#BootLoader-é˜¶æ®µ" class="headerlink" title="BootLoader é˜¶æ®µ"></a>BootLoader é˜¶æ®µ</h3><p>ä¸»å¼•å¯¼è®°å½•åŠ è½½å®Œ Bootloaderï¼ˆä¸»è¦ä¸ºGRUBï¼‰åˆ° RAM ä¸­ä¹‹åï¼ŒGRUB ä¼šæ ¹æ®éœ€æ±‚æ˜¾ç¤ºä¸€ä¸ªå¯ç”¨çš„å†…æ ¸åˆ—è¡¨ï¼ˆå®šä¹‰åœ¨/etc/grub.confï¼Œä»¥åŠ/etc/grub/menu.lstå’Œ/etc/grub.confçš„è½¯è¿æ¥ï¼‰ã€‚æ ¹æ® GRUB çš„é…ç½®åŠ è½½é»˜è®¤å†…æ ¸é•œåƒå’Œ initrd é•œåƒåˆ°å†…å­˜ä¸­ï¼Œå½“æ‰€æœ‰é•œåƒå‡†å¤‡å¥½åï¼Œå³è·³è½¬åˆ°å†…æ ¸é•œåƒã€‚</p><h3 id="kernel-é˜¶æ®µ"><a href="#kernel-é˜¶æ®µ" class="headerlink" title="kernel é˜¶æ®µ"></a>kernel é˜¶æ®µ</h3><p>BootLoader é˜¶æ®µå®Œæˆä¹‹åå†…æ ¸é•œåƒåŠ è½½åˆ°å†…å­˜ä¸­ï¼Œç³»ç»Ÿçš„æ§åˆ¶æƒå°±äº¤ç»™å†…æ ¸é•œåƒï¼Œç”±æ­¤å†…æ ¸é˜¶æ®µå¼€å§‹äº†ã€‚å†…æ ¸é•œåƒä¸æ˜¯ä¸€ä¸ªå¯ä»¥æ‰§è¡Œçš„å†…æ ¸ï¼Œè€Œæ˜¯ä¸€ä¸ªè¢«å‹ç¼©çš„å†…æ ¸é•œåƒ ï¼ˆzImage æˆ– bzImageï¼‰ã€‚åœ¨å†…æ ¸é•œåƒçš„å¤´éƒ¨æœ‰ä¸€ä¸ªå°å‹ç¨‹åº routine ï¼Œå…¶åšå°‘é‡çš„ç¡¬ä»¶è®¾ç½®ï¼Œç„¶åè‡ªè§£å‹å‹ç¼©çš„å†…æ ¸é•œåƒå¹¶æ”¾åˆ°é«˜ç«¯å†…å­˜ã€‚å¦‚æœå­˜åœ¨åˆå§‹ç£ç›˜é•œåƒï¼ˆinitrdï¼‰ï¼Œroutine å°†æ‹·è´ initrd ä»¥ä¾›ç¨åå®‰è£…ä½¿ç”¨ï¼Œç„¶å routine å°†è°ƒç”¨å†…æ ¸å¼€å§‹å†…æ ¸å¯åŠ¨ã€‚</p><blockquote><p>åœ¨å†…æ ¸å¼•å¯¼è¿‡ç¨‹ä¸­ï¼Œåˆå§‹ RAM ç£ç›˜ï¼ˆinitrdï¼‰æ˜¯ç”± BootLoader åŠ è½½åˆ°å†…å­˜ä¸­çš„ï¼Œå®ƒä¼šè¢«å¤åˆ¶åˆ° RAM ä¸­å¹¶æŒ‚è½½åˆ°ç³»ç»Ÿä¸Šã€‚è¿™ä¸ª initrd ä½œä¸º RAM ä¸­çš„ä¸´æ—¶æ ¹æ–‡ä»¶ç³»ç»Ÿä½¿ç”¨ï¼Œå¹¶å…è®¸å†…æ ¸åœ¨æ²¡æœ‰æŒ‚è½½ä»»ä½•ç‰©ç†ç£ç›˜çš„æƒ…å†µä¸‹å®Œæ•´åœ°å®ç°å¼•å¯¼ã€‚ç”±äºä¸å¤–å›´è®¾å¤‡è¿›è¡Œäº¤äº’æ‰€éœ€è¦çš„æ¨¡å—å¯æ˜¯ initrd çš„ä¸€éƒ¨åˆ†ï¼Œå› æ­¤å†…æ ¸å¯ä»¥éå¸¸å°ï¼Œä½†æ˜¯ä»ç„¶æ”¯æŒå¤§é‡å¯èƒ½çš„ç¡¬ä»¶é…ç½®ã€‚åœ¨å†…æ ¸å¯åŠ¨åï¼Œå°±å¯ä»¥æ­£å¼è£…å¤‡æ ¹æ–‡ä»¶ç³»ç»Ÿäº†ï¼ˆé€šè¿‡ pivot_rootï¼‰ï¼Œæ­¤æ—¶ä¼šå°† initrd æ ¹æ–‡ä»¶ç³»ç»Ÿå¸è½½æ‰ï¼Œå¹¶æŒ‚è½½çœŸæ­£çš„æ ¹æ–‡ä»¶ç³»ç»Ÿã€‚<br>initrd å‡½æ•°è®©æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªå°å‹çš„ Linux å†…æ ¸ï¼Œå…¶ä¸­åŒ…æ‹¬ä½œä¸ºå¯åŠ è½½æ¨¡å—ç¼–è¯‘çš„é©±åŠ¨ç¨‹åºã€‚è¿™äº›å¯åŠ è½½çš„æ¨¡å—ä¸ºå†…æ ¸æä¾›äº†è®¿é—®ç£ç›˜å’Œç£ç›˜ä¸Šçš„æ–‡ä»¶ç³»ç»Ÿçš„æ–¹æ³•ï¼Œå¹¶ä¸ºå…¶ä»–ç¡¬ä»¶æä¾›äº†é©±åŠ¨ç¨‹åºã€‚ç”±äºæ ¹æ–‡ä»¶ç³»ç»Ÿæ˜¯ç£ç›˜ä¸Šçš„ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿï¼Œå› æ­¤ initrd å‡½æ•°ä¼šæä¾›ä¸€ç§å¯åŠ¨æ–¹æ³•æ¥è·å¾—å¯¹ç£ç›˜çš„è®¿é—®ï¼Œå¹¶æŒ‚è½½çœŸæ­£çš„æ ¹æ–‡ä»¶ç³»ç»Ÿã€‚åœ¨æ²¡æœ‰ç¡¬ç›˜çš„åµŒå…¥å¼ç›®æ ‡ä¸­ï¼Œinitrd å¯ä»¥æ˜¯æœ€ç»ˆçš„æ ¹æ–‡ä»¶ç³»ç»Ÿï¼Œæˆ–è€…ä¹Ÿå¯ä»¥é€šè¿‡ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿï¼ˆNFSï¼‰æ¥æŒ‚è½½æœ€ç»ˆçš„æ ¹æ–‡ä»¶ç³»ç»Ÿã€‚</p></blockquote><p>å¯ä»¥ä½¿ç”¨ dmesg æ¥æŸ¥çœ‹ä»åŠ è½½å†…æ ¸åçš„æµç¨‹ï¼Œä¸‹ä¸€ç¯‡åšå®¢ä¼šå†™ä» dmesg æ—¥å¿—åˆ†æ Linux å†…æ ¸å¯åŠ¨æµç¨‹ï¼ˆæŒ–å‘</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">â•­â”€root@blog /home/ubuntu</span><br><span class="line">â•°â”€# dmesg</span><br><span class="line">[    0.000000] Linux version 5.0.0-1031-gcp (buildd@lcy01-amd64-020) (gcc version 7.4.0 (Ubuntu 7.4.0-1ubuntu1~18.04.1)) #32-Ubuntu SMP Tue Feb 11 03:55:48 UTC 2020 (Ubuntu 5.0.0-1031.32-gcp 5.0.21)</span><br><span class="line">[    0.000000] Command line: BOOT_IMAGE=/boot/vmlinuz-5.0.0-1031-gcp root=PARTUUID=9b22aacc-c8b9-497a-9583-a20c1be968c4 ro scsi_mod.use_blk_mq=Y console=ttyS0</span><br><span class="line">[    0.000000] KERNEL supported cpus:</span><br><span class="line">[    0.000000]   Intel GenuineIntel</span><br><span class="line">[    0.000000]   AMD AuthenticAMD</span><br><span class="line">[    0.000000]   Hygon HygonGenuine</span><br><span class="line">[    0.000000]   Centaur CentaurHauls</span><br><span class="line">â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦</span><br><span class="line">[    2.486896] Write protecting the kernel read-only data: 22528k</span><br><span class="line">[    2.489395] Freeing unused kernel image memory: 2016K</span><br><span class="line">[    2.490937] Freeing unused kernel image memory: 1708K</span><br><span class="line">[    2.500867] x86/mm: Checked W+X mappings: passed, no W+X pages found.</span><br><span class="line">[    2.503126] x86/mm: Checking user space page tables</span><br><span class="line">[    2.513767] x86/mm: Checked W+X mappings: passed, no W+X pages found.</span><br><span class="line">[    2.516258] Run /sbin/init as init process</span><br><span class="line">[    3.992535] systemd[1]: systemd 237 running in system mode. (+PAM +AUDIT +SELINUX +IMA +APPARMOR +SMACK +SYSVINIT +UTMP +LIBCRYPTSETUP +GCRYPT +GNUTLS +ACL +XZ +LZ4 +SECCOMP +BLKID +ELFUTILS +KMOD -IDN2 +IDN -PCRE2 default-hierarchy=hybrid)</span><br><span class="line">[    4.002297] systemd[1]: Detected virtualization kvm.</span><br><span class="line">[    4.004593] systemd[1]: Detected architecture x86-64.</span><br><span class="line">[    4.031531] systemd[1]: Set hostname to &lt;blog&gt;.</span><br><span class="line">[    5.343604] systemd[1]: Reached target Swap.</span><br><span class="line">[    5.355156] systemd[1]: Started Dispatch Password Requests to Console Directory Watch.</span><br><span class="line">[    5.367360] systemd[1]: Created slice User and Session Slice.</span><br><span class="line">[    5.379321] systemd[1]: Set up automount Arbitrary Executable File Formats File System Automount Point.</span><br><span class="line">[    5.395189] systemd[1]: Started Forward Password Requests to Wall Directory Watch.</span><br><span class="line">[    5.411078] systemd[1]: Reached target Local Encrypted Volumes.</span><br><span class="line">[    5.644759] EXT4-fs (sda1): re-mounted. Opts: (null)</span><br><span class="line">[   11.663490] bpfilter: Loaded bpfilter_umh pid 456</span><br></pre></td></tr></table></figure><h3 id="init-åˆå§‹åŒ–é˜¶æ®µ"><a href="#init-åˆå§‹åŒ–é˜¶æ®µ" class="headerlink" title="init åˆå§‹åŒ–é˜¶æ®µ"></a>init åˆå§‹åŒ–é˜¶æ®µ</h3><p>ä¸€æ—¦å†…æ ¸è‡ªè§£å‹å®Œæˆï¼Œå¯åŠ¨å¹¶åˆå§‹åŒ–åï¼Œå†…æ ¸å¯åŠ¨ç¬¬ä¸€ä¸ª<strong>ç”¨æˆ·ç©ºé—´åº”ç”¨ç¨‹åº</strong>ï¼Œå³ systemd è¿›ç¨‹ï¼ˆå…¶æ˜¯è€å¼ System V ç³»ç»Ÿçš„ init ç¨‹åºçš„æ›¿ä»£å“)ï¼Œå¹¶è½¬ç§»æ§åˆ¶æƒåˆ° systemdã€‚è¿™æ˜¯è°ƒç”¨çš„ç¬¬ä¸€ä¸ªä½¿ç”¨æ ‡å‡† C åº“ç¼–è¯‘çš„ç¨‹åºï¼Œåœ¨æ­¤è¿›ç¨‹ä¹‹å‰ï¼Œè¿˜æ²¡æœ‰æ‰§è¡Œä»»ä½•æ ‡å‡†çš„ C åº”ç”¨ç¨‹åºã€‚è‡³æ­¤æ•´ä¸ªç³»ç»Ÿå¼•å¯¼è¿‡ç¨‹çš„ç»“æŸï¼Œkernelå’Œ systemd å¤„äºè¿è¡ŒçŠ¶æ€ï¼Œæ¥ä¸‹æ¥å°±ç”± systemd æ¥å¯åŠ¨å„é¡¹ç¨‹åºã€‚</p><p>ä» dmesg çš„è¾“å‡ºæ—¥å¿—æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œç›´åˆ° 2.516258 ç§’æ‰å¼€å§‹æ‰§è¡Œ <code>/sbin/init</code> å‘½ä»¤ï¼Œè€Œå¯¹äºé‡‡ç”¨ systemd çš„å‘è¡Œç‰ˆæ¥è¯´ï¼Œ<code>/sbin/init</code> æ˜¯æŒ‡å‘ <code>/sbin/init -&gt; /lib/systemd/systemd</code> ï¼Œçš„é“¾æ¥æ–‡ä»¶ï¼Œå®é™…ä¸Šå°±æ˜¯åœ¨å¯åŠ¨ systemd ğŸ˜‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[    2.516258] Run /sbin/init as init process</span><br><span class="line">[    3.992535] systemd[1]: systemd 237 running in system mode. (+PAM +AUDIT +SELINUX +IMA +APPARMOR +SMACK +SYSVINIT +UTMP +LIBCRYPTSETUP +GCRYPT +GNUTLS +ACL +XZ +LZ4 +SECCOMP +BLKID +ELFUTILS +KMOD -IDN2 +IDN -PCRE2 default-hierarchy=hybrid)</span><br></pre></td></tr></table></figure><h2 id="ä¸»è§’-systemd"><a href="#ä¸»è§’-systemd" class="headerlink" title="ä¸»è§’ systemd"></a>ä¸»è§’ systemd</h2><p>ä¸ºä»€ä¹ˆæ–‡ç« é¢˜åä¸º <strong>Linux çš„å°ä¼™ä¼´ systemd</strong> å‘ï¼Œå…¶å®å¹¿ä¹‰ä¸Šæ¥è®² Linux æ˜¯ä¼—å¤š Linux ç³»ç»Ÿå‘è¡Œç‰ˆçš„é›†åˆï¼Œä½†ä¸¥æ ¼æ¥è®² Linux ä»…ä»…æ˜¯ä¸€ä¸ª OS çš„ kernel è€Œå·²ï¼Œä»…ä»…æœ‰ä¸€ä¸ªå†…æ ¸æ˜¯æ— æ³•ç»„æˆä¸€ä¸ªç³»ç»Ÿçš„ï¼Œæ‰€ä»¥ Linux kernel è¿˜éœ€è¦ä»–çš„å‡ ä¸ªå…„å¼Ÿæ¯”å¦‚ GNU ã€ systemd ã€X Window ã€GNOME ã€ KDE ã€Xfce ç­‰ç­‰å…¶ä»–ç”¨æˆ·å±‚é¢çš„ç¨‹åºæ¥æ„å»ºå‡ºä¸€å¥—å®Œæ•´çš„æ“ä½œç³»ç»Ÿå‡ºæ¥ã€‚</p><p>è¿˜æœ‰å¦‚æœä½ è¦æ˜¯å½“ç€è‡ªç”±è½¯ä»¶åŸºé‡‘ä¼šä¸»å¸­ RMS <a href="https://zh.wikipedia.org/wiki/%E7%90%86%E6%9F%A5%E5%BE%B7%C2%B7%E6%96%AF%E6%89%98%E6%9B%BC" target="_blank" rel="noopener">ç†æŸ¥å¾·Â·æ–¯æ‰˜æ›¼</a> è¯´ Linux çš„è¯ï¼Œä»–ä¼šç»™ä½ å‘ç«å“¦ï¼Œä½ è¦è¯´ GNU/Linux æ‰è¡ŒğŸ˜‚ã€‚</p><p>å°† Debian å“²å­¦ä¸æ–¹æ³•è®ºï¼ŒGNU å·¥å…·é›†ã€Linux å†…æ ¸ï¼Œä»¥åŠå…¶ä»–é‡è¦çš„è‡ªç”±è½¯ä»¶ç»“åˆåœ¨ä¸€èµ·æ‰€æ„æˆçš„ç‹¬ç‰¹çš„è½¯ä»¶å‘è¡Œç‰ˆç§°ä¸º Debian GNU/Linuxã€‚å½“ä½ å°† Debian çš„å®‰è£…é•œåƒåˆ»å½•åˆ° U ç›˜ä¹‹åæ˜¾ç¤ºçš„åç§°å°±æ˜¯ <code>Debian GNU/Linux</code> ã€‚å…³äº GNU å’Œ Linux çš„æ•…äº‹å¯ä»¥å»çœ‹ä¸€å“ˆ <a href="https://zh.wikipedia.org/zh-cn/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E9%9D%A9%E5%91%BD" target="_blank" rel="noopener">æ“ä½œç³»ç»Ÿé©å‘½</a> çºªå½•ç‰‡ï¼Œä»¥åŠ RMS çš„è‡ªä¼ ã€Šè‹¥ä¸ºè‡ªç”±æ•…ï¼šè‡ªç”±è½¯ä»¶ä¹‹çˆ¶ç†æŸ¥å¾·Â·æ–¯æ‰˜æ›¼ä¼ ã€‹ä»¥åŠ Linus çš„è‡ªä¼ ã€Šåªæ˜¯ä¸ºäº†å¥½ç©å„¿ã€‹ã€‚</p><h3 id="systemd-ç®€ä»‹"><a href="#systemd-ç®€ä»‹" class="headerlink" title="systemd ç®€ä»‹"></a>systemd ç®€ä»‹</h3><p>è®²å®Œäº† Linux ç³»ç»Ÿå¯åŠ¨çš„æµç¨‹ï¼Œæ¥ä¸‹æ¥å°±åˆ°äº†æœ¬æ–‡çš„ä¸»è§’ <code>systemd</code> ä¸Šåœºå•¦ã€‚å‰½çªƒä¸€æ®µ archlinux.org ä¸Šçš„æ–‡æ¡£æ¥ä»‹ç»ä¸€ä¸‹ systemd ã€‚ï¼ˆarchlinux çš„æ–‡æ¡£æ˜¯åšçš„æœ€å¥½çš„å“¦ï¼</p><blockquote><p><em>systemd</em> æ˜¯ä¸€ä¸ª Linux ç³»ç»ŸåŸºç¡€ç»„ä»¶çš„é›†åˆï¼Œæä¾›äº†ä¸€ä¸ªç³»ç»Ÿå’ŒæœåŠ¡ç®¡ç†å™¨ï¼Œè¿è¡Œä¸º PID 1 å¹¶è´Ÿè´£å¯åŠ¨å…¶å®ƒç¨‹åºã€‚åŠŸèƒ½åŒ…æ‹¬ï¼š</p><ul><li>æ”¯æŒå¹¶è¡ŒåŒ–ä»»åŠ¡ï¼›</li><li>åŒæ—¶é‡‡ç”¨ socket å¼ä¸ <a href="https://wiki.archlinux.org/index.php/D-Bus_(ç®€ä½“ä¸­æ–‡)" target="_blank" rel="noopener">D-Bus</a> æ€»çº¿å¼æ¿€æ´»æœåŠ¡ï¼›</li><li>æŒ‰éœ€å¯åŠ¨å®ˆæŠ¤è¿›ç¨‹ï¼ˆdaemonï¼‰ï¼›</li><li>åˆ©ç”¨ Linux çš„ <a href="https://wiki.archlinux.org/index.php/Cgroups" target="_blank" rel="noopener">cgroups</a> ç›‘è§†è¿›ç¨‹ï¼› # æœ¬æ–‡å¼€ç¯‡è®²åˆ°çš„ systemctl æ˜¾ç¤º CPU å’Œ  Mem ä¿¡æ¯å°±æ˜¯åŸºäºæ­¤å“¦ã€‚</li><li>æ”¯æŒå¿«ç…§å’Œç³»ç»Ÿæ¢å¤ï¼›</li><li>ç»´æŠ¤æŒ‚è½½ç‚¹å’Œè‡ªåŠ¨æŒ‚è½½ç‚¹ï¼›</li><li>å„æœåŠ¡é—´åŸºäºä¾èµ–å…³ç³»è¿›è¡Œç²¾å¯†æ§åˆ¶ã€‚</li><li>systemd* æ”¯æŒ SysV å’Œ LSB åˆå§‹è„šæœ¬ï¼Œå¯ä»¥æ›¿ä»£ sysvinitã€‚</li><li>é™¤æ­¤ä¹‹å¤–ï¼ŒåŠŸèƒ½è¿˜åŒ…æ‹¬æ—¥å¿—è¿›ç¨‹ã€æ§åˆ¶åŸºç¡€ç³»ç»Ÿé…ç½®ï¼Œç»´æŠ¤ç™»é™†ç”¨æˆ·åˆ—è¡¨ä»¥åŠç³»ç»Ÿè´¦æˆ·ã€è¿è¡Œæ—¶ç›®å½•å’Œè®¾ç½®ï¼Œå¯ä»¥è¿è¡Œå®¹å™¨å’Œè™šæ‹Ÿæœºï¼Œå¯ä»¥ç®€å•çš„ç®¡ç†ç½‘ç»œé…ç½®ã€ç½‘ç»œæ—¶é—´åŒæ­¥ã€æ—¥å¿—è½¬å‘å’Œåç§°è§£æç­‰ã€‚</li></ul></blockquote><p>è¿˜æœ‰ä¸€æ®µæ‘˜è‡ª <a href="https://systemd.io/" target="_blank" rel="noopener">systemd.io</a></p><blockquote><p>systemd is a suite of basic building blocks for a Linux system. It provides a system and service manager that runs as PID 1 and starts the rest of the system.</p><p>systemd provides aggressive parallelization capabilities, uses socket and D-Bus activation for starting services, offers on-demand starting of daemons, keeps track of processes using Linux control groups, maintains mount and automount points, and implements an elaborate transactional dependency-based service control logic. systemd supports SysV and LSB init scripts and works as a replacement for sysvinit.</p><p>Other parts include a logging daemon, utilities to control basic system configuration like the hostname, date, locale, maintain a list of logged-in users and running containers and virtual machines, system accounts, runtime directories and settings, and daemons to manage simple network configuration, network time synchronization, log forwarding, and name resolution.</p></blockquote><h3 id="systemd-è®¾è®¡ç›®æ ‡"><a href="#systemd-è®¾è®¡ç›®æ ‡" class="headerlink" title="systemd è®¾è®¡ç›®æ ‡"></a>systemd è®¾è®¡ç›®æ ‡</h3><ul><li>æ”¹è¿›æ•ˆèƒ½ã€‚ä½¿ç”¨äºŒè¿›åˆ¶ä»£ç æ›¿æ¢æ¾æ•£çš„SYSVå¯åŠ¨è„šæœ¬ï¼Œå‡å°‘é¢‘ç¹çš„è¿›ç¨‹åˆ›å»ºï¼Œåº“åŠ è½½ï¼Œå†…æ ¸/ç”¨æˆ·åˆ‡æ¢ã€‚</li><li>åˆ©ç”¨ Dbus è¿›ç¨‹é—´é€šè®¯ä¸ socket æ¿€æ´»æœºåˆ¶ï¼Œè§£å†³ä»»åŠ¡å¯åŠ¨æ—¶çš„ä¾èµ–é—®é¢˜ï¼Œå®ç°å¯åŠ¨å¹¶è¡ŒåŒ–ã€‚</li><li>å®ç°ä»»åŠ¡ï¼ˆdaemonsï¼‰çš„ç²¾ç¡®æ§åˆ¶ã€‚ä½¿ç”¨å†…æ ¸çš„ cgroup æœºåˆ¶ï¼Œä¸ä¾èµ– pid æ¥è¿½è¸ªè¿›ç¨‹ï¼Œå³ä½¿æ˜¯ä¸¤æ¬¡ forkä¹‹åç”Ÿæˆçš„å®ˆæŠ¤è¿›ç¨‹ä¹Ÿä¸ä¼šè„±ç¦» systemd çš„æ§åˆ¶ã€‚</li><li>ç»Ÿä¸€ä»»åŠ¡å®šä¹‰ã€‚ç”¨æˆ·ä¸éœ€è¦è‡ªè¡Œç¼–å†™ shell è„šæœ¬ï¼Œè€Œä»…ä¾æ® systemd åˆ¶å®šçš„ unit è§„åˆ™ã€‚</li></ul><h3 id="systemd-ä½“ç³»æ¶æ„"><a href="#systemd-ä½“ç³»æ¶æ„" class="headerlink" title="systemd ä½“ç³»æ¶æ„"></a>systemd ä½“ç³»æ¶æ„</h3><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/systemd_components-svg.png" alt="img"></p><ul><li>æœ€åº•å±‚ï¼šsystemd å†…æ ¸å±‚é¢ä¾èµ– cgroupã€autofsã€kdbus</li><li>ç¬¬äºŒå±‚ï¼šsystemd libraries æ˜¯ systemd ä¾èµ–åº“</li><li>ç¬¬ä¸‰å±‚ï¼šsystemd Core æ˜¯ systemd è‡ªå·±çš„åº“</li><li>ç¬¬å››å±‚ï¼šsystemd daemons ä»¥åŠ targets æ˜¯è‡ªå¸¦çš„ä¸€äº›åŸºæœ¬ unitã€targetï¼Œç±»ä¼¼äº sysvinit ä¸­è‡ªå¸¦çš„è„šæœ¬</li><li>æœ€ä¸Šå±‚å°±æ˜¯å’Œ  systemd äº¤äº’çš„ä¸€äº›å·¥å…·</li></ul><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/linux_kernel_unified_hierarchy_cgroups_and_systemd-svg.png" alt="img"></p><h3 id="systemd-unit"><a href="#systemd-unit" class="headerlink" title="systemd unit"></a>systemd unit</h3><p>systemd å°†å„ç§ç³»ç»Ÿå¯åŠ¨å’Œè¿è¡Œç›¸å…³çš„å¯¹è±¡ï¼Œ è¡¨ç¤ºä¸ºå„ç§ä¸åŒç±»å‹çš„å•å…ƒ<code>unit</code>ï¼Œ å¹¶æä¾›äº† å¤„ç†ä¸åŒå•å…ƒä¹‹é—´ä¾èµ–å…³ç³»çš„èƒ½åŠ›ã€‚</p><table><thead><tr><th align="center">type</th><th align="center">name</th><th align="left">ä½œç”¨</th></tr></thead><tbody><tr><td align="center">Service unit</td><td align="center">.service</td><td align="left">ç”¨äºå°è£…ä¸€ä¸ªåå°æœåŠ¡è¿›ç¨‹</td></tr><tr><td align="center">Target unit</td><td align="center">.target</td><td align="left">ç”¨äºå°†å¤šä¸ªå•å…ƒåœ¨é€»è¾‘ä¸Šç»„åˆåœ¨ä¸€èµ·ã€‚</td></tr><tr><td align="center">Device unit</td><td align="center">.device</td><td align="left">ç”¨äºå®šä¹‰å†…æ ¸è¯†åˆ«çš„è®¾å¤‡ï¼Œåœ¨ sysfs(5) é‡Œé¢ä½œä¸º udev(7) è®¾å¤‡æ ‘å±•ç¤º</td></tr><tr><td align="center">Socket unit</td><td align="center">.socket</td><td align="left">ç”¨äºæ ‡è¯†è¿›ç¨‹é—´é€šä¿¡ç”¨åˆ°çš„socketæ–‡ä»¶</td></tr><tr><td align="center">Snapshot unit</td><td align="center">.snapshot</td><td align="left">ç®¡ç†ç³»ç»Ÿå¿«ç…§</td></tr><tr><td align="center">Swap unit</td><td align="center">.swap</td><td align="left">ç”¨äºæ ‡è¯†swap æ–‡ä»¶æˆ–è®¾å¤‡</td></tr><tr><td align="center">Mount unit</td><td align="center">.mount</td><td align="left">ç”¨äºå°è£…ä¸€ä¸ªæ–‡ä»¶ç³»ç»ŸæŒ‚è½½ç‚¹(ä¹Ÿå‘åå…¼å®¹ä¼ ç»Ÿçš„ /etc/fstab æ–‡ä»¶)</td></tr><tr><td align="center">Automount unit</td><td align="center">.automount</td><td align="left">ç”¨äºå°è£…ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿè‡ªåŠ¨æŒ‚è½½ç‚¹</td></tr><tr><td align="center">Path unit</td><td align="center">.path</td><td align="left">ç”¨äºæ ¹æ®æ–‡ä»¶ç³»ç»Ÿä¸Šç‰¹å®šå¯¹è±¡çš„å˜åŒ–æ¥å¯åŠ¨å…¶ä»–æœåŠ¡ã€‚</td></tr><tr><td align="center">Time unit</td><td align="center">.timer</td><td align="left">ç”¨äºå°è£…ä¸€ä¸ªåŸºäºæ—¶é—´è§¦å‘çš„åŠ¨ä½œã€‚å–ä»£ä¼ ç»Ÿçš„ crond ç­‰ä»»åŠ¡è®¡åˆ’æœåŠ¡</td></tr><tr><td align="center">Slice unit</td><td align="center">*.slice</td><td align="left">ç”¨äºæ§åˆ¶ç‰¹å®š CGroup å†…æ‰€æœ‰è¿›ç¨‹çš„æ€»ä½“èµ„æºå ç”¨ã€‚</td></tr></tbody></table><p>éœ€è¦æ³¨æ„çš„æ˜¯ systemd åªåœ¨å†…å­˜ä¸­åŠ è½½æœ€å°åŒ–çš„ä¸€ç»„å•å…ƒã€‚ åªæœ‰è‡³å°‘æ»¡è¶³ä¸‹åˆ—æ¡ä»¶ä¹‹ä¸€çš„å•å…ƒï¼Œæ‰ä¼šè¢«åŠ è½½åˆ°å†…å­˜ä¸­ï¼š</p><ul><li><p>å¤„äº æ´»åŠ¨(active)ã€å¯åŠ¨ä¸­(activating)ã€åœæ­¢ä¸­(deactivating)ã€å¤±è´¥(failed) çŠ¶æ€ä¹‹ä¸€(ä¹Ÿå°±æ˜¯åœæ­¢(inactive)ä¹‹å¤–çš„çŠ¶æ€)</p></li><li><p>è‡³å°‘æœ‰ä¸€ä¸ªä½œä¸šæ­£åœ¨ä½œä¸šé˜Ÿåˆ—ä¸­</p></li><li><p>è‡³å°‘æœ‰ä¸€ä¸ªå…¶ä»–å·²ç»åŠ è½½åˆ°å†…å­˜ä¸­çš„å•å…ƒä¾èµ–äºå®ƒ</p></li><li><p>ä»ç„¶å æœ‰æŸäº›èµ„æº (ä¾‹å¦‚ä¸€ä¸ªå·²åœæ­¢çš„æœåŠ¡å•å…ƒçš„è¿›ç¨‹å¿½ç•¥äº†ç»ˆæ­¢è¯·æ±‚ï¼Œä»åœ¨é€—ç•™)</p></li><li><p>è¢« D-Bus è°ƒç”¨ä»¥ç¨‹åºåŒ–çš„æ–¹å¼å›ºå®šåˆ°äº†å†…å­˜ä¸­</p></li></ul><blockquote><p>åªè¦æœ‰éœ€è¦ï¼Œsystemd å°±ä¼šè‡ªåŠ¨ä»ç£ç›˜åŠ è½½æ‰€éœ€çš„å•å…ƒã€‚ å› æ­¤å®é™…ä¸Šç”¨æˆ·å¹¶ä¸èƒ½æ˜¾è€Œæ˜“è§çš„çœ‹åˆ°æŸä¸ªå•å…ƒæ˜¯å¦å·²è¢«åŠ è½½åˆ°å†…å­˜ã€‚ ä½¿ç”¨ <strong>systemctl list-units â€“all</strong> å‘½ä»¤å¯ä»¥æ˜¾ç¤ºå½“å‰å·²åŠ è½½åˆ°å†…å­˜ä¸­çš„æ‰€æœ‰å•å…ƒã€‚ ä¸æ»¡è¶³åŠ è½½æ¡ä»¶(è§ä¸Šæ–‡)çš„å•å…ƒä¼šè¢«ç«‹å³ä»å†…å­˜ä¸­å¸è½½ï¼Œå¹¶ä¸”å®ƒçš„è®°å¸æ•°æ®(accounting data)ä¹Ÿä¼šè¢«æ¸…ç©ºã€‚ ä¸è¿‡ï¼Œå› ä¸ºæ¯å½“ä¸€ä¸ªå•å…ƒå…³é—­æ—¶ï¼Œéƒ½ä¼šç”Ÿæˆä¸€æ¡æ—¥å¿—è®°å½•å£°æ˜è¯¥å•å…ƒæ‰€æ¶ˆè€—çš„èµ„æºï¼Œ æ‰€ä»¥è¿™äº›æ•°æ®é€šå¸¸ä¸ä¼šå½»åº•æ¶ˆå¤±ã€‚</p></blockquote><h3 id="systemd-unit-é…ç½®æ–‡ä»¶"><a href="#systemd-unit-é…ç½®æ–‡ä»¶" class="headerlink" title="systemd unit é…ç½®æ–‡ä»¶"></a>systemd unit é…ç½®æ–‡ä»¶</h3><ul><li>åœ¨ CentOS/RedHat å‘è¡Œç‰ˆä¸­ <code>man systemd.unit</code></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Table 1.  Load path when running in system mode (--system).</span><br><span class="line">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br><span class="line">â”‚Path                    â”‚ Description                 â”‚</span><br><span class="line">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span><br><span class="line">â”‚&#x2F;etc&#x2F;systemd&#x2F;system     â”‚ Local configuration         â”‚</span><br><span class="line">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span><br><span class="line">â”‚&#x2F;run&#x2F;systemd&#x2F;system     â”‚ Runtime units               â”‚</span><br><span class="line">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span><br><span class="line">â”‚&#x2F;usr&#x2F;lib&#x2F;systemd&#x2F;system â”‚ Units of installed packages â”‚</span><br><span class="line">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br></pre></td></tr></table></figure><ul><li>åœ¨ Ubuntu/Debian å‘è¡Œç‰ˆä¸­ <code>man systemd.unit</code></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Table 1.  Load path when running in system mode (--system).</span><br><span class="line">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br><span class="line">â”‚Path                â”‚ Description                 â”‚</span><br><span class="line">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span><br><span class="line">â”‚&#x2F;etc&#x2F;systemd&#x2F;system â”‚ Local configuration         â”‚</span><br><span class="line">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span><br><span class="line">â”‚&#x2F;run&#x2F;systemd&#x2F;system â”‚ Runtime units               â”‚</span><br><span class="line">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span><br><span class="line">â”‚&#x2F;lib&#x2F;systemd&#x2F;system â”‚ Units of installed packages â”‚</span><br><span class="line">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br></pre></td></tr></table></figure><p>ä¸åŒçš„å‘è¡Œç‰ˆ systemd unit çš„ path ä¸ä¸€æ ·å“¦ï¼Œä¸è¿‡ systemd çš„é…ç½®æ–‡ä»¶ä¸»è¦ä½äºä»¥ä¸‹ä¸‰ä¸ªç›®å½•ä¸­</p><ul><li><p><code>/usr/lib/systemd/system</code> æˆ– <code>/lib/systemd</code> : ä½¿ç”¨åŒ…ç®¡ç†å™¨å®‰è£…çš„è½¯ä»¶çš„ systemd unit ä»¶å®é™…é…ç½®æ–‡ä»¶çš„å­˜æ”¾ä½ç½®</p></li><li><p><code>/run/systemd/system</code>ï¼šåœ¨è¿è¡Œæ—¶åˆ›å»ºçš„s ystemd unit æ–‡ä»¶ã€‚è¯¥ç›®å½•ä¼˜å…ˆäºå·²å®‰è£…æœåŠ¡å•å…ƒæ–‡ä»¶çš„ç›®å½•ã€‚</p><p>  <code>/etc/systemd/system</code>:  ä¼˜å…ˆçº§æœ€é«˜ï¼Œç”± systemctl å‘½ä»¤åˆ›å»ºçš„ systemd unit æ–‡ä»¶ä»¥åŠä¸ºæ‰©å±•æœåŠ¡è€Œæ·»åŠ çš„ unit æ–‡ä»¶éƒ½å°†å¯ç”¨ã€‚</p></li></ul><p>åœ¨ä½¿ç”¨ yum/apt æˆ–å…¶ä»–åŒ…ç®¡ç†å™¨ï¼Œä»¥åŠ rpm/deb ç­‰è½¯ä»¶åŒ…å®‰è£…è½¯ä»¶çš„æ—¶å€™ï¼Œå¦‚æœè¯¥è½¯ä»¶æ”¯æŒ systemd ç®¡ç†çš„è¯ï¼Œå°±ä¼šè‡ªåŠ¨åœ¨<code>/usr/lib/systemd/system</code>ç›®å½•æ·»åŠ ä¸€ä¸ªé…ç½®æ–‡ä»¶ã€‚å¯ä»¥ç”¨è¿‡  systemctl cat name æ¥æŸ¥çœ‹è¯¥è½¯ä»¶çš„  systemd å•å…ƒæ–‡ä»¶ï¼Œæ¯”å¦‚æŸ¥çœ‹ä¸€ä¸‹ nginx çš„ <code>nginx.service</code> æ–‡ä»¶</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">â•­â”€root@sg-02 ~</span><br><span class="line">â•°â”€# systemctl cat nginx                                                                                         1 â†µ</span><br><span class="line"><span class="meta">#</span><span class="bash"> /lib/systemd/system/nginx.service</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Stop dance <span class="keyword">for</span> nginx</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> =======================</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ExecStop sends SIGSTOP (graceful stop) to the nginx process.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> If, after 5s (--retry QUIT/5) nginx is still running, systemd takes control</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> and sends SIGTERM (fast shutdown) to the main process.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> After another 5s (TimeoutStopSec=5), and <span class="keyword">if</span> nginx is alive, systemd sends</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> SIGKILL to all the remaining processes <span class="keyword">in</span> the process group (KillMode=mixed).</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> nginx signals reference doc:</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> http://nginx.org/en/docs/control.html</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line">[Unit]</span><br><span class="line">Description=A high performance web server and a reverse proxy server</span><br><span class="line">Documentation=man:nginx(8)</span><br><span class="line">After=network.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=forking</span><br><span class="line">PIDFile=/run/nginx.pid</span><br><span class="line">ExecStartPre=/usr/sbin/nginx -t -q -g 'daemon on; master_process on;'</span><br><span class="line">ExecStart=/usr/sbin/nginx -g 'daemon on; master_process on;'</span><br><span class="line">ExecReload=/usr/sbin/nginx -g 'daemon on; master_process on;' -s reload</span><br><span class="line">ExecStop=-/sbin/start-stop-daemon --quiet --stop --retry QUIT/5 --pidfile /run/nginx.pid</span><br><span class="line">TimeoutStopSec=5</span><br><span class="line">KillMode=mixed</span><br><span class="line"></span><br><span class="line">[Install]</span><br></pre></td></tr></table></figure><p>å¦‚æœè½¯ä»¶æ²¡æœ‰è‡ªå¸¦ systemd é…ç½®æ–‡ä»¶çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå·±æ“ä¸€ä¸ªé…ç½®æ–‡ä»¶å‡ºæ¥ï¼Œå¹¶å¤åˆ¶åˆ°ç›¸åº”çš„ç›®å½•ä¸‹å³å¯ã€‚æ¯”æˆ‘æˆ‘ä»¬çš„ <a href="https://github.com/webp-sh/webp_server_go" target="_blank" rel="noopener">Webp Server Go</a> çš„ <code>webps.service</code></p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[Unit]</span></span><br><span class="line"><span class="attr">Description</span>=WebP Server Go</span><br><span class="line"><span class="attr">Documentation</span>=https://github.com/webp-sh/webp_server_go</span><br><span class="line"><span class="attr">After</span>=nginx.target</span><br><span class="line"></span><br><span class="line"><span class="section">[Service]</span></span><br><span class="line"><span class="attr">Type</span>=simple</span><br><span class="line"><span class="attr">StandardError</span>=journal</span><br><span class="line"><span class="attr">WorkingDirectory</span>=/opt/webps</span><br><span class="line"><span class="attr">ExecStart</span>=/opt/webps/webp-server --config /opt/webps/config.json</span><br><span class="line"><span class="attr">Restart</span>=always</span><br><span class="line"><span class="attr">RestartSec</span>=<span class="number">3</span>s</span><br><span class="line"></span><br><span class="line"><span class="section">[Install]</span></span><br><span class="line"><span class="attr">WantedBy</span>=multi-user.target</span><br></pre></td></tr></table></figure><p>å…³äº systemd çš„å•å…ƒé…ç½®æ–‡ä»¶å¦‚ä½•ä¹¦å†™ï¼Œå› ä¸ºæ ¹æ®ä¸åŒçš„å•å…ƒç±»å‹åŒ…å«çš„é…ç½®é¡¹å®åœ¨æ˜¯å·¨å¤šã€‚ä¸æ˜¯ä¸‰è¨€ä¸¤è¯­å°±èƒ½è®²æ¸…çš„ï¼Œæ‰€ä»¥å¤§å®¶è¿˜æ˜¯å‚è€ƒä¸€ä¸‹ systemd çš„å®˜æ–¹æ–‡æ¡£/ç¤¾åŒºç¿»è¯‘æ–‡æ¡£ã€‚æ¯”å¦‚ <a href="http://www.jinbuguo.com/systemd/systemd.index.html" target="_blank" rel="noopener">systemd (ç®€ä½“ä¸­æ–‡)</a>ã€‚</p><h3 id="é“¾æ¥æ–‡ä»¶"><a href="#é“¾æ¥æ–‡ä»¶" class="headerlink" title="é“¾æ¥æ–‡ä»¶"></a>é“¾æ¥æ–‡ä»¶</h3><p>å½“æˆ‘ä»¬ä½¿ç”¨ reboot ã€poweroff ã€shutdown ç­‰å‘½ä»¤çš„æ—¶å€™ï¼Œå…¶å®å¹¶ä¸æ˜¯æ‰§è¡Œè¯¥å‘½ä»¤æœ¬èº«ï¼ŒèƒŒåæ˜¯è°ƒç”¨çš„ systemctl å‘½ä»¤ã€‚systemctl å‘½ä»¤ä¼šå°† reboot è¿™äº›å‘½ä»¤ä½œä¸º $1 å‚æ•°ä¼ é€’è¿›å»ã€‚æ‰€ä»¥æ‰§è¡Œ reboot å’Œ systemctl reboot æœ¬è´¨ä¸Šæ˜¯ä¸€æ ·çš„ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">â•­â”€root@gitlab /sbin</span><br><span class="line">â•°â”€# ls -alh /usr/bin /sbin /bin /usr/local/bin  | grep systemctl</span><br><span class="line">-rwxr-xr-x  1 root root 179K Feb  5 01:07 systemctl</span><br><span class="line">lrwxrwxrwx  1 root root      14 Feb  5 01:07 halt -&gt; /bin/systemctl</span><br><span class="line">lrwxrwxrwx  1 root root      14 Feb  5 01:07 poweroff -&gt; /bin/systemctl</span><br><span class="line">lrwxrwxrwx  1 root root      14 Feb  5 01:07 reboot -&gt; /bin/systemctl</span><br><span class="line">lrwxrwxrwx  1 root root      14 Feb  5 01:07 runlevel -&gt; /bin/systemctl</span><br><span class="line">lrwxrwxrwx  1 root root      14 Feb  5 01:07 shutdown -&gt; /bin/systemctl</span><br><span class="line">lrwxrwxrwx  1 root root      14 Feb  5 01:07 telinit -&gt; /bin/systemctl</span><br></pre></td></tr></table></figure><p>è¿˜æœ‰å‰æ–‡æåˆ°çš„æœ‰ä¸€ç‚¹å°±æ˜¯ç»å¤§å¤šæ•°ä½¿ç”¨ systemd çš„å‘è¡Œç‰ˆéƒ½è®¾ç½®äº†ä¸€ä¸ªè½¯è¿æ¥ï¼Œç”± <code>/sbin/init -&gt; /lib/systemd/systemd</code>ã€‚å¦å¤–åœ¨ <code>/etc/systemd</code> ä¸‹ä¹Ÿæœ‰å¾ˆå¤šé“¾æ¥æ–‡ä»¶ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥å»åˆ†æä¸€ä¸‹ã€‚</p><h3 id="systemd-å¯åŠ¨æµç¨‹"><a href="#systemd-å¯åŠ¨æµç¨‹" class="headerlink" title="systemd å¯åŠ¨æµç¨‹"></a>systemd å¯åŠ¨æµç¨‹</h3><p>å›åˆ° Linux å¯åŠ¨æµç¨‹ï¼Œå½“å†…æ ¸åŠ è½½åˆ°å†…å­˜ä¸­åå¼€å§‹æ‰§è¡Œ systemd ã€‚æ ¹æ® dmesg çš„æ—¥å¿—æˆ‘ä»¬å¯ä»¥äº†è§£åˆ° systemd å¯åŠ¨åæ‰§è¡Œäº†å“ªä¸€äº›æ“ä½œã€‚</p><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[    <span class="number">2</span><span class="variable">.516258</span>] Run /sbin/init as init process</span><br><span class="line">[    <span class="number">3</span><span class="variable">.992535</span>] systemd[<span class="number">1</span>]: systemd <span class="number">237</span> running in system mode. (+PAM +AUDIT +SELINUX +IMA +APPARMOR +SMACK +SYSVINIT +UTMP +LIBCRYPTSETUP +GCRYPT +GNUTLS +ACL +XZ +LZ4 +SECCOMP +BLKID +ELFUTILS +KMOD -IDN2 +IDN -PCRE2 <span class="keyword">default</span>-hierarchy=hybrid)</span><br><span class="line">[    <span class="number">4</span><span class="variable">.002297</span>] systemd[<span class="number">1</span>]: Detected virtualization kvm.</span><br><span class="line">[    <span class="number">4</span><span class="variable">.004593</span>] systemd[<span class="number">1</span>]: Detected architecture x86-<span class="number">64</span>.</span><br><span class="line">[    <span class="number">4</span><span class="variable">.031531</span>] systemd[<span class="number">1</span>]: Set hostname to &lt;blog&gt;.</span><br><span class="line">[    <span class="number">5</span><span class="variable">.343604</span>] systemd[<span class="number">1</span>]: Reached target Swap.</span><br><span class="line">[    <span class="number">5</span><span class="variable">.355156</span>] systemd[<span class="number">1</span>]: Started Dispatch Password Requests to Console Directory Watch.</span><br><span class="line">[    <span class="number">5</span><span class="variable">.367360</span>] systemd[<span class="number">1</span>]: Created slice User <span class="keyword">and</span> Session Slice.</span><br><span class="line">[    <span class="number">5</span><span class="variable">.379321</span>] systemd[<span class="number">1</span>]: Set up automount Arbitrary Executable File Formats File System Automount Point.</span><br><span class="line">[    <span class="number">5</span><span class="variable">.395189</span>] systemd[<span class="number">1</span>]: Started Forward Password Requests to Wall Directory Watch.</span><br><span class="line">[    <span class="number">5</span><span class="variable">.411078</span>] systemd[<span class="number">1</span>]: Reached target Local Encrypted Volumes.</span><br><span class="line">[    <span class="number">5</span><span class="variable">.644759</span>] EXT4-fs (sda1): re-mounted. Opts: (<span class="literal">null</span>)</span><br><span class="line">[    <span class="number">5</span><span class="variable">.702603</span>] RPC: Registered named UNIX socket transport <span class="keyword">module</span>.</span><br><span class="line">[    <span class="number">5</span><span class="variable">.704115</span>] RPC: Registered udp transport <span class="keyword">module</span>.</span><br><span class="line">[    <span class="number">5</span><span class="variable">.705318</span>] RPC: Registered tcp transport <span class="keyword">module</span>.</span><br><span class="line">[    <span class="number">5</span><span class="variable">.706573</span>] RPC: Registered tcp NFSv4<span class="variable">.1</span> backchannel transport <span class="keyword">module</span>.</span><br><span class="line">[    <span class="number">5</span><span class="variable">.825727</span>] Loading iSCSI transport <span class="keyword">class</span> v2<span class="variable">.0</span>-<span class="number">870</span>.</span><br><span class="line">[    <span class="number">5</span><span class="variable">.912079</span>] iscsi: registered transport (tcp)</span><br><span class="line">[    <span class="number">5</span><span class="variable">.942499</span>] systemd-journald[<span class="number">196</span>]: Received request to flush runtime journal from PID <span class="number">1</span></span><br><span class="line">[    <span class="number">5</span><span class="variable">.973269</span>] systemd-journald[<span class="number">196</span>]: File /<span class="keyword">var</span>/log/journal/<span class="number">7</span>bc72ce3e0aa559e38159aa4fa0547f9/system<span class="variable">.journal</span> corrupted <span class="keyword">or</span> uncleanly shut down, renaming <span class="keyword">and</span> replacing.</span><br></pre></td></tr></table></figure><blockquote><p>ä¸‹é¢çš„å›¾è¡¨è§£é‡Šäº† è¿™äº›å…·æœ‰ç‰¹å®šå«ä¹‰çš„ target å•å…ƒä¹‹é—´çš„ä¾èµ–å…³ç³» ä»¥åŠå„è‡ªåœ¨å¯åŠ¨æµç¨‹ä¸­çš„ä½ç½®ã€‚å›¾ä¸­çš„ç®­å¤´è¡¨ç¤ºäº†å•å…ƒä¹‹é—´çš„ä¾èµ–å…³ç³»ä¸å…ˆåé¡ºåºï¼Œ æ•´ä¸ªå›¾è¡¨æŒ‰ç…§è‡ªä¸Šè€Œä¸‹çš„æ—¶é—´é¡ºåºæ‰§è¡Œã€‚</p></blockquote><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span>-fs-pre<span class="variable">.target</span></span><br><span class="line">            |</span><br><span class="line">            v</span><br><span class="line">   (various mounts <span class="keyword">and</span>   (various swap   (various cryptsetup</span><br><span class="line">    fsck services...)     devices...)        devices...)       (various low-level   (various low-level</span><br><span class="line">            |                  |                  |             services: udevd,     API VFS mounts:</span><br><span class="line">            v                  v                  v             tmpfiles, random     mqueue, configfs,</span><br><span class="line">     <span class="keyword">local</span>-fs<span class="variable">.target</span>      swap<span class="variable">.target</span>     cryptsetup<span class="variable">.target</span>    seed, sysctl, ...)      debugfs, ...)</span><br><span class="line">            |                  |                  |                    |                    |</span><br><span class="line">            \<span class="number">__________________</span>|<span class="number">_________________</span> | <span class="meta">`_______________` |____________________/</span></span><br><span class="line">                                                 \|/</span><br><span class="line">                                                  v</span><br><span class="line">                                           sysinit<span class="variable">.target</span></span><br><span class="line">                                                  |</span><br><span class="line">             <span class="meta">`________________________________` /|\________________________________________</span></span><br><span class="line">            /                  |                  |                    |                    \</span><br><span class="line">            |                  |                  |                    |                    |</span><br><span class="line">            v                  v                  |                    v                    v</span><br><span class="line">        (various           (various               |                (various          rescue<span class="variable">.service</span></span><br><span class="line">       timers...)          paths...)              |               sockets...)               |</span><br><span class="line">            |                  |                  |                    |                    v</span><br><span class="line">            v                  v                  |                    v             *rescue<span class="variable">.target</span></span><br><span class="line">      timers<span class="variable">.target</span>      paths<span class="variable">.target</span>             |             sockets<span class="variable">.target</span></span><br><span class="line">            |                  |                  |                    |</span><br><span class="line">            v                  \<span class="number">_________________</span> | <span class="meta">`_______________` /</span></span><br><span class="line">                                                 \|/</span><br><span class="line">                                                  v</span><br><span class="line">                                            basic<span class="variable">.target</span></span><br><span class="line">                                                  |</span><br><span class="line">             <span class="meta">`________________________________` /|                                 emergency.service</span></span><br><span class="line">            /                  |                  |                                         |</span><br><span class="line">            |                  |                  |                                         v</span><br><span class="line">            v                  v                  v                                *emergency<span class="variable">.target</span></span><br><span class="line">        display-        (various system    (various system</span><br><span class="line">    manager<span class="variable">.service</span>         services           services)</span><br><span class="line">            |             required <span class="keyword">for</span>            |</span><br><span class="line">            |            graphical UIs)           v</span><br><span class="line">            |                  |          *multi-user<span class="variable">.target</span></span><br><span class="line">            |                  |                  |</span><br><span class="line">            \<span class="number">_________________</span> | <span class="meta">`_____________` /</span></span><br><span class="line">                              \|/</span><br><span class="line">                               v</span><br><span class="line">                  *graphical<span class="variable">.target</span></span><br></pre></td></tr></table></figure><ul><li>systemd æ‰§è¡Œçš„ç¬¬ä¸€ä¸ªç›®æ ‡æ˜¯ <strong>default.target</strong>ã€‚ä½†å®é™…ä¸Š default.target æ˜¯æŒ‡å‘ <strong>graphical.target</strong> çš„è½¯é“¾æ¥ã€‚Graphical.target çš„å®é™…ä½ç½®æ˜¯<code>/usr/lib/systemd/system/graphical.target</code>ã€‚</li></ul><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">â•­â”€root@ ~</span><br><span class="line">â•°â”€# cat /usr/lib/systemd/system/graphical.target</span><br><span class="line"><span class="comment">#  This file is part of systemd.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#  systemd is free software; you can redistribute it and/or modify it</span></span><br><span class="line"><span class="comment">#  under the terms of the GNU Lesser General Public License as published by</span></span><br><span class="line"><span class="comment">#  the Free Software Foundation; either version 2.1 of the License, or</span></span><br><span class="line"><span class="comment">#  (at your option) any later version.</span></span><br><span class="line"></span><br><span class="line"><span class="section">[Unit]</span></span><br><span class="line"><span class="attr">Description</span>=Graphical Interface</span><br><span class="line"><span class="attr">Documentation</span>=man:systemd.special(<span class="number">7</span>)</span><br><span class="line"><span class="attr">Requires</span>=multi-user.target</span><br><span class="line"><span class="attr">Wants</span>=display-manager.service</span><br><span class="line"><span class="attr">Conflicts</span>=rescue.service rescue.target</span><br><span class="line"><span class="attr">After</span>=multi-user.target rescue.service rescue.target display-manager.service</span><br><span class="line"><span class="attr">AllowIsolate</span>=<span class="literal">yes</span></span><br></pre></td></tr></table></figure><ul><li>åœ¨<strong>default.target</strong>è¿™ä¸ªé˜¶æ®µï¼Œä¼šå¯åŠ¨<strong>multi-user.target</strong>è€Œè¿™ä¸ª target å°†è‡ªå·±çš„å­å•å…ƒæ”¾åœ¨ç›®å½•<code>/etc/systemd/system/multi-user.target.wants</code>é‡Œã€‚è¿™ä¸ª target ä¸ºå¤šç”¨æˆ·æ”¯æŒè®¾å®šç³»ç»Ÿç¯å¢ƒã€‚é rootç”¨æˆ·ä¼šåœ¨è¿™ä¸ªé˜¶æ®µçš„å¼•å¯¼è¿‡ç¨‹ä¸­å¯ç”¨ã€‚é˜²ç«å¢™ç›¸å…³çš„æœåŠ¡ä¹Ÿä¼šåœ¨è¿™ä¸ªé˜¶æ®µå¯åŠ¨ã€‚<strong>multi-user.target</strong>ä¼šå°†æ§åˆ¶æƒäº¤ç»™å¦ä¸€å±‚<strong>basic.target</strong>ã€‚</li></ul><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">â•­â”€root@docker-230 ~</span><br><span class="line">â•°â”€# cat /usr/lib/systemd/system/multi-user.target</span><br><span class="line"><span class="comment">#  This file is part of systemd.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#  systemd is free software; you can redistribute it and/or modify it</span></span><br><span class="line"><span class="comment">#  under the terms of the GNU Lesser General Public License as published by</span></span><br><span class="line"><span class="comment">#  the Free Software Foundation; either version 2.1 of the License, or</span></span><br><span class="line"><span class="comment">#  (at your option) any later version.</span></span><br><span class="line"></span><br><span class="line"><span class="section">[Unit]</span></span><br><span class="line"><span class="attr">Description</span>=Multi-User System</span><br><span class="line"><span class="attr">Documentation</span>=man:systemd.special(<span class="number">7</span>)</span><br><span class="line"><span class="attr">Requires</span>=basic.target</span><br><span class="line"><span class="attr">Conflicts</span>=rescue.service rescue.target</span><br><span class="line"><span class="attr">After</span>=basic.target rescue.service rescue.target</span><br><span class="line"><span class="attr">AllowIsolate</span>=<span class="literal">yes</span></span><br></pre></td></tr></table></figure><ul><li><strong>basic.target</strong>å•å…ƒç”¨äºå¯åŠ¨æ™®é€šæœåŠ¡ç‰¹åˆ«æ˜¯å›¾å½¢ç®¡ç†æœåŠ¡ã€‚å®ƒé€šè¿‡<code>/etc/systemd/system/basic.target.wants</code>ç›®å½•æ¥å†³å®šå“ªäº›æœåŠ¡ä¼šè¢«å¯åŠ¨ï¼Œ<strong>basic.target</strong> ä¹‹åå°†æ§åˆ¶æƒäº¤ç»™ <strong>sysinit.target</strong>.</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">â•­â”€root@docker-230 ~</span><br><span class="line">â•°â”€# tree /etc/systemd/system/multi-user.target.wants</span><br><span class="line">/etc/systemd/system/multi-user.target.wants</span><br><span class="line">â”œâ”€â”€ auditd.service -&gt; /usr/lib/systemd/system/auditd.service</span><br><span class="line">â”œâ”€â”€ chronyd.service -&gt; /usr/lib/systemd/system/chronyd.service</span><br><span class="line">â”œâ”€â”€ crond.service -&gt; /usr/lib/systemd/system/crond.service</span><br><span class="line">â”œâ”€â”€ docker.service -&gt; /usr/lib/systemd/system/docker.service</span><br><span class="line">â”œâ”€â”€ firewalld.service -&gt; /usr/lib/systemd/system/firewalld.service</span><br><span class="line">â”œâ”€â”€ gitlab-runsvdir.service -&gt; /usr/lib/systemd/system/gitlab-runsvdir.service</span><br><span class="line">â”œâ”€â”€ irqbalance.service -&gt; /usr/lib/systemd/system/irqbalance.service</span><br><span class="line">â”œâ”€â”€ kdump.service -&gt; /usr/lib/systemd/system/kdump.service</span><br><span class="line">â”œâ”€â”€ NetworkManager.service -&gt; /usr/lib/systemd/system/NetworkManager.service</span><br><span class="line">â”œâ”€â”€ remote-fs.target -&gt; /usr/lib/systemd/system/remote-fs.target</span><br><span class="line">â”œâ”€â”€ rhel-configure.service -&gt; /usr/lib/systemd/system/rhel-configure.service</span><br><span class="line">â”œâ”€â”€ rsyslog.service -&gt; /usr/lib/systemd/system/rsyslog.service</span><br><span class="line">â”œâ”€â”€ sshd.service -&gt; /usr/lib/systemd/system/sshd.service</span><br><span class="line">â””â”€â”€ tuned.service -&gt; /usr/lib/systemd/system/tuned.service</span><br></pre></td></tr></table></figure><ul><li><strong>sysinit.target</strong>ä¼šå¯åŠ¨é‡è¦çš„ç³»ç»ŸæœåŠ¡ä¾‹å¦‚ç³»ç»ŸæŒ‚è½½ï¼Œå†…å­˜äº¤æ¢ç©ºé—´å’Œè®¾å¤‡ï¼Œå†…æ ¸è¡¥å……é€‰é¡¹ç­‰ç­‰ã€‚sysinit.target åœ¨å¯åŠ¨è¿‡ç¨‹ä¸­ä¼šä¼ é€’ç»™<strong>local-fs.target</strong>ã€‚</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">â•­â”€root@docker-230 ~</span><br><span class="line">â•°â”€<span class="comment"># tree /etc/systemd/system/basic.target.wants</span></span><br><span class="line">/etc/systemd/system/basic.target.wants</span><br><span class="line">â”œâ”€â”€ microcode.service -&gt; /usr/lib/systemd/system/microcode.service</span><br><span class="line">â””â”€â”€ rhel-dmesg.service -&gt; /usr/lib/systemd/system/rhel-dmesg.service</span><br><span class="line"></span><br><span class="line">0 directories, 2 files</span><br></pre></td></tr></table></figure><ul><li><code>local-fs.target</code>ï¼Œè¿™ä¸ª target å•å…ƒä¸ä¼šå¯åŠ¨ç”¨æˆ·ç›¸å…³çš„æœåŠ¡ï¼Œå®ƒåªå¤„ç†åº•å±‚æ ¸å¿ƒæœåŠ¡ã€‚è¿™ä¸ª target ä¼šæ ¹æ® /etc/fstab å’Œ /etc/inittab æ¥æ‰§è¡Œç›¸å…³æ“ä½œã€‚</li></ul><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">â•­â”€root@docker-230 ~</span><br><span class="line">â•°â”€# cat /usr/lib/systemd/system/sysinit.target</span><br><span class="line"><span class="comment">#  This file is part of systemd.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#  systemd is free software; you can redistribute it and/or modify it</span></span><br><span class="line"><span class="comment">#  under the terms of the GNU Lesser General Public License as published by</span></span><br><span class="line"><span class="comment">#  the Free Software Foundation; either version 2.1 of the License, or</span></span><br><span class="line"><span class="comment">#  (at your option) any later version.</span></span><br><span class="line"></span><br><span class="line"><span class="section">[Unit]</span></span><br><span class="line"><span class="attr">Description</span>=System Initialization</span><br><span class="line"><span class="attr">Documentation</span>=man:systemd.special(<span class="number">7</span>)</span><br><span class="line"><span class="attr">Conflicts</span>=emergency.service emergency.target</span><br><span class="line"><span class="attr">Wants</span>=local-fs.target swap.target</span><br><span class="line"><span class="attr">After</span>=local-fs.target swap.target emergency.service emergency.target</span><br></pre></td></tr></table></figure><h3 id="è¿›ç¨‹æ ‘"><a href="#è¿›ç¨‹æ ‘" class="headerlink" title="è¿›ç¨‹æ ‘"></a>è¿›ç¨‹æ ‘</h3><p>æˆ‘ä»¬ä½¿ç”¨ pstree å‘½ä»¤æ¥çœ‹ä¸€å“ˆè¿›ç¨‹æ ‘çš„çŠ¶æ€ï¼Œç”¨æˆ·ç©ºé—´çš„è¿›ç¨‹éƒ½æŒ‚åœ¨  PID ä¸º 1 çš„ systemd ä¸‹ã€‚ç”± systemd æ¥ç®¡ç†è¿›ç¨‹ä¼˜ç‚¹å¤šå¤š ğŸ˜‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">â•­â”€root@sg-02 ~</span><br><span class="line">â•°â”€# pstree -p</span><br><span class="line">systemd(1)â”€â”¬â”€accounts-daemon(661)â”€â”¬â”€&#123;accounts-daemon&#125;(689)</span><br><span class="line">           â”‚                      â””â”€&#123;accounts-daemon&#125;(729)</span><br><span class="line">           â”œâ”€agetty(971)</span><br><span class="line">           â”œâ”€agetty(992)</span><br><span class="line">           â”œâ”€aria2c(1010)</span><br><span class="line">           â”œâ”€atd(653)</span><br><span class="line">           â”œâ”€containerd(2915)â”€â”¬â”€&#123;containerd&#125;(2928)</span><br><span class="line">           â”‚                  â”œâ”€&#123;containerd&#125;(2929)</span><br><span class="line">           â”‚                  â”œâ”€&#123;containerd&#125;(2930)</span><br><span class="line">           â”‚                  â”œâ”€&#123;containerd&#125;(2934)</span><br><span class="line">           â”‚                  â”œâ”€&#123;containerd&#125;(2935)</span><br><span class="line">           â”‚                  â”œâ”€&#123;containerd&#125;(2950)</span><br><span class="line">           â”‚                  â”œâ”€&#123;containerd&#125;(2951)</span><br><span class="line">           â”‚                  â”œâ”€&#123;containerd&#125;(2978)</span><br><span class="line">           â”‚                  â”œâ”€&#123;containerd&#125;(5360)</span><br><span class="line">           â”‚                  â””â”€&#123;containerd&#125;(8299)</span><br><span class="line">           â”œâ”€cron(639)â”€â”€â”€cron(20506)â”€â”€â”€sh(20507)â”€â”€â”€monitor.sh(20509)â”€â”€â”€ffmpeg(20514)</span><br><span class="line">           â”œâ”€dbus-daemon(664)</span><br><span class="line">           â”œâ”€dockerd(17771)â”€â”¬â”€&#123;dockerd&#125;(17783)</span><br><span class="line">           â”‚                â”œâ”€&#123;dockerd&#125;(17784)</span><br><span class="line">           â”‚                â”œâ”€&#123;dockerd&#125;(17785)</span><br><span class="line">           â”‚                â”œâ”€&#123;dockerd&#125;(17791)</span><br><span class="line">           â”‚                â”œâ”€&#123;dockerd&#125;(17793)</span><br><span class="line">           â”‚                â”œâ”€&#123;dockerd&#125;(17800)</span><br><span class="line">           â”‚                â”œâ”€&#123;dockerd&#125;(17803)</span><br><span class="line">           â”‚                â”œâ”€&#123;dockerd&#125;(3030)</span><br><span class="line">           â”‚                â””â”€&#123;dockerd&#125;(3031)</span><br><span class="line">           â”œâ”€fail2ban-server(755)â”€â”¬â”€&#123;fail2ban-server&#125;(1059)</span><br><span class="line">           â”‚                      â””â”€&#123;fail2ban-server&#125;(1060)</span><br><span class="line">           â”œâ”€iscsid(896)</span><br><span class="line">           â”œâ”€iscsid(897)</span><br><span class="line">           â”œâ”€lvmetad(392)</span><br><span class="line">           â”œâ”€networkd-dispat(622)â”€â”€â”€&#123;networkd-dispat&#125;(982)</span><br><span class="line">           â”œâ”€nginx(3305)â”€â”€â”€nginx(17700)</span><br><span class="line">           â”œâ”€php-fpm7.2(7497)â”€â”¬â”€php-fpm7.2(1295)</span><br><span class="line">           â”‚                  â”œâ”€php-fpm7.2(1296)</span><br><span class="line">           â”‚                  â””â”€php-fpm7.2(5611)</span><br><span class="line">           â”œâ”€polkitd(808)â”€â”¬â”€&#123;polkitd&#125;(820)</span><br><span class="line">           â”‚              â””â”€&#123;polkitd&#125;(822)</span><br><span class="line">           â”œâ”€rngd(981)</span><br><span class="line">           â”œâ”€rpcbind(7125)</span><br><span class="line">           â”œâ”€rsyslogd(11567)â”€â”¬â”€&#123;rsyslogd&#125;(11598)</span><br><span class="line">           â”‚                 â”œâ”€&#123;rsyslogd&#125;(11599)</span><br><span class="line">           â”‚                 â””â”€&#123;rsyslogd&#125;(11600)</span><br><span class="line">           â”œâ”€ss-server(17126)â”€â”€â”€obfs-server(17138)</span><br><span class="line">             â”œâ”€sshd(5357)â”€â”¬â”€sshd(15490)â”€â”€â”€sshd(15598)â”€â”€â”€zsh(15619)â”€â”€â”€pstree(20539)</span><br><span class="line">           â”‚            â”œâ”€sshd(20413)â”€â”€â”€sshd(20414)</span><br><span class="line">           â”‚            â””â”€sshd(20517)</span><br><span class="line">           â”œâ”€systemd(5715)â”€â”€â”€(sd-pam)(5718)</span><br><span class="line">           â”œâ”€systemd-journal(12866)</span><br><span class="line">           â”œâ”€systemd-logind(652)</span><br><span class="line">           â”œâ”€systemd-network(12827)</span><br><span class="line">           â”œâ”€systemd-resolve(12839)</span><br><span class="line">           â”œâ”€systemd-timesyn(12852)â”€â”€â”€&#123;systemd-timesyn&#125;(12861)</span><br><span class="line">           â””â”€systemd-udevd(8171)</span><br></pre></td></tr></table></figure><h2 id="ç®¡ç†-systemd"><a href="#ç®¡ç†-systemd" class="headerlink" title="ç®¡ç† systemd"></a>ç®¡ç† systemd</h2><p>è®²å®Œäº† systemd çš„åŸºç¡€çŸ¥è¯†ï¼Œæ¥ä¸‹æ¥å°±å¼€å§‹åŠ¨æ‰‹å®è·µï¼Œæ§åˆ¶ systemd çš„ä¸»è¦å‘½ä»¤ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§ï¼š</p><ul><li>systemctl å‘½ä»¤æ§åˆ¶ <code>systemd</code> çš„ç®¡ç†ç³»ç»Ÿå’ŒæœåŠ¡çš„å‘½ä»¤è¡Œå·¥å…·</li><li>systemsdm å‘½ä»¤æ§åˆ¶ <code>systemd</code> çš„ç®¡ç†å’ŒæœåŠ¡çš„å›¾å½¢åŒ–å·¥å…·</li><li>journalctl å‘½ä»¤æŸ¥è©¢ <code>systemd</code> æ—¥å¿—ç³»ç»Ÿ</li><li>loginctl å‘½ä»¤æ§åˆ¶ <code>systemd</code> ç™»å…¥ç®¡ç†å™¨</li><li>systemd-analyze åˆ†æç³»ç»Ÿå¯åŠ¨æ•ˆèƒ½ï¼ˆç±»ä¼¼å¼€æœºæ—¶é—´ï¼Ÿ</li></ul><h3 id="systemctl-åŸºæœ¬ç”¨æ³•"><a href="#systemctl-åŸºæœ¬ç”¨æ³•" class="headerlink" title="systemctl åŸºæœ¬ç”¨æ³•"></a>systemctl åŸºæœ¬ç”¨æ³•</h3><h4 id="å¯åŠ¨-é‡å¯-åœæ­¢æœåŠ¡"><a href="#å¯åŠ¨-é‡å¯-åœæ­¢æœåŠ¡" class="headerlink" title="å¯åŠ¨/é‡å¯/åœæ­¢æœåŠ¡"></a>å¯åŠ¨/é‡å¯/åœæ­¢æœåŠ¡</h4><ul><li><code>systemctl start NAME</code></li><li><code>systemctl restart NAME</code></li><li><code>systemctl stop NAME</code></li></ul><h4 id="æŸ¥çœ‹æœåŠ¡çŠ¶æ€"><a href="#æŸ¥çœ‹æœåŠ¡çŠ¶æ€" class="headerlink" title="æŸ¥çœ‹æœåŠ¡çŠ¶æ€"></a>æŸ¥çœ‹æœåŠ¡çŠ¶æ€</h4><p>å°±å¦‚æ–‡ç« å¼€å¤´æ‰€æåˆ°çš„ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯æœ€ä¸‹é¢é‚£ç§å¸¦æ—¶é—´æˆ³çš„æ˜¯è¾“å‡ºçš„æ—¥å¿—</p><ul><li><code>systemctl status NAME</code></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">â•­â”€root@blog /home/ubuntu</span><br><span class="line">â•°â”€# systemctl status webps                                                                                    130 â†µ</span><br><span class="line">â— webps.service - WebP Server</span><br><span class="line">   Loaded: loaded (/opt/webps/webps.service; enabled; vendor preset: enabled)</span><br><span class="line">   Active: active (running) since Wed 2020-03-18 13:58:00 UTC; 22h ago</span><br><span class="line">     Docs: https://github.com/n0vad3v/webp_server_go</span><br><span class="line"> Main PID: 5732 (webp-server)</span><br><span class="line">    Tasks: 52 (limit: 684)</span><br><span class="line">   Memory: 185.2M</span><br><span class="line">      CPU: 1min 30.092s</span><br><span class="line">   CGroup: /system.slice/webps.service</span><br><span class="line">           â””â”€5732 /opt/webps/webp-server --config /opt/webps/config.json</span><br><span class="line"></span><br><span class="line">Mar 19 05:23:20 blog webp-server[5732]: Save to exhaushttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/image-20200109192923891.png.1584538399.webp ok</span><br></pre></td></tr></table></figure><h4 id="åˆ—å‡ºæ‰€æœ‰å•å…ƒï¼š"><a href="#åˆ—å‡ºæ‰€æœ‰å•å…ƒï¼š" class="headerlink" title="åˆ—å‡ºæ‰€æœ‰å•å…ƒï¼š"></a>åˆ—å‡ºæ‰€æœ‰å•å…ƒï¼š</h4><ul><li><code>systemctl list-unit-files</code></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">â•­â”€root@docker-230 ~</span><br><span class="line">â•°â”€<span class="comment"># systemctl list-unit-files</span></span><br><span class="line">UNIT FILE                                     STATE</span><br><span class="line">proc-sys-fs-binfmt_misc.automount             static</span><br><span class="line">dev-hugepages.mount                           static</span><br><span class="line">dev-mqueue.mount                              static</span><br></pre></td></tr></table></figure><h4 id="åˆ—å‡ºæ¿€æ´»çš„å•å…ƒ"><a href="#åˆ—å‡ºæ¿€æ´»çš„å•å…ƒ" class="headerlink" title="åˆ—å‡ºæ¿€æ´»çš„å•å…ƒ"></a>åˆ—å‡ºæ¿€æ´»çš„å•å…ƒ</h4><ul><li><code>systemctl list-units</code> ç­‰åŒäº <code>systemctl</code></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">â•­â”€root@docker-230 ~</span><br><span class="line">â•°â”€# systemctl list-units                                                                                      127 â†µ</span><br><span class="line">  UNIT                                         LOAD   ACTIVE SUB       DESCRIPTION</span><br><span class="line">  proc-sys-fs-binfmt_misc.automount            loaded active waiting   Arbitrary Executable File Formats File System</span><br><span class="line">  sys-devices-pci0000:00-0000:00:15.0-0000:03:00.0-host2-target2:0:0-2:0:0:0-block-sda-sda1.device loaded active plu</span><br><span class="line">  sys-devices-pci0000:00-0000:00:15.0-0000:03:00.0-host2-target2:0:0-2:0:0:0-block-sda-sda2.device loaded active plu</span><br></pre></td></tr></table></figure><h4 id="é‡æ–°è½½å…¥-systemdï¼Œæ‰«ææ–°çš„æˆ–æœ‰å˜åŠ¨çš„å•å…ƒï¼š"><a href="#é‡æ–°è½½å…¥-systemdï¼Œæ‰«ææ–°çš„æˆ–æœ‰å˜åŠ¨çš„å•å…ƒï¼š" class="headerlink" title="é‡æ–°è½½å…¥ systemdï¼Œæ‰«ææ–°çš„æˆ–æœ‰å˜åŠ¨çš„å•å…ƒï¼š"></a>é‡æ–°è½½å…¥ systemdï¼Œæ‰«ææ–°çš„æˆ–æœ‰å˜åŠ¨çš„å•å…ƒï¼š</h4><p>å½“å‘ systemd çš„ç›®å½•ä¸­æ·»åŠ æ˜¾å¾— unit æ–‡ä»¶åéœ€è¦ reload ä¸€ä¸‹æ‰èƒ½ç”Ÿæ•ˆ</p><ul><li><code>systemctl daemon-reload</code></li></ul><h4 id="æŸ¥è¯¢æœåŠ¡æ˜¯å¦å¼€æœºå¯åŠ¨"><a href="#æŸ¥è¯¢æœåŠ¡æ˜¯å¦å¼€æœºå¯åŠ¨" class="headerlink" title="æŸ¥è¯¢æœåŠ¡æ˜¯å¦å¼€æœºå¯åŠ¨"></a>æŸ¥è¯¢æœåŠ¡æ˜¯å¦å¼€æœºå¯åŠ¨</h4><ul><li><code>systemctl is-enabled crond</code></li></ul><h4 id="è®¾ç½®-å–æ¶ˆæœåŠ¡å¼€æœºè‡ªå¯"><a href="#è®¾ç½®-å–æ¶ˆæœåŠ¡å¼€æœºè‡ªå¯" class="headerlink" title="è®¾ç½®/å–æ¶ˆæœåŠ¡å¼€æœºè‡ªå¯"></a>è®¾ç½®/å–æ¶ˆæœåŠ¡å¼€æœºè‡ªå¯</h4><ul><li><code>systemctl enable NAME</code></li><li><code>systemctl disable NAME</code></li></ul><h4 id="è¿œç¨‹æ§åˆ¶å…¶ä»–æœåŠ¡å™¨çš„-systemd"><a href="#è¿œç¨‹æ§åˆ¶å…¶ä»–æœåŠ¡å™¨çš„-systemd" class="headerlink" title="è¿œç¨‹æ§åˆ¶å…¶ä»–æœåŠ¡å™¨çš„ systemd"></a>è¿œç¨‹æ§åˆ¶å…¶ä»–æœåŠ¡å™¨çš„ systemd</h4><p> <code>systemctl</code> å‚æ•°ä¸­æ·»åŠ  <code>-H &lt;ç”¨æˆ·å&gt;@&lt;ä¸»æœºå&gt;</code> å¯ä»¥å®ç°å¯¹å…¶ä»–æœºå™¨çš„è¿œç¨‹æ§åˆ¶ï¼Œè¯¥åŠŸèƒ½ä½¿ç”¨ <a href="https://wiki.archlinux.org/index.php/SSH_(ç®€ä½“ä¸­æ–‡)" target="_blank" rel="noopener">SSH</a> è¿æ¥ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">â•­â”€root@blog /home/ubuntu</span><br><span class="line">â•°â”€# systemctl status nginx -H sg2</span><br><span class="line">â— nginx.service - A high performance web server and a reverse proxy server</span><br><span class="line">   Loaded: loaded (/lib/systemd/system/nginx.service; enabled; vendor preset: enabled)</span><br><span class="line">   Active: active (running) since Mon 2020-02-17 08:41:11 UTC; 1 months 0 days ago</span><br><span class="line">     Docs: man:nginx(8)</span><br><span class="line"> Main PID: 3305</span><br><span class="line">    Tasks: 2 (limit: 1152)</span><br><span class="line">   CGroup: /system.slice/nginx.service</span><br><span class="line">           â”œâ”€ 3305 nginx: master process /usr/sbin/nginx -g daemon on; master_process on;</span><br><span class="line">           â””â”€17700 nginx: worker process</span><br></pre></td></tr></table></figure><h4 id="ä½¿ç”¨systemctlå‘½ä»¤æ€æ­»æœåŠ¡"><a href="#ä½¿ç”¨systemctlå‘½ä»¤æ€æ­»æœåŠ¡" class="headerlink" title="ä½¿ç”¨systemctlå‘½ä»¤æ€æ­»æœåŠ¡"></a>ä½¿ç”¨systemctlå‘½ä»¤æ€æ­»æœåŠ¡</h4><ul><li><code>systemctl kill NAME</code></li></ul><h3 id="journal"><a href="#journal" class="headerlink" title="journal"></a>journal</h3><p>systemd çš„ç¬¬äºŒä¸ªä¸»è¦éƒ¨åˆ†æ˜¯ journal æ—¥å¿—ç³»ç»Ÿï¼Œç±»ä¼¼äº syslog ä½†ä¹Ÿæœ‰äº›æ˜¾è‘—åŒºåˆ«ã€‚å¦‚æœä½ å–œæ¬¢ç”¨ <code>sed ã€grep ã€awk</code> ä¸‰å‰‘å®¢æ¥å¤„ç†æ—¥å¿—ï¼Œé‚£ä¹ˆå½“ä½ é¢å¯¹ journal æ—¥å¿—ç³»ç»Ÿçš„æ—¶å€™ä½ å°±å‡†å¤‡<strong>æ€æ¡Œå„¿</strong>å§ï¼å› ä¸ºè¿™æ˜¯ä¸ªäºŒè¿›åˆ¶æ—¥å¿—ï¼Œæ— æ³•ä½¿ç”¨å¸¸è§„çš„å‘½ä»¤è¡Œæ–‡æœ¬å¤„ç†å·¥å…·æ¥è§£æå®ƒğŸ˜‚</p><h3 id="systemd-analyze"><a href="#systemd-analyze" class="headerlink" title="systemd-analyze"></a>systemd-analyze</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">â•­â”€root@docker-230 ~</span><br><span class="line">â•°â”€<span class="comment"># systemd-analyze</span></span><br><span class="line">Startup finished <span class="keyword">in</span> 489ms (kernel) + 1.547s (initrd) + 10.333s (userspace) = 12.369s</span><br></pre></td></tr></table></figure><h2 id="æ¨è-å‚è€ƒ"><a href="#æ¨è-å‚è€ƒ" class="headerlink" title="æ¨è/å‚è€ƒ"></a>æ¨è/å‚è€ƒ</h2><h3 id="æºç "><a href="#æºç " class="headerlink" title="æºç "></a>æºç </h3><ul><li><a href="https://github.com/systemd/systemd" target="_blank" rel="noopener">github.com/systemd/systemd</a></li><li><a href="https://systemd.io/" target="_blank" rel="noopener">systemd.io</a></li></ul><h3 id="æ–‡æ¡£"><a href="#æ–‡æ¡£" class="headerlink" title="æ–‡æ¡£"></a>æ–‡æ¡£</h3><ul><li><p><a href="http://www.jinbuguo.com/systemd/systemd.exec.html" target="_blank" rel="noopener">systemd.exec ä¸­æ–‡æ‰‹å†Œ</a></p></li><li><p><a href="https://wiki.archlinux.org/index.php/systemd_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)" target="_blank" rel="noopener">systemd (ç®€ä½“ä¸­æ–‡)</a></p></li><li><p><a href="https://wiki.debian.org/systemd" target="_blank" rel="noopener">wiki.debian.org/systemd</a></p></li><li><p><a href="https://www.debian.org/doc/manuals/debian-reference/ch03.zh-tw.html" target="_blank" rel="noopener">ç¬¬ 3 ç«  ç³»çµ±åˆå§‹åŒ–</a></p></li><li><p><a href="https://openwrt.org/docs/techref/architecture" target="_blank" rel="noopener">OpenWrt â€“ operating system architecture</a></p></li><li><p><a href="http://manpages.ubuntu.com/manpages/cosmic/zh_CN/man7/bootup.7.html" target="_blank" rel="noopener">bootup - ç³»ç»Ÿå¯åŠ¨æµç¨‹</a></p></li><li><p><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/system_administrators_guide/chap-managing_services_with_systemd" target="_blank" rel="noopener">CHAPTER 10. MANAGING SERVICES WITH SYSTEMD</a></p></li></ul><h3 id="åšå®¢"><a href="#åšå®¢" class="headerlink" title="åšå®¢"></a>åšå®¢</h3><ul><li><p><a href="https://coolshell.cn/articles/17998.html" target="_blank" rel="noopener">LINUX PID 1 å’Œ SYSTEMD</a> è€—å­çš„åšå®¢ï¼Œå¿…é¡»å¢™è£‚æ¨èé˜…è¯»å“ˆï¼Œå…¶ä»–çš„å¯ä»¥ä¸è¯»ï¼Œä½†è¿™ä¸€ç¯‡åšå®¢å¿…é¡»è¦è¯»å“¦ ï¼šï¼‰</p></li><li><p><a href="https://lp007819.wordpress.com/2015/01/11/systemd%E7%9A%84%E4%B8%80%E4%BA%9B%E6%80%BB%E7%BB%93/" target="_blank" rel="noopener">systemdçš„ä¸€äº›æ€»ç»“</a></p></li><li><p><a href="https://linux.cn/article-5457-1.html" target="_blank" rel="noopener">èµ°è¿›Linuxä¹‹systemdå¯åŠ¨è¿‡ç¨‹</a></p></li><li><p><a href="https://hotttao.github.io/2018/08/03/linux_mt/14-Linux%E7%B3%BB%E7%BB%9F%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B%E5%8F%8A%E5%86%85%E6%A0%B8%E6%A8%A1%E5%9D%97%E7%AE%A1%E7%90%86/CentOS7-Systemd%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/" target="_blank" rel="noopener">13.3 Centos7 Systemd å¯åŠ¨æµç¨‹</a></p></li><li><p><a href="https://www.itwire.com/business-it-news/open-source/65402-torvalds-says-he-has-no-strong-opinions-on-systemd" target="_blank" rel="noopener">Torvalds says he has no strong opinions on systemd</a></p></li><li><p><a href="http://0pointer.de/blog/projects/systemd.html" target="_blank" rel="noopener">Rethinking PID 1</a></p></li><li><p><a href="http://0pointer.de/blog/projects/the-biggest-myths.html" target="_blank" rel="noopener">The Biggest Myths</a></p></li><li><p><a href="https://www.bennythink.com/linux-keep-running.html" target="_blank" rel="noopener">Linux æ€ä¹ˆè®©ç¨‹åºæŒç»­è¿è¡Œï¼šç®€å•è¯´è¯´å‡ ç§å¥½ç©çš„åŠæ³•</a></p></li><li><p><a href="https://www.bennythink.com/systemd-accounting.html" target="_blank" rel="noopener">systemd â€“ systemctl ä¸æ˜¾ç¤ºå†…å­˜ CPU ä¿¡æ¯</a></p></li><li><p><a href="https://lp007819.wordpress.com/2015/01/17/systemd-journal-%e4%bb%8b%e7%bb%8d/" target="_blank" rel="noopener">systemd journal ä»‹ç»</a></p></li><li><p><a href="http://blog.lujun9972.win/blog/2018/08/08/%E4%BD%BF%E7%94%A8journalctl%E6%9F%A5%E7%9C%8Bsystemd%E6%97%A5%E5%BF%97/index.html" target="_blank" rel="noopener">ä½¿ç”¨journalctlæŸ¥çœ‹systemdæ—¥å¿—</a></p></li><li><p><a href="http://blog.lujun9972.win/blog/2019/11/30/%E5%A6%82%E4%BD%95%E9%98%B2%E6%AD%A2%E6%84%8F%E5%A4%96%E9%87%8D%E5%90%AFlinux(%E5%9F%BA%E4%BA%8Esystemd)/index.html" target="_blank" rel="noopener">å¦‚ä½•é˜²æ­¢æ„å¤–é‡å¯Linux(åŸºäºsystemd)</a></p></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        
        
          &lt;h2 id=&quot;å°æ’æ›²&quot;&gt;&lt;a href=&quot;#å°æ’æ›²&quot;
        
      
    
    </summary>
    
    
      <category term="æŠ€æœ¯" scheme="https://blog.k8s.li/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="blog" scheme="https://blog.k8s.li/tags/blog/"/>
    
      <category term="Linux" scheme="https://blog.k8s.li/tags/Linux/"/>
    
      <category term="ç¬”è®°" scheme="https://blog.k8s.li/tags/%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>N1 ç›’å­åˆ·å…¥ OpenWrt å¹¶éƒ¨ç½² K3s</title>
    <link href="https://blog.k8s.li/N1-openwrt.html"/>
    <id>https://blog.k8s.li/N1-openwrt.html</id>
    <published>2020-03-07T16:00:00.000Z</published>
    <updated>2020-03-07T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="K3s"><a href="#K3s" class="headerlink" title="K3s"></a>K3s</h2><p>å»å¹´çš„æ—¶å€™å¬äº† Rancher çš„ç›´æ’­åˆ†äº«è®²  <a href="http://dockone.io/article/9384" target="_blank" rel="noopener">k3såœ¨è¾¹ç¼˜è®¡ç®—ä¸­çš„åº”ç”¨å®è·µ</a>ï¼Œå°±æ„Ÿè§‰å¾ˆå¥½ç©å„¿ï¼Œå½“æ—¶å¯¹ K3s è¿˜æ˜¯å¾ˆæ„Ÿå…´è¶£ï¼Œæ— å¥ˆå½“æ—¶æ‰‹å¤´æ²¡æœ‰åˆé€‚çš„å¼€å‘æ¿å¯ç©ï¼Œå°±æ²¡æ„¿æ„èŠ±é’±å†ä¹°å—æ ‘è“æ´¾åƒç°ğŸ˜‚ã€‚ç›´åˆ°ä¸Šå‘¨æœ«çš„æ—¶å€™ä¸€æ¬¡æœºä¼šå¾—ä»¥é‡æ–°è®¤è¯†äº†ä¸€ä¸‹ <a href="https://github.com/rancher/k3s" target="_blank" rel="noopener">K3s</a> æ‰€ä»¥å°±æƒ³æ‰¾ä¸ªè®¾å¤‡æ¥ç©ç© K3sã€‚äºæ˜¯ä¸œæŒ‘è¥¿é€‰å°±é€‰å®šäº†æ–è®¯ N1 ï¼Œä¼˜ç‚¹å¤šå¤šï¼Œä¸ä»…å¯ä»¥åšè·¯ç”±å™¨è¿˜èƒ½è·‘ docker ã€è¿˜èƒ½åš NAS ç­‰ç­‰ï¼Œä¸¤ä¸ªå­—çœŸé¦™ğŸ˜‚ã€‚ä¹‹å‰æˆ‘ä¸€ç›´ä½¿ç”¨ <code>R6300V2</code> åˆ·äº†æ¢…æ—ä»¥åŠå¦ä¸€å° <code>WNDR3700V4</code> åˆ·äº† <code>OpenWrt</code> åšé€æ˜ä»£ç†ï¼Œåœ¨ <code>ESXi</code> ä¸Šä¹Ÿè£…äº†ä¸ª <code>OpenWrt</code> è½¯è·¯ç”±ç»™å†…ç½‘çš„è™šæ‹Ÿæœºåšé€æ˜ä»£ç†ï¼Œä½†è¿˜æ˜¯å¿ƒæœ‰ä¸ç”˜æƒ³æ‰¾ä¸€å°æ€§èƒ½æ›´å¥½ä¸€ç‚¹çš„è®¾å¤‡æ¥åšæ—è·¯ç½‘å…³ã€‚ç»¼ä¸Šå°±ç§è‰ä¹°äº†æ—©å·²ç»è¢«å¤§å®¶ç©çƒ‚äº†çš„ <a href="https://pockies.github.io/2019/03/07/phicomm-n1/" target="_blank" rel="noopener">N1ç›’å­</a>ã€‚</p><h2 id="å¼€ç®±"><a href="#å¼€ç®±" class="headerlink" title="å¼€ç®±"></a>å¼€ç®±</h2><h3 id="å¤–åŒ…è£…"><a href="#å¤–åŒ…è£…" class="headerlink" title="å¤–åŒ…è£…"></a>å¤–åŒ…è£…</h3><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/image-20200308170852893.png" alt="image-20200308170852893"></p><h3 id="æ¥å£"><a href="#æ¥å£" class="headerlink" title="æ¥å£"></a>æ¥å£</h3><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/image-20200308170909549.png" alt="image-20200308170909549"></p><h3 id="å¼€æœºç”»é¢"><a href="#å¼€æœºç”»é¢" class="headerlink" title="å¼€æœºç”»é¢"></a>å¼€æœºç”»é¢</h3><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/image-20200308170935704.png" alt="image-20200308170935704"></p><h3 id="ç”µè§†ç³»ç»Ÿ"><a href="#ç”µè§†ç³»ç»Ÿ" class="headerlink" title="ç”µè§†ç³»ç»Ÿ"></a>ç”µè§†ç³»ç»Ÿ</h3><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/image-20200308171000114.png" alt="image-20200308171000114"></p><h3 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h3><h4 id="æ‹†æœº"><a href="#æ‹†æœº" class="headerlink" title="æ‹†æœº"></a>æ‹†æœº</h4><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/image-20200309141919253.png" alt="image-20200309141919253"></p><h4 id="CPU"><a href="#CPU" class="headerlink" title="CPU"></a>CPU</h4><ul><li>Amlogic S905ï¼ŒARM Cortex-A53ï¼Œå››æ ¸ 2GHzï¼ŒGPU æ˜¯ ARM Maliâ„¢-450ï¼Œæ”¯æŒ 4K@60fps ç¡¬ä»¶è§£ç ï¼ŒHDMI 2.0ã€‚</li><li>å¦å¤–æ”¯æŒ AES åŠ å¯†è§£å¯†ï¼Œæ‰€ä»¥åœ¨ä¸Šé¢è·‘çš„ SS/SSR çš„åŠ å¯†ç®—æ³•é€‚åˆé€‰æ‹© AES å–½ã€‚</li></ul><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">â•­â”€root@OpenWrt ~</span><br><span class="line">â•°â”€# cat /proc/cpuinfo</span><br><span class="line">processor       : 0</span><br><span class="line">model name      : ARMv8 Processor rev 4 (v8l)</span><br><span class="line">BogoMIPS        : 48.00</span><br><span class="line">Features        : fp asimd evtstrm aes pmull sha1 sha2 crc32 cpuid</span><br><span class="line">CPU implementer : 0x41</span><br><span class="line">CPU architecture: 8</span><br><span class="line">CPU variant     : 0x0</span><br><span class="line">CPU part        : 0xd03</span><br><span class="line">CPU revision    : 4</span><br><span class="line"></span><br><span class="line">processor       : 1</span><br><span class="line">model name      : ARMv8 Processor rev 4 (v8l)</span><br><span class="line">BogoMIPS        : 48.00</span><br><span class="line">Features        : fp asimd evtstrm aes pmull sha1 sha2 crc32 cpuid</span><br><span class="line">CPU implementer : 0x41</span><br><span class="line">CPU architecture: 8</span><br><span class="line">CPU variant     : 0x0</span><br><span class="line">CPU part        : 0xd03</span><br><span class="line">CPU revision    : 4</span><br><span class="line"></span><br><span class="line">processor       : 2</span><br><span class="line">model name      : ARMv8 Processor rev 4 (v8l)</span><br><span class="line">BogoMIPS        : 48.00</span><br><span class="line">Features        : fp asimd evtstrm aes pmull sha1 sha2 crc32 cpuid</span><br><span class="line">CPU implementer : 0x41</span><br><span class="line">CPU architecture: 8</span><br><span class="line">CPU variant     : 0x0</span><br><span class="line">CPU part        : 0xd03</span><br><span class="line">CPU revision    : 4</span><br><span class="line"></span><br><span class="line">processor       : 3</span><br><span class="line">model name      : ARMv8 Processor rev 4 (v8l)</span><br><span class="line">BogoMIPS        : 48.00</span><br><span class="line">Features        : fp asimd evtstrm aes pmull sha1 sha2 crc32 cpuid</span><br><span class="line">CPU implementer : 0x41</span><br><span class="line">CPU architecture: 8</span><br><span class="line">CPU variant     : 0x0</span><br><span class="line">CPU part        : 0xd03</span><br><span class="line">CPU revision    : 4</span><br></pre></td></tr></table></figure><h4 id="RAM"><a href="#RAM" class="headerlink" title="RAM"></a>RAM</h4><ul><li>å†…å­˜èŠ¯ç‰‡ RAMï¼šK4B4G1646E ï¼ŒDDR3-1866MHzï¼Œå†…å­˜å®¹é‡ 512MBï¼›å‰åä¸€å…±æœ‰ 4 é¢—ï¼Œæ€»å†…å­˜ 2GBã€‚</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">â•­â”€root@OpenWrt ~</span><br><span class="line">â•°â”€<span class="comment"># cat /proc/meminfo</span></span><br><span class="line">MemTotal:        1851688 kB</span><br><span class="line">MemFree:         1278128 kB</span><br><span class="line">MemAvailable:    1639036 kB</span><br><span class="line">â•­â”€root@OpenWrt ~</span><br><span class="line">â•°â”€<span class="comment"># dmesg | grep Memory</span></span><br><span class="line">[    0.000000] Memory: 924744K/1911808K available (12926K kernel code, 1108K rwdata, 5116K rodata, 640K init, 748K bss, 69560K reserved, 917504K cma-reserved)</span><br></pre></td></tr></table></figure><h4 id="ROM"><a href="#ROM" class="headerlink" title="ROM"></a>ROM</h4><ul><li>KLM8G1GEMEï¼Œ8GB eMMCã€‚</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">â•­â”€root@OpenWrt ~</span><br><span class="line">â•°â”€<span class="comment"># fdisk -l /dev/mmcblk1</span></span><br><span class="line">Disk /dev/mmcblk1: 7.3 GiB, 7818182656 bytes, 15269888 sectors</span><br><span class="line">Units: sectors of 1 * 512 = 512 bytes</span><br><span class="line">Sector size (logical/physical): 512 bytes / 512 bytes</span><br><span class="line">I/O size (minimum/optimal): 512 bytes / 512 bytes</span><br><span class="line">Disklabel <span class="built_in">type</span>: dos</span><br><span class="line">Disk identifier: 0x7db7c786</span><br><span class="line"></span><br><span class="line">Device         Boot   Start      End  Sectors  Size Id Type</span><br><span class="line">/dev/mmcblk1p1      1433600  1695743   262144  128M  c W95 FAT32 (LBA)</span><br><span class="line">/dev/mmcblk1p2      1695744  2744319  1048576  512M 83 Linux</span><br><span class="line">/dev/mmcblk1p3      2744320 15269887 12525568    6G 83 Linux</span><br><span class="line">â•­â”€root@OpenWrt ~</span><br><span class="line">â•°â”€<span class="comment"># lsblk</span></span><br><span class="line">NAME         MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT</span><br><span class="line">mmcblk1      179:0    0  7.3G  0 disk</span><br><span class="line">â”œâ”€mmcblk1p1  179:1    0  128M  0 part /boot</span><br><span class="line">â”œâ”€mmcblk1p2  179:2    0  512M  0 part /</span><br><span class="line">â””â”€mmcblk1p3  179:3    0    6G  0 part /mnt/mmcblk1p3</span><br><span class="line">mmcblk1boot0 179:32   0    4M  1 disk</span><br><span class="line">mmcblk1boot1 179:64   0    4M  1 disk</span><br></pre></td></tr></table></figure><h4 id="net"><a href="#net" class="headerlink" title="net"></a>net</h4><ul><li>åƒå…† <code>1Gbps/Full</code> ç½‘å¡ä»¥åŠ 2.4GHz/5GHz çš„æ— çº¿ç½‘å¡</li><li>çœ‹åˆ° <code>RTL8211F</code> æˆ‘å“­äº†ï¼Œç«Ÿç„¶æ˜¯èƒèŸ¹å¡ï¼Œæ€æ¡Œå„¿ğŸ˜¡</li><li>WIFI èŠ¯ç‰‡ï¼šå±è”½ç½©æ˜¯ç„Šæ­»çš„ï¼Œæ‰€ä»¥ä¸æ¸…æ¥šã€‚åªçŸ¥é“æ˜¯åŒé¢‘ 1x1mimo ç”¨æ”¯æŒ 5G acï¼Œ2.4G è¿æ¥é€Ÿç‡ 65Mbpsï¼Œ5G è¿æ¥é€Ÿç‡ 390Mbpsã€‚ä¸ºä»€ä¹ˆä¸æ˜¯ 72m å’Œ 433mï¼Œå› ä¸º No SGIã€‚</li></ul><blockquote><p>ï¼ˆN1ä¸æ”¯æŒ RTL8153ï¼Œæ˜¯å› ä¸ºç¡¬ä»¶ä¾›ç”µçš„åŸå› ï¼Œä¸æ˜¯é©±åŠ¨çš„åŸå› ï¼Œä¹Ÿæœ‰ä¸ªåˆ«ç½‘å‹è¯´èƒ½æ”¯æŒçš„ï¼Œå¯èƒ½å› ä¸º rtl8153 ä¹Ÿæœ‰ä¸åŒç‰ˆæœ¬ï¼Œä½†æ”¯ æŒAX88179ï¼Œé€Ÿç‡ 200m å·¦å³, å› æ­¤ä»æ€§èƒ½ä¸Šè€ƒè™‘ï¼ŒN1ä¸å»ºè®®å¤–æ¥ä»»ä½•ç½‘å¡ï¼Œç›´æ¥ç”¨å•ç½‘å¡åšæ—è·¯ç”±ä¹Ÿèƒ½è¾¾åˆ° 750m å·¦å³ï¼‰</p></blockquote><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">â•­â”€root@OpenWrt ~</span><br><span class="line">â•°â”€# dmesg | grep net</span><br><span class="line">[    0.000000] Kernel command line: root=UUID=69fd696a-85a4-4ec8-b604-4cefd053cbc1 rootfstype=btrfs rootflags=compress=zstd console=ttyAML0,115200n8 console=tty0 no_console_suspend consoleblank=0 fsck.fix=yes fsck.repair=yes net.ifnames=0 cgroup_enable=cpuset cgroup_memory=1 cgroup_enable=memory swapaccount=1</span><br><span class="line">[    0.691325] audit: initializing netlink subsys (disabled)</span><br><span class="line">[    5.131043] meson8b-dwmac c9410000.ethernet: IRQ eth_wake_irq not found</span><br><span class="line">[    5.136694] meson8b-dwmac c9410000.ethernet: IRQ eth_lpi not found</span><br><span class="line">[    5.142854] meson8b-dwmac c9410000.ethernet: PTP uses main clock</span><br><span class="line">[    5.148731] meson8b-dwmac c9410000.ethernet: no reset control found</span><br><span class="line">[    5.155366] meson8b-dwmac c9410000.ethernet: User ID: 0x11, Synopsys ID: 0x37</span><br><span class="line">[    5.162029] meson8b-dwmac c9410000.ethernet:         DWMAC1000</span><br><span class="line">[    5.167192] meson8b-dwmac c9410000.ethernet: DMA HW capability register supported</span><br><span class="line">[    5.174594] meson8b-dwmac c9410000.ethernet: RX Checksum Offload Engine supported</span><br><span class="line">[    5.182017] meson8b-dwmac c9410000.ethernet: COE Type 2</span><br><span class="line">[    5.187192] meson8b-dwmac c9410000.ethernet: TX Checksum insertion supported</span><br><span class="line">[    5.194171] meson8b-dwmac c9410000.ethernet: Wake-Up On Lan supported</span><br><span class="line">[    5.200586] meson8b-dwmac c9410000.ethernet: Normal descriptors</span><br><span class="line">[    5.206426] meson8b-dwmac c9410000.ethernet: Ring mode enabled</span><br><span class="line">[    5.212198] meson8b-dwmac c9410000.ethernet: Enable RX Mitigation via HW Watchdog Timer</span><br><span class="line">[    5.428271] Initializing XFRM netlink socket</span><br><span class="line">[    5.521946] bridge: filtering via arp/ip/ip6tables is no longer available by default. Update your scripts to load br_netfilter if you need this.</span><br><span class="line">[   11.076508] meson8b-dwmac c9410000.ethernet eth0: PHY [0.2009087f:00] driver [RTL8211F Gigabit Ethernet]</span><br><span class="line">[   11.083720] meson8b-dwmac c9410000.ethernet eth0: No Safety Features support found</span><br><span class="line">[   11.088006] meson8b-dwmac c9410000.ethernet eth0: PTP not supported by HW</span><br><span class="line">[   11.094588] meson8b-dwmac c9410000.ethernet eth0: configuring for phy/rgmii link mode</span><br><span class="line">[   19.250095] meson8b-dwmac c9410000.ethernet eth0: PHY [0.2009087f:00] driver [RTL8211F Gigabit Ethernet]</span><br><span class="line">[   19.265579] meson8b-dwmac c9410000.ethernet eth0: No Safety Features support found</span><br><span class="line">[   19.267519] meson8b-dwmac c9410000.ethernet eth0: PTP not supported by HW</span><br><span class="line">[   19.274244] meson8b-dwmac c9410000.ethernet eth0: configuring for phy/rgmii link mode</span><br><span class="line">[   19.411257] netlink: 4 bytes leftover after parsing attributes in process `iw'.</span><br><span class="line">[   19.595853] ieee80211 phy0: brcmf_net_attach: couldn't register the net device</span><br><span class="line">[   19.597447] ieee80211 phy0: brcmf_ap_add_vif: Registering netdevice failed</span><br><span class="line">[   21.019546] meson8b-dwmac c9410000.ethernet eth0: Link is Up - 1Gbps/Full - flow control rx/tx</span><br><span class="line">[ 1047.556475] meson8b-dwmac c9410000.ethernet eth0: Link is Down</span><br><span class="line">[ 1047.772626] meson8b-dwmac c9410000.ethernet eth0: PHY [0.2009087f:00] driver [RTL8211F Gigabit Ethernet]</span><br><span class="line">[ 1047.785569] meson8b-dwmac c9410000.ethernet eth0: No Safety Features support found</span><br><span class="line">[ 1047.787510] meson8b-dwmac c9410000.ethernet eth0: PTP not supported by HW</span><br><span class="line">[ 1047.794242] meson8b-dwmac c9410000.ethernet eth0: configuring for phy/rgmii link mode</span><br><span class="line">[ 1051.459018] meson8b-dwmac c9410000.ethernet eth0: Link is Up - 1Gbps/Full - flow control rx/tx</span><br><span class="line">[ 1241.984013] netlink: 4 bytes leftover after parsing attributes in process `iw'.</span><br><span class="line">[ 1346.112897] meson8b-dwmac c9410000.ethernet eth0: Link is Down</span><br><span class="line">[ 1346.295582] meson8b-dwmac c9410000.ethernet eth0: PHY [0.2009087f:00] driver [RTL8211F Gigabit Ethernet]</span><br><span class="line">[ 1346.312202] meson8b-dwmac c9410000.ethernet eth0: No Safety Features support found</span><br><span class="line">[ 1346.314172] meson8b-dwmac c9410000.ethernet eth0: PTP not supported by HW</span><br><span class="line">[ 1346.320888] meson8b-dwmac c9410000.ethernet eth0: configuring for phy/rgmii link mode</span><br><span class="line">[ 1349.769672] meson8b-dwmac c9410000.ethernet eth0: Link is Up - 1Gbps/Full - flow control rx/tx</span><br></pre></td></tr></table></figure><h4 id="htop"><a href="#htop" class="headerlink" title="htop"></a>htop</h4><p>å¼å¼å¼ï¼Œå±…ç„¶è¿˜èƒ½è·‘ Docker ï¼Œé‚£ K3s ä¹Ÿè‚¯å®šæ²¡é—®é¢˜å•¦ï¼ˆ</p><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/image-20200308180733757.png" alt="image-20200308180733757"></p><h2 id="å‡†å¤‡"><a href="#å‡†å¤‡" class="headerlink" title="å‡†å¤‡"></a>å‡†å¤‡</h2><p>é¦–å…ˆå‡†å¤‡ä¸ªåˆ·æœºè¿‡ç¨‹ä¸­éœ€è¦çš„æ¸…å• <del>åˆ«çœ‹ä½ ä»Šå¤©é—¹å¾—æ¬¢ï¼Œå°å¿ƒä»Šåæ‹‰æ¸…å•</del></p><ul><li>USB å…¬å¯¹å…¬æ•°æ®çº¿ï¼ˆå–å®¶èµ é€äº†çº¿</li><li>ç½‘çº¿æˆ– WiFiï¼Œç½‘çº¿æœ‰æ—¶è·å–ä¸åˆ°æ­£ç¡®çš„ IP ï¼Œå¯ä»¥å€ŸåŠ© WiFi</li><li>HDMI çº¿ä»¥åŠæ˜¾ç¤ºå™¨ï¼Œéœ€è¦è¿›å…¥ç›’å­ç³»ç»Ÿæ‰‹åŠ¨å¼€å¯ adb</li><li>Android SDK å¹³å°å·¥å…· <a href="https://developer.android.com/studio/releases/platform-tools" target="_blank" rel="noopener">Platform-tools</a></li><li>é•œåƒå†™å…¥å·¥å…· <a href="https://github.com/pbatard/rufus" target="_blank" rel="noopener">Rufus</a> æˆ– <a href="https://www.roadkil.net/program.php?ProgramID=12" target="_blank" rel="noopener">Roadkils DiskImage</a></li><li>OpenWrt é•œåƒ <a href="https://disk.longe.xyz/N1/Openwrt/28%2Bo%E7%89%88N1_OP_U%E7%9B%98%E7%9B%B4%E5%88%B7%E5%8C%85/N1_Openwrt_R20.2.15_k5.4.23-amlogic-flippy-28%2Bo.7z" target="_blank" rel="noopener">N1_Openwrt_R20.2.15_k5.4.23-amlogic-flippy-28+o.7z</a></li></ul><blockquote><p>Openwrt_U ç›˜ç›´åˆ·åŒ…ï¼šé“¾æ¥ï¼š<a href="https://pan.baidu.com/s/1K0bNItsY1-Br4o1EsRokkg" target="_blank" rel="noopener">https://pan.baidu.com/s/1K0bNItsY1-Br4o1EsRokkg</a> æå–ç ï¼šlidf</p></blockquote><h3 id="æ¨èèµ„æº"><a href="#æ¨èèµ„æº" class="headerlink" title="æ¨èèµ„æº"></a>æ¨èèµ„æº</h3><p>åˆ·æœºè¿‡ç¨‹ä¸­çš„èµ„æºæ¥è‡ªä»¥ä¸‹ï¼Œå¯ä»¥å»è¿™é‡Œæ‰¾æ›´å¤šä½ æƒ³è¦çš„ï¼Œä»–ä»¬çš„æ•™ç¨‹ä¹Ÿä¼šæ¯”æˆ‘æ›´ä¼˜ç§€ä¸€äº›ï¼Œè€Œä¸” B ç«™ä¸Šä¹Ÿæœ‰è§†é¢‘ï¼Œè§†é¢‘è®²è§£çš„è¦æ›´å¥½ã€‚å†™è¿™ç¯‡åšå®¢ä¹Ÿåªæ˜¯ä¸ºäº†è®°å½•ä¸€ä¸‹ğŸ˜‚</p><ul><li><a href="https://drive.google.com/drive/folders/1XvhPCwodZzCfV83oW3DXegAvDOrHW7iV" target="_blank" rel="noopener">Pi&amp;N1 Google Drive</a></li><li><a href="https://github.com/real-pin1group/3000web/wiki" target="_blank" rel="noopener">ä¸‰åƒé—®</a></li><li><a href="https://t.me/PIN1Group" target="_blank" rel="noopener">t.me/PIN1Group</a></li><li><a href="https://t.me/NewPiN1Channel" target="_blank" rel="noopener">Pi&amp;N1äº¤æµç¾¤é€šçŸ¥é¢‘é“</a></li><li><a href="https://disk.longe.xyz/" target="_blank" rel="noopener">å±±å°ç‚®ç½‘ç›˜</a></li><li><a href="https://disk.longe.xyz/N1/OpenWrt/%E3%80%902019-6-20%E3%80%91Phicomm%20N1%E5%88%B7openwrt%E8%B7%AF%E7%94%B1%E5%9B%BA%E4%BB%B6%E8%AF%A6%E7%BB%86%E7%AC%94%E8%AE%B0.pdf" target="_blank" rel="noopener">Phicomm N1åˆ·openwrtè·¯ç”±å›ºä»¶è¯¦ç»†ç¬”è®°.pdf</a></li><li><a href="https://disk.longe.xyz/N1/OpenWrt/28%2Boç‰ˆN1_OP_Uç›˜ç›´åˆ·åŒ…/" target="_blank" rel="noopener">28+oç‰ˆN1_OP_Uç›˜ç›´åˆ·åŒ…</a></li><li><a href="https://www.right.com.cn/forum/thread-981406-1-1.html" target="_blank" rel="noopener">[2020-3-8]â˜…29+ç‰ˆN1_OP_Uç›˜ç›´åˆ·åŒ…ï¼ŒåŠè´å£³äº‘_OP_çº¿åˆ·åŒ…ï¼Œå†…æ ¸5.4</a></li></ul><h2 id="åˆ·æœº"><a href="#åˆ·æœº" class="headerlink" title="åˆ·æœº"></a>åˆ·æœº</h2><h3 id="å¼€å¯-ADB"><a href="#å¼€å¯-ADB" class="headerlink" title="å¼€å¯ ADB"></a>å¼€å¯ ADB</h3><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/image-20200309085941030.png" alt="image-20200309085941030"></p><p>å°† HDMI çº¿è¿æ¥åˆ°ç›’å­çš„ HDMI å£ï¼Œå°† USB å…¬å¯¹å…¬çš„æ•°æ®çº¿åˆ†åˆ«æ’åœ¨ç›’å­çš„é è¿‘ HDMI å£çš„ USB ï¼Œå¦ä¸€å¤´æ’åœ¨ PC çš„ USB å£ï¼Œå†å°†é¼ æ ‡è¿æ¥åˆ°ç›’å­çš„å¦ä¸€ä¸ª USB å£ã€‚æ’å¥½ä¸Šè¿°çš„çº¿ç¼†ä¹‹åæ’ä¸Šç”µæºå¼€æœºï¼Œç”±äºç›’å­æ²¡æœ‰ç”µæºå¼€å…³æ‰€ä»¥åªèƒ½é€šè¿‡æ’æ‹”ç”µæºçš„æ–¹å¼å¼€å…³æœºã€‚å¼€æœºä¹‹åä¼šè‡ªåŠ¨è¿›å…¥åˆ°ç”µè§†ç›’å­ç³»ç»Ÿçš„é¡µé¢ï¼Œç„¶åæŒªåŠ¨é¼ æ ‡ï¼Œåœ¨ <code>å›ºä»¶ç‰ˆæœ¬</code>  é‚£é‡Œç‹‚ç‚¹é¼ æ ‡å››ä¸‹å¼€å¯ <code>ADB</code> è°ƒè¯•æ¨¡å¼ã€‚å±å¹•ä¸­é—´ä¼šå¼¹å‡ºä¸ªç°è‰²çš„æ–¹æ¡†æç¤º<code>æ‰“å¼€ adb</code></p><blockquote><p>PSï¼šæåˆ° adb å’±å°±ä¸ç”±è‡ªä¸»åœ°æƒ³èµ·äº†å»å¹´ä¸–ç•Œäº”ç™¾å¼ºä»–å®¶çš„å·ç§°è¦å–ä»£ Android ã€è‡ªä¸»ç ”å‘ã€å¾®å†…æ ¸ã€é¢å‘ç¡®å®š<a href="https://zh.wikipedia.org/wiki/æ—¶å»¶" target="_blank" rel="noopener">æ—¶å»¶</a>ã€åˆ†å¸ƒå¼ã€å½¢å¼åŒ–éªŒè¯ã€å¤šåœºæ™¯ï¼›å¤§åé¼é¼çš„å“„æ‡µï¼ˆPPTï¼‰æ“ä½œç³»ç»Ÿç«Ÿç„¶ä¹Ÿæœ‰ ADB ï¼ˆå·ç¬‘</p></blockquote><p>åœ¨è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä½¿ç”¨ç½‘çº¿è¿æ¥ç›’å­å’Œè·¯ç”±å™¨åï¼Œå±å¹•ä¸Šæ˜¾ç¤ºçš„ IP å¹¶ä¸æ˜¯æˆ‘æœ¬åœ°å†…ç½‘çš„ IP ï¼Œè¿™ä¸€ç‚¹å¾ˆå¥‡æ€ªï¼Œè€Œä½¿ç”¨æ— çº¿è¿æ¥åˆ°æˆ‘çš„æ— çº¿è·¯ç”±å™¨åå»èƒ½è·å–åˆ°æ­£å¸¸çš„å†…ç½‘ IP ï¼Œæ‰€ä»¥å¦‚æœä½ ä½¿ç”¨ç½‘çº¿è¿æ¥æ—¶ä¹Ÿé‡åˆ°è¿™æ ·çš„æƒ…å†µï¼Œä¸å¦¨å°è¯•ä¸€ä¸‹ä½¿ç”¨æ— çº¿è¿æ¥ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/image-20200308171341327.png" alt="image-20200308171341327"></p><h3 id="PC-ä¸Šè¿æ¥-ADB-è¿›å…¥-fastboot-æ¨¡å¼"><a href="#PC-ä¸Šè¿æ¥-ADB-è¿›å…¥-fastboot-æ¨¡å¼" class="headerlink" title="PC ä¸Šè¿æ¥ ADB è¿›å…¥ fastboot æ¨¡å¼"></a>PC ä¸Šè¿æ¥ ADB è¿›å…¥ fastboot æ¨¡å¼</h3><p>ä¸Šè¿°è¦å°†ç›’å­çš„ HMDI æ¥å…¥æ˜¾ç¤ºå™¨å¹¶æ’ä¸Šé¼ æ ‡ï¼Œå°±æ˜¯ä¸ºäº†åœ¨ ADB æ¨¡å¼ä¸‹è¿›å…¥ fastboot æ¨¡å¼ï¼Œè€Œ fastboot æ¨¡å¼å’Œæˆ‘ä»¬æ™®é€šçš„ Android åˆ·æœºæ—¶çš„ fastboot ä¸€æ ·ï¼Œä½•å†µè¿™ä¸ªç›’å­ä¹Ÿæ˜¯åŸºäº Android çš„ï¼Œæ‰€ä»¥å˜›ï¼Œå’Œ Android åˆ·æœºå¤§åŒå°å¼‚ã€‚ç„¶åä¸‹è½½å¥½ Android SDK å¹³å°å·¥å…· <a href="https://developer.android.com/studio/releases/platform-tools" target="_blank" rel="noopener">Platform-tools</a> å¹¶è§£å‹åˆ°åˆé€‚çš„ä½ç½®ï¼ŒæŒ‰ä½ <code>shift</code> é”®ä¹‹åé¼ æ ‡å³é”®ç‚¹å‡»<code>åœ¨æ­¤å¤„æ‰“å¼€ Powershell çª—å£</code> ï¼Œæ¥ç€åœ¨è¯¥å‘½ä»¤è¡Œä¸‹è¾“å…¥ <code>adb.exe connect IP</code> ï¼Œè¿™é‡Œçš„ IP å³ä¸ºå±å¹•ä¸Šæ˜¾ç¤ºçš„ IP ï¼Œè¿æ¥æˆåŠŸä¹‹åä¼šæœ‰æç¤ºå·²ç»è¿æ¥ã€‚ç„¶åå†è¿è¡Œ <code>adb.exe shell reboot fastboot</code> è¿›å…¥ fastboot æ¨¡å¼ã€‚è¿™ä¸€æ­¥å’Œæˆ‘ä»¬ç»™ Android æ‰‹æœºåˆ·æœºæ—¶ä¿ºç”µæºé”®+éŸ³é‡é”®ï¼Œè¿›å…¥ fastboot æ¨¡å¼ä¸€æ ·çš„é“ç†ï¼Œåªä¸è¿‡ç›’å­æ²¡æœ‰éŸ³é‡é”®å’Œå¼€æœºé”®ï¼Œæ‰€ä»¥è¦ä½¿ç”¨ adb çš„æ–¹å¼è¿›å…¥åˆ° fastboot ã€‚</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PS D:\Desktop&gt; adb.exe connect <span class="number">192.168</span>.<span class="number">0.105</span></span><br><span class="line">connected to <span class="number">192.168</span>.<span class="number">0.105</span>:<span class="number">5555</span></span><br><span class="line">PS D:\Desktop\N1&gt; adb.exe shell reboot fastboot</span><br></pre></td></tr></table></figure><h3 id="åˆ·å…¥é™çº§é•œåƒ"><a href="#åˆ·å…¥é™çº§é•œåƒ" class="headerlink" title="åˆ·å…¥é™çº§é•œåƒ"></a>åˆ·å…¥é™çº§é•œåƒ</h3><p>ç›’å­é‡å¯è¿›å…¥ fastboot æ¨¡å¼ä¹‹åï¼ŒPC ä¸Šä¼šæç¤ºæ’å…¥æ–°è®¾å¤‡ï¼Œå¹¶å®å’šå“ä¸€ä¸‹ï¼Œä¹‹åä¼šè‡ªåŠ¨å®‰è£…ä¸Šé©±åŠ¨ç¨‹åºã€‚</p><p>å³é”®è®¡ç®—æœºâ€“&gt;ç®¡ç†â€“&gt; è®¾å¤‡ç®¡ç†å™¨ <code>LeMobile Android Device</code> ä¸‹çš„ <code>Android ADB Interface</code> ã€‚å¦‚æœæ²¡æœ‰å‡ºç°è¯¥è®¾å¤‡çš„è¯ï¼Œå¯ä»¥ä¸‹è½½ä¸ªé©±åŠ¨å®‰è£…ç¨‹åºæ¥ç»™ä½ è£…ä¸Šè¯¥è®¾å¤‡çš„é©±åŠ¨ã€‚ä½¿ç”¨ <code>fastboot devices -l</code> å‘½ä»¤æ¥æŸ¥çœ‹è¯¥è®¾å¤‡æ˜¯å¦æ­£å¸¸è¿æ¥ä¸Šã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/image-20200308152333262.png" alt="image-20200308152333262"></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PS D:\Desktop\N1&gt; fastboot devices <span class="literal">-l</span></span><br><span class="line"><span class="number">1234567890</span>             fastboot</span><br></pre></td></tr></table></figure><h4 id="æ ¡éªŒé•œåƒ"><a href="#æ ¡éªŒé•œåƒ" class="headerlink" title="æ ¡éªŒé•œåƒ"></a>æ ¡éªŒé•œåƒ</h4><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">Mode                LastWriteTime         Length Name</span><br><span class="line">----          -------------   ------ ----</span><br><span class="line">-a----   2020/3/7     17:53       14191104 boot.img</span><br><span class="line">-a----   2020/3/7     17:53         672256 bootloader.img</span><br><span class="line">-a----   2020/3/7     17:53            605 hash.txt</span><br><span class="line">-a----   2020/3/7     17:53       18295296 recovery.img</span><br><span class="line"><span class="comment"># åˆ·æœºä¹‹å‰è¦å…ˆæ ¡éªŒé•œåƒæ˜¯å¦å®Œæ•´æˆ–è€…è¢«ç¯¡æ”¹ï¼Œå…»æˆå¥½ä¹ æƒ¯ğŸ˜‹</span></span><br><span class="line">PS D:\Desktop\N1&gt; cat .\hash.txt</span><br><span class="line">æ–‡ä»¶: N1_V2.19_imgs\bootloader.img</span><br><span class="line">å¤§å°: 672256 å­—èŠ‚</span><br><span class="line">ä¿®æ”¹æ—¶é—´: 2018å¹´5æœˆ25æ—¥ æ˜ŸæœŸäº”, 23:09:08</span><br><span class="line">MD5: 80BD2EFED2F76B6ECA56F7E026549E1A</span><br><span class="line">SHA1: 3A1FFCADF062748CA1D00EB80E73F2175B160A0D</span><br><span class="line">CRC32: 34BA154A</span><br><span class="line"></span><br><span class="line">æ–‡ä»¶: N1_V2.19_imgs\recovery.img</span><br><span class="line">å¤§å°: 18295296 å­—èŠ‚</span><br><span class="line">ä¿®æ”¹æ—¶é—´: 2018å¹´5æœˆ25æ—¥ æ˜ŸæœŸäº”, 23:09:19</span><br><span class="line">MD5: CAC6ED1DED5BB1D9CFAD39B2B1C6CD8A</span><br><span class="line">SHA1: B468A3134B376A5295C1FD5857343128D0AC056C</span><br><span class="line">CRC32: AA11C424</span><br><span class="line"></span><br><span class="line">æ–‡ä»¶: N1_V2.19_imgs\boot.img</span><br><span class="line">å¤§å°: 14191104 å­—èŠ‚</span><br><span class="line">ä¿®æ”¹æ—¶é—´: 2018å¹´5æœˆ25æ—¥ æ˜ŸæœŸäº”, 23:09:46</span><br><span class="line">MD5: 75DA954D0C4CBCD4A86CEE501B40C5AA</span><br><span class="line">SHA1: 1A0D04DB8FB57F252C72C909A3268B6B2C3BD241</span><br><span class="line">CRC32: 547D7823</span><br><span class="line"></span><br><span class="line"><span class="comment"># Windows CMD ä¸‹å¯ä½¿ç”¨ certUtil æ¥è®¡ç®—æ–‡ä»¶çš„ HASH å€¼</span></span><br><span class="line">PS D:\Desktop\N1&gt; certUtil -hashfile .\recovery.img</span><br><span class="line">SHA1 hash of .\recovery.img:</span><br><span class="line">b468a3134b376a5295c1fd5857343128d0ac056c</span><br><span class="line">CertUtil: -hashfile command completed successfully.</span><br><span class="line">PS D:\Desktop\N1&gt; certUtil -hashfile .\boot.img</span><br><span class="line">SHA1 hash of .\boot.img:</span><br><span class="line">1a0d04db8fb57f252c72c909a3268b6b2c3bd241</span><br><span class="line">CertUtil: -hashfile command completed successfully.</span><br><span class="line">PS D:\Desktop\N1&gt; certUtil -hashfile .\bootloader.img</span><br><span class="line">SHA1 hash of .\bootloader.img:</span><br><span class="line">3a1ffcadf062748ca1d00eb80e73f2175b160a0d</span><br><span class="line">CertUtil: -hashfile command completed successfully.</span><br></pre></td></tr></table></figure><h4 id="è¾“å…¥é™çº§åŒ…é•œåƒ"><a href="#è¾“å…¥é™çº§åŒ…é•œåƒ" class="headerlink" title="è¾“å…¥é™çº§åŒ…é•œåƒ"></a>è¾“å…¥é™çº§åŒ…é•œåƒ</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç„¶åæ ¹æ®å¯¹åº”çš„åˆ†åŒºåˆ·å…¥å¯¹åº”çš„é•œåƒï¼Œè¿™ç‚¹ä¸è¦ææ··ï¼Œä¸ç„¶ä¼šå˜ç –çš„</span></span><br><span class="line">PS D:\Desktop\N1&gt; fastboot flash bootloader bootloader.img</span><br><span class="line">Sending <span class="string">'bootloader'</span> (656 KB)                      OKAY [  0.037s]</span><br><span class="line">Writing <span class="string">'bootloader'</span>                               OKAY [  0.075s]</span><br><span class="line">Finished. Total time: 0.118s</span><br><span class="line">PS D:\Desktop\N1&gt; fastboot flash boot boot.img</span><br><span class="line">Sending <span class="string">'boot'</span> (13858 KB)                          OKAY [  0.620s]</span><br><span class="line">Writing <span class="string">'boot'</span>                                     OKAY [  0.666s]</span><br><span class="line">Finished. Total time: 1.290s</span><br><span class="line">PS D:\Desktop\N1&gt; fastboot flash recovery recovery.img</span><br><span class="line">Sending <span class="string">'recovery'</span> (17866 KB)                      OKAY [  0.802s]</span><br><span class="line">Writing <span class="string">'recovery'</span>                                 OKAY [  0.869s]</span><br><span class="line">Finished. Total time: 1.684s</span><br><span class="line">PS D:\Desktop\N1&gt;</span><br></pre></td></tr></table></figure><h3 id="å°†-OpenWrt-åˆ·å…¥-EMMC"><a href="#å°†-OpenWrt-åˆ·å…¥-EMMC" class="headerlink" title="å°† OpenWrt åˆ·å…¥ EMMC"></a>å°† OpenWrt åˆ·å…¥ EMMC</h3><p>é™çº§æˆåŠŸä¹‹åæˆ‘ä»¬å°±å¯ä»¥å¼€æœºè¿›å…¥çº¿åˆ·æ¨¡å¼ï¼Œä»è€Œå¯ä»¥é€‰æ‹©ä» U ç›˜è®¾å¤‡å¯åŠ¨ï¼Œä¹‹æ‰€ä»¥é™çº§ä¹Ÿæ˜¯å› ä¸ºè¿™ï¼Œé«˜ç‰ˆæœ¬çš„å›ºä»¶å±è”½äº†è¿™ä¸€åŠŸèƒ½ã€‚æˆ‘ä»¬æ— æ³•ç›´æ¥å°† OpenWrt çš„é•œåƒå†™å…¥åˆ°ç›’å­çš„ EMMC å­˜å‚¨ä¸­ï¼Œè¦è¿›å…¥åˆ°ä¸€ä¸ªå« Armbian çš„åµŒå…¥å¼ç³»ç»Ÿä¸­ï¼Œåœ¨ Armbian ç³»ç»Ÿé‡Œå°† OpenWrt é•œåƒå†™å…¥åˆ° EMMC å­˜å‚¨è®¾å¤‡ä¸­ã€‚è€Œä¹Ÿæœ‰ä¸€äº›å¤§ä½¬å°†äºŒè€…çš„é•œåƒç»“åˆåœ¨ä¸€èµ·ï¼Œä¹Ÿå°±æ˜¯å¯ä»¥ä½¿ç”¨è¯¥é•œåƒåœ¨ U ç›˜æ¨¡å¼ä¸‹å°† OpenWrt é•œåƒå†™å…¥åˆ° EMMC ä¸­ï¼Œå¹¶ä¸”å‡†å¤‡å¥½äº†è‡ªåŠ¨å†™å…¥çš„è„šæœ¬ï¼Œæ¯”è¾ƒæ–¹ä¾¿ã€‚è¯¥é•œåƒå¯ä»¥ä» <a href="https://www.right.com.cn/forum/thread-981406-1-1.html" target="_blank" rel="noopener">29+ç‰ˆN1_OP_Uç›˜ç›´åˆ·åŒ…ï¼ŒåŠè´å£³äº‘_OP_çº¿åˆ·åŒ…ï¼Œå†…æ ¸5.4</a> æ‰¾åˆ°ã€‚</p><h4 id="å†™å…¥-U-ç›˜é•œåƒ"><a href="#å†™å…¥-U-ç›˜é•œåƒ" class="headerlink" title="å†™å…¥ U ç›˜é•œåƒ"></a>å†™å…¥ U ç›˜é•œåƒ</h4><p>æˆ‘å†™å…¥ U ç›˜çš„é•œåƒæ˜¯ N1_<strong>Openwrt_R20.2.15_k5.4.23-amlogic-flippy-28+.img</strong> ä¹Ÿå°±æ˜¯ <code>N1-Openwrt_Uç›˜ç›´åˆ·åŒ…</code> ï¼Œå†™å…¥å·¥å…·ä½¿ç”¨  <a href="https://github.com/pbatard/rufus" target="_blank" rel="noopener">Rufus</a> æˆ– <a href="https://www.roadkil.net/program.php?ProgramID=12" target="_blank" rel="noopener">Roadkils DiskImage</a> éƒ½å¯ä»¥ï¼Œå°±å’Œæˆ‘ä»¬å¹³æ—¶åˆ¶ä½œå¯åŠ¨ç›˜ä¸€æ ·ã€‚</p><h4 id="ä»-update-æ¨¡å¼å¯åŠ¨-Armbian"><a href="#ä»-update-æ¨¡å¼å¯åŠ¨-Armbian" class="headerlink" title="ä» update æ¨¡å¼å¯åŠ¨ Armbian"></a>ä» update æ¨¡å¼å¯åŠ¨ Armbian</h4><p>è¦æ‹”æ‰ USB å…¬å¯¹å…¬çš„çº¿ï¼Œç›’å­å¼€æœºåä½¿ç”¨ bat è„šæœ¬è¿›å…¥çº¿åˆ·æ¨¡å¼ï¼Œåœ¨ update æ¨¡å¼ä¸‹æ‰å¯ä»¥ä»æˆ‘ä»¬åˆšåˆšå†™å…¥çš„é•œåƒ U ç›˜ä¸­å¯åŠ¨ã€‚å¦‚æœä½ ä¸‹è½½å¥½ Google Drive ä¸Šçš„èµ„æºçš„è¯ï¼Œå·¥å…·åœ¨ <code>/ç©æ³•0--å„ç§ç©æ³•å¿…å¤‡å·¥å…·/2---è¿›çº¿åˆ·æ¨¡å¼å·¥å…·---å¯åŠ¨Uç›˜ç³»ç»Ÿå‰è¦å…ˆè¿›çº¿åˆ·æ¨¡å¼/è¿›çº¿åˆ·æ¨¡å¼å·¥å…·</code> ä¸‹çš„</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">@echo off</span><br><span class="line">echo æœ¬å·¥å…·é€šè¿‡adbè¿æ¥ä½¿N1é‡å¯è¿›å…¥çº¿åˆ·æ¨¡å¼!</span><br><span class="line">echo è¯·å…ˆç”¨usbåŒå…¬å¤´çº¿è¿æ¥ç›’å­å’Œç”µè„‘!</span><br><span class="line">echo made by webpad</span><br><span class="line">set /p ip=è¯·è¾“å…¥ç›’å­çš„å†…ç½‘IPåœ°å€ï¼š</span><br><span class="line">adb kill<span class="literal">-server</span></span><br><span class="line"><span class="keyword">if</span> <span class="string">"%ip%"</span> == <span class="string">""</span> echo æç¤ºï¼šè¯·è¾“å…¥æ­£ç¡®çš„IPåœ°å€ &amp;&amp; goto <span class="keyword">end</span></span><br><span class="line">echo å¼€å§‹é€šè¿‡ç½‘ç»œè¿›è¡ŒADBè¿æ¥â€¦â€¦</span><br><span class="line">adb connect %ip%</span><br><span class="line">adb devices <span class="literal">-l</span> | findstr <span class="string">"p230"</span></span><br><span class="line"><span class="keyword">if</span> %ERRORLEVEL% NEQ <span class="number">0</span> echo è¿æ¥æµ‹è¯•å¤±è´¥ï¼è¯·ç¡®ä¿å·²å¼€å¯è¿œç¨‹è°ƒè¯•ï¼&amp;&amp;goto <span class="keyword">end</span></span><br><span class="line">echo *</span><br><span class="line">echo *</span><br><span class="line">echo *</span><br><span class="line">echo ç›’å­å·²é‡å¯è¿›å…¥çº¿åˆ·æ¨¡å¼ï¼Œè‹¥windowså‘ç°äº†æ–°è®¾å¤‡ï¼Œè¯·åœ¨è®¾å¤‡ç®¡ç†å™¨ä¸­æ‰‹åŠ¨å®‰è£…é©±åŠ¨ï¼Œæ­¤çª—å£å¯ä»¥å…³é—­...</span><br><span class="line">adb shell reboot update</span><br><span class="line">del adbshell.txt &gt;nul <span class="number">2</span>&gt;nul</span><br><span class="line"></span><br><span class="line">:<span class="keyword">end</span></span><br><span class="line">echo æŒ‰ä»»æ„é”®é€€å‡º...</span><br><span class="line">pause &gt; nul</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œå®Œè¯¥è„šæœ¬å<strong>æç¤ºæˆåŠŸè¿›å…¥çº¿åˆ·æ¨¡å¼æ—¶å°±é©¬ä¸Šæ’åˆ·å¥½é•œåƒçš„ U ç›˜</strong> ä¸è¦é”™è¿‡æ—¶æœº(ã€‚ãƒ»âˆ€ãƒ»)ãƒ</p><p>å…¶å®è¿™ä¸ªå·¥å…·ä¹Ÿå°±æ˜¯ä¸€æ¡ <code>adb shell reboot update</code> æŒ‡ä»¤è€Œå·²ï¼Œ<code>abd connect  IP</code> è¿æ¥åˆ°ç›’å­ä¹‹åï¼Œç„¶åå†æ‰§è¡Œ <code>adb shell reboot update</code> ï¼Œç„¶åå†æ’å…¥åˆšåˆšå†™å¥½é•œåƒçš„ U ç›˜ã€‚æ’ä¸Š HMDI çº¿è¿æ¥æ˜¾ç¤ºå™¨å°±ä¼šçœ‹åˆ°æ§åˆ¶ç»ˆç«¯è¾“å‡ºç€å¯åŠ¨æµç¨‹çš„ç”»é¢ï¼Œä¸Šé¢è¿˜æœ‰å››åªå°ä¼é¹…ï¼Œè¿™å°±è¯´æ˜æˆ‘ä»¬æˆåŠŸè¿›å…¥äº† Armbian ç³»ç»Ÿ</p><h4 id="å°†-OpenWrt-å†™å…¥åˆ°-EMMC-å­˜å‚¨ä¸­"><a href="#å°†-OpenWrt-å†™å…¥åˆ°-EMMC-å­˜å‚¨ä¸­" class="headerlink" title="å°† OpenWrt å†™å…¥åˆ° EMMC å­˜å‚¨ä¸­"></a>å°† OpenWrt å†™å…¥åˆ° EMMC å­˜å‚¨ä¸­</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /root</span><br><span class="line">./inst-to-emmc.sh</span><br></pre></td></tr></table></figure><p>è¯¥è„šæœ¬æˆåŠŸæ‰§è¡Œåï¼Œé‡å¯æ‹”æ‰ U ç›˜å°±å¯ä»¥ç›´æ¥è¿›å…¥åˆ° OpenWrt ç³»ç»Ÿä¸­äº†ï¼šï¼‰</p><h2 id="OpenWrt-ä¸Šçš„ä¸€äº›å°ä¼˜åŒ–"><a href="#OpenWrt-ä¸Šçš„ä¸€äº›å°ä¼˜åŒ–" class="headerlink" title="OpenWrt ä¸Šçš„ä¸€äº›å°ä¼˜åŒ–"></a>OpenWrt ä¸Šçš„ä¸€äº›å°ä¼˜åŒ–</h2><p>ä½¿ç”¨  <code>ifconfig eth0 192.168.0.211 netmask 255.255.255.0</code> ä¿®æ”¹ eth0 çš„ IP ï¼Œä½†ä¾æ—§æ— æ³• ping é€š 192.168.0.1 ç½‘å…³ï¼Œè¿˜éœ€è¦ä¿®æ”¹ä¸€ä¸‹ LAN å£çš„é…ç½®ã€‚</p><h3 id="ä¿®æ”¹-IP"><a href="#ä¿®æ”¹-IP" class="headerlink" title="ä¿®æ”¹ IP"></a>ä¿®æ”¹ IP</h3><p>ç”±äº LAN å£é»˜è®¤çš„æ˜¯ <code>192.168.1.1</code> ï¼Œå¦‚æœä½ çš„ç½‘ç»œä¸æ˜¯åœ¨è¯¥ç½‘æ®µä¸‹çš„è¯å°±è¿ä¸ä¸Šè¯¥è®¾å¤‡ï¼Œæ‰€ä»¥å¦‚æœä¸æ˜¯é‡‡ç”¨ç›´è¿ç½‘çº¿çš„è¯ï¼Œè€Œæ˜¯å°†ç›’å­è¿æ¥åœ¨è·¯ç”±å™¨ï¼Œè¿™æ—¶å°±éœ€è¦æ‰‹åŠ¨ä¿®æ”¹ä¸€ä¸‹é»˜è®¤çš„é…ç½®æ‰èƒ½è¿æ¥åˆ°ç›’å­ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">config</span> <span class="string">interface</span> <span class="string">'lan'</span></span><br><span class="line">        <span class="string">option</span> <span class="string">type</span> <span class="string">'bridge'</span></span><br><span class="line">        <span class="string">option</span> <span class="string">ifname</span> <span class="string">'eth0'</span></span><br><span class="line">        <span class="string">option</span> <span class="string">proto</span> <span class="string">'static'</span></span><br><span class="line">        <span class="string">option</span> <span class="string">netmask</span> <span class="string">'255.255.255.0'</span></span><br><span class="line">        <span class="string">option</span> <span class="string">dns</span> <span class="string">'119.29.29.29'</span></span><br><span class="line">        <span class="string">option</span> <span class="string">gateway</span> <span class="string">'192.168.0.1'</span></span><br><span class="line">        <span class="string">option</span> <span class="string">delegate</span> <span class="string">'0'</span></span><br><span class="line">        <span class="string">option</span> <span class="string">ipaddr</span> <span class="string">'192.168.0.211'</span></span><br></pre></td></tr></table></figure><p>ä¿®æ”¹ä¸€ä¸‹ lan ç½‘å£çš„ IP ä¸ºä½ å†…ç½‘å¯è®¿é—®åˆ°çš„ IP å³å¯ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨è¯¥ IP è®¿é—® OpenWrt ç³»ç»Ÿäº†</p><h3 id="å®‰è£…å¿…å¤‡å·¥å…·"><a href="#å®‰è£…å¿…å¤‡å·¥å…·" class="headerlink" title="å®‰è£…å¿…å¤‡å·¥å…·"></a>å®‰è£…å¿…å¤‡å·¥å…·</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é¦–å…ˆä¿®æ”¹ä¸€ä¸‹ opkg æºï¼Œé»˜è®¤ç»™ä¿®æ”¹ä¸ºä¸­ç§‘å¤§çš„ä»£ç†é•œåƒç«™äº†ï¼Œè¿™ç‚¹ä¸é”™</span></span><br><span class="line">â•­â”€root@OpenWrt /mnt</span><br><span class="line">â•°â”€<span class="comment"># opkg update</span></span><br><span class="line">Downloading https://openwrt.proxy.ustclug.org/snapshots/targets/armvirt/64/packages/Packages.gz</span><br><span class="line">Updated list of available packages <span class="keyword">in</span> /var/opkg-lists/openwrt_core</span><br><span class="line">Downloading</span><br></pre></td></tr></table></figure><ul><li>git  è¿™æ˜¯å¿…é¡»çš„å‘€</li><li>ca-bundle å’Œ ca-certificatesï¼Œhttps å¿…é¡»è¦ç”¨åˆ°çš„</li><li>git-http å¦‚æœä¸è£…çš„è¯åœ¨ git clone https çš„ repo æ—¶ä¼šæç¤º <a href="https://stackoverflow.com/questions/8329485/unable-to-find-remote-helper-for-https-during-git-clone" target="_blank" rel="noopener">â€œUnable to find remote helper for â€˜httpsâ€™â€ during git clone</a></li><li>zsh å’Œ oh-my-zshï¼Œå¼ºå¤§çš„ shell ä¸ç”¨åºŸè¯ğŸ˜‹</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">â•­â”€root@OpenWrt /mnt</span><br><span class="line">â•°â”€<span class="comment"># opkg install git zsh git-http ca-bundle ca-certificates wget curl</span></span><br><span class="line">Package git (2.25.1-1) installed <span class="keyword">in</span> root is up to date.</span><br><span class="line">Package zsh (5.7.1-1) installed <span class="keyword">in</span> root is up to date.</span><br><span class="line">Package git-http (2.25.1-1) installed <span class="keyword">in</span> root is up to date.</span><br><span class="line">Package ca-bundle (20190110-2) installed <span class="keyword">in</span> root is up to date.</span><br><span class="line">Package ca-certificates (20190110-2) installed <span class="keyword">in</span> root is up to date.</span><br><span class="line">Upgrading wget on root from 1.20.3-2 to 1.20.3-3...</span><br><span class="line">Downloading https://openwrt.proxy.ustclug.org/snapshots/packages/aarch64_generic/packages/wget_1.20.3-3_aarch64_generic.ipk</span><br><span class="line">Multiple packages (librt and librt) providing same name marked HOLD or PREFER. Using latest.</span><br><span class="line">Upgrading curl on root from 7.66.0-1 to 7.68.0-1...</span><br><span class="line">Downloading https://openwrt.proxy.ustclug.org/snapshots/packages/aarch64_generic/base/curl_7.68.0-1_aarch64_generic.ipk</span><br><span class="line">Configuring curl.</span><br><span class="line">Configuring wget.</span><br></pre></td></tr></table></figure><h4 id="zsh-è¸©å‘"><a href="#zsh-è¸©å‘" class="headerlink" title="zsh è¸©å‘"></a>zsh è¸©å‘</h4><p>å®‰è£…å®Œ oh-my-zsh ä¹‹åï¼Œä¸ä¼šå¸®ä½ ä¿®æ”¹ <code>/etc/passwd</code> ä¸­çš„é…ç½®ï¼Œéœ€è¦æ‰‹åŠ¨ä¿®æ”¹ï¼Œç„¶åæˆ‘è¿˜æ˜¯æŒ‰ç…§å¾€å¸¸çš„ä¿®æ”¹æ–¹æ³•ï¼š</p><p><code>root:x:0:0:root:/root:/bin/zsh</code></p><p>ç¬¬äºŒå¤©æˆ‘å¼€å¼€å¿ƒå¿ƒåœ° ssh ç™»å½•æ—¶ï¼Œå½“åœºç¿»è½¦äº†ï¼Œå®ƒä¼šæç¤º<code>Permission denied, please try again.</code> ï¼Œå’¦æˆ‘å¯†ç å°±æ˜¯è¿™ä¸ªå‘€ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">debug1: Next authentication method: password</span><br><span class="line">root@192.168.0.211<span class="string">'s password:</span></span><br><span class="line"><span class="string">debug1: Authentications that can continue: publickey,password,keyboard-interactive</span></span><br><span class="line"><span class="string">Permission denied, please try again.</span></span><br><span class="line"><span class="string">root@192.168.0.211'</span>s password:</span><br></pre></td></tr></table></figure><p>ç„¶åæˆ‘é€šè¿‡ OpenWrt çš„ web ç®¡ç†é¡µé¢èƒ½æ­£å¸¸ç™»å½•ï¼Œåœ¨ web ç®¡ç†ä¸­çš„ <code>TTYD ç»ˆç«¯</code>ä¸­å°è¯•ç™»å½•ï¼Œç„¶åå°±ä¼šæç¤ºä½  <code>connection closed</code> ï¼Œçœ‹æ¥æ‰¾åˆ°é—®é¢˜çš„åŸå› äº†ï¼Œç”¨æˆ·ç™»å½•æ—¶æ— æ³•æ‰§è¡Œå®ƒçš„ shell æ‰€è‡´ã€‚æ¯”è¾ƒå¥½çš„è§£å†³åŠæ³•å°±æ˜¯åœ¨ web ç®¡ç†é¡µé¢ <code>ç³»ç»Ÿ â€“&gt; å¤‡ä»½/å‡çº§</code>é‚£é‡Œå¤‡ä»½é…ç½®æ–‡ä»¶ â€“&gt;æŠŠå¤‡ä»½ä¸‹è½½ä¸‹æ¥ â€“&gt; <del>ç„¶åè§£åŒ…åä¿®æ”¹é…ç½®æ–‡ä»¶å†æ‰“åŒ…</del> ç›´æ¥ä½¿ç”¨ vim æ‰“å¼€ tar åŒ…ä¿®æ”¹ <code>/etc/passwd</code> â€“&gt; å†ä¸Šä¼ æ¢å¤é…ç½®æ–‡ä»¶å³å¯ã€‚æ›²çº¿æ•‘å›½ ã¤ï¹âŠ‚ ä¸è¿‡åœ¨æ­¤éœ€è¦æ³¨æ„ä¸€ä¸‹å¤‡ä»½æ–‡ä»¶çš„ç›®å½•ç»“æ„ï¼Œè§£åŒ…å‰ç›®å½•ç»“æ„æ˜¯ä»€ä¹ˆæ ·ï¼Œé‡æ–°æ‰“åŒ…ä¹‹åçš„ç›®å½•ç»“æ„ä¹Ÿæ˜¯ä»€ä¹ˆæ ·ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">OpenWrt login: root</span><br><span class="line">Password:</span><br><span class="line">login: can<span class="string">'t execute '</span>/bin/zsh<span class="string">': No such file or directory</span></span><br></pre></td></tr></table></figure><p>åœ¨ Debian å’Œ Ubuntu å‘è¡Œç‰ˆä¸­ zsh ä¼šé»˜è®¤å®‰è£…åœ¨ <code>/bin/zsh</code> ä¸‹ï¼Œå¹¶åˆ›å»ºä¸€ä¸ª <code>/usr/bin/zsh</code> çš„ä¸€ä¸ªè½¯é“¾æ¥ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">â•­â”€debian@debian /mnt/d/Desktop</span><br><span class="line">â•°â”€$ ls -alh /bin/zsh</span><br><span class="line">-rwxr-xr-x 1 root root 842K Feb  5  2019 /bin/zsh</span><br><span class="line">â•­â”€debian@debian /mnt/d/Desktop</span><br><span class="line">â•°â”€$ ls -alh /usr/bin/zsh</span><br><span class="line">lrwxrwxrwx 1 root root 8 Aug 31  2019 /usr/bin/zsh -&gt; /bin/zsh</span><br></pre></td></tr></table></figure><p>è€Œåœ¨ OpenWrt ä¸­å´é»˜è®¤å®‰è£…åœ¨äº† <code>/usr/bin/zsh</code> ä¸‹ï¼Œä¹Ÿæ²¡æœ‰ä¸º <code>/bin/zsh</code> åˆ›å»ºä¸€ä¸ªè½¯é“¾æ¥ï¼Œä¹Ÿå°è¯•è¿‡ä½¿ç”¨scp çš„æ–¹å¼å°† <code>/usr/bin/zsh</code> å¤åˆ¶åˆ° <code>/bin/zsh</code> ï¼Œæ²¡æƒ³åˆ° scp ä¹Ÿéœ€è¦ç”¨æˆ·çš„ shell ç¨‹åºæ¥æ‰§è¡ŒğŸ˜</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># OpenWrt ä¸‹ zsh çš„å®‰è£…è·¯å¾„ä¸º /usr/bin/zsh è€Œä¸æ˜¯ä¼ ç»Ÿå‘ç›¸ç‰ˆä¸­çš„ /bin/zsh</span></span><br><span class="line">â•­â”€root@OpenWrt ~</span><br><span class="line">â•°â”€<span class="comment"># where zsh</span></span><br><span class="line">/usr/bin/zsh</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°è¯•ä½¿ç”¨ scp å¤åˆ¶ä¸€ä»½ zsh åˆ° /bin/zsh ï¼Œä¸å¾—è¡Œï¼ğŸ˜‚</span></span><br><span class="line">â•­â”€debian@debian ~</span><br><span class="line">â•°â”€$ scp root@192.168.0.211:/usr/bin/zsh root@192.168.0.211:/bin/zsh</span><br><span class="line">root@192.168.0.211<span class="string">'s password:</span></span><br><span class="line"><span class="string">Permission denied, please try again.</span></span><br></pre></td></tr></table></figure><h3 id="éƒ¨ç½²ä¸€ä¸‹-K3s"><a href="#éƒ¨ç½²ä¸€ä¸‹-K3s" class="headerlink" title="éƒ¨ç½²ä¸€ä¸‹ K3s"></a>éƒ¨ç½²ä¸€ä¸‹ K3s</h3><p>è¿™é‡Œåªæ˜¯ç®€å•çš„éƒ¨ç½²è¯•ç”¨ä¸€ä¸‹ï¼ŒåæœŸæˆ‘ä¼šè¯¦ç»†è®²ä¸€ä¸‹å…³äº K3s çš„å†…å®¹ã€‚</p><h4 id="å®˜æ–¹è„šæœ¬"><a href="#å®˜æ–¹è„šæœ¬" class="headerlink" title="å®˜æ–¹è„šæœ¬"></a>å®˜æ–¹è„šæœ¬</h4><p>æ ¹æ®å®˜æ–¹çš„è„šæœ¬ä¸€å¥å‘½ä»¤è¡Œ<code>curl -sfL https://get.k3s.io | sh -</code>å°±èƒ½è·‘èµ· K3s å‡ºæ¥ï¼Œæ¯”èµ·éš”å£çš„ K8s è¦ç®€å•å¾ˆå¤šå¾ˆå¤šã€‚ä½†æ˜¯è„šæœ¬ä¸€æ‰§è¡Œå°±ç¿»è½¦äº†ğŸ˜‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">â•­â”€root@OpenWrt ~</span><br><span class="line">â•°â”€<span class="comment"># curl -sfL https://get.k3s.io | sh -</span></span><br><span class="line">[ERROR]  Can not find systemd or openrc to use as a process supervisor <span class="keyword">for</span> k3s</span><br></pre></td></tr></table></figure><p>ç”±äº OpenWrt æ²¡æœ‰ systemd å’Œ OpenRC æ¥ç®¡ç†è¿›ç¨‹ï¼Œæ‰€ä»¥æ— æ³•é€šè¿‡è„šæœ¬çš„æ–¹å¼ä¸€é”®éƒ¨ç½²ï¼Œåªèƒ½äºŒè¿›åˆ¶éƒ¨ç½²å•¦ã€‚å› ä¸º systemd å¯¹äº OpenWrt æ¥è®²è¿‡äºå¤æ‚è‡ƒè‚¿ï¼Œå¯¹äºå‡ å MB ç”šè‡³å‡  MB å­˜å‚¨ç©ºé—´çš„è·¯ç”±å™¨æ¥è¯´å®åœ¨æ˜¯è£…ä¸ä¸‹ã€‚æ‰€ä»¥ OpenWrt ä½¿ç”¨çš„ init ç³»ç»Ÿæ˜¯ <code>procd</code></p><blockquote><p>Whereas desktop distributions use <a href="https://en.wikipedia.org/wiki/GLib" target="_blank" rel="noopener">glib</a>+<a href="https://en.wikipedia.org/wiki/D-Bus" target="_blank" rel="noopener">dbus</a>+<a href="https://en.wikipedia.org/wiki/udev" target="_blank" rel="noopener">udev(part of systemd)</a>, OpenWrt uses <a href="https://openwrt.org/docs/techref/libubox" target="_blank" rel="noopener">libubox</a>+<a href="https://openwrt.org/docs/techref/ubus" target="_blank" rel="noopener">ubus</a>+<a href="https://openwrt.org/docs/techref/hotplug_legacy" target="_blank" rel="noopener">hotplug2</a>. This provides some pretty awesome functionality without requiring huge libraries with huge dependencies (<em>cough</em> glib).</p></blockquote><h4 id="äºŒè¿›åˆ¶éƒ¨ç½²"><a href="#äºŒè¿›åˆ¶éƒ¨ç½²" class="headerlink" title="äºŒè¿›åˆ¶éƒ¨ç½²"></a>äºŒè¿›åˆ¶éƒ¨ç½²</h4><p>åœ¨ K3s çš„ release é¡µé¢ä¸‹è½½åˆ° <a href="https://github.com/rancher/k3s/releases/download/v1.17.3%2Bk3s1/k3s-arm64" target="_blank" rel="noopener">k3s-arm64</a> äºŒè¿›åˆ¶æ–‡ä»¶ã€‚æˆ‘æ”¾åœ¨äº† <code>/opt/bin/</code> ç›®å½•ä¸‹ï¼Œå¹¶åœ¨ <code>.zshrc</code> è¿½åŠ  <code>export PATH=/opt/bin:$PATH</code> ç¯å¢ƒå˜é‡ã€‚</p><h4 id="usage"><a href="#usage" class="headerlink" title="usage"></a>usage</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">â•­â”€root@OpenWrt ~</span><br><span class="line">â•°â”€<span class="comment"># k3s</span></span><br><span class="line">NAME:</span><br><span class="line">   k3s - Kubernetes, but small and simple</span><br><span class="line"></span><br><span class="line">USAGE:</span><br><span class="line">   k3s [global options] <span class="built_in">command</span> [<span class="built_in">command</span> options] [arguments...]</span><br><span class="line"></span><br><span class="line">VERSION:</span><br><span class="line">   v1.17.3+k3s1 (5b17a175)</span><br><span class="line"></span><br><span class="line">COMMANDS:</span><br><span class="line">   server        Run management server</span><br><span class="line">   agent         Run node agent</span><br><span class="line">   kubectl       Run kubectl</span><br><span class="line">   crictl        Run crictl</span><br><span class="line">   ctr           Run ctr</span><br><span class="line">   check-config  Run config check</span><br><span class="line">   <span class="built_in">help</span>, h       Shows a list of commands or <span class="built_in">help</span> <span class="keyword">for</span> one <span class="built_in">command</span></span><br><span class="line"></span><br><span class="line">GLOBAL OPTIONS:</span><br><span class="line">   --debug        Turn on debug logs [<span class="variable">$K3S_DEBUG</span>]</span><br><span class="line">   --<span class="built_in">help</span>, -h     show <span class="built_in">help</span></span><br><span class="line">   --version, -v  <span class="built_in">print</span> the version</span><br></pre></td></tr></table></figure><h4 id="check-config"><a href="#check-config" class="headerlink" title="check-config"></a>check-config</h4><p>å¯åŠ¨ä¸€ä¸ª K3s é›†ç¾¤ä¹‹å‰çº¿ check config ä¸€ä¸‹ä¸‹ğŸ˜‹</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">â•­â”€root@OpenWrt</span> <span class="string">~</span></span><br><span class="line"><span class="string">â•°â”€#</span> <span class="string">k3s</span> <span class="string">check-config</span></span><br><span class="line"><span class="string">INFO[0000]</span> <span class="string">Preparing</span> <span class="string">data</span> <span class="string">dir</span> <span class="string">/var/lib/rancher/k3s/data/a61d93bc56bb3dd34b5ca93517164f5b503e16b6c7414e87b11cf336eeb8ebd7</span></span><br><span class="line"></span><br><span class="line"><span class="attr">Verifying binaries in /var/lib/rancher/k3s/data/a61d93bc56bb3dd34b5ca93517164f5b503e16b6c7414e87b11cf336eeb8ebd7/bin:</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">sha256sum:</span> <span class="string">good</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">links:</span> <span class="string">good</span></span><br><span class="line"></span><br><span class="line"><span class="attr">System:</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">/usr/sbin</span> <span class="string">iptables</span> <span class="string">v1.8.3</span> <span class="string">(legacy):</span> <span class="string">ok</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">swap:</span> <span class="string">disabled</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">routes:</span> <span class="string">ok</span></span><br><span class="line"></span><br><span class="line"><span class="attr">Limits:</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">/proc/sys/kernel/keys/root_maxkeys:</span> <span class="number">1000000</span></span><br><span class="line"></span><br><span class="line"><span class="attr">modprobe:</span> <span class="string">module</span> <span class="string">configs</span> <span class="string">not</span> <span class="string">found</span> <span class="string">in</span> <span class="string">modules.dep</span></span><br><span class="line"><span class="attr">info:</span> <span class="string">reading</span> <span class="string">kernel</span> <span class="string">config</span> <span class="string">from</span> <span class="string">/proc/config.gz</span> <span class="string">...</span></span><br><span class="line"></span><br><span class="line"><span class="attr">Generally Necessary:</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">cgroup hierarchy:</span> <span class="string">properly</span> <span class="string">mounted</span> <span class="string">[/sys/fs/cgroup]</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">CONFIG_NAMESPACES:</span> <span class="string">enabled</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">CONFIG_NET_NS:</span> <span class="string">enabled</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">CONFIG_PID_NS:</span> <span class="string">enabled</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">CONFIG_IPC_NS:</span> <span class="string">enabled</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">CONFIG_UTS_NS:</span> <span class="string">enabled</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">CONFIG_CGROUPS:</span> <span class="string">enabled</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">CONFIG_CGROUP_CPUACCT:</span> <span class="string">enabled</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">CONFIG_CGROUP_DEVICE:</span> <span class="string">enabled</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">CONFIG_CGROUP_FREEZER:</span> <span class="string">enabled</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">CONFIG_CGROUP_SCHED:</span> <span class="string">enabled</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">CONFIG_CPUSETS:</span> <span class="string">enabled</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">CONFIG_MEMCG:</span> <span class="string">enabled</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">CONFIG_KEYS:</span> <span class="string">enabled</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">CONFIG_VETH:</span> <span class="string">enabled</span> <span class="string">(as</span> <span class="string">module)</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">CONFIG_BRIDGE:</span> <span class="string">enabled</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">CONFIG_BRIDGE_NETFILTER:</span> <span class="string">enabled</span> <span class="string">(as</span> <span class="string">module)</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">CONFIG_NF_NAT_IPV4:</span> <span class="string">missing</span> <span class="string">(fail)</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">CONFIG_IP_NF_FILTER:</span> <span class="string">enabled</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">CONFIG_IP_NF_TARGET_MASQUERADE:</span> <span class="string">enabled</span> <span class="string">(as</span> <span class="string">module)</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">CONFIG_NETFILTER_XT_MATCH_ADDRTYPE:</span> <span class="string">enabled</span> <span class="string">(as</span> <span class="string">module)</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">CONFIG_NETFILTER_XT_MATCH_CONNTRACK:</span> <span class="string">enabled</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">CONFIG_NETFILTER_XT_MATCH_IPVS:</span> <span class="string">enabled</span> <span class="string">(as</span> <span class="string">module)</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">CONFIG_IP_NF_NAT:</span> <span class="string">enabled</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">CONFIG_NF_NAT:</span> <span class="string">enabled</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">CONFIG_NF_NAT_NEEDED:</span> <span class="string">missing</span> <span class="string">(fail)</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">CONFIG_POSIX_MQUEUE:</span> <span class="string">enabled</span></span><br><span class="line"></span><br><span class="line"><span class="attr">Optional Features:</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">CONFIG_USER_NS:</span> <span class="string">enabled</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">CONFIG_SECCOMP:</span> <span class="string">enabled</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">CONFIG_CGROUP_PIDS:</span> <span class="string">enabled</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">CONFIG_BLK_CGROUP:</span> <span class="string">enabled</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">CONFIG_BLK_DEV_THROTTLING:</span> <span class="string">enabled</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">CONFIG_CGROUP_PERF:</span> <span class="string">enabled</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">CONFIG_CGROUP_HUGETLB:</span> <span class="string">enabled</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">CONFIG_NET_CLS_CGROUP:</span> <span class="string">enabled</span> <span class="string">(as</span> <span class="string">module)</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">CONFIG_CGROUP_NET_PRIO:</span> <span class="string">enabled</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">CONFIG_CFS_BANDWIDTH:</span> <span class="string">enabled</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">CONFIG_FAIR_GROUP_SCHED:</span> <span class="string">enabled</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">CONFIG_RT_GROUP_SCHED:</span> <span class="string">enabled</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">CONFIG_IP_NF_TARGET_REDIRECT:</span> <span class="string">enabled</span> <span class="string">(as</span> <span class="string">module)</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">CONFIG_IP_SET:</span> <span class="string">enabled</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">CONFIG_IP_VS:</span> <span class="string">enabled</span> <span class="string">(as</span> <span class="string">module)</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">CONFIG_IP_VS_NFCT:</span> <span class="string">enabled</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">CONFIG_IP_VS_PROTO_TCP:</span> <span class="string">enabled</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">CONFIG_IP_VS_PROTO_UDP:</span> <span class="string">enabled</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">CONFIG_IP_VS_RR:</span> <span class="string">enabled</span> <span class="string">(as</span> <span class="string">module)</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">CONFIG_EXT4_FS:</span> <span class="string">enabled</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">CONFIG_EXT4_FS_POSIX_ACL:</span> <span class="string">enabled</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">CONFIG_EXT4_FS_SECURITY:</span> <span class="string">enabled</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">Network Drivers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">"overlay":</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">CONFIG_VXLAN:</span> <span class="string">enabled</span> <span class="string">(as</span> <span class="string">module)</span></span><br><span class="line">      <span class="string">Optional</span> <span class="string">(for</span> <span class="string">encrypted</span> <span class="string">networks):</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">CONFIG_CRYPTO:</span> <span class="string">enabled</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">CONFIG_CRYPTO_AEAD:</span> <span class="string">enabled</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">CONFIG_CRYPTO_GCM:</span> <span class="string">enabled</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">CONFIG_CRYPTO_SEQIV:</span> <span class="string">enabled</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">CONFIG_CRYPTO_GHASH:</span> <span class="string">enabled</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">CONFIG_XFRM:</span> <span class="string">enabled</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">CONFIG_XFRM_USER:</span> <span class="string">enabled</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">CONFIG_XFRM_ALGO:</span> <span class="string">enabled</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">CONFIG_INET_ESP:</span> <span class="string">enabled</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">CONFIG_INET_XFRM_MODE_TRANSPORT:</span> <span class="string">missing</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">Storage Drivers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">"overlay":</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">CONFIG_OVERLAY_FS:</span> <span class="string">enabled</span></span><br><span class="line"></span><br><span class="line"><span class="attr">STATUS:</span> <span class="number">2</span> <span class="string">(fail)</span></span><br></pre></td></tr></table></figure><p>å‘ç° <code>ONFIG_NF_NAT_IPV4: missing (fail)</code> å’Œ <code>CONFIG_NF_NAT_NEEDED: missing (fail)</code> å¤±è´¥äº†ğŸ™ƒï¼Œå…ˆä¸ç®¡çœ‹çœ‹èƒ½ä¸èƒ½è·‘èµ·æ¥å†è¯´ã€‚</p><h4 id="åˆ›å»º-K3s-é›†ç¾¤"><a href="#åˆ›å»º-K3s-é›†ç¾¤" class="headerlink" title="åˆ›å»º K3s é›†ç¾¤"></a>åˆ›å»º K3s é›†ç¾¤</h4><p>æ ¹æ® K3s çš„æ–‡æ¡£ï¼Œä½¿ç”¨ <code>k3s server</code>  é€‰é¡¹å°±èƒ½åˆ›å»ºä¸€ä¸ª K3s é›†ç¾¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line">â•­â”€root@OpenWrt ~</span><br><span class="line">â•°â”€<span class="comment"># k3s server</span></span><br><span class="line">INFO[2020-03-08T20:17:00.103499172+08:00] Starting k3s v1.17.3+k3s1 (5b17a175)</span><br><span class="line">INFO[2020-03-08T20:17:00.112443368+08:00] Kine listening on unix://kine.sock</span><br><span class="line">INFO[2020-03-08T20:17:01.572347551+08:00] Active TLS secret  (ver=) (count 7): map[listener.cattle.io/cn-10.43.0.1:10.43.0.1 listener.cattle.io/cn-127.0.0.1:127.0.0.1 listener.cattle.io/cn-192.168.0.212:192.168.0.212 listener.cattle.io/cn-kubernetes:kubernetes listener.cattle.io/cn-kubernetes.default:kubernetes.default listener.cattle.io/cn-kubernetes.default.svc.cluster.local:kubernetes.default.svc.cluster.local listener.cattle.io/cn-localhost:localhost listener.cattle.io/<span class="built_in">hash</span>:089b0c6a0b78e5f9d3a33b154e97185f644ed693bee80d4559c47e00f19af2f8]</span><br><span class="line">INFO[2020-03-08T20:17:01.591244044+08:00] Running kube-apiserver --advertise-port=6443 --allow-privileged=<span class="literal">true</span> --anonymous-auth=<span class="literal">false</span> --api-audiences=unknown --authorization-mode=Node,RBAC --basic-auth-file=/var/lib/rancher/k3s/server/cred/passwd --<span class="built_in">bind</span>-address=127.0.0.1 --cert-dir=/var/lib/rancher/k3s/server/tls/temporary-certs --client-ca-file=/var/lib/rancher/k3s/server/tls/client-ca.crt --<span class="built_in">enable</span>-admission-plugins=NodeRestriction --etcd-servers=unix://kine.sock --insecure-port=0 --kubelet-certificate-authority=/var/lib/rancher/k3s/server/tls/server-ca.crt --kubelet-client-certificate=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.crt --kubelet-client-key=/var/lib/rancher/k3s/server/tls/client-kube-apiserver.key --proxy-client-cert-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.crt --proxy-client-key-file=/var/lib/rancher/k3s/server/tls/client-auth-proxy.key --requestheader-allowed-names=system:auth-proxy --requestheader-client-ca-file=/var/lib/rancher/k3s/server/tls/request-header-ca.crt --requestheader-extra-headers-prefix=X-Remote-Extra- --requestheader-group-headers=X-Remote-Group --requestheader-username-headers=X-Remote-User --secure-port=6444 --service-account-issuer=k3s --service-account-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-account-signing-key-file=/var/lib/rancher/k3s/server/tls/service.key --service-cluster-ip-range=10.43.0.0/16 --storage-backend=etcd3 --tls-cert-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.crt --tls-private-key-file=/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.key</span><br><span class="line">Flag --basic-auth-file has been deprecated, Basic authentication mode is deprecated and will be removed <span class="keyword">in</span> a future release. It is not recommended <span class="keyword">for</span> production environments.</span><br><span class="line">I0308 20:17:01.593861    9319 server.go:622] external host was not specified, using 192.168.0.212</span><br><span class="line">I0308 20:17:01.594884    9319 server.go:163] Version: v1.17.3+k3s1</span><br><span class="line">I0308 20:17:04.485872    9319 plugins.go:158] Loaded 11 mutating admission controller(s) successfully <span class="keyword">in</span> the following order: NamespaceLifecycle,LimitRanger,ServiceAccount,NodeRestriction,TaintNodesByCondition,Priority,DefaultTolerationSeconds,DefaultStorageClass,StorageObjectInUseProtection,MutatingAdmissionWebhook,RuntimeClass.</span><br><span class="line">I0308 20:17:04.485954    9319 plugins.go:161] Loaded 7 validating admission controller(s) successfully <span class="keyword">in</span> the following order: LimitRanger,ServiceAccount,Priority,PersistentVolumeClaimResize,ValidatingAdmissionWebhook,RuntimeClass,ResourceQuota.</span><br><span class="line">I0308 20:17:04.491004    9319 plugins.go:158] Loaded 11 mutating admission controller(s) successfully <span class="keyword">in</span> the following order: NamespaceLifecycle,LimitRanger,ServiceAccount,NodeRestriction,TaintNodesByCondition,Priority,DefaultTolerationSeconds,DefaultStorageClass,StorageObjectInUseProtection,MutatingAdmissionWebhook,RuntimeClass.</span><br><span class="line">I0308 20:17:04.491084    9319 plugins.go:161] Loaded 7 validating admission controller(s) successfully <span class="keyword">in</span> the following order: LimitRanger,ServiceAccount,Priority,PersistentVolumeClaimResize,ValidatingAdmissionWebhook,RuntimeClass,ResourceQuota.</span><br><span class="line">I0308 20:17:04.592193    9319 master.go:267] Using reconciler: lease</span><br><span class="line">I0308 20:17:04.699310    9319 rest.go:115] the default service ipfamily <span class="keyword">for</span> this cluster is: IPv4</span><br><span class="line">W0308 20:17:06.161374    9319 genericapiserver.go:404] Skipping API batch/v2alpha1 because it has no resources.</span><br><span class="line">W0308 20:17:06.212135    9319 genericapiserver.go:404] Skipping API discovery.k8s.io/v1alpha1 because it has no resources.</span><br><span class="line">W0308 20:17:06.264606    9319 genericapiserver.go:404] Skipping API node.k8s.io/v1alpha1 because it has no resources.</span><br><span class="line">W0308 20:17:06.361403    9319 genericapiserver.go:404] Skipping API rbac.authorization.k8s.io/v1alpha1 because it has no resources.</span><br><span class="line">W0308 20:17:06.379432    9319 genericapiserver.go:404] Skipping API scheduling.k8s.io/v1alpha1 because it has no resources.</span><br><span class="line">W0308 20:17:06.447661    9319 genericapiserver.go:404] Skipping API storage.k8s.io/v1alpha1 because it has no resources.</span><br><span class="line">W0308 20:17:06.550084    9319 genericapiserver.go:404] Skipping API apps/v1beta2 because it has no resources.</span><br><span class="line">W0308 20:17:06.550168    9319 genericapiserver.go:404] Skipping API apps/v1beta1 because it has no resources.</span><br><span class="line">I0308 20:17:06.599929    9319 plugins.go:158] Loaded 11 mutating admission controller(s) successfully <span class="keyword">in</span> the following order: NamespaceLifecycle,LimitRanger,ServiceAccount,NodeRestriction,TaintNodesByCondition,Priority,DefaultTolerationSeconds,DefaultStorageClass,StorageObjectInUseProtection,MutatingAdmissionWebhook,RuntimeClass.</span><br><span class="line">I0308 20:17:06.600017    9319 plugins.go:161] Loaded 7 validating admission controller(s) successfully <span class="keyword">in</span> the following order: LimitRanger,ServiceAccount,Priority,PersistentVolumeClaimResize,ValidatingAdmissionWebhook,RuntimeClass,ResourceQuota.</span><br><span class="line">I0308 20:17:16.394308    9319 dynamic_cafile_content.go:166] Starting client-ca-bundle::/var/lib/rancher/k3s/server/tls/client-ca.crt</span><br><span class="line">I0308 20:17:16.394308    9319 dynamic_cafile_content.go:166] Starting request-header::/var/lib/rancher/k3s/server/tls/request-header-ca.crt</span><br><span class="line">I0308 20:17:16.395251    9319 dynamic_serving_content.go:129] Starting serving-cert::/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.crt::/var/lib/rancher/k3s/server/tls/serving-kube-apiserver.key</span><br><span class="line">I0308 20:17:16.397910    9319 secure_serving.go:178] Serving securely on 127.0.0.1:6444</span><br><span class="line">I0308 20:17:16.398017    9319 tlsconfig.go:219] Starting DynamicServingCertificateController</span><br><span class="line">I0308 20:17:16.398379    9319 autoregister_controller.go:140] Starting autoregister controller</span><br><span class="line">I0308 20:17:16.398459    9319 cache.go:32] Waiting <span class="keyword">for</span> caches to sync <span class="keyword">for</span> autoregister controller</span><br><span class="line">I0308 20:17:16.398723    9319 available_controller.go:386] Starting AvailableConditionController</span><br><span class="line">I0308 20:17:16.398794    9319 cache.go:32] Waiting <span class="keyword">for</span> caches to sync <span class="keyword">for</span> AvailableConditionController controller</span><br><span class="line">I0308 20:17:16.399089    9319 crdregistration_controller.go:111] Starting crd-autoregister controller</span><br><span class="line">I0308 20:17:16.399288    9319 shared_informer.go:197] Waiting <span class="keyword">for</span> caches to sync <span class="keyword">for</span> crd-autoregister</span><br><span class="line">I0308 20:17:16.399546    9319 crd_finalizer.go:263] Starting CRDFinalizer</span><br><span class="line">I0308 20:17:16.399790    9319 controller.go:85] Starting OpenAPI controller</span><br><span class="line">I0308 20:17:16.400002    9319 customresource_discovery_controller.go:208] Starting DiscoveryController</span><br><span class="line">I0308 20:17:16.400341    9319 naming_controller.go:288] Starting NamingConditionController</span><br><span class="line">I0308 20:17:16.400638    9319 establishing_controller.go:73] Starting EstablishingController</span><br><span class="line">I0308 20:17:16.400854    9319 nonstructuralschema_controller.go:191] Starting NonStructuralSchemaConditionController</span><br><span class="line">I0308 20:17:16.401201    9319 apiapproval_controller.go:185] Starting KubernetesAPIApprovalPolicyConformantConditionController</span><br><span class="line">I0308 20:17:16.402017    9319 cluster_authentication_trust_controller.go:440] Starting cluster_authentication_trust_controller controller</span><br><span class="line">I0308 20:17:16.402094    9319 shared_informer.go:197] Waiting <span class="keyword">for</span> caches to sync <span class="keyword">for</span> cluster_authentication_trust_controller</span><br><span class="line">I0308 20:17:16.403447    9319 apiservice_controller.go:94] Starting APIServiceRegistrationController</span><br><span class="line">I0308 20:17:16.403537    9319 cache.go:32] Waiting <span class="keyword">for</span> caches to sync <span class="keyword">for</span> APIServiceRegistrationController controller</span><br><span class="line">I0308 20:17:16.403681    9319 controller.go:81] Starting OpenAPI AggregationController</span><br><span class="line">I0308 20:17:16.418176    9319 dynamic_cafile_content.go:166] Starting client-ca-bundle::/var/lib/rancher/k3s/server/tls/client-ca.crt</span><br><span class="line">I0308 20:17:16.419045    9319 dynamic_cafile_content.go:166] Starting request-header::/var/lib/rancher/k3s/server/tls/request-header-ca.crt</span><br><span class="line">I0308 20:17:16.606683    9319 shared_informer.go:204] Caches are synced <span class="keyword">for</span> cluster_authentication_trust_controller</span><br><span class="line">I0308 20:17:16.613199    9319 cache.go:39] Caches are synced <span class="keyword">for</span> autoregister controller</span><br><span class="line">I0308 20:17:16.614373    9319 cache.go:39] Caches are synced <span class="keyword">for</span> AvailableConditionController controller</span><br><span class="line">I0308 20:17:16.614504    9319 shared_informer.go:204] Caches are synced <span class="keyword">for</span> crd-autoregister</span><br><span class="line">I0308 20:17:16.616912    9319 cache.go:39] Caches are synced <span class="keyword">for</span> APIServiceRegistrationController controller</span><br><span class="line">E0308 20:17:16.633217    9319 controller.go:150] Unable to perform initial Kubernetes service initialization: Service <span class="string">"kubernetes"</span> is invalid: spec.clusterIP: Invalid value: <span class="string">"10.43.0.1"</span>: cannot allocate resources of <span class="built_in">type</span> serviceipallocations at this time</span><br><span class="line">E0308 20:17:16.639707    9319 controller.go:155] Unable to remove old endpoints from kubernetes service: StorageError: key not found, Code: 1, Key: /registry/masterleases/192.168.0.212, ResourceVersion: 0, AdditionalErrorMsg:</span><br><span class="line">I0308 20:17:17.394171    9319 controller.go:107] OpenAPI AggregationController: Processing item</span><br><span class="line">I0308 20:17:17.394300    9319 controller.go:130] OpenAPI AggregationController: action <span class="keyword">for</span> item : Nothing (removed from the queue).</span><br><span class="line">I0308 20:17:17.394391    9319 controller.go:130] OpenAPI AggregationController: action <span class="keyword">for</span> item k8s_internal_local_delegation_chain_0000000000: Nothing (removed from the queue).</span><br><span class="line">I0308 20:17:17.431078    9319 storage_scheduling.go:133] created PriorityClass system-node-critical with value 2000001000</span><br><span class="line">I0308 20:17:17.445315    9319 storage_scheduling.go:133] created PriorityClass system-cluster-critical with value 2000000000</span><br><span class="line">I0308 20:17:17.445429    9319 storage_scheduling.go:142] all system priority classes are created successfully or already exist.</span><br><span class="line">I0308 20:17:18.939225    9319 controller.go:606] quota admission added evaluator <span class="keyword">for</span>: roles.rbac.authorization.k8s.io</span><br><span class="line">I0308 20:17:19.103599    9319 controller.go:606] quota admission added evaluator <span class="keyword">for</span>: rolebindings.rbac.authorization.k8s.io</span><br><span class="line">W0308 20:17:19.434785    9319 lease.go:224] Resetting endpoints <span class="keyword">for</span> master service <span class="string">"kubernetes"</span> to [192.168.0.212]</span><br><span class="line">I0308 20:17:19.438264    9319 controller.go:606] quota admission added evaluator <span class="keyword">for</span>: endpoints</span><br><span class="line">INFO[2020-03-08T20:17:19.626006745+08:00] Running kube-scheduler --<span class="built_in">bind</span>-address=127.0.0.1 --kubeconfig=/var/lib/rancher/k3s/server/cred/scheduler.kubeconfig --leader-elect=<span class="literal">false</span> --port=10251 --secure-port=0</span><br><span class="line">INFO[2020-03-08T20:17:19.629360634+08:00] Running kube-controller-manager --allocate-node-cidrs=<span class="literal">true</span> --<span class="built_in">bind</span>-address=127.0.0.1 --cluster-cidr=10.42.0.0/16 --cluster-signing-cert-file=/var/lib/rancher/k3s/server/tls/server-ca.crt --cluster-signing-key-file=/var/lib/rancher/k3s/server/tls/server-ca.key --kubeconfig=/var/lib/rancher/k3s/server/cred/controller.kubeconfig --leader-elect=<span class="literal">false</span> --port=10252 --root-ca-file=/var/lib/rancher/k3s/server/tls/server-ca.crt --secure-port=0 --service-account-private-key-file=/var/lib/rancher/k3s/server/tls/service.key --use-service-account-credentials=<span class="literal">true</span></span><br><span class="line">I0308 20:17:19.655674    9319 controllermanager.go:161] Version: v1.17.3+k3s1</span><br><span class="line">I0308 20:17:19.657868    9319 deprecated_insecure_serving.go:53] Serving insecurely on [::]:10252</span><br><span class="line">INFO[2020-03-08T20:17:19.658915754+08:00] Waiting <span class="keyword">for</span> cloudcontroller rbac role to be created</span><br><span class="line">INFO[2020-03-08T20:17:19.664219593+08:00] Creating CRD addons.k3s.cattle.io</span><br><span class="line">INFO[2020-03-08T20:17:19.686759095+08:00] Creating CRD helmcharts.helm.cattle.io</span><br><span class="line">W0308 20:17:19.691464    9319 authorization.go:47] Authorization is disabled</span><br><span class="line">W0308 20:17:19.691548    9319 authentication.go:92] Authentication is disabled</span><br><span class="line">I0308 20:17:19.691602    9319 deprecated_insecure_serving.go:51] Serving healthz insecurely on [::]:10251</span><br><span class="line">INFO[2020-03-08T20:17:19.762954369+08:00] Waiting <span class="keyword">for</span> CRD helmcharts.helm.cattle.io to become available</span><br><span class="line">INFO[2020-03-08T20:17:20.280122513+08:00] Done waiting <span class="keyword">for</span> CRD helmcharts.helm.cattle.io to become available</span><br><span class="line">INFO[2020-03-08T20:17:20.320314726+08:00] Writing static file: /var/lib/rancher/k3s/server/static/charts/traefik-1.81.0.tgz</span><br><span class="line">INFO[2020-03-08T20:17:20.321243908+08:00] Writing manifest: /var/lib/rancher/k3s/server/manifests/coredns.yaml</span><br><span class="line">INFO[2020-03-08T20:17:20.321700333+08:00] Writing manifest: /var/lib/rancher/k3s/server/manifests/metrics-server/aggregated-metrics-reader.yaml</span><br><span class="line">INFO[2020-03-08T20:17:20.322113756+08:00] Writing manifest: /var/lib/rancher/k3s/server/manifests/metrics-server/metrics-apiservice.yaml</span><br><span class="line">INFO[2020-03-08T20:17:20.322546305+08:00] Writing manifest: /var/lib/rancher/k3s/server/manifests/metrics-server/metrics-server-deployment.yaml</span><br><span class="line">INFO[2020-03-08T20:17:20.322947895+08:00] Writing manifest: /var/lib/rancher/k3s/server/manifests/metrics-server/metrics-server-service.yaml</span><br><span class="line">INFO[2020-03-08T20:17:20.323365277+08:00] Writing manifest: /var/lib/rancher/k3s/server/manifests/metrics-server/resource-reader.yaml</span><br><span class="line">INFO[2020-03-08T20:17:20.323768992+08:00] Writing manifest: /var/lib/rancher/k3s/server/manifests/traefik.yaml</span><br><span class="line">INFO[2020-03-08T20:17:20.324187832+08:00] Writing manifest: /var/lib/rancher/k3s/server/manifests/ccm.yaml</span><br><span class="line">INFO[2020-03-08T20:17:20.324764300+08:00] Writing manifest: /var/lib/rancher/k3s/server/manifests/<span class="built_in">local</span>-storage.yaml</span><br><span class="line">INFO[2020-03-08T20:17:20.325164932+08:00] Writing manifest: /var/lib/rancher/k3s/server/manifests/metrics-server/auth-delegator.yaml</span><br><span class="line">INFO[2020-03-08T20:17:20.325563897+08:00] Writing manifest: /var/lib/rancher/k3s/server/manifests/metrics-server/auth-reader.yaml</span><br><span class="line">INFO[2020-03-08T20:17:20.325996113+08:00] Writing manifest: /var/lib/rancher/k3s/server/manifests/rolebindings.yaml</span><br><span class="line">INFO[2020-03-08T20:17:20.527152139+08:00] Starting k3s.cattle.io/v1, Kind=Addon controller</span><br><span class="line">INFO[2020-03-08T20:17:20.529057920+08:00] Node token is available at /var/lib/rancher/k3s/server/token</span><br><span class="line">INFO[2020-03-08T20:17:20.529286008+08:00] To join node to cluster: k3s agent -s https://192.168.0.212:6443 -t <span class="variable">$&#123;NODE_TOKEN&#125;</span></span><br><span class="line">INFO[2020-03-08T20:17:20.527299933+08:00] Waiting <span class="keyword">for</span> master node  startup: resource name may not be empty</span><br><span class="line">INFO[2020-03-08T20:17:20.725057527+08:00] Waiting <span class="keyword">for</span> cloudcontroller rbac role to be created</span><br><span class="line">I0308 20:17:20.810135    9319 controller.go:606] quota admission added evaluator <span class="keyword">for</span>: addons.k3s.cattle.io</span><br><span class="line">INFO[2020-03-08T20:17:20.830872877+08:00] Starting helm.cattle.io/v1, Kind=HelmChart controller</span><br><span class="line">INFO[2020-03-08T20:17:20.831652182+08:00] Starting batch/v1, Kind=Job controller</span><br><span class="line">INFO[2020-03-08T20:17:20.832798326+08:00] Starting /v1, Kind=Service controller</span><br><span class="line">INFO[2020-03-08T20:17:20.833998971+08:00] Starting /v1, Kind=Pod controller</span><br><span class="line">INFO[2020-03-08T20:17:20.835217450+08:00] Starting /v1, Kind=Endpoints controller</span><br><span class="line">INFO[2020-03-08T20:17:20.836690891+08:00] Starting /v1, Kind=Secret controller</span><br><span class="line">INFO[2020-03-08T20:17:20.838569298+08:00] Starting /v1, Kind=Node controller</span><br></pre></td></tr></table></figure><h4 id="é›†ç¾¤çŠ¶æ€"><a href="#é›†ç¾¤çŠ¶æ€" class="headerlink" title="é›†ç¾¤çŠ¶æ€"></a>é›†ç¾¤çŠ¶æ€</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">â•­â”€root@OpenWrt ~</span><br><span class="line">â•°â”€<span class="comment"># ks cluster-info</span></span><br><span class="line">Kubernetes master is running at https://127.0.0.1:6443</span><br><span class="line">CoreDNS is running at https://127.0.0.1:6443/api/v1/namespaces/kube-system/services/kube-dns:dns/proxy</span><br><span class="line">Metrics-server is running at https://127.0.0.1:6443/api/v1/namespaces/kube-system/services/https:metrics-server:/proxy</span><br><span class="line"></span><br><span class="line">To further debug and diagnose cluster problems, use <span class="string">'kubectl cluster-info dump'</span>.</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line">â•­â”€root@OpenWrt ~</span><br><span class="line">â•°â”€<span class="comment"># ks get node</span></span><br><span class="line">NAME      STATUS   ROLES    AGE     VERSION</span><br><span class="line">openwrt   Ready    master   5m26s   v1.17.3+k3s1</span><br><span class="line">â•­â”€root@OpenWrt ~</span><br><span class="line">â•°â”€<span class="comment"># ks get pod -n kube-system</span></span><br><span class="line">NAME                                      READY   STATUS              RESTARTS   AGE</span><br><span class="line">metrics-server-6d684c7b5-8gv8j            1/1     Running             0          5m20s</span><br><span class="line"><span class="built_in">local</span>-path-provisioner-58fb86bdfd-h8jkk   1/1     Running             0          5m20s</span><br><span class="line">svclb-traefik-9kwxx                       0/2     ContainerCreating   0          3m29s</span><br><span class="line">helm-install-traefik-nw9td                0/1     Completed           2          5m20s</span><br><span class="line">coredns-d798c9dd-62sb9                    1/1     Running             0          5m20s</span><br><span class="line">traefik-6787cddb4b-p6hs9                  1/1     Running             0          3m30s</span><br><span class="line">â•­â”€root@OpenWrt ~</span><br><span class="line">â•°â”€<span class="comment"># ks describe node</span></span><br><span class="line">Name:               openwrt</span><br><span class="line">Roles:              master</span><br><span class="line">Labels:             beta.kubernetes.io/arch=arm64</span><br><span class="line">                    beta.kubernetes.io/instance-type=k3s</span><br><span class="line">                    beta.kubernetes.io/os=linux</span><br><span class="line">                    k3s.io/hostname=openwrt</span><br><span class="line">                    k3s.io/internal-ip=192.168.0.212</span><br><span class="line">                    kubernetes.io/arch=arm64</span><br><span class="line">                    kubernetes.io/hostname=openwrt</span><br><span class="line">                    kubernetes.io/os=linux</span><br><span class="line">                    node-role.kubernetes.io/master=<span class="literal">true</span></span><br><span class="line">                    node.kubernetes.io/instance-type=k3s</span><br><span class="line">Annotations:        flannel.alpha.coreos.com/backend-data: &#123;<span class="string">"VtepMAC"</span>:<span class="string">"ca:8f:da:03:f3:e5"</span>&#125;</span><br><span class="line">                    flannel.alpha.coreos.com/backend-type: vxlan</span><br><span class="line">                    flannel.alpha.coreos.com/kube-subnet-manager: <span class="literal">true</span></span><br><span class="line">                    flannel.alpha.coreos.com/public-ip: 192.168.0.212</span><br><span class="line">                    node.alpha.kubernetes.io/ttl: 0</span><br><span class="line">                    volumes.kubernetes.io/controller-managed-attach-detach: <span class="literal">true</span></span><br><span class="line">CreationTimestamp:  Sun, 08 Mar 2020 20:17:23 +0800</span><br><span class="line">Taints:             &lt;none&gt;</span><br><span class="line">Unschedulable:      <span class="literal">false</span></span><br><span class="line">Lease:</span><br><span class="line">  HolderIdentity:  openwrt</span><br><span class="line">  AcquireTime:     &lt;<span class="built_in">unset</span>&gt;</span><br><span class="line">  RenewTime:       Sun, 08 Mar 2020 20:23:44 +0800</span><br><span class="line">Conditions:</span><br><span class="line">  Type                 Status  LastHeartbeatTime                 LastTransitionTime                Reason                       Message</span><br><span class="line">  ----               ------  -----------------               ------------------              ------                     -------</span><br><span class="line">  NetworkUnavailable   False   Sun, 08 Mar 2020 20:17:38 +0800   Sun, 08 Mar 2020 20:17:38 +0800   FlannelIsUp                  Flannel is running on this node</span><br><span class="line">  MemoryPressure       False   Sun, 08 Mar 2020 20:19:54 +0800   Sun, 08 Mar 2020 20:17:23 +0800   KubeletHasSufficientMemory   kubelet has sufficient memory available</span><br><span class="line">  DiskPressure         False   Sun, 08 Mar 2020 20:19:54 +0800   Sun, 08 Mar 2020 20:17:23 +0800   KubeletHasNoDiskPressure     kubelet has no disk pressure</span><br><span class="line">  PIDPressure          False   Sun, 08 Mar 2020 20:19:54 +0800   Sun, 08 Mar 2020 20:17:23 +0800   KubeletHasSufficientPID      kubelet has sufficient PID available</span><br><span class="line">  Ready                True    Sun, 08 Mar 2020 20:19:54 +0800   Sun, 08 Mar 2020 20:17:34 +0800   KubeletReady                 kubelet is posting ready status</span><br><span class="line">Addresses:</span><br><span class="line">  InternalIP:  192.168.0.212</span><br><span class="line">  Hostname:    openwrt</span><br><span class="line">Capacity:</span><br><span class="line">  cpu:                4</span><br><span class="line">  ephemeral-storage:  925844Ki</span><br><span class="line">  hugepages-1Gi:      0</span><br><span class="line">  hugepages-2Mi:      0</span><br><span class="line">  hugepages-32Mi:     0</span><br><span class="line">  hugepages-64Ki:     0</span><br><span class="line">  memory:             1851688Ki</span><br><span class="line">  pods:               110</span><br><span class="line">Allocatable:</span><br><span class="line">  cpu:                4</span><br><span class="line">  ephemeral-storage:  900661043</span><br><span class="line">  hugepages-1Gi:      0</span><br><span class="line">  hugepages-2Mi:      0</span><br><span class="line">  hugepages-32Mi:     0</span><br><span class="line">  hugepages-64Ki:     0</span><br><span class="line">  memory:             1851688Ki</span><br><span class="line">  pods:               110</span><br><span class="line">System Info:</span><br><span class="line">  Machine ID:                 96581db4e82a9fb36b0553115e64de1a</span><br><span class="line">  System UUID:</span><br><span class="line">  Boot ID:                    87856a60-0482-4ca3-a144-2ec073e1d2c7</span><br><span class="line">  Kernel Version:             5.4.23-amlogic-flippy-28+</span><br><span class="line">  OS Image:                   OpenWrt SNAPSHOT</span><br><span class="line">  Operating System:           linux</span><br><span class="line">  Architecture:               arm64</span><br><span class="line">  Container Runtime Version:  containerd://1.3.3-k3s1</span><br><span class="line">  Kubelet Version:            v1.17.3+k3s1</span><br><span class="line">  Kube-Proxy Version:         v1.17.3+k3s1</span><br><span class="line">PodCIDR:                      10.42.0.0/24</span><br><span class="line">PodCIDRs:                     10.42.0.0/24</span><br><span class="line">ProviderID:                   k3s://openwrt</span><br><span class="line">Non-terminated Pods:          (5 <span class="keyword">in</span> total)</span><br><span class="line">  Namespace                   Name                                       CPU Requests  CPU Limits  Memory Requests  Memory Limits  AGE</span><br><span class="line">  ---------                 ----                                     ------------  ----------  ---------------  -------------  ---</span><br><span class="line">  kube-system                 metrics-server-6d684c7b5-8gv8j             0 (0%)        0 (0%)      0 (0%)           0 (0%)         6m10s</span><br><span class="line">  kube-system                 <span class="built_in">local</span>-path-provisioner-58fb86bdfd-h8jkk    0 (0%)        0 (0%)      0 (0%)           0 (0%)         6m10s</span><br><span class="line">  kube-system                 svclb-traefik-9kwxx                        0 (0%)        0 (0%)      0 (0%)           0 (0%)         4m19s</span><br><span class="line">  kube-system                 coredns-d798c9dd-62sb9                     100m (2%)     0 (0%)      70Mi (3%)        170Mi (9%)     6m10s</span><br><span class="line">  kube-system                 traefik-6787cddb4b-p6hs9                   0 (0%)        0 (0%)      0 (0%)           0 (0%)         4m20s</span><br><span class="line">Allocated resources:</span><br><span class="line">  (Total limits may be over 100 percent, i.e., overcommitted.)</span><br><span class="line">  Resource           Requests   Limits</span><br><span class="line">  --------         -------- ------</span><br><span class="line">  cpu                100m (2%)  0 (0%)</span><br><span class="line">  memory             70Mi (3%)  170Mi (9%)</span><br><span class="line">  ephemeral-storage  0 (0%)     0 (0%)</span><br><span class="line">Events:</span><br><span class="line">  Type     Reason                   Age                    From                 Message</span><br><span class="line">  ----   ------                 ----                 ----               -------</span><br><span class="line">  Normal   Starting                 6m24s                  kubelet, openwrt     Starting kubelet.</span><br><span class="line">  Warning  InvalidDiskCapacity      6m24s                  kubelet, openwrt     invalid capacity 0 on image filesystem</span><br><span class="line">  Normal   NodeHasSufficientPID     6m23s (x2 over 6m24s)  kubelet, openwrt     Node openwrt status is now: NodeHasSufficientPID</span><br><span class="line">  Normal   NodeHasSufficientMemory  6m23s (x2 over 6m24s)  kubelet, openwrt     Node openwrt status is now: NodeHasSufficientMemory</span><br><span class="line">  Normal   NodeHasNoDiskPressure    6m23s (x2 over 6m24s)  kubelet, openwrt     Node openwrt status is now: NodeHasNoDiskPressure</span><br><span class="line">  Normal   NodeAllocatableEnforced  6m23s                  kubelet, openwrt     Updated Node Allocatable <span class="built_in">limit</span> across pods</span><br><span class="line">  Normal   Starting                 6m23s                  kube-proxy, openwrt  Starting kube-proxy.</span><br><span class="line">  Normal   NodeReady                6m13s                  kubelet, openwrt     Node openwrt status is now: NodeReady</span><br></pre></td></tr></table></figure><h2 id="ç»“æŸå•¦"><a href="#ç»“æŸå•¦" class="headerlink" title="ç»“æŸå•¦"></a>ç»“æŸå•¦</h2><p>å…³äº OpenWrt æœ€é‡è¦çš„<code>é€æ˜ä»£ç†æ—è·¯ç½‘å…³</code> è¿˜æ²¡æœ‰è®²åˆ°ï¼Œç¨åå†æ›´æ–°ä¸€ä¸‹ï¼Œæ¯•ç«Ÿæˆ‘ä¹°äº†æ˜¯ç©å„¿ K3s çš„ğŸ˜‚ã€‚æ€»ä¹‹è¿™ä¸ªåƒåœ¾è¿˜æ˜¯å€¼å¾—æ¡çš„ï¼Œå‡†å¤‡å†æ¡å‡ å°ï¼Ÿéƒ¨ç½²ä¸ª K3s é›†ç¾¤ï¼Ÿé«˜å¯ç”¨ï¼Ÿäº”èŠ‚ç‚¹ï¼Ÿä»¨ master ä¿© nodeï¼Ÿï¼ˆé€ƒ</p><p>ä¸è¿‡æ„å¤–å‘ç°è¯¥ç›’å­çš„ USB å£ç«Ÿç„¶æ”¯æŒä½¿ç”¨ echo å‘½ä»¤æ¥ä¿®æ”¹ <code>/sys/bus/usb/devices/usb1/power/level</code> çš„å€¼æ¥æ§åˆ¶ USB çš„ç”µæºçŠ¶æ€ï¼Œè¿™æ ·ä»USB å£å¼•å‡ºæ­£è´Ÿææ¥åœ¨ç»§ç”µå™¨ä¸Šï¼Œè¿™å°±æ˜¯ä¸€ä¸ªé€šè¿‡ç½‘ç»œæ§åˆ¶çš„å¼€å…³ã€‚æˆ‘åœ¨ <code>R6300V2</code> å’Œ <code>WNDR3700V4</code> ä¸Šæ¢¦å¯ä»¥æ±‚æ²¡æœ‰çš„åŠŸèƒ½å±…ç„¶åœ¨è¿™ä¸ªç ´ç›’å­ä¸Šæœ‰ã€‚æ„å¤–æ”¶è·ï¼</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">â•­â”€root@OpenWrt ~</span><br><span class="line">â•°â”€<span class="comment"># tree /sys/bus/usb/devices/usb1/power/</span></span><br><span class="line">/sys/bus/usb/devices/usb1/power/</span><br><span class="line">â”œâ”€â”€ active_duration</span><br><span class="line">â”œâ”€â”€ autosuspend</span><br><span class="line">â”œâ”€â”€ autosuspend_delay_ms</span><br><span class="line">â”œâ”€â”€ connected_duration</span><br><span class="line">â”œâ”€â”€ control</span><br><span class="line">â”œâ”€â”€ level</span><br><span class="line">â”œâ”€â”€ runtime_active_time</span><br><span class="line">â”œâ”€â”€ runtime_status</span><br><span class="line">â”œâ”€â”€ runtime_suspended_time</span><br><span class="line">â”œâ”€â”€ wakeup</span><br><span class="line">â”œâ”€â”€ wakeup_abort_count</span><br><span class="line">â”œâ”€â”€ wakeup_active</span><br><span class="line">â”œâ”€â”€ wakeup_active_count</span><br><span class="line">â”œâ”€â”€ wakeup_count</span><br><span class="line">â”œâ”€â”€ wakeup_expire_count</span><br><span class="line">â”œâ”€â”€ wakeup_last_time_ms</span><br><span class="line">â”œâ”€â”€ wakeup_max_time_ms</span><br><span class="line">â””â”€â”€ wakeup_total_time_ms</span><br></pre></td></tr></table></figure><p>æœ€åç¥å¤§å®¶ <strong>Happy Hacking</strong></p>]]></content>
    
    <summary type="html">
    
      
      
        
        
          &lt;h2 id=&quot;K3s&quot;&gt;&lt;a href=&quot;#K3s&quot;
        
      
    
    </summary>
    
    
      <category term="åˆ·æœº" scheme="https://blog.k8s.li/categories/%E5%88%B7%E6%9C%BA/"/>
    
    
      <category term="è½¯è·¯ç”±" scheme="https://blog.k8s.li/tags/%E8%BD%AF%E8%B7%AF%E7%94%B1/"/>
    
      <category term="OpenWrt" scheme="https://blog.k8s.li/tags/OpenWrt/"/>
    
      <category term="K3s" scheme="https://blog.k8s.li/tags/K3s/"/>
    
  </entry>
  
  <entry>
    <title>è®©å›¾ç‰‡é£èµ·æ¥ oh-my-webp.sh ï¼</title>
    <link href="https://blog.k8s.li/oh-my-webpsh.html"/>
    <id>https://blog.k8s.li/oh-my-webpsh.html</id>
    <published>2020-03-04T16:00:00.000Z</published>
    <updated>2020-03-05T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>å’±æ¥æ¨é”€ webp server go å•¦ ï¼ˆxå°å£°</p></blockquote><h2 id="åŠé€€ä¸‰è¿ğŸ˜‚"><a href="#åŠé€€ä¸‰è¿ğŸ˜‚" class="headerlink" title="åŠé€€ä¸‰è¿ğŸ˜‚"></a>åŠé€€ä¸‰è¿ğŸ˜‚</h2><ul><li>éœ€è¦é…ç½® nginx åå‘ä»£ç†ï¼ˆï¼ï¹ï¼œï¼‰</li><li>å›¾ç‰‡å¿…é¡»æ”¾åœ¨è‡ªå·±çš„æœåŠ¡å™¨ä¸Šï¼Œå›¾åºŠä¸å¾—è¡Œ (ï¾‰*ï½¥Ï‰ï½¥)ï¾‰</li><li>éœ€è¦ç‹¬ç«‹çš„æœåŠ¡å™¨ï¼ŒGitHub page ä¹‹ç±»çš„ä¸å¾—è¡Œï¼ˆâ•¯ï¸¿â•°ï¼‰</li></ul><p>ä¸è¿‡ï¼Œå¯¹äºå·²ç»ä¼šè‡ªç”±è®¿é—®äº’è”ç½‘çš„äººæ¥è¯´è¿™éƒ½ä¸éš¾ (â—Ë‡âˆ€Ë‡â—) ï¼Œé£Ÿç”¨è¿‡ç¨‹ä¸­æœ‰ä»€ä¹ˆç–‘é—®çš„è¯ä¹Ÿå¯ä»¥è”ç³»å’±ï¼Œå’±ä¼šå°½è‡ªå·±æ‰€èƒ½æä¾›ä¸€äº›å¸®åŠ©ğŸ˜˜ï¼Œä¸€èµ·æ¥å®Œå–„è¿™ä¸ªå¼€æºé¡¹ç›®ã€‚</p><h2 id="WebP"><a href="#WebP" class="headerlink" title="WebP"></a>WebP</h2><blockquote><p>WebPçš„æœ‰æŸå‹ç¼©ç®—æ³•æ˜¯åŸºäºVP8è§†é¢‘æ ¼å¼çš„å¸§å†…ç¼–ç [17]ï¼Œå¹¶ä»¥RIFFä½œä¸ºå®¹å™¨æ ¼å¼ã€‚[2] å› æ­¤ï¼Œå®ƒæ˜¯ä¸€ä¸ªå…·æœ‰å…«ä½è‰²å½©æ·±åº¦å’Œä»¥1:2çš„æ¯”ä¾‹è¿›è¡Œè‰²åº¦å­é‡‡æ ·çš„äº®åº¦-è‰²åº¦æ¨¡å‹ï¼ˆYCbCr 4:2:0ï¼‰çš„åŸºäºå—çš„è½¬æ¢æ–¹æ¡ˆã€‚[18] ä¸å«å†…å®¹çš„æƒ…å†µä¸‹ï¼ŒRIFFå®¹å™¨è¦æ±‚åªéœ€20å­—èŠ‚çš„å¼€é”€ï¼Œä¾ç„¶èƒ½ä¿å­˜é¢å¤–çš„ å…ƒæ•°æ®(metadata)ã€‚[2] WebPå›¾åƒçš„è¾¹é•¿é™åˆ¶ä¸º16383åƒç´ ã€‚</p></blockquote><p>WebP æ˜¯ä¸€ç§è¡ç”Ÿè‡ª Google VP8 çš„å›¾åƒæ ¼å¼ï¼ŒåŒæ—¶æ”¯æŒæœ‰æŸå’Œæ— æŸç¼–ç ã€‚å½“ä½¿ç”¨æœ‰æŸæ¨¡å¼ï¼Œå®ƒåœ¨ç›¸åŒä½“ç§¯æä¾›æ¯” JPG å›¾åƒæ›´å¥½çš„è´¨é‡ï¼›å½“ä½¿ç”¨æ— æŸæ¨¡å¼ï¼Œå®ƒæä¾›æ¯”æœ€ä½³å‹ç¼©çš„ PNG å›¾åƒæ›´å°çš„ä½“ç§¯ã€‚ç®€å•æ¥è¯´ï¼ŒWebP å›¾ç‰‡æ ¼å¼çš„å­˜åœ¨ï¼Œè®©æˆ‘ä»¬åœ¨ WebP ä¸Šå±•ç¤ºçš„å›¾ç‰‡ä½“ç§¯å¯ä»¥æœ‰è¾ƒå¤§å¹…åº¦çš„ç¼©å°ã€‚ç½‘ç«™ä¸Šçš„å›¾ç‰‡èµ„æºå¦‚æœä½¿ç”¨ WebPï¼Œé‚£ä¹ˆè‡ªç„¶ä¹Ÿä¼šå‡å°‘è¿™äº›å›¾ç‰‡æ–‡ä»¶çš„åŠ è½½æ—¶é—´ï¼Œä¹Ÿå°±å¸¦æ¥äº†ç½‘ç«™åŠ è½½æ€§èƒ½çš„æå‡ã€‚å…³äº webp å›¾åƒæ ¼å¼çš„å…·ä½“å®ç°ç»†èŠ‚å¯ä»¥å»ç»´åŸºç™¾ç§‘æˆ–è€…æ–‡æœ«æˆ‘æåˆ°çš„æ¨èé˜…è¯»çœ‹ä¸€ä¸‹ï¼Œæ€»ä¹‹ webp å¾ˆé¦™å°±æ˜¯å•¦ (â—â€™â—¡â€™â—)</p><h3 id="æ”¯æŒæƒ…å†µ"><a href="#æ”¯æŒæƒ…å†µ" class="headerlink" title="æ”¯æŒæƒ…å†µ"></a>æ”¯æŒæƒ…å†µ</h3><p>æ ¹æ® <a href="https://caniuse.com/#search=webp" target="_blank" rel="noopener">caniuse</a> çš„ç»Ÿè®¡æƒ…å†µï¼Œä¸»æµæµè§ˆå™¨ï¼ˆæ¥è¿‘80%ï¼‰éƒ½æ”¯æŒ webp äº†ï¼Œå¦‚æœé‡åˆ° Safari è¿™æ ·çš„å¥‡è‘©ï¼Œå’±ç›´æ¥è¿”å›åŸå›¾ã€‚IE æµè§ˆå™¨ï¼Ÿï¼Ÿ</p><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/image-20200306094307271.png" alt="image-20200306094307271"></p><h2 id="webp-sh"><a href="#webp-sh" class="headerlink" title="webp-sh"></a>webp-sh</h2><ul><li>å®˜ç½‘ <a href="https://webp.sh" target="_blank" rel="noopener">webp.sh</a></li><li>GitHub <a href="https://github.com/webp-sh" target="_blank" rel="noopener">webp-sh</a></li></ul><p>webp server é¡¾åæ€ä¹‰å°±æ˜¯ webp æœåŠ¡å™¨å•¦ï¼Œç”¨äºå°†ç½‘ç«™é‡Œçš„å›¾ç‰‡ï¼ˆjpgã€pngã€jpegç­‰ï¼‰è½¬æ¢æˆ webp å›¾åƒç¼–ç æ ¼å¼ï¼Œè€Œä¸”æ— é¡»ä¿®æ”¹åšå®¢ç«™ç‚¹å†…å›¾ç‰‡çš„ url ï¼Œå› æ­¤å¯¹äºè®¿é—®å›¾ç‰‡èµ„æºçš„å®¢æˆ·ç«¯æ¥è®²æ˜¯é€æ˜çš„ã€‚ä¸»æµçš„ CDN ä¹Ÿæ”¯æŒè¿™æ ·ç±»ä¼¼çš„åŠŸèƒ½ï¼Œæ¯”å¦‚ Cloudflare çš„ <a href="">Polish</a> ï¼Œå¯ä»¥å‚è€ƒ <a href="https://support.cloudflare.com/hc/en-us/articles/360000607372-Using-Cloudflare-Polish-to-compress-images">Using Cloudflare Polish to compress images</a> ã€‚ä½†æ˜¯å¤©ä¸‹æ²¡æœ‰å…è´¹çš„åˆé¤ï¼Œå›¾ç‰‡è½¬ç ä¸ç¼–ç è¿™éƒ½æ˜¯è¦ç®—åŠ›çš„ï¼Œéƒ½æ˜¯è¦è®¡ç®—èµ„æºçš„ï¼Œéƒ½æ˜¯è¦ CPU çš„ï¼Œéƒ½æ˜¯è¦èŠ±é’±çš„ğŸ˜‚ã€‚è¯´åˆ°åº•è¿˜æ˜¯ç©·å•Šï¼ˆå’± webp server æ˜¯å¼€æºå…è´¹çš„ã€‚</p><blockquote><p>æœ€é‡è¦çš„ä¸€ç‚¹æ˜¯â€”â€”æˆ‘ä»¬è®¿é—®çš„ URL å¯ä»¥å®Œå…¨ä¸ç”¨æ”¹å˜ï¼Œè®¿å®¢è®¿é—®çš„ä¾ç„¶æ˜¯ <code>https://image.nova.moe/tsuki/tsuki.jpg</code> ï¼Œä½†æ˜¯å¾—åˆ°çš„å›¾ç‰‡æ ¼å¼ä¸ºï¼š<code>image/webp</code>ï¼Œè€Œä¸”ä½“ç§¯å‡å°‘äº†ä¸å°‘ã€‚</p></blockquote><p>å…¶å® webp server æœ‰å¤šç§è¯­è¨€éƒ½å®ç°äº†ï¼Œå¹¶ä¸”è¿™äº›ä»“åº“è¿˜éƒ½æ”¾åœ¨äº† <a href="https://github.com/webp-sh" target="_blank" rel="noopener">webp-sh</a> è¯¥ Organizations ä¸‹ã€‚ä¸è¿‡å’±æ¯”è¾ƒå–œæ¬¢ golang æ‰€ä»¥å°±æ¨è webp server go å•¦ğŸ˜‚ï¼Œéš”å£çš„ webp server rust åˆ«æ‰“æˆ‘å•Šï¼ˆé€ƒ</p><blockquote><p>è¿™ä¸ªå·¥å…·å°±æ˜¯ç”± <a href="https://nova.moe/" target="_blank" rel="noopener">Nova ç«¥é‹</a>ã€ <a href="https://www.bennythink.com" target="_blank" rel="noopener">Benny</a> ã€<a href="https://blog.0xbbc.com/" target="_blank" rel="noopener">cocoa</a> ä»¥åŠ <a href="https://blog.k8s.li/">muzi</a> å°ç›†å‹ä¸€èµ·é¼“æ£çš„ webp_server_go å•¦ï¼</p></blockquote><ul><li><a href="https://github.com/webp-sh/webp_server_go" target="_blank" rel="noopener">webp_server_go</a></li><li><a href="https://github.com/webp-sh/webp_server_rs" target="_blank" rel="noopener">webp_server_rs</a></li><li><a href="https://github.com/webp-sh/webp_server_node" target="_blank" rel="noopener">webp_server_node</a></li><li><a href="https://github.com/webp-sh/webp_server_java" target="_blank" rel="noopener">webp_server_java</a></li><li><a href="https://github.com/webp-sh/webp_server_python" target="_blank" rel="noopener">webp_server_python</a></li></ul><h2 id="é£Ÿç”¨æŒ‡å—"><a href="#é£Ÿç”¨æŒ‡å—" class="headerlink" title="é£Ÿç”¨æŒ‡å—"></a>é£Ÿç”¨æŒ‡å—</h2><h3 id="1-ä¸‹è½½"><a href="#1-ä¸‹è½½" class="headerlink" title="1. ä¸‹è½½"></a>1. ä¸‹è½½</h3><p>é¦–å…ˆåˆ° <a href="https://github.com/webp-sh/webp_server_go/releases" target="_blank" rel="noopener">release</a> é¡µé¢ä¸‹è½½å·²ç»ç¼–è¯‘å¥½çš„äºŒè¿›åˆ¶æ–‡ä»¶æˆ–è€…æ ¹æ®è‡ªå·±çš„å‘è¡Œç‰ˆé€‰æ‹©ä¸‹è½½ rpm æˆ– deb åŒ…ï¼Œåœ¨æ­¤è¦æ³¨æ„é€‰æ‹©ä¸‹è½½ç¬¦åˆè‡ªå·±çš„ arch å’Œ OSã€‚</p><p>è‡³äºå®‰è£…è·¯å¾„ï¼Œæˆ‘ä¸ªäººæ›´å€¾å‘äºæ”¾åœ¨ <code>/opt/</code> ç›®å½•ä¸‹ï¼Œå› ä¸ºè¿™ä¸ªç›®å½•ä¸‹çš„ä¸œè¥¿éƒ½æ˜¯è‡ªå·±å®‰è£…çš„ï¼Œè€Œä¸”ä¹Ÿä¸ä¾èµ–äºç‰¹å®šçš„å‘è¡Œç‰ˆï¼Œæ–¹ä¾¿åšå®¢è¿ç§»ï¼ˆæ¬å®¶ï¼‰ï¼Œæ¬å®¶çš„æ—¶å€™ç›´æ¥æ‰“åŒ… <code>/opt</code> ç›®å½•ï¼Œç„¶å scp ä¸€ä¸‹å°±å·é“ºç›–èµ°äººï¼Œå¤šæ–¹ä¾¿å‘€ğŸ˜‚ã€‚</p><h3 id="2-é…ç½®"><a href="#2-é…ç½®" class="headerlink" title="2. é…ç½®"></a>2. é…ç½®</h3><p>é£Ÿç”¨ webp-server-go ä¹‹å‰é€‰å‡†å¤‡å¥½ä¸€ä¸ª <code>config.json</code> é…ç½®æ–‡ä»¶ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"HOST"</span>: <span class="string">"127.0.0.1"</span>,</span><br><span class="line">  <span class="attr">"PORT"</span>: <span class="string">"3333"</span>,</span><br><span class="line">  <span class="attr">"QUALITY"</span>: <span class="string">"80"</span>,</span><br><span class="line">  <span class="attr">"IMG_PATH"</span>: <span class="string">"/var/www/hexo"</span>,</span><br><span class="line">  <span class="attr">"EXHAUST_PATH"</span>: <span class="string">"./dist"</span>,</span><br><span class="line">  <span class="attr">"ALLOWED_TYPES"</span>: [<span class="string">"jpg"</span>,<span class="string">"png"</span>,<span class="string">"jpeg"</span>,<span class="string">"bmp"</span>,<span class="string">"gif"</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>HOSTï¼šå¯¹äº webp server æœåŠ¡æ¥è®²åªéœ€è¦ç›‘å¬ 127.0.0.1 è¿™ä¸ªæœ¬æœºåœ°å€å°±å¯ä»¥äº†ï¼Œç¨åä½¿ç”¨ nginx åå‘ä»£ç†ä¸€ä¸‹ã€‚</li><li>PORTï¼šå°±æ˜¯ webp server æœåŠ¡ç›‘å¬çš„çš„ç«¯å£å·ï¼Œæ ¹æ®è‡ªå·±éœ€æ±‚ä¿®æ”¹</li><li>QUALITYï¼šç¼–ç çš„è´¨é‡ï¼Œä¸€èˆ¬æ¨è 75 ï¼Œä¸è¿‡ä½¿ç”¨ 80 ä¹Ÿæ˜¯ä¸é”™çš„ã€‚</li><li>IMG_PATHï¼šç½‘ç«™çš„æ ¹ç›®å½•ï¼Œæ ¹ç›®å½•ï¼Œæ ¹ç›®å½•ï¼Œä¸€å®šè¦é…ç½®ä½ å›¾ç‰‡ url çš„æ ¹ç›®å½•ã€‚</li><li>EXHAUST_PATHï¼šè½¬æ¢åçš„ webp å›¾ç‰‡æ–‡ä»¶å­˜æ”¾ä½ç½®ï¼Œæå‰åˆ›å»ºå¥½ã€‚</li><li>ALLOWED_TYPESï¼šå…è®¸è½¬ç çš„å›¾ç‰‡æ ¼å¼ï¼Œç›®å‰æ”¯æŒè¿™å‡ ç§ã€‚</li></ul><p>æ¥ä¸‹æ¥å†é…ç½®ä»¥ä¸‹ nginx ï¼Œä¸‹é¢ä»¥æˆ‘çš„ hexo åšå®¢ä¸ºä¾‹ï¼Œhugo ä¹ŸåŒæ ·å¦‚æ­¤ã€‚å†æ·»åŠ ä¸€å— localtion å­—æ®µå³å¯ï¼Œå¦‚æœä½ ä¿®æ”¹äº†é»˜è®¤ç«¯å£å·çš„è¯ä¸è¦å¿˜è®°ä¿®æ”¹ä¸ºä½ æ”¹ä¹‹åçš„ç«¯å£å·ã€‚</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">location</span> <span class="regexp">~* \.(png|jpg|jpeg)$</span> &#123;</span><br><span class="line">    <span class="attribute">proxy_pass</span> http://127.0.0.1:3333;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>/etc/nginx/conf.d/blog.conf</code></p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">        <span class="attribute">listen</span> <span class="number">80</span>;</span><br><span class="line">        <span class="attribute">listen</span> [::]:<span class="number">80</span>;</span><br><span class="line">        <span class="attribute">server_name</span>  blog.<span class="number">502</span>.li;</span><br><span class="line">        <span class="attribute">set</span> <span class="variable">$base</span> /var/www/hexo/public;</span><br><span class="line">        <span class="attribute">root</span> <span class="variable">$base</span>/;</span><br><span class="line">        <span class="attribute">location</span> / &#123;</span><br><span class="line">            <span class="attribute">index</span>  index.html;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="attribute">location</span> <span class="regexp">~* \.(png|jpg|jpeg)$</span> &#123;</span><br><span class="line">            <span class="attribute">proxy_pass</span> http://127.0.0.1:3333;</span><br><span class="line">            <span class="attribute">proxy_set_header</span> X-Real-IP <span class="variable">$remote_addr</span>;</span><br><span class="line">            <span class="attribute">proxy_hide_header</span> X-Powered-By;</span><br><span class="line">            <span class="attribute">proxy_set_header</span> HOST <span class="variable">$http_host</span>;</span><br><span class="line">            <span class="attribute">add_header</span> Cache-Control <span class="string">'no-store, no-cache, must-revalidate, proxy-revalidate, max-age=0'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸è¿‡åœ¨æ­¤éœ€è¦æ³¨æ„ï¼Œnginx çš„ location å­—æ®µçš„è·¯å¾„ä¸€å®šè¦å’Œ webp server <code>config.json</code> é‡Œçš„ <code>IMG_PATH</code> ç›¸å¯¹åº”ï¼Œä¸ç„¶ä¼šå¯¼è‡´è¯·æ±‚èµ„æºçš„ uri ä¸ webp server è½¬æ¢åçš„æ–‡ä»¶è·¯å¾„ä¸ä¸€è‡´è€Œå¯¼è‡´èµ„æº 404 ã€‚è¿˜æœ‰ä¸€ç‚¹å°±æ˜¯ location é‚£é‡Œä¸èƒ½ä»…ä»…æ·»åŠ  <code>proxy_pass http://127.0.0.1:3333;</code> ï¼Œè¿™æ ·æµè§ˆå™¨çš„ UA ä¼šè¢« nginx ç»™åƒæ‰ğŸ˜„ï¼Œnginx å°†è¯·æ±‚ proxy ç»™ webp server åæ— æ³•ä» headers é‚£é‡Œè·å–åˆ° UA ï¼Œè€Œå¯¼è‡´ <code>Safari</code> æµè§ˆå™¨æ— æ³•æ­£å¸¸è¾“å‡ºåŸå›¾ã€‚æ‰€ä»¥ä»¥ä¸‹å‡ è¡Œæ·»åŠ åœ¨ <code>proxy_pass</code> ä¸‹é¢æ˜¯å¿…é¡»çš„ï¼š</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">proxy_set_header</span> HOST <span class="variable">$http_host</span>;</span><br><span class="line"><span class="attribute">add_header</span> Cache-Control <span class="string">'no-store, no-cache, must-revalidate, proxy-revalidate, max-age=0'</span>;</span><br></pre></td></tr></table></figure><p>æ­¤å¤–æ„Ÿè°¢å¥½å¿ƒè¯»è€…çš„æé†’æ‰å‘ç°è¿™ä¸ª bug ğŸ˜˜</p><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/image-20200307102856702.png" alt="image-20200307102856702"></p><h3 id="3-å¯åŠ¨"><a href="#3-å¯åŠ¨" class="headerlink" title="3.å¯åŠ¨"></a>3.å¯åŠ¨</h3><p>æ‰‹åŠ¨è¿è¡Œèµ·æ¥å¾ˆç®€å•ï¼Œ<code>./webp-server -config /path/to/config.json</code> ï¼Œå¦‚æœè¯¥æœåŠ¡æŒ‚æ‰äº†èµ„æºå°± gg äº†ï¼Œæ‰€ä»¥è¿˜æ˜¯é€‰ç”¨ä¸€ç§ç¨³å®šæŒä¹…åŒ–çš„è¿è¡Œæ–¹å¼ã€‚å’±æ¨èä½¿ç”¨ systemd æ¥å¯åŠ¨ï¼Œè¿™æ · webp server æœåŠ¡æŒ‚æ‰äº†ä¹Ÿä¼šè‡ªåŠ¨æ‹‰èµ·é‡å¯ä¸€ä¸‹ã€‚é¦–å…ˆè¦åˆ›å»ºæˆ–ä¿®æ”¹ä¸€ä¸‹ <code>webps.service</code> é…ç½®æ–‡ä»¶ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=WebP Server</span><br><span class="line">Documentation=https://github.com/webp-sh/webp_server_go</span><br><span class="line">After=nginx.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=simple</span><br><span class="line">StandardError=journal</span><br><span class="line">AmbientCapabilities=CAP_NET_BIND_SERVICE</span><br><span class="line">WorkingDirectory=/opt/webps</span><br><span class="line">ExecStart=/opt/webps/webp-server --config /opt/webps/config.json</span><br><span class="line">ExecReload=/bin/<span class="built_in">kill</span> -HUP <span class="variable">$MAINPID</span></span><br><span class="line">Restart=always</span><br><span class="line">RestartSec=3s</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹ä¸€ä¸‹ <code>ExecStart=/opt/webps/webp-server --config /opt/webps/config.json</code> å’Œ <code>WorkingDirectory=/opt/webps</code> å¯¹åº”çš„è·¯å¾„ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cp webps.service /lib/systemd/system/</span><br><span class="line">systemctl daemon-reload</span><br><span class="line">systemctl <span class="built_in">enable</span> webps.service</span><br><span class="line">systemctl start webps.service</span><br></pre></td></tr></table></figure><h3 id="4-é¢„åŠ è½½"><a href="#4-é¢„åŠ è½½" class="headerlink" title="4.é¢„åŠ è½½"></a>4.é¢„åŠ è½½</h3><p>webp-server-go æœ‰ä¸ªé¢„åŠ è½½çš„åŠŸèƒ½ï¼Œå°±æ˜¯æå‰å°†å…¨éƒ¨çš„å›¾ç‰‡èµ„æºè¿›è¡Œä¸€æ¬¡è½¬æ¢ï¼Œè¿™æ ·å†æ¬¡è®¿é—®å›¾ç‰‡èµ„æºçš„æ—¶å€™å°±ä¸å¿…å†è¿›è¡Œè½¬æ¢ï¼Œè€Œç›´æ¥ä½¿ç”¨å·²ç»è½¬æ¢åçš„ webp æ–‡ä»¶å³å¯ã€‚è¿™ç›¸å½“äºä¸€æ¬¡ â€œç¼“å­˜â€ ã€‚</p><p>ä½¿ç”¨ <code>./webp-server -jobs 1 -config config.json -prefetch</code> æ¥è¿›è¡Œä¸€æ¬¡é¢„åŠ è½½ï¼Œå…¶ä¸­ jobs åé¢çš„æ•°å­—ä¸ºä½  CPU çš„æ ¸å¿ƒæ•°ï¼Œä¹Ÿå¯ä»¥ä¸ç”¨åŠ é»˜è®¤ä½¿ç”¨å…¨éƒ¨æ ¸å¿ƒã€‚</p><h2 id="benchmark"><a href="#benchmark" class="headerlink" title="benchmark"></a>benchmark</h2><p>è¯´åˆ°æ€§èƒ½ï¼Œå’±å¿…é¡»å¾—è¿›è¡Œä¸€æ¬¡å‹æµ‹æ‰èƒ½æ”¾å¿ƒå¤§èƒ†åœ°æ¨èå„ä½é£Ÿç”¨ webp server go å•¦ï¼Œä¸‹é¢å¾—å°±æ˜¯å’±çš„æµ‹è¯•æ•°æ®æ ·ä¾‹ã€‚å›¾ç‰‡çš„æµ‹è¯•æ ·æœ¬æ˜¯å’±ä½¿ç”¨ <a href="https://github.com/Tsuk1ko/pxder" target="_blank" rel="noopener">pxder</a> çˆ¬ä¸‹æ¥çš„ï¼Œæ€»å…± 10600 å¼ å›¾ç‰‡ï¼Œæ€»å¤§å° 11.1 GBã€‚å¦‚æœä½ ä¹Ÿéœ€è¦è¿™äº›æµ‹è¯•æ ·æœ¬çš„è¯å¯ä»¥ç§èŠå’±å‘ç»™ä½ ã€‚ä¸‹é¢å°±æ˜¯çœŸå®çš„æµ‹è¯•æ•°æ®ã€‚æµ‹è¯•ç¯å¢ƒæ˜¯ 8 core Ã—3.4G Hzï¼Œæµ‹è¯•ç‰ˆæœ¬ä¸º <a href="https://github.com/webp-sh/webp_server_go/releases/tag/0.1.0" target="_blank" rel="noopener">v0.1.0</a> ï¼Œä½¿ç”¨çš„æ˜¯é»˜è®¤å‚æ•°é…ç½®ã€‚</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"HOST"</span>: <span class="string">"127.0.0.1"</span>,</span><br><span class="line">  <span class="attr">"PORT"</span>: <span class="string">"3333"</span>,</span><br><span class="line">  <span class="attr">"QUALITY"</span>: <span class="string">"80"</span>,</span><br><span class="line">  <span class="attr">"IMG_PATH"</span>: <span class="string">"./src"</span>,</span><br><span class="line">  <span class="attr">"EXHAUST_PATH"</span>: <span class="string">"./dist"</span>,</span><br><span class="line">  <span class="attr">"ALLOWED_TYPES"</span>: [<span class="string">"jpg"</span>,<span class="string">"png"</span>,<span class="string">"jpeg"</span>,<span class="string">"bmp"</span>,<span class="string">"gif"</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/image-20200304191400500.png" alt="image-20200304191400500"></p><h3 id="æµ‹è¯•ç»“æœ"><a href="#æµ‹è¯•ç»“æœ" class="headerlink" title="æµ‹è¯•ç»“æœ"></a>æµ‹è¯•ç»“æœ</h3><table><thead><tr><th align="center">file_size_range</th><th align="center">file_num</th><th align="center">src_size</th><th align="center">dist_size</th><th align="center">total</th><th align="center">user</th><th align="center">system</th><th align="center">cpu</th><th align="center">core</th></tr></thead><tbody><tr><td align="center">(10KB,500KB)</td><td align="center">4600</td><td align="center">1.3G</td><td align="center">310M</td><td align="center">1:44.49</td><td align="center">905.41s</td><td align="center">9.55s</td><td align="center">875%</td><td align="center">8</td></tr><tr><td align="center">(500KB,1MB)</td><td align="center">3500</td><td align="center">2.4G</td><td align="center">361M</td><td align="center">2:04.81</td><td align="center">1092.50s</td><td align="center">7.98s</td><td align="center">881%</td><td align="center">8</td></tr><tr><td align="center">(1MB,4MB)</td><td align="center">2000</td><td align="center">3.8G</td><td align="center">342M</td><td align="center">2:32.64</td><td align="center">1345.73s</td><td align="center">10.84s</td><td align="center">888%</td><td align="center">8</td></tr><tr><td align="center">(4MB,32MB)</td><td align="center">500</td><td align="center">3.6G</td><td align="center">246M</td><td align="center">1:44.53</td><td align="center">916.91s</td><td align="center">12.03s</td><td align="center">888%</td><td align="center">8</td></tr></tbody></table><h4 id="ä¸åŒæ ¸å¿ƒ-total-å¯¹æ¯”"><a href="#ä¸åŒæ ¸å¿ƒ-total-å¯¹æ¯”" class="headerlink" title="ä¸åŒæ ¸å¿ƒ total å¯¹æ¯”"></a>ä¸åŒæ ¸å¿ƒ total å¯¹æ¯”</h4><table><thead><tr><th align="center">file_size_range</th><th align="center">file_num</th><th align="center">src_size</th><th align="center">dist_size</th><th align="center">8</th><th align="center">4</th><th align="center">2</th><th align="center">1</th></tr></thead><tbody><tr><td align="center">(10KB,500KB)</td><td align="center">4600</td><td align="center">1.3G</td><td align="center">310M</td><td align="center">1:44.49</td><td align="center">2:18.49</td><td align="center">3:36.05</td><td align="center">5:20.88</td></tr><tr><td align="center">(500KB,1MB)</td><td align="center">3500</td><td align="center">2.4G</td><td align="center">361M</td><td align="center">2:04.81</td><td align="center">2:49.46</td><td align="center">4:16.41</td><td align="center">6:28.97</td></tr><tr><td align="center">(1MB,4MB)</td><td align="center">2000</td><td align="center">3.8G</td><td align="center">342M</td><td align="center">2:32.64</td><td align="center">3:26.18</td><td align="center">5:22.15</td><td align="center">7:53.45</td></tr><tr><td align="center">(4MB,32MB)</td><td align="center">500</td><td align="center">3.6G</td><td align="center">246M</td><td align="center">1:44.53</td><td align="center">2:21.22</td><td align="center">3:39.16</td><td align="center">5:28.65</td></tr></tbody></table><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">### 10KB-500KB</span></span><br><span class="line">./webp-server -<span class="built_in">jobs</span> 1 -config config.json -prefetch  632.77s user 11.23s system 200% cpu 5:20.88 total</span><br><span class="line">./webp-server -<span class="built_in">jobs</span> 2 -config config.json -prefetch  639.31s user 8.77s system 299% cpu 3:36.05 total</span><br><span class="line">./webp-server -<span class="built_in">jobs</span> 4 -config config.json -prefetch  676.17s user 8.12s system 494% cpu 2:18.49 total</span><br><span class="line">./webp-server -<span class="built_in">jobs</span> 8 -config config.json -prefetch  905.41s user 9.55s system 875% cpu 1:44.49 total</span><br><span class="line"></span><br><span class="line"><span class="comment">### 500KB-1MB</span></span><br><span class="line"></span><br><span class="line">./webp-server -<span class="built_in">jobs</span> 1 -config config.json -prefetch  767.45s user 10.14s system 199% cpu 6:28.97 total</span><br><span class="line">./webp-server -<span class="built_in">jobs</span> 2 -config config.json -prefetch  778.00s user 8.62s system 295% cpu 4:16.41 total</span><br><span class="line">./webp-server -<span class="built_in">jobs</span> 4 -config config.json -prefetch  831.38s user 7.62s system 495% cpu 2:49.46 total</span><br><span class="line">./webp-server -<span class="built_in">jobs</span> 8 -config config.json -prefetch  1092.50s user 7.98s system 881% cpu 2:04.81 total</span><br><span class="line"></span><br><span class="line"><span class="comment">### 1MB-4MB</span></span><br><span class="line"></span><br><span class="line">./webp-server -<span class="built_in">jobs</span> 1 -config config.json -prefetch  934.22s user 12.45s system 199% cpu 7:53.45 total</span><br><span class="line">./webp-server -<span class="built_in">jobs</span> 2 -config config.json -prefetch  958.41s user 9.41s system 300% cpu 5:22.15 total</span><br><span class="line">./webp-server -<span class="built_in">jobs</span> 4 -config config.json -prefetch  1010.56s user 8.05s system 494% cpu 3:26.18 total</span><br><span class="line">./webp-server -<span class="built_in">jobs</span> 8 -config config.json -prefetch  1345.73s user 10.84s system 888% cpu 2:32.64 total</span><br><span class="line"></span><br><span class="line"><span class="comment">### 4MB-32MB</span></span><br><span class="line"></span><br><span class="line">./webp-server -<span class="built_in">jobs</span> 1 -config config.json -prefetch  641.78s user 10.77s system 187% cpu 5:28.65 total</span><br><span class="line">./webp-server -<span class="built_in">jobs</span> 2 -config config.json -prefetch  643.19s user 9.73s system 297% cpu 3:39.16 total</span><br><span class="line">./webp-server -<span class="built_in">jobs</span> 4 -config config.json -prefetch  688.05s user 9.91s system 494% cpu 2:21.22 total</span><br><span class="line">./webp-server -<span class="built_in">jobs</span> 8 -config config.json -prefetch  916.91s user 12.03s system 888% cpu 1:44.53 total</span><br></pre></td></tr></table></figure><h3 id="è½¬æ¢å‰åå¤§å°å¯¹æ¯”"><a href="#è½¬æ¢å‰åå¤§å°å¯¹æ¯”" class="headerlink" title="è½¬æ¢å‰åå¤§å°å¯¹æ¯”"></a>è½¬æ¢å‰åå¤§å°å¯¹æ¯”</h3><p>ä»¥ä¸‹å’±å°±æˆªå–ä¸€å°éƒ¨åˆ†çš„æµ‹è¯•ç»“æœï¼Œå®Œæ•´çš„æ—¥å¿—æ”¾åœ¨äº†æˆ‘çš„ gist ä¸Š <strong><a href="https://gist.github.com/muzi502/4f7c4128895ac3f438e7a183df219661" target="_blank" rel="noopener">webp-server-go_test.log</a></strong> ã€‚å›¾ç‰‡éƒ½æ˜¯çœŸæ˜¯çš„æ•°æ®ï¼Œæ ¹æ®æ–‡ä»¶åçš„ ID å¯ä»¥åœ¨ pixiv.net ä¸Šæ‰¾åˆ°æºæ–‡ä»¶ï¼Œç›¸ä¿¡è€å¸æœºä»¬éƒ½æ‡‚å¾—ğŸ˜‚ã€‚</p><h4 id="10KB-500KB"><a href="#10KB-500KB" class="headerlink" title="(10KB,500KB)"></a>(10KB,500KB)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">./webp-server -<span class="built_in">jobs</span> 8 -config config.json -prefetch</span><br><span class="line">905.41s user 9.55s system 875% cpu 1:44.49 total</span><br><span class="line"></span><br><span class="line">src    distnum</span><br><span class="line">1.3G310M4600</span><br><span class="line">63304866.png495K40K</span><br><span class="line">40881097.jpg495K118K</span><br><span class="line">21045662.jpg495K94K</span><br><span class="line">67888534.png495K73K</span><br><span class="line">50136421.jpg495K62K</span><br><span class="line">72636668.png495K113K</span><br><span class="line">55156014.jpg495K78K</span><br><span class="line">76671894.png495K59K</span><br><span class="line">64709121.png495K67K</span><br><span class="line">78336881.jpg495K77K</span><br><span class="line">57090512.png494K35K</span><br><span class="line">72153105.jpg494K64K</span><br><span class="line">62457185.png494K39K</span><br><span class="line">44892218.png494K96K</span><br><span class="line">39599640.jpg494K39K</span><br><span class="line">21428544.jpg493K76K</span><br><span class="line">65293876.jpg493K68K</span><br><span class="line">76098632.png493K80K</span><br><span class="line">65418239.jpg493K119K</span><br><span class="line">17900553.jpg493K51K</span><br><span class="line">61511853.jpg493K123K</span><br><span class="line">77984504.png493K56K</span><br><span class="line">54667116.jpg493K56K</span><br><span class="line">75357235.jpg493K67K</span><br><span class="line">21085426.jpg492K55K</span><br></pre></td></tr></table></figure><h4 id="500KB-1MB"><a href="#500KB-1MB" class="headerlink" title="(500KB,1MB)"></a>(500KB,1MB)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">./webp-server -<span class="built_in">jobs</span> 8 -config config.json -prefetch</span><br><span class="line">1092.50s user 7.98s system 881% cpu 2:04.81 total</span><br><span class="line"></span><br><span class="line">srcdistnum</span><br><span class="line">2.4G361M3500</span><br><span class="line"></span><br><span class="line">44937735.png974K74K</span><br><span class="line">56343106.png974K49K</span><br><span class="line">51320479.png974K73K</span><br><span class="line">68346957.jpg974K112K</span><br><span class="line">74882964.png974K150K</span><br><span class="line">76640395.jpg974K75K</span><br><span class="line">62034004.jpg974K110K</span><br><span class="line">59897148.jpg974K147K</span><br><span class="line">46287856.jpg973K68K</span><br><span class="line">54674488.jpg973K111K</span><br><span class="line">42265521.png973K51K</span><br><span class="line">40261146.jpg973K135K</span><br><span class="line">76815098.png973K77K</span><br><span class="line">57095484.png973K99K</span><br><span class="line">65354070.jpg973K206K</span><br><span class="line">24130390.jpg973K121K</span><br><span class="line">73753170.jpg972K106K</span><br><span class="line">64066680.jpg972K92K</span><br><span class="line">72175991.png972K49K</span><br><span class="line">53402985.png972K114K</span><br><span class="line">70710923.png971K63K</span><br><span class="line">76242996.png971K63K</span><br><span class="line">65736419.jpg971K728K</span><br><span class="line">70095856.png971K91K</span><br><span class="line">64284761.png971K53K</span><br><span class="line">73907152.jpg971K101K</span><br><span class="line">62120962.png970K85K</span><br><span class="line">22003560.png970K76K</span><br><span class="line">77293789.jpg970K116K</span><br><span class="line">68647243.png970K46K</span><br><span class="line">54618347.png970K59K</span><br><span class="line">79602155.jpg969K120K</span><br><span class="line">55491641.jpg968K119K</span><br><span class="line">53473372.png968K45K</span><br><span class="line">77569729.jpg968K69K</span><br><span class="line">57420240.png968K61K</span><br><span class="line">69798500.png968K74K</span><br><span class="line">63487148.png968K47K</span><br><span class="line">79687107.jpg967K164K</span><br><span class="line">70081772.jpg966K129K</span><br><span class="line">79623240.jpg966K133K</span><br><span class="line">72535236.jpg966K160K</span><br><span class="line">47680545.png966K162K</span><br></pre></td></tr></table></figure><h4 id="1MB-4MB"><a href="#1MB-4MB" class="headerlink" title="(1MB,4MB)"></a>(1MB,4MB)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">./webp-server -<span class="built_in">jobs</span> 8 -config config.json -prefetch</span><br><span class="line">1345.73s user 10.84s system 888% cpu 2:32.64 total</span><br><span class="line"></span><br><span class="line">src  distnum</span><br><span class="line">3.8G342M2000</span><br><span class="line"></span><br><span class="line">73839511.png4.1M293K</span><br><span class="line">73839511.png4.1M293K</span><br><span class="line">66504933.png4.1M107K</span><br><span class="line">78316050.png4.1M319K</span><br><span class="line">74264931.png4.1M330K</span><br><span class="line">74412671.png4.1M186K</span><br><span class="line">77414892.png4.1M227K</span><br><span class="line">76442741.png4.0M191K</span><br><span class="line">71330750.png4.0M199K</span><br><span class="line">78361206.png4.0M153K</span><br><span class="line">68763693.png4.0M233K</span><br><span class="line">67222487.png4.0M368K</span><br><span class="line">68560466.png4.0M186K</span><br><span class="line">72437850.png4.0M282K</span><br><span class="line">67767752.png4.0M203K</span><br><span class="line">73597995.png4.0M432K</span><br><span class="line">71506633.png4.0M88K</span><br><span class="line">77601042.png4.0M726K</span><br><span class="line">77033762.png4.0M261K</span><br><span class="line">73436647.jpg4.0M514K</span><br><span class="line">78099751.png4.0M283K</span><br><span class="line">73165937.png4.0M202K</span><br><span class="line">74379006.png4.0M300K</span><br><span class="line">79274246.png4.0M191K</span><br><span class="line">69701132.png4.0M129K</span><br><span class="line">67455430.jpg3.9M397K</span><br><span class="line">73651880.png3.9M183K</span><br><span class="line">79152655.png3.9M298K</span><br><span class="line">73117385.png3.9M258K</span><br><span class="line">70281950.png3.9M314K</span><br><span class="line">68501346.png3.9M203K</span><br><span class="line">78895125.png3.9M310K</span><br><span class="line">70159814.png3.9M156K</span><br><span class="line">70764048.jpg3.9M437K</span><br></pre></td></tr></table></figure><h4 id="4MB-32MB"><a href="#4MB-32MB" class="headerlink" title="(4MB,32MB)"></a>(4MB,32MB)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">./webp-server -<span class="built_in">jobs</span> 8 -config config.json -prefetch</span><br><span class="line">916.91s user 12.03s system 888% cpu 1:44.53 total</span><br><span class="line"></span><br><span class="line">srcdistnum</span><br><span class="line">3.8G3.8G500</span><br><span class="line"></span><br><span class="line">78467499.png32M2.8M</span><br><span class="line">79620324.png32M</span><br><span class="line">74975502.png32M3.0M</span><br><span class="line">74902740.png31M2.6M</span><br><span class="line">77032574.png31M2.5M</span><br><span class="line">77673519.png30M2.3M</span><br><span class="line">77298781.png29M1.4M</span><br><span class="line">77959551.png27M1.5M</span><br><span class="line">69987155.png26M649K</span><br><span class="line">74432253.png25M1.6M</span><br><span class="line">78994948.png25M923K</span><br><span class="line">77218195.png24M1.6M</span><br><span class="line">72379562.png22M251K</span><br><span class="line">77559996.png22M1.9M</span><br><span class="line">71522636.png22M1.3M</span><br><span class="line">78236671.png21M1.7M</span><br><span class="line">78033540.jpg20M2.7M</span><br><span class="line">70906047.png19M677K</span><br><span class="line">72498744.png19M882K</span><br><span class="line">73977640.png19M523K</span><br><span class="line">78757823.png18M1.5M</span><br><span class="line">71588979.png18M1.2M</span><br><span class="line">75747535.png17M1.2M</span><br><span class="line">71504158.png17M1.2M</span><br><span class="line">76969768.png17M1.4M</span><br><span class="line">77995994.png17M568K</span><br><span class="line">75340699.png17M1.4M</span><br><span class="line">69821163.png16M1.1M</span><br><span class="line">70050613.png16M1.1M</span><br><span class="line">76559411.png15M1.7M</span><br><span class="line">76576885.png15M853K</span><br><span class="line">75640746.png15M1.4M</span><br><span class="line">78188732.png15M1.4M</span><br><span class="line">73355141.png15M589K</span><br><span class="line">75977096.png15M1.4M</span><br><span class="line">72840608.jpg15M1.8M</span><br><span class="line">75665779.png14M1.5M</span><br><span class="line">77898275.png14M1.2M</span><br><span class="line">79663534.png13M1.2M</span><br><span class="line">76539246.png13M1.2M</span><br><span class="line">70598104.png13M840K</span><br><span class="line">78348611.jpg13M2.7M</span><br></pre></td></tr></table></figure><h2 id="å®é™…æ•ˆæœ"><a href="#å®é™…æ•ˆæœ" class="headerlink" title="å®é™…æ•ˆæœ"></a>å®é™…æ•ˆæœ</h2><p>ä¸ºäº†åšä¸ªå¯¹æ¯”ï¼Œå’±ä½¿ç”¨  <code>hexo.502.li</code> è¿™ä¸ªåŸŸåä¸ºå¯¹ç…§ç»„ï¼Œå³è¾“å‡ºæºæ–‡ä»¶ï¼Œä½¿ç”¨ <code>blog.502.li</code> è¿™ä¸ªåŸŸåä¸ºå®éªŒç»„åŠ ä¸Š webp server æ¥æµ‹è¯•ï¼Œå„ä½è¯»è€…ä¹Ÿå¯ä»¥åˆ†åˆ«è®¿é—®è¿™ä¸¤ä¸ªåŸŸåæ¥å®é™…ä½“éªŒä¹‹é—´çš„å·®åˆ«ï¼Œè‚‰çœ¼å¯è§ğŸ˜‚ã€‚</p><h3 id="no-webps"><a href="#no-webps" class="headerlink" title="no webps"></a>no webps</h3><p>ä¼˜åŒ–å»ºè®®èƒ½èŠ‚çœ 138s ï¼Œä¹‹å‰ä¹Ÿæœ‰è¯»è€…æ™®éåæ˜ å›¾ç‰‡æ‰“å¼€ææ…¢</p><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/no-webp.png" alt="nowebps"></p><h3 id="webps-yes"><a href="#webps-yes" class="headerlink" title="webps yes!"></a>webps yes!</h3><p>ä¼˜åŒ–å»ºè®®èƒ½èŠ‚çœ 19s ï¼Œæ¯”ä¸é€‚ç”¨ webp æ•´æ•´å‡å°‘äº†å°†è¿‘ 2 minğŸ˜‚ï¼Œçœ‹æ¥æ•ˆæœåŠå…¶æ˜æ˜¾å‘€ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/with-webp.png" alt="weith"></p><p>é€‰æ‹©ä¸¤ç¯‡å›¾ç‰‡æ¯”è¾ƒå¤šçš„åšå®¢ï¼Œæµ‹è¯•é“¾æ¥ä¸º ï¼š</p><ul><li><code>https://blog.k8s.li/2020-Lunar-New-Year.html</code></li><li><code>https://blog.k8s.li/wd-hc310-dc-hdd.html</code></li><li><code>https://hexo.502.li/2020-Lunar-New-Year.html</code></li><li><code>https://hexo.502.li/wd-hc310-dc-hdd.html</code></li></ul><h2 id="æ¨èé˜…è¯»"><a href="#æ¨èé˜…è¯»" class="headerlink" title="æ¨èé˜…è¯»"></a>æ¨èé˜…è¯»</h2><ul><li><a href="https://nova.moe/re-introduce-webp-server/" target="_blank" rel="noopener">è®©ç«™ç‚¹å›¾ç‰‡åŠ è½½é€Ÿåº¦æ›´å¿«â€”â€”å¼•å…¥ WebP Server æ— ç¼è½¬æ¢å›¾ç‰‡ä¸º WebP</a></li><li><a href="https://await.moe/2020/02/note-about-encountered-memory-changes-for-no-reason-in-golang/" target="_blank" rel="noopener">è®° Golang ä¸‹é‡åˆ°çš„ä¸€å›ã€Œæ¯«æ— ç”±å¤´ã€çš„å†…å­˜æ›´æ”¹</a></li><li><a href="https://await.moe/2020/02/webp-server-in-rust/" target="_blank" rel="noopener">WebP Server in Rust</a></li><li><a href="https://www.bennythink.com/flying-webp.html" target="_blank" rel="noopener">ä¸ªäººç½‘ç«™æ— ç¼åˆ‡æ¢å›¾ç‰‡åˆ° webp</a></li><li><a href="https://halo.run/archives/halo-and-webp" target="_blank" rel="noopener">ä¼˜é›…çš„è®© Halo æ”¯æŒ webp å›¾ç‰‡è¾“å‡º</a></li><li><a href="https://vince.xin/2018/09/12/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E2%80%94%E2%80%94%E4%BD%BF%E7%94%A8webp%E6%9D%A5%E4%BC%98%E5%8C%96%E4%BD%A0%E7%9A%84%E5%9B%BE%E7%89%87/" target="_blank" rel="noopener">å‰ç«¯æ€§èƒ½ä¼˜åŒ–â€”â€”ä½¿ç”¨webpæ¥ä¼˜åŒ–ä½ çš„å›¾ç‰‡xx</a></li><li><a href="https://aotu.io/notes/2016/06/23/explore-something-of-webp/index.html" target="_blank" rel="noopener">æ¢ç©¶WebPä¸€äº›äº‹å„¿</a></li><li><a href="https://developers.google.com/speed/webp" target="_blank" rel="noopener">A new image format for the Web</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        
        
          &lt;blockquote&gt;
&lt;p&gt;å’±æ¥æ¨é”€ webp
        
      
    
    </summary>
    
    
      <category term="æŠ€æœ¯" scheme="https://blog.k8s.li/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="åšå®¢" scheme="https://blog.k8s.li/tags/%E5%8D%9A%E5%AE%A2/"/>
    
  </entry>
  
  <entry>
    <title>Linux ç½‘ç»œå’Œ iptables è¿è¡ŒåŸç†</title>
    <link href="https://blog.k8s.li/linux-net-and-iptables.html"/>
    <id>https://blog.k8s.li/linux-net-and-iptables.html</id>
    <published>2020-03-01T16:00:00.000Z</published>
    <updated>2020-03-01T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘å‚åŠ äº†ä¸€åœºè§†é¢‘ä¼šè®®é¢è¯•ï¼Œè™½ç„¶ç»“æœå¯èƒ½ä¸å¤ªç†æƒ³ï¼Œä½†è¿˜æ˜¯å‘ç°è‡ªå·±å¯¹æŠ€æœ¯ç»†èŠ‚é’»ç ”çš„ä¸å¤Ÿæ·±ï¼Œä¸€äº›å¾ˆåŸºç¡€æ€§çš„çŸ¥è¯†ç‚¹å¹¶æ²¡æœ‰å½¢æˆä¸€ä¸ªç³»ç»Ÿæ€§çš„çŸ¥è¯†æ¶æ„ã€‚æ¯”å¦‚ TCP å’Œ UDP çš„åŒºåˆ«ï¼Œè¿™æ˜¯å†ç®€å•ä¸è¿‡çš„é—®é¢˜ã€‚è™½ç„¶å¹³æ—¶éƒ½çŸ¥é“ TCP åº”ç”¨äºå“ªäº›åœºæ™¯ï¼ŒUDP åº”ç”¨ä¸å“ªäº›åœºæ™¯ï¼Œä½†äºŒè€…ä¹‹é—´çš„ç»†èŠ‚ï¼Œè¿˜æ˜¯æ²¡èƒ½ä»”ç»†åœ°æ·±å…¥ç ”ç©¶ã€‚æ‰€ä»¥ä»ç°åœ¨å¼€å§‹ä»æ–°å­¦ä¹ ä¸€ä¸‹ä¸€äº›åŸºç¡€æ€§çš„ä¸œè¥¿ï¼Œè¡¥è¶³ä¸€ä¸‹æ¬ ä¸‹çš„çŸ¥è¯†ğŸ˜¥ã€‚ä¸è¿‡è¿™æ¬¡é¢è¯•ä¹Ÿè®©æˆ‘æ„è¯†åˆ°ï¼Œæˆ‘æ˜¯è¯¥ç¦»å¼€è¿™ä¸ªå®‰é€¸çš„ç¯å¢ƒäº†ï¼Œå†è¿‡å‡ å¹´å°±è¦ä¸‰åè€Œç«‹äº†ï¼Œè€Œè¿™å‡ å¹´ä¹Ÿæ­£æ˜¯æŠ€æœ¯ç§¯ç´¯æ²‰æ·€çš„é»„é‡‘æ—¶ä»£ï¼Œå¸Œæœ›çæƒœè¿™æ®µæ—¶å…‰è¸è¸å®å®ç ”ç©¶æŠ€æœ¯ã€‚</p><h2 id="Linux-åè®®æ ˆ"><a href="#Linux-åè®®æ ˆ" class="headerlink" title="Linux åè®®æ ˆ"></a>Linux åè®®æ ˆ</h2><p>åœ¨è®²è§£ iptables ä¹‹å‰è¦å›é¡¾ä¸€ä¸‹ Linux æ¥æ”¶æ•°æ®åŒ…å’Œå‘é€æ•°æ®åŒ…çš„æµç¨‹ï¼Œæ‰èƒ½ç†è§£ iptables åœ¨ Linux ç½‘ç»œåè®®æ ˆä¸­çš„ä½ç½®å’Œä½œç”¨ã€‚å»å¹´çš„æ—¶å€™å¬äº† Go å¤œè¯»çš„  <a href="https://github.com/developer-learning/night-reading-go/issues/506" target="_blank" rel="noopener">ã€Go å¤œè¯»ã€‘ ç½‘ç»œçŸ¥è¯†åå…¨å¤§è¡¥ä¸¸</a> ï¼Œæ¨èå»çœ‹ä¸€ä¸‹<a href="https://www.youtube.com/watch?v=30wCahZEjNg" target="_blank" rel="noopener">YouTubeã€Go å¤œè¯»ã€‘#68 ç½‘ç»œçŸ¥è¯†åå…¨å¤§è¡¥ä¸¸</a>ã€‚</p><blockquote><p>åç«¯å·¥ç¨‹å¸ˆåœ¨å·¥ä½œä¸­ç»å¸¸ä¼šé‡åˆ°è®¡ç®—æœºç½‘ç»œæ–¹é¢çš„é—®é¢˜ï¼Œç½‘ç»œå¯¹å¤šæ•°äººæ¥è¯´è¿˜æ˜¯ä¸€ä¸ªé»‘ç›’å­ï¼Œæœ¬æ¬¡æŠ€æœ¯åˆ†äº«ä»å¸¸è§çš„ç½‘ç»œç¡¬ä»¶ã€ä¼ä¸šå’Œæ•°æ®ä¸­å¿ƒçš„ç½‘ç»œæ‹“æ‰‘ã€Linuxåè®®æ ˆå’Œé˜²ç«å¢™ç­‰åŸºç¡€ç½‘ç»œçŸ¥è¯†å¼€å§‹ä»‹ç»ï¼Œä¸€ç›´è®²åˆ°TCPå’ŒHTTPè¿™äº›å¹´çš„æŠ€æœ¯æ¼”è¿›è·¯çº¿å’Œæœªæ¥è¶‹åŠ¿ã€‚</p></blockquote><h3 id="æ”¶åŒ…æµç¨‹"><a href="#æ”¶åŒ…æµç¨‹" class="headerlink" title="æ”¶åŒ…æµç¨‹"></a>æ”¶åŒ…æµç¨‹</h3><h4 id="1-æ•°æ®åŒ…åˆ°è¾¾ç½‘å¡-NIC-Network-Interface-Card"><a href="#1-æ•°æ®åŒ…åˆ°è¾¾ç½‘å¡-NIC-Network-Interface-Card" class="headerlink" title="1. æ•°æ®åŒ…åˆ°è¾¾ç½‘å¡ NIC(Network Interface Card)"></a>1. æ•°æ®åŒ…åˆ°è¾¾ç½‘å¡ NIC(Network Interface Card)</h4><h4 id="2-NIC-æ£€éªŒ-MAC-ç½‘å¡-ç½‘å¡éæ··æ‚æ¨¡å¼-å’Œå¸§çš„æ ¡éªŒå­—æ®µ-FCS"><a href="#2-NIC-æ£€éªŒ-MAC-ç½‘å¡-ç½‘å¡éæ··æ‚æ¨¡å¼-å’Œå¸§çš„æ ¡éªŒå­—æ®µ-FCS" class="headerlink" title="2. NIC æ£€éªŒ MAC ç½‘å¡(ç½‘å¡éæ··æ‚æ¨¡å¼)å’Œå¸§çš„æ ¡éªŒå­—æ®µ FCS"></a>2. NIC æ£€éªŒ MAC ç½‘å¡(ç½‘å¡éæ··æ‚æ¨¡å¼)å’Œå¸§çš„æ ¡éªŒå­—æ®µ FCS</h4><p>NIC ä¼šæ ¡éªŒæ”¶åˆ°æ•°æ®åŒ…çš„ç›®çš„ MAC åœ°å€æ˜¯ä¸æ˜¯è‡ªå·±çš„ MAC åœ°å€ï¼Œåœ¨ç½‘å¡éæ··æ‚æ¨¡å¼ä¸‹ï¼ŒMAC åœ°å€ä¸æ˜¯è‡ªå·±çš„æ•°æ®åŒ…é€šå¸¸å°±ä¼šä¸¢å¼ƒã€‚åœ¨å¼€å¯æ··æ‚æ¨¡å¼ä¹‹åæ‰€æœ‰æ•°æ®åŒ…éƒ½ä¼šæ˜¯æ¥æ”¶å¤„ç†ã€‚</p><p>ä½¿ç”¨éæ··æ‚æ¨¡å¼çš„åœºæ™¯ï¼š</p><ul><li>æŠ“åŒ…</li><li>è™šæ‹Ÿæœº</li><li>æŠ“åŒ…ç¨‹åºä¼šæŠŠç½‘å¡è®¾ç½®ä¸ºéæ··æ‚æ¨¡å¼ï¼Œå› æ­¤æŠ“åŒ…ç¨‹åºéœ€è¦  root æƒé™ï¼Œæ²¡æœ‰ root æƒé™æ— æ³•ä¿®æ”¹ç¡¬ä»¶è®¾å¤‡çš„é…ç½®ã€‚</li></ul><p>æ ¡éªŒå®Œ MAC åœ°å€ä¹‹å NIC è¿˜ä¼šæ ¡éªŒå¸§çš„æ ¡éªŒå­—æ®µ FCSï¼Œä¸€æ¬¡æ¥ç¡®ä¿æ¥æ”¶åˆ°çš„æ•°æ®åŒ…æ˜¯æ­£ç¡®çš„ï¼Œå¦‚æœæ ¡éªŒå¤±è´¥å°±ç›´æ¥ä¸¢å¼ƒæ•°æ®åŒ…</p><h4 id="3-NIC-é€šè¿‡-DMA-å°†æ•°æ®åŒ…æ”¾å…¥æå‰æ˜ å°„å¥½çš„å†…å­˜åŒºåŸŸ"><a href="#3-NIC-é€šè¿‡-DMA-å°†æ•°æ®åŒ…æ”¾å…¥æå‰æ˜ å°„å¥½çš„å†…å­˜åŒºåŸŸ" class="headerlink" title="3. NIC é€šè¿‡ DMA å°†æ•°æ®åŒ…æ”¾å…¥æå‰æ˜ å°„å¥½çš„å†…å­˜åŒºåŸŸ"></a>3. NIC é€šè¿‡ DMA å°†æ•°æ®åŒ…æ”¾å…¥æå‰æ˜ å°„å¥½çš„å†…å­˜åŒºåŸŸ</h4><p>DMAï¼šè‹±æ–‡æ‹¼å†™æ˜¯ â€œDirect Memory Accessâ€ ï¼Œç¿»è¯‘æˆä¸­æ–‡å°±æ˜¯ç›´æ¥å†…å­˜è®¿é—®ã€‚DMA å…è®¸ç½‘ç»œè®¾å¤‡å°†æ•°æ®åŒ…æ•°æ®ç›´æ¥ç§»åŠ¨åˆ°ç³»ç»Ÿå†…å­˜ä¸­, ä»è€Œé™ä½ CPU åˆ©ç”¨ç‡ã€‚</p><p>æ­£å¸¸æƒ…å†µä¸‹ï¼Œä¸€ä¸ªç½‘ç»œæ•°æ®åŒ…ä»ç½‘å¡åˆ°åº”ç”¨ç¨‹åºéœ€è¦ç»è¿‡å¦‚ä¸‹çš„è¿‡ç¨‹ï¼šæ•°æ®ä»ç½‘å¡é€šè¿‡ DMA ç­‰æ–¹å¼ä¼ åˆ°å†…æ ¸å¼€è¾Ÿçš„ç¼“å†²åŒºï¼Œç„¶åä»å†…æ ¸ç©ºé—´æ‹·è´åˆ°ç”¨æˆ·æ€ç©ºé—´ï¼Œåœ¨ Linux å†…æ ¸åè®®æ ˆä¸­ï¼Œè¿™ä¸ªè€—æ—¶æ“ä½œç”šè‡³å åˆ°äº†æ•°æ®åŒ…æ•´ä¸ªå¤„ç†æµç¨‹çš„ 57.1%ã€‚</p><h4 id="4-NIC-å°†æ•°æ®åŒ…çš„å¼•ç”¨æ”¾å…¥æ¥æ”¶çš„-ring-buffer-ï¼ˆç¯å½¢ç¼“å†²åŒºï¼‰é˜Ÿåˆ—-rx-ä¸­"><a href="#4-NIC-å°†æ•°æ®åŒ…çš„å¼•ç”¨æ”¾å…¥æ¥æ”¶çš„-ring-buffer-ï¼ˆç¯å½¢ç¼“å†²åŒºï¼‰é˜Ÿåˆ—-rx-ä¸­" class="headerlink" title="4. NIC å°†æ•°æ®åŒ…çš„å¼•ç”¨æ”¾å…¥æ¥æ”¶çš„ ring buffer ï¼ˆç¯å½¢ç¼“å†²åŒºï¼‰é˜Ÿåˆ— rx ä¸­"></a>4. NIC å°†æ•°æ®åŒ…çš„å¼•ç”¨æ”¾å…¥æ¥æ”¶çš„ ring buffer ï¼ˆç¯å½¢ç¼“å†²åŒºï¼‰é˜Ÿåˆ— rx ä¸­</h4><h4 id="5-NIC-ç­‰å¾…-rx-usecs-çš„è¶…æ—¶æ—¶é—´æˆ–è€…-rx-é˜Ÿåˆ—é•¿åº¦è¾¾åˆ°-rx-frames-åè§¦å‘ç¡¬ä»¶ä¸­æ–­-IRQï¼Œè¡¨ç¤ºæ•°æ®åŒ…æ”¶åˆ°äº†"><a href="#5-NIC-ç­‰å¾…-rx-usecs-çš„è¶…æ—¶æ—¶é—´æˆ–è€…-rx-é˜Ÿåˆ—é•¿åº¦è¾¾åˆ°-rx-frames-åè§¦å‘ç¡¬ä»¶ä¸­æ–­-IRQï¼Œè¡¨ç¤ºæ•°æ®åŒ…æ”¶åˆ°äº†" class="headerlink" title="5. NIC ç­‰å¾… rx-usecs çš„è¶…æ—¶æ—¶é—´æˆ–è€… rx é˜Ÿåˆ—é•¿åº¦è¾¾åˆ° rx-frames åè§¦å‘ç¡¬ä»¶ä¸­æ–­ IRQï¼Œè¡¨ç¤ºæ•°æ®åŒ…æ”¶åˆ°äº†"></a>5. NIC ç­‰å¾… rx-usecs çš„è¶…æ—¶æ—¶é—´æˆ–è€… rx é˜Ÿåˆ—é•¿åº¦è¾¾åˆ° rx-frames åè§¦å‘ç¡¬ä»¶ä¸­æ–­ IRQï¼Œè¡¨ç¤ºæ•°æ®åŒ…æ”¶åˆ°äº†</h4><ul><li><p>rx-usecs: ç³»ç»Ÿå†…æ ¸å‚æ•°è®¾ç½®çš„è‹¥å¹²å¾®å¦™çš„è¶…æ—¶æ—¶é—´ã€‚</p></li><li><p>rx-frames: å¯¹åº”çš„ rx é˜Ÿåˆ—é•¿åº¦ã€‚</p></li></ul><p>è°ƒæ•´äºŒè€…å‚æ•°å¤§ä¸€ç‚¹ï¼Œä¸­æ–­ä¸é¢‘ç¹ï¼Œååé‡ä¼šé«˜ä¸€äº›ï¼Œä½†å®æ—¶æ€§ä¼šå·®ä¸€äº›ã€‚äºŒè€…å‚æ•°è°ƒå°ä¸€äº›ï¼ŒNIC ä¸­æ–­é¢‘ç¹ä¸€äº›ï¼Œå®æ—¶æ€§ä¼šé«˜ä¸€äº›ï¼Œä½†ååé‡ä¼šå°ä¸€äº›ã€‚</p><h4 id="6-CPU-æ‰§è¡Œç¡¬ä»¶ä¸­æ–­å’Œç½‘å¡çš„é©±åŠ¨ç¨‹åº"><a href="#6-CPU-æ‰§è¡Œç¡¬ä»¶ä¸­æ–­å’Œç½‘å¡çš„é©±åŠ¨ç¨‹åº" class="headerlink" title="6. CPU æ‰§è¡Œç¡¬ä»¶ä¸­æ–­å’Œç½‘å¡çš„é©±åŠ¨ç¨‹åº"></a>6. CPU æ‰§è¡Œç¡¬ä»¶ä¸­æ–­å’Œç½‘å¡çš„é©±åŠ¨ç¨‹åº</h4><p>CPU æ¥æ”¶ç¡¬ä»¶ä¸­æ–­ä¿¡å·åå°±åœæ­¢æ‰‹é‡Œçš„æ´»ï¼Œä¿å­˜ä¸Šä¸‹æ–‡ï¼Œæ¥ç€å»æ‰§è¡Œç½‘å¡çš„ä¸­æ–­ç¨‹åºï¼Œç½‘å¡çš„ä¸­æ–­ç¨‹åºæ˜¯ç½‘å¡çš„é©±åŠ¨ç¨‹åºæå‰æ³¨å†Œå¥½çš„ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥ä¼šè°ƒç”¨ç½‘å¡çš„é©±åŠ¨ç¨‹åºã€‚</p><h4 id="7-é©±åŠ¨ç¨‹åºæ¸…ç†ç¡¬ä¸­æ–­å¹¶è§¦å‘è½¯ä¸­æ–­-NET-RX-SOFTIRQ"><a href="#7-é©±åŠ¨ç¨‹åºæ¸…ç†ç¡¬ä¸­æ–­å¹¶è§¦å‘è½¯ä¸­æ–­-NET-RX-SOFTIRQ" class="headerlink" title="7. é©±åŠ¨ç¨‹åºæ¸…ç†ç¡¬ä¸­æ–­å¹¶è§¦å‘è½¯ä¸­æ–­ NET_RX_SOFTIRQ"></a>7. é©±åŠ¨ç¨‹åºæ¸…ç†ç¡¬ä¸­æ–­å¹¶è§¦å‘è½¯ä¸­æ–­ NET_RX_SOFTIRQ</h4><p>åœ¨æ­¤ç¡¬ä»¶ä¸­æ–­å°±å¤„ç†å®Œäº†ã€‚åœ¨æ­¤æ¢³ç†ä¸€äº›æ•´ä¸ªä¸­æ–­å¤„ç†çš„è¿‡ç¨‹ï¼šNIC å¼•èµ·ç¡¬ä»¶ä¸­æ–­ â€“&gt; ç¡¬ä»¶ä¸­æ–­çš„ handler å°†å¼•èµ·è½¯ä»¶ä¸­æ–­ â€“&gt; é©±åŠ¨å°†å¤„ç†è¿™ä¸ªä¸­æ–­ï¼Œå®ƒå°†æŠ¥æ–‡ä»ç¯å½¢ç¼“å†²åŒºæº¢å‡ºï¼Œåœ¨å†…å­˜ä¸­åˆ†é…ä¸€ä¸ª skb â€“&gt; è°ƒç”¨ netif_rx(skb) â€“&gt; æ­¤ skb å°†æ”¾å…¥ cpu å¤„ç†æŠ¥æ–‡çš„é˜Ÿåˆ—ä¸­ã€‚å¦‚æœé˜Ÿåˆ—æ»¡äº†æ­¤åŒ…å°†ä¸¢æ‰ã€‚åˆ°è¿™ä¸ºæ­¢ä¸­æ–­å°±å¤„ç†ç»“æŸã€‚</p><ul><li><strong>linux kernel åœ¨æŠ¥æ–‡å¤„ç†ä¸Šçš„ä¸è¶³</strong></li></ul><blockquote><p>1.<strong>ä¸­æ–­å¤„ç†ï¼š</strong>å½“ç½‘ç»œä¸­å¤§é‡æ•°æ®åŒ…åˆ°æ¥æ—¶ï¼Œä¼šäº§ç”Ÿé¢‘ç¹çš„ç¡¬ä»¶ä¸­æ–­è¯·æ±‚ï¼Œè¿™äº›ç¡¬ä»¶ä¸­æ–­å¯ä»¥æ‰“æ–­ä¹‹å‰è¾ƒä½ä¼˜å…ˆçº§çš„è½¯ä¸­æ–­æˆ–è€…ç³»ç»Ÿè°ƒç”¨çš„æ‰§è¡Œè¿‡ç¨‹ï¼Œå¦‚æœè¿™ç§æ‰“æ–­é¢‘ç¹çš„è¯ï¼Œå°†ä¼šäº§ç”Ÿè¾ƒé«˜çš„æ€§èƒ½å¼€é”€ã€‚<br>2.<strong>å†…å­˜æ‹·è´</strong>ï¼šæ­£å¸¸æƒ…å†µä¸‹ï¼Œä¸€ä¸ªç½‘ç»œæ•°æ®åŒ…ä»ç½‘å¡åˆ°åº”ç”¨ç¨‹åºéœ€è¦ç»è¿‡å¦‚ä¸‹çš„è¿‡ç¨‹ï¼šæ•°æ®ä»ç½‘å¡é€šè¿‡ DMA ç­‰æ–¹å¼ä¼ åˆ°å†…æ ¸å¼€è¾Ÿçš„ç¼“å†²åŒºï¼Œç„¶åä»å†…æ ¸ç©ºé—´æ‹·è´åˆ°ç”¨æˆ·æ€ç©ºé—´ï¼Œåœ¨ Linux å†…æ ¸åè®®æ ˆä¸­ï¼Œè¿™ä¸ªè€—æ—¶æ“ä½œç”šè‡³å åˆ°äº†æ•°æ®åŒ…æ•´ä¸ªå¤„ç†æµç¨‹çš„ 57.1%ã€‚<br>3.<strong>ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼š</strong>é¢‘ç¹åˆ°è¾¾çš„ç¡¬ä»¶ä¸­æ–­å’Œè½¯ä¸­æ–­éƒ½å¯èƒ½éšæ—¶æŠ¢å ç³»ç»Ÿè°ƒç”¨çš„è¿è¡Œï¼Œè¿™ä¼šäº§ç”Ÿå¤§é‡çš„ä¸Šä¸‹æ–‡åˆ‡æ¢å¼€é”€ã€‚å¦å¤–ï¼Œåœ¨åŸºäºå¤šçº¿ç¨‹çš„æœåŠ¡å™¨è®¾è®¡æ¡†æ¶ä¸­ï¼Œçº¿ç¨‹é—´çš„è°ƒåº¦ä¹Ÿä¼šäº§ç”Ÿé¢‘ç¹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢å¼€é”€ï¼ŒåŒæ ·ï¼Œé”ç«äº‰çš„è€—èƒ½ä¹Ÿæ˜¯ä¸€ä¸ªéå¸¸ä¸¥é‡çš„é—®é¢˜ã€‚<br>4.<strong>å±€éƒ¨æ€§å¤±æ•ˆï¼š</strong>å¦‚ä»Šä¸»æµçš„å¤„ç†å™¨éƒ½æ˜¯å¤šä¸ªæ ¸å¿ƒçš„ï¼Œè¿™æ„å‘³ç€ä¸€ä¸ªæ•°æ®åŒ…çš„å¤„ç†å¯èƒ½è·¨å¤šä¸ª CPU æ ¸å¿ƒï¼Œæ¯”å¦‚ä¸€ä¸ªæ•°æ®åŒ…å¯èƒ½ä¸­æ–­åœ¨ cpu0ï¼Œå†…æ ¸æ€å¤„ç†åœ¨ cpu1ï¼Œç”¨æˆ·æ€å¤„ç†åœ¨ cpu2ï¼Œè¿™æ ·è·¨å¤šä¸ªæ ¸å¿ƒï¼Œå®¹æ˜“é€ æˆ CPU ç¼“å­˜å¤±æ•ˆï¼Œé€ æˆå±€éƒ¨æ€§å¤±æ•ˆã€‚å¦‚æœæ˜¯ NUMA æ¶æ„ï¼Œæ›´ä¼šé€ æˆè·¨ NUMA è®¿é—®å†…å­˜ï¼Œæ€§èƒ½å—åˆ°å¾ˆå¤§å½±å“ã€‚<br>5.<strong>å†…å­˜ç®¡ç†ï¼š</strong>ä¼ ç»ŸæœåŠ¡å™¨å†…å­˜é¡µä¸º 4Kï¼Œä¸ºäº†æé«˜å†…å­˜çš„è®¿é—®é€Ÿåº¦ï¼Œé¿å… cache missï¼Œå¯ä»¥å¢åŠ  cache ä¸­æ˜ å°„è¡¨çš„æ¡ç›®ï¼Œä½†è¿™åˆä¼šå½±å“ CPU çš„æ£€ç´¢æ•ˆç‡ã€‚</p></blockquote><p><code>æ­¤å¤„å¼•ç”¨</code> <a href="https://github.com/OSH-2019/x-xdp-on-android/blob/master/docs/research.md" target="_blank" rel="noopener">1</a></p><h4 id="8-è½¯ä¸­æ–­å¯¹ç½‘å¡è¿›è¡Œè½®è®­æ”¶åŒ…"><a href="#8-è½¯ä¸­æ–­å¯¹ç½‘å¡è¿›è¡Œè½®è®­æ”¶åŒ…" class="headerlink" title="8. è½¯ä¸­æ–­å¯¹ç½‘å¡è¿›è¡Œè½®è®­æ”¶åŒ…"></a>8. è½¯ä¸­æ–­å¯¹ç½‘å¡è¿›è¡Œè½®è®­æ”¶åŒ…</h4><ul><li><strong>è¡¥å……</strong></li></ul><p>å› ä¸ºç¡¬ä»¶ä¸­æ–­ä¸èƒ½è¢«åµŒå¥—å³ä¸èƒ½è¢«æ‰“æ–­ï¼Œæ‰€ä»¥ NIC ä¼šå°†ç¡¬ä¸­æ–­ä¿¡å·æ¸…ç†æ‰å»è§¦å‘ä¸€ä¸ªè½¯ä¸­æ–­ï¼Œè€Œè½¯ä¸­æ–­åªéœ€è¦æŒ‡ä»¤å³å¯è§¦å‘ã€‚</p><ul><li><p>ç¡¬ä¸­æ–­ï¼šç¡¬ä»¶ä¿¡å·è§¦å‘çš„ï¼Œæ¯”å¦‚é”®ç›˜æŒ‰é”®ã€‚</p></li><li><p>è½¯ä¸­æ–­ï¼šCPU è‡ªèº«æŒ‡ä»¤è§¦å‘çš„ä¸­æ–­ï¼Œå¯ä»¥è¢«ç¡¬ä»¶ä¸­æ–­æ‰“æ–­ã€‚æ¯”å¦‚ç³»ç»Ÿè°ƒç”¨ã€‚</p></li></ul><p>ä¸­æ–­æ•°é‡å¤ªå¤šçš„æ—¶å€™ï¼ŒCPU ä¸æ–­åœ°ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œæ•´ä¸ªç³»ç»Ÿçš„æ€§èƒ½å°†ä¼šæœ‰æ‰€æŸè€—ã€‚</p><p>åŠä¸­æ–­åŠè½®è¯¢æ¨¡å¼ï¼šåœ¨è½¯ä¸­æ–­é‡Œè½®è¯¢æ”¶åŒ…ã€‚</p><h4 id="9-æ•°æ®åŒ…è¢«æ”¾å…¥-qdisc-é˜Ÿåˆ—"><a href="#9-æ•°æ®åŒ…è¢«æ”¾å…¥-qdisc-é˜Ÿåˆ—" class="headerlink" title="9. æ•°æ®åŒ…è¢«æ”¾å…¥ qdisc é˜Ÿåˆ—"></a>9. æ•°æ®åŒ…è¢«æ”¾å…¥ qdisc é˜Ÿåˆ—</h4><p>ä»¥å‰æ¯ä¸€ä¸ª NIC ä¸€ä¸ªé˜Ÿåˆ—ï¼Œæ‰€æœ‰çš„ä¸­æ–­éƒ½è¢«ä¸€ä¸ª CPU å¤„ç†ï¼Œç›´åˆ°åæ¥æ”¹è¿›è®¾è®¡å‡ºç½‘å¡å¤šé˜Ÿåˆ—çš„æ¨¡å‹ã€‚</p><p>ç½‘å¡å¤šé˜Ÿåˆ—ï¼šä¸€ä¸ªç½‘å¡å¯¹åº”å¤šä¸ªæ¥æ”¶é˜Ÿåˆ—ï¼Œåœ¨æ”¶åˆ°æ•°æ®åŒ…åä¼šå¯¹æºåœ°å€å’Œç›®çš„åœ°å€åšä¸€ä¸ª HASH åˆ†é…åˆ°å¯¹å„ä¸ªé˜Ÿåˆ—å½“ä¸­å»ï¼Œæ¯ä¸€ä¸ªé˜Ÿåˆ—éƒ½ä¼šæœ‰ä¸ªå­ä¸­æ–­å·ï¼Œè¿™ä¸ªå­ä¸­æ–­å·å¯ä»¥åˆ†é…åˆ°ä¸åŒçš„ CPU ä¸­å»å¤„ç†ã€‚è¿™æ ·å¯ä»¥è®© NIC æ”¶åˆ°çš„æ•°æ®åŒ…è®©å¤šä¸ª CPU æ¥å¤„ç†ã€‚</p><p>CPU ç»‘å®šï¼šä¸€ä¸ª NIC äº§ç”Ÿå¤šä¸ªä¸­æ–­ï¼Œè®©å¤šä¸ª CPU å»åˆ†æ‹…ä¸­æ–­çš„è´Ÿè½½ã€‚</p><h4 id="10-å°†æ•°æ®åŒ…é€å…¥åè®®æ ˆï¼Œè°ƒç”¨-ip-recv"><a href="#10-å°†æ•°æ®åŒ…é€å…¥åè®®æ ˆï¼Œè°ƒç”¨-ip-recv" class="headerlink" title="10. å°†æ•°æ®åŒ…é€å…¥åè®®æ ˆï¼Œè°ƒç”¨ ip_recv"></a>10. å°†æ•°æ®åŒ…é€å…¥åè®®æ ˆï¼Œè°ƒç”¨ ip_recv</h4><p>åœ¨æ­¤æ•°æ®åŒ…å°±è¿›å…¥äº†åè®®æ ˆï¼Œè°ƒç”¨ ip_recv è¿›å…¥ä¸‰å±‚åè®®æ ˆã€‚</p><p>ip_recvå‡½æ•° <a href="http://abcdxyzk.github.io/blog/2015/03/04/kernel-net-ip/" target="_blank" rel="noopener">linux TCP/IPåè®®æ ˆ-IPå±‚</a></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* ä¸»è¦åŠŸèƒ½ï¼šå¯¹IPå¤´éƒ¨åˆæ³•æ€§è¿›è¡Œä¸¥æ ¼æ£€æŸ¥ï¼Œç„¶åæŠŠå…·ä½“åŠŸèƒ½äº¤ç»™ip_rcv_finishã€‚*/</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ip_rcv</span><span class="params">(struct sk_buff *skb, struct net_device *dev, struct packet_type *pt, struct net_device *orig_dev)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">iphdr</span> *<span class="title">iph</span>;</span></span><br><span class="line">u32 len;</span><br><span class="line"><span class="comment">/* ç½‘ç»œåå­—ç©ºé—´ï¼Œå¿½ç•¥ */</span></span><br><span class="line"><span class="keyword">if</span> (dev-&gt;nd_net != &amp;init_net)</span><br><span class="line"><span class="keyword">goto</span> drop;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> *å½“ç½‘å¡å¤„äºæ··æ‚æ¨¡å¼æ—¶ï¼Œæ”¶åˆ°ä¸æ˜¯å‘å¾€è¯¥ä¸»æœºçš„æ•°æ®åŒ…ï¼Œç”±net_rx_action()è®¾ç½®ã€‚</span></span><br><span class="line"><span class="comment"> *åœ¨è°ƒç”¨ip_rcvä¹‹å‰ï¼Œå†…æ ¸ä¼šå°†è¯¥æ•°æ®åŒ…äº¤ç»™å—…æ¢å™¨ï¼Œæ‰€ä»¥è¯¥å‡½æ•°ä»…ä¸¢å¼ƒè¯¥åŒ…ã€‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">if</span> (skb-&gt;pkt_type == PACKET_OTHERHOST)</span><br><span class="line"><span class="keyword">goto</span> drop;</span><br><span class="line"><span class="comment">/* SNMPæ‰€éœ€è¦çš„ç»Ÿè®¡æ•°æ®ï¼Œå¿½ç•¥ */</span></span><br><span class="line">IP_INC_STATS_BH(IPSTATS_MIB_INRECEIVES);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> *ip_rcvæ˜¯ç”±netif_receive_skbå‡½æ•°è°ƒç”¨ï¼Œå¦‚æœå—…æ¢å™¨æˆ–è€…å…¶ä»–çš„ç”¨æˆ·å¯¹æ•°æ®åŒ…éœ€è¦è¿›</span></span><br><span class="line"><span class="comment"> *è¿›è¡Œå¤„ç†ï¼Œåˆ™åœ¨è°ƒç”¨ip_rcvä¹‹å‰ï¼Œnetif_receive_skbä¼šå¢åŠ skbçš„å¼•ç”¨è®¡æ•°ï¼Œæ—¢è¯¥å¼•</span></span><br><span class="line"><span class="comment"> *ç”¨è®¡æ•°ä¼šå¤§äº1ã€‚è‹¥å¦‚æ­¤æ¬¡ï¼Œåˆ™skb_share_checkä¼šåˆ›å»ºsk_buffçš„ä¸€ä»½æ‹·è´ã€‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">if</span> ((skb = skb_share_check(skb, GFP_ATOMIC)) == <span class="literal">NULL</span>) &#123;</span><br><span class="line">IP_INC_STATS_BH(IPSTATS_MIB_INDISCARDS);</span><br><span class="line"><span class="keyword">goto</span> out;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> *pskb_may_pullç¡®ä¿skb-&gt;dataæŒ‡å‘çš„å†…å­˜åŒ…å«çš„æ•°æ®è‡³å°‘ä¸ºIPå¤´éƒ¨å¤§å°ï¼Œç”±äºæ¯ä¸ª</span></span><br><span class="line"><span class="comment"> *IPæ•°æ®åŒ…åŒ…æ‹¬IPåˆ†ç‰‡å¿…é¡»åŒ…å«ä¸€ä¸ªå®Œæ•´çš„IPå¤´éƒ¨ã€‚å¦‚æœå°äºIPå¤´éƒ¨å¤§å°ï¼Œåˆ™ç¼ºå¤±</span></span><br><span class="line"><span class="comment"> *çš„éƒ¨åˆ†å°†ä»æ•°æ®åˆ†ç‰‡ä¸­æ‹·è´ã€‚è¿™äº›åˆ†ç‰‡ä¿å­˜åœ¨skb_shinfo(skb)-&gt;frags[]ä¸­ã€‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">if</span> (!pskb_may_pull(skb, <span class="keyword">sizeof</span>(struct iphdr)))</span><br><span class="line"><span class="keyword">goto</span> inhdr_error;</span><br><span class="line"><span class="comment">/* pskb_may_pullå¯èƒ½ä¼šè°ƒæ•´skbä¸­çš„æŒ‡é’ˆï¼Œæ‰€ä»¥éœ€è¦é‡æ–°å®šä¹‰IPå¤´éƒ¨*/</span></span><br><span class="line">iph = ip_hdr(skb);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> *    RFC1122: 3.1.2.2 MUST silently discard any IP frame that fails the checksum.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *    Is the datagram acceptable?</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *    1.    Length at least the size of an ip header</span></span><br><span class="line"><span class="comment"> *    2.    Version of 4</span></span><br><span class="line"><span class="comment"> *    3.    Checksums correctly. [Speed optimisation for later, skip loopback checksums]</span></span><br><span class="line"><span class="comment"> *    4.    Doesn't have a bogus length</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">/* ä¸Šé¢è¯´çš„å¾ˆæ¸…æ¥šäº† */</span></span><br><span class="line"><span class="keyword">if</span> (iph-&gt;ihl &lt; <span class="number">5</span> || iph-&gt;version != <span class="number">4</span>)</span><br><span class="line"><span class="keyword">goto</span> inhdr_error;</span><br><span class="line"><span class="comment">/* ç¡®ä¿IPå®Œæ•´çš„å¤´éƒ¨åŒ…æ‹¬é€‰é¡¹åœ¨å†…å­˜ä¸­ */</span></span><br><span class="line"><span class="keyword">if</span> (!pskb_may_pull(skb, iph-&gt;ihl*<span class="number">4</span>))</span><br><span class="line"><span class="keyword">goto</span> inhdr_error;</span><br><span class="line"></span><br><span class="line">iph = ip_hdr(skb);</span><br><span class="line"><span class="comment">/* éªŒè¯IPå¤´éƒ¨çš„æ ¡éªŒå’Œ */</span></span><br><span class="line"><span class="keyword">if</span> (unlikely(ip_fast_csum((u8 *)iph, iph-&gt;ihl)))</span><br><span class="line"><span class="keyword">goto</span> inhdr_error;</span><br><span class="line"><span class="comment">/* IPå¤´éƒ¨ä¸­æŒ‡ç¤ºçš„IPæ•°æ®åŒ…æ€»é•¿åº¦ */</span></span><br><span class="line">len = ntohs(iph-&gt;tot_len);</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> *ç¡®ä¿skbçš„æ•°æ®é•¿åº¦å¤§äºç­‰äºIPå¤´éƒ¨ä¸­æŒ‡ç¤ºçš„IPæ•°æ®åŒ…æ€»é•¿åº¦åŠæ•°æ®åŒ…æ€»é•¿åº¦å¿…é¡»</span></span><br><span class="line"><span class="comment"> *å¤§äºç­‰äºIPå¤´éƒ¨é•¿åº¦ã€‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">if</span> (skb-&gt;len &lt; len) &#123;</span><br><span class="line">IP_INC_STATS_BH(IPSTATS_MIB_INTRUNCATEDPKTS);</span><br><span class="line"><span class="keyword">goto</span> drop;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (len &lt; (iph-&gt;ihl*<span class="number">4</span>))</span><br><span class="line"><span class="keyword">goto</span> inhdr_error;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Our transport medium may have padded the buffer out. Now we know it</span></span><br><span class="line"><span class="comment"> * is IP we can trim to the true length of the frame.</span></span><br><span class="line"><span class="comment"> * Note this now means skb-&gt;len holds ntohs(iph-&gt;tot_len).</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">/* æ³¨é‡Šè¯´æ˜çš„å¾ˆæ¸…æ¥šï¼Œè¯¥å‡½æ•°æˆåŠŸæ‰§è¡Œå®Œä¹‹åï¼Œskb-&gt;len = ntohs(iph-&gt;tot_len). */</span></span><br><span class="line"><span class="keyword">if</span> (pskb_trim_rcsum(skb, len)) &#123;</span><br><span class="line">IP_INC_STATS_BH(IPSTATS_MIB_INDISCARDS);</span><br><span class="line"><span class="keyword">goto</span> drop;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Remove any debris in the socket control block */</span></span><br><span class="line"><span class="built_in">memset</span>(IPCB(skb), <span class="number">0</span>, <span class="keyword">sizeof</span>(struct inet_skb_parm));</span><br><span class="line"><span class="comment">/* å¿½ç•¥ä¸netfilterå­ç³»ç»Ÿçš„äº¤äº’ï¼Œè°ƒç”¨ä¸ºip_rcv_finish(skb) */</span></span><br><span class="line"><span class="keyword">return</span> NF_HOOK(PF_INET, NF_IP_PRE_ROUTING, skb, dev, <span class="literal">NULL</span>,</span><br><span class="line"> ip_rcv_finish);</span><br><span class="line"></span><br><span class="line">inhdr_error:</span><br><span class="line">IP_INC_STATS_BH(IPSTATS_MIB_INHDRERRORS);</span><br><span class="line">drop:</span><br><span class="line">kfree_skb(skb);</span><br><span class="line">out:</span><br><span class="line"><span class="keyword">return</span> NET_RX_DROP;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="11-è°ƒç”¨-netfilter-çš„-PREROUTING-é“¾"><a href="#11-è°ƒç”¨-netfilter-çš„-PREROUTING-é“¾" class="headerlink" title="11. è°ƒç”¨ netfilter çš„ PREROUTING é“¾"></a>11. è°ƒç”¨ netfilter çš„ PREROUTING é“¾</h4><blockquote><p>netfilterï¼š æ˜¯ Linux å†…æ ¸ä¸­è¿›è¡Œæ•°æ®åŒ…è¿‡æ»¤ï¼Œè¿æ¥è·Ÿè¸ªï¼ˆConnect Trackï¼‰ï¼Œç½‘ç»œåœ°å€è½¬æ¢ï¼ˆNATï¼‰ç­‰åŠŸèƒ½çš„ä¸»è¦å®ç°æ¡†æ¶ï¼›è¯¥æ¡†æ¶åœ¨ç½‘ç»œåè®®æ ˆå¤„ç†æ•°æ®åŒ…çš„å…³é”®æµç¨‹ä¸­å®šä¹‰äº†ä¸€ç³»åˆ—é’©å­ç‚¹ï¼ˆHook ç‚¹ï¼‰ï¼Œå¹¶åœ¨è¿™äº›é’©å­ç‚¹ä¸­æ³¨å†Œä¸€ç³»åˆ—å‡½æ•°å¯¹æ•°æ®åŒ…è¿›è¡Œå¤„ç†ã€‚è¿™äº›æ³¨å†Œåœ¨é’©å­ç‚¹çš„å‡½æ•°å³ä¸ºè®¾ç½®åœ¨ç½‘ç»œåè®®æ ˆå†…çš„æ•°æ®åŒ…é€šè¡Œç­–ç•¥ï¼Œä¹Ÿå°±æ„å‘³ç€ï¼Œè¿™äº›å‡½æ•°å¯ä»¥å†³å®šå†…æ ¸æ˜¯æ¥å—è¿˜æ˜¯ä¸¢å¼ƒæŸä¸ªæ•°æ®åŒ…ï¼Œæ¢å¥è¯è¯´ï¼Œè¿™äº›å‡½æ•°çš„å¤„ç†ç»“æœå†³å®šäº†è¿™äº›ç½‘ç»œæ•°æ®åŒ…çš„â€œå‘½è¿â€ã€‚</p></blockquote><p>åœ¨è¿™é‡Œå°±åˆ°äº†å†…æ ¸é˜²ç«å¢™<em>ip_rcv</em>å‡½æ•°ä¸ºç½‘ç»œå±‚å‘ä¸‹å±‚å¼€æ”¾çš„å…¥å£ï¼Œæ•°æ®åŒ…é€šè¿‡è¯¥å‡½æ•°è¿›å…¥ç½‘ç»œå±‚è¿›è¡Œå¤„ç†ï¼Œè¯¥å‡½æ•°ä¸»è¦å¯¹ä¸Šä¼ åˆ°ç½‘ç»œå±‚çš„æ•°æ®åŒ…è¿›è¡Œå‰æœŸåˆæ³•æ€§æ£€æŸ¥ï¼Œé€šè¿‡åäº¤ç”± Netfilter çš„é’©å­èŠ‚ç‚¹ï¼ˆIP_PRE_ROUTINGï¼‰ï¼› IP_PRE_ROUTING ä¼šæ ¹æ®é¢„è®¾çš„è§„åˆ™å¯¹æ•°æ®åŒ…è¿›è¡Œåˆ¤å†³å¹¶æ ¹æ®åˆ¤å†³ç»“æœåšç›¸å…³çš„å¤„ç†ï¼Œæ¯”å¦‚æ‰§è¡Œ NAT è½¬æ¢ï¼›</p><h4 id="12-æŸ¥æ‰¾è·¯ç”±è¡¨ï¼Œè¿›è¡Œè½¬å‘æˆ–è€…æŠ•é€’åˆ°-local"><a href="#12-æŸ¥æ‰¾è·¯ç”±è¡¨ï¼Œè¿›è¡Œè½¬å‘æˆ–è€…æŠ•é€’åˆ°-local" class="headerlink" title="12. æŸ¥æ‰¾è·¯ç”±è¡¨ï¼Œè¿›è¡Œè½¬å‘æˆ–è€…æŠ•é€’åˆ° local"></a>12. æŸ¥æ‰¾è·¯ç”±è¡¨ï¼Œè¿›è¡Œè½¬å‘æˆ–è€…æŠ•é€’åˆ° local</h4><p>IP_PRE_ROUTING èŠ‚ç‚¹å¤„ç†å®Œæˆåï¼Œæ•°æ®åŒ…å°†äº¤ç”± <code>ip_rcv_finish</code> å¤„ç†ï¼Œè¯¥å‡½æ•°æ ¹æ®è·¯ç”±åˆ¤å†³ç»“æœï¼Œå†³å®šæ•°æ®åŒ…æ˜¯äº¤ç”±æœ¬æœºä¸Šå±‚åº”ç”¨å¤„ç†ï¼Œè¿˜æ˜¯éœ€è¦è¿›è¡Œè½¬å‘ï¼›å¦‚æœæ˜¯äº¤ç”±æœ¬æœºå¤„ç†ï¼Œåˆ™ä¼šäº¤ç”± <code>p_local_deliver</code> æœ¬åœ°ä¸Šäº¤æµç¨‹ï¼›å¦‚æœéœ€è¦è½¬å‘ï¼Œåˆ™äº¤ç”± <code>ip_forward</code> å‡½æ•°èµ°è½¬å‘æµç¨‹ï¼ŒIP_FORWARD èŠ‚ç‚¹ä¼šå¯¹è½¬å‘æ•°æ®åŒ…è¿›è¡Œæ£€æŸ¥è¿‡æ»¤ï¼›</p><h4 id="13-å¯¹æŠ•é€’åˆ°-local-çš„æ•°æ®åŒ…è°ƒç”¨-netfilter-çš„-LOCAL-IN-é“¾"><a href="#13-å¯¹æŠ•é€’åˆ°-local-çš„æ•°æ®åŒ…è°ƒç”¨-netfilter-çš„-LOCAL-IN-é“¾" class="headerlink" title="13. å¯¹æŠ•é€’åˆ° local çš„æ•°æ®åŒ…è°ƒç”¨ netfilter çš„ LOCAL_IN é“¾"></a>13. å¯¹æŠ•é€’åˆ° local çš„æ•°æ®åŒ…è°ƒç”¨ netfilter çš„ LOCAL_IN é“¾</h4><h4 id="14-è°ƒç”¨å››å±‚åè®®æ ˆï¼Œå¦‚-tcp-v4-rcv"><a href="#14-è°ƒç”¨å››å±‚åè®®æ ˆï¼Œå¦‚-tcp-v4-rcv" class="headerlink" title="14. è°ƒç”¨å››å±‚åè®®æ ˆï¼Œå¦‚ tcp_v4_rcv"></a>14. è°ƒç”¨å››å±‚åè®®æ ˆï¼Œå¦‚ tcp_v4_rcv</h4><h4 id="15-æŸ¥æ‰¾åˆ°å¯¹åº”çš„-socketï¼Œè¿è¡Œ-TCP-çš„çŠ¶æ€æœº"><a href="#15-æŸ¥æ‰¾åˆ°å¯¹åº”çš„-socketï¼Œè¿è¡Œ-TCP-çš„çŠ¶æ€æœº" class="headerlink" title="15. æŸ¥æ‰¾åˆ°å¯¹åº”çš„ socketï¼Œè¿è¡Œ TCP çš„çŠ¶æ€æœº"></a>15. æŸ¥æ‰¾åˆ°å¯¹åº”çš„ socketï¼Œè¿è¡Œ TCP çš„çŠ¶æ€æœº</h4><p>å†…æ ¸ä¸­çš„äº”å…ƒç»„ï¼š<code>| åè®®ç±»å‹ | æºåœ°å€ | æºç«¯å£ | ç›®æ ‡åœ°å€ | ç›®çš„ç«¯å£ |</code></p><p>å°†äº”å…ƒç»„è¿›è¡Œ HASH ï¼Œæ ¹æ®å“ˆå¸Œå€¼æ‰¾åˆ°å¯¹åº”çš„ socket â€“&gt; å»è¿è¡Œè¯¥ socket çš„ TCP çŠ¶æ€æœºã€‚</p><h4 id="16-å°†æ•°æ®æ”¾å…¥-TCP-çš„æ¥æ”¶ç¼“å†²åŒºä¸­"><a href="#16-å°†æ•°æ®æ”¾å…¥-TCP-çš„æ¥æ”¶ç¼“å†²åŒºä¸­" class="headerlink" title="16. å°†æ•°æ®æ”¾å…¥ TCP çš„æ¥æ”¶ç¼“å†²åŒºä¸­"></a>16. å°†æ•°æ®æ”¾å…¥ TCP çš„æ¥æ”¶ç¼“å†²åŒºä¸­</h4><h4 id="17-é€šè¿‡-epoll-æˆ–è€…å…¶ä»–è½®è®­æ–¹å¼é€šçŸ¥åº”ç”¨ç¨‹åº"><a href="#17-é€šè¿‡-epoll-æˆ–è€…å…¶ä»–è½®è®­æ–¹å¼é€šçŸ¥åº”ç”¨ç¨‹åº" class="headerlink" title="17. é€šè¿‡ epoll æˆ–è€…å…¶ä»–è½®è®­æ–¹å¼é€šçŸ¥åº”ç”¨ç¨‹åº"></a>17. é€šè¿‡ epoll æˆ–è€…å…¶ä»–è½®è®­æ–¹å¼é€šçŸ¥åº”ç”¨ç¨‹åº</h4><p>epollï¼šé€šè¿‡ epoll ç›‘å¬å¯è¯»äº‹ä»¶ï¼Œæ•°æ®åŒ…ä¸¢åˆ°æ¥æ”¶ç¼“å†²åŒºçš„æ—¶å€™å°±æœ‰ä¸€ä¸ªå¯è¯»çš„äº‹ä»¶ï¼Œepoll å°±ä¼šæŒ‚ä¸€ä¸ªé’©å­ï¼Œå¯è¯»äº‹ä»¶å°±ä¼šè°ƒç”¨ epoll è¿™ä¸ªé’©å­ï¼Œç„¶åå°†å¯è¯»äº‹ä»¶æ”¾å…¥åˆ°å¯è¯»é˜Ÿåˆ—ä¸­ï¼Œæ¥ç€é€šçŸ¥åˆ°åº”ç”¨ç¨‹åºã€‚</p><p>selectï¼š</p><h4 id="18-åº”ç”¨ç¨‹åºè¯»å–ç¨‹åº"><a href="#18-åº”ç”¨ç¨‹åºè¯»å–ç¨‹åº" class="headerlink" title="18. åº”ç”¨ç¨‹åºè¯»å–ç¨‹åº"></a>18. åº”ç”¨ç¨‹åºè¯»å–ç¨‹åº</h4><p>é€šè¿‡ read()å‡½æ•°è¯»å–æ•°æ®ï¼Ÿ</p><h3 id="å‘åŒ…æµç¨‹"><a href="#å‘åŒ…æµç¨‹" class="headerlink" title="å‘åŒ…æµç¨‹"></a>å‘åŒ…æµç¨‹</h3><h4 id="1-åº”ç”¨æ•°æ®å‘é€ç¨‹åº"><a href="#1-åº”ç”¨æ•°æ®å‘é€ç¨‹åº" class="headerlink" title="1. åº”ç”¨æ•°æ®å‘é€ç¨‹åº"></a>1. åº”ç”¨æ•°æ®å‘é€ç¨‹åº</h4><p>è°ƒç”¨ send() å‡½æ•°ï¼Œå°†æ•°æ®ä»åº”ç”¨å±‚æ‹·è´åˆ°å†…æ ¸ä¸­ã€‚</p><h4 id="2-TCP-ä¸ºå‘é€çš„æ•°æ®ç”³è¯·-skb"><a href="#2-TCP-ä¸ºå‘é€çš„æ•°æ®ç”³è¯·-skb" class="headerlink" title="2. TCP ä¸ºå‘é€çš„æ•°æ®ç”³è¯· skb"></a>2. TCP ä¸ºå‘é€çš„æ•°æ®ç”³è¯· skb</h4><p>åœ¨ Linux å†…æ ¸ä¸­ï¼Œç³»ç»Ÿä½¿ç”¨ <code>sk_buff</code> æ•°æ®ç»“æ„å¯¹æ•°æ®åŒ…è¿›è¡Œå­˜å‚¨å’Œç®¡ç†ã€‚åœ¨æ•°æ®åŒ…æ¥æ”¶è¿‡ç¨‹ä¸­ï¼Œè¯¥æ•°æ®ç»“æ„ä»ç½‘å¡é©±åŠ¨æ”¶åŒ…å¼€å§‹ï¼Œä¸€ç›´è´¯ç©¿åˆ°å†…æ ¸ç½‘ç»œåè®®æ ˆçš„é¡¶å±‚ï¼Œç›´åˆ°ç”¨æˆ·æ€ç¨‹åºä»å†…æ ¸è·å–æ•°æ®ã€‚</p><h4 id="3-æ„å»º-TCP-å¤´éƒ¨ï¼Œå¦‚-src-å’Œ-dst-çš„-portï¼Œchecksum"><a href="#3-æ„å»º-TCP-å¤´éƒ¨ï¼Œå¦‚-src-å’Œ-dst-çš„-portï¼Œchecksum" class="headerlink" title="3. æ„å»º TCP å¤´éƒ¨ï¼Œå¦‚ src å’Œ dst çš„ portï¼Œchecksum"></a>3. æ„å»º TCP å¤´éƒ¨ï¼Œå¦‚ src å’Œ dst çš„ portï¼Œchecksum</h4><h4 id="4-è°ƒç”¨ç¬¬ä¸‰å±‚åè®®ï¼Œæ„å»º-IP-å¤´éƒ¨ï¼Œè°ƒç”¨-netfilter-çš„-LOCAL-OUT-é“¾"><a href="#4-è°ƒç”¨ç¬¬ä¸‰å±‚åè®®ï¼Œæ„å»º-IP-å¤´éƒ¨ï¼Œè°ƒç”¨-netfilter-çš„-LOCAL-OUT-é“¾" class="headerlink" title="4. è°ƒç”¨ç¬¬ä¸‰å±‚åè®®ï¼Œæ„å»º IP å¤´éƒ¨ï¼Œè°ƒç”¨ netfilter çš„ LOCAL_OUT é“¾"></a>4. è°ƒç”¨ç¬¬ä¸‰å±‚åè®®ï¼Œæ„å»º IP å¤´éƒ¨ï¼Œè°ƒç”¨ netfilter çš„ LOCAL_OUT é“¾</h4><p>æ­¤å¤„é˜²ç«å¢™ï¼Œä»æœ¬æœºå‡ºå»çš„åŒ…éƒ½è¦è·‘ä¸€ä¸‹ LOCAL_OUT é“¾ï¼Œç½‘ç»œå±‚é€šè¿‡æ³¨å†Œåˆ°ä¸Šå±‚çš„ <code>ip_local_out</code> å‡½æ•°æ¥æ”¶æ•°æ®å¤„ç†ï¼Œå¤„ç† OK è¿›ä¸€æ­¥äº¤ç”± <code>IP_LOCAL_OUT</code> èŠ‚ç‚¹æ£€æµ‹ã€‚</p><h4 id="5-æŸ¥æ‰¾è·¯ç”±è¡¨ï¼Œç¡®å®šä¸‹ä¸€è·³"><a href="#5-æŸ¥æ‰¾è·¯ç”±è¡¨ï¼Œç¡®å®šä¸‹ä¸€è·³" class="headerlink" title="5. æŸ¥æ‰¾è·¯ç”±è¡¨ï¼Œç¡®å®šä¸‹ä¸€è·³"></a>5. æŸ¥æ‰¾è·¯ç”±è¡¨ï¼Œç¡®å®šä¸‹ä¸€è·³</h4><h4 id="6-è°ƒç”¨-netfilter-çš„-POST-ROUTING-é“¾"><a href="#6-è°ƒç”¨-netfilter-çš„-POST-ROUTING-é“¾" class="headerlink" title="6. è°ƒç”¨ netfilter çš„ POST_ROUTING é“¾"></a>6. è°ƒç”¨ netfilter çš„ POST_ROUTING é“¾</h4><p>å¯¹äºå³å°†å‘å¾€ä¸‹å±‚çš„æ•°æ®åŒ…ï¼Œéœ€è¦ç»è¿‡ <code>IP_POST_ROUTING</code> èŠ‚ç‚¹å¤„ç†ï¼›ç½‘ç»œå±‚å¤„ç†ç»“æŸï¼Œé€šè¿‡ <code>dev_queue_xmit</code> å‡½æ•°å°†æ•°æ®åŒ…äº¤ç”± Linux å†…æ ¸ä¸­è™šæ‹Ÿç½‘ç»œè®¾å¤‡åšè¿›ä¸€æ­¥å¤„ç†ï¼Œä»è¿™é‡Œæ•°æ®åŒ…å³ç¦»å¼€ç½‘ç»œå±‚è¿›å…¥åˆ°ä¸‹ä¸€å±‚ã€‚</p><h4 id="7-å¯¹è¶…æ—¶-MTU-çš„æŠ¥æ–‡è¿›è¡Œåˆ†ç‰‡-fragment"><a href="#7-å¯¹è¶…æ—¶-MTU-çš„æŠ¥æ–‡è¿›è¡Œåˆ†ç‰‡-fragment" class="headerlink" title="7. å¯¹è¶…æ—¶ MTU çš„æŠ¥æ–‡è¿›è¡Œåˆ†ç‰‡(fragment)"></a>7. å¯¹è¶…æ—¶ MTU çš„æŠ¥æ–‡è¿›è¡Œåˆ†ç‰‡(fragment)</h4><h4 id="8-è°ƒç”¨äºŒæˆçš„å‘åŒ…å‡½æ•°-dev-queue-xmit"><a href="#8-è°ƒç”¨äºŒæˆçš„å‘åŒ…å‡½æ•°-dev-queue-xmit" class="headerlink" title="8. è°ƒç”¨äºŒæˆçš„å‘åŒ…å‡½æ•° dev_queue_xmit"></a>8. è°ƒç”¨äºŒæˆçš„å‘åŒ…å‡½æ•° dev_queue_xmit</h4><h4 id="9-å°†å¾…å‘æ•°æ®åŒ…æ”¾å…¥è¾“å‡ºçš„-QDisc-é˜Ÿåˆ—"><a href="#9-å°†å¾…å‘æ•°æ®åŒ…æ”¾å…¥è¾“å‡ºçš„-QDisc-é˜Ÿåˆ—" class="headerlink" title="9. å°†å¾…å‘æ•°æ®åŒ…æ”¾å…¥è¾“å‡ºçš„ QDisc é˜Ÿåˆ—"></a>9. å°†å¾…å‘æ•°æ®åŒ…æ”¾å…¥è¾“å‡ºçš„ QDisc é˜Ÿåˆ—</h4><h4 id="10-è°ƒç”¨ç½‘å¡é©±åŠ¨ç¨‹åºï¼Œå°†æ•°æ®åŒ…æ”¾å…¥å¾ªç¯ç¼“å†²é˜Ÿåˆ—-tx"><a href="#10-è°ƒç”¨ç½‘å¡é©±åŠ¨ç¨‹åºï¼Œå°†æ•°æ®åŒ…æ”¾å…¥å¾ªç¯ç¼“å†²é˜Ÿåˆ—-tx" class="headerlink" title="10. è°ƒç”¨ç½‘å¡é©±åŠ¨ç¨‹åºï¼Œå°†æ•°æ®åŒ…æ”¾å…¥å¾ªç¯ç¼“å†²é˜Ÿåˆ— tx"></a>10. è°ƒç”¨ç½‘å¡é©±åŠ¨ç¨‹åºï¼Œå°†æ•°æ®åŒ…æ”¾å…¥å¾ªç¯ç¼“å†²é˜Ÿåˆ— tx</h4><h4 id="11-é©±åŠ¨ç¨‹åºåœ¨-tx-usecs-çš„è¶…æ—¶æ—¶é—´åï¼Œæˆ–è€…ç§¯ç´¯-tx-frames-ä¸ªå¾…å‘æ•°æ®åŒ…åè§¦å‘è½¯ä¸­æ–­"><a href="#11-é©±åŠ¨ç¨‹åºåœ¨-tx-usecs-çš„è¶…æ—¶æ—¶é—´åï¼Œæˆ–è€…ç§¯ç´¯-tx-frames-ä¸ªå¾…å‘æ•°æ®åŒ…åè§¦å‘è½¯ä¸­æ–­" class="headerlink" title="11. é©±åŠ¨ç¨‹åºåœ¨ tx-usecs çš„è¶…æ—¶æ—¶é—´åï¼Œæˆ–è€…ç§¯ç´¯ tx-frames ä¸ªå¾…å‘æ•°æ®åŒ…åè§¦å‘è½¯ä¸­æ–­"></a>11. é©±åŠ¨ç¨‹åºåœ¨ tx-usecs çš„è¶…æ—¶æ—¶é—´åï¼Œæˆ–è€…ç§¯ç´¯ tx-frames ä¸ªå¾…å‘æ•°æ®åŒ…åè§¦å‘è½¯ä¸­æ–­</h4><ul><li><p>tx-usecs</p></li><li><p>tx-frames</p></li></ul><h4 id="12-é©±åŠ¨ç¨‹åºå¯ç”¨ç½‘å¡çš„ç¡¬ä»¶ä¸­æ–­"><a href="#12-é©±åŠ¨ç¨‹åºå¯ç”¨ç½‘å¡çš„ç¡¬ä»¶ä¸­æ–­" class="headerlink" title="12. é©±åŠ¨ç¨‹åºå¯ç”¨ç½‘å¡çš„ç¡¬ä»¶ä¸­æ–­"></a>12. é©±åŠ¨ç¨‹åºå¯ç”¨ç½‘å¡çš„ç¡¬ä»¶ä¸­æ–­</h4><h4 id="13-é©±åŠ¨ç¨‹åºå°†æ•°æ®åŒ…æ˜ å°„åˆ°-DMA-å†…å­˜"><a href="#13-é©±åŠ¨ç¨‹åºå°†æ•°æ®åŒ…æ˜ å°„åˆ°-DMA-å†…å­˜" class="headerlink" title="13. é©±åŠ¨ç¨‹åºå°†æ•°æ®åŒ…æ˜ å°„åˆ° DMA å†…å­˜"></a>13. é©±åŠ¨ç¨‹åºå°†æ•°æ®åŒ…æ˜ å°„åˆ° DMA å†…å­˜</h4><h4 id="14-ç½‘å¡ä»-DMA-ä¸­å–æ•°æ®å¹¶å‘é€"><a href="#14-ç½‘å¡ä»-DMA-ä¸­å–æ•°æ®å¹¶å‘é€" class="headerlink" title="14. ç½‘å¡ä» DMA ä¸­å–æ•°æ®å¹¶å‘é€"></a>14. ç½‘å¡ä» DMA ä¸­å–æ•°æ®å¹¶å‘é€</h4><h4 id="15-ç½‘å¡å‘é€å®Œæ¯•åè§¦å‘ç¡¬ä»¶ä¸­æ–­"><a href="#15-ç½‘å¡å‘é€å®Œæ¯•åè§¦å‘ç¡¬ä»¶ä¸­æ–­" class="headerlink" title="15. ç½‘å¡å‘é€å®Œæ¯•åè§¦å‘ç¡¬ä»¶ä¸­æ–­"></a>15. ç½‘å¡å‘é€å®Œæ¯•åè§¦å‘ç¡¬ä»¶ä¸­æ–­</h4><h4 id="16-ç¡¬ä¸­æ–­æ¸…ç†ä¸­æ–­ä¿¡å·åè§¦å‘è½¯ä¸­æ–­"><a href="#16-ç¡¬ä¸­æ–­æ¸…ç†ä¸­æ–­ä¿¡å·åè§¦å‘è½¯ä¸­æ–­" class="headerlink" title="16. ç¡¬ä¸­æ–­æ¸…ç†ä¸­æ–­ä¿¡å·åè§¦å‘è½¯ä¸­æ–­"></a>16. ç¡¬ä¸­æ–­æ¸…ç†ä¸­æ–­ä¿¡å·åè§¦å‘è½¯ä¸­æ–­</h4><h4 id="17-è½¯ä¸­æ–­é‡Šæ”¾å·²ç»å‘é€å®Œçš„æ•°æ®åŒ…çš„å†…å­˜"><a href="#17-è½¯ä¸­æ–­é‡Šæ”¾å·²ç»å‘é€å®Œçš„æ•°æ®åŒ…çš„å†…å­˜" class="headerlink" title="17. è½¯ä¸­æ–­é‡Šæ”¾å·²ç»å‘é€å®Œçš„æ•°æ®åŒ…çš„å†…å­˜"></a>17. è½¯ä¸­æ–­é‡Šæ”¾å·²ç»å‘é€å®Œçš„æ•°æ®åŒ…çš„å†…å­˜</h4><h2 id="é˜²ç«å¢™"><a href="#é˜²ç«å¢™" class="headerlink" title="é˜²ç«å¢™"></a>é˜²ç«å¢™</h2><p>æåˆ°é˜²ç«å¢™ï¼Œæƒ³å¿…å„ä½éƒ½çŸ¥é“å¤§åé¼é¼çš„æ–¹æ•™æˆå“ˆğŸ˜‚ï¼Œä¸è¿‡å’±ä»Šå¤©ä¸è°ˆè¿™ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥å»è¯»ä¸€å“ˆ <a href="https://gfw.report/blog/gfw_shadowsocks/zh.html" target="_blank" rel="noopener">Shadowsocksæ˜¯å¦‚ä½•è¢«æ£€æµ‹å’Œå°é”çš„</a> å’Œ <a href="http://www.oneyearago.me/2019/06/14/learn_gwf/" target="_blank" rel="noopener">G.F.Wçš„åŸç†</a></p><p>è®²å®Œäº† Linux å‘åŒ…å’Œæ”¶åŒ…çš„æ•´ä¸ªæµç¨‹æˆ‘ä»¬å°±æ¸…æ¥šäº†é˜²ç«å¢™åœ¨ç½‘ç»œä¸­æ‰€å·¥ä½œçš„åœ°æ–¹ï¼Œä¸‹é¢å°±å°†ä¸€ä¸‹ Linux ä¸Šçš„é˜²ç«å¢™ iptablesã€‚</p><h3 id="iptales"><a href="#iptales" class="headerlink" title="iptales"></a>iptales</h3><p>è‡ªä» Linux å†…æ ¸ 2.4 ä¹‹å iptables å°±é›†æˆè¿›ä¸»çº¿å†…æ ¸ï¼Œä¸è¿‡ iptables åªæ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨äºé…ç½®ç®¡ç†æ•°æ®åŒ…çš„è¿‡æ»¤è§„åˆ™ï¼Œè€ŒçœŸæ­£èµ·åˆ°ä¿¡æ¯åŒ…è¿‡æ»¤ä½œç”¨çš„æ˜¯ netfilter æ¡†æ¶ã€‚å‡†ç¡®æ¥è®² iptables æ˜¯ä¸€ä¸ªé€šè¿‡æ§åˆ¶ Linux å†…æ ¸çš„ netfilter æ¨¡å—æ¥<strong>ç®¡ç†ç½‘ç»œæ•°æ®åŒ…çš„æµåŠ¨ä¸è½¬é€</strong>çš„åº”ç”¨è½¯ä»¶ï¼Œå…¶åŠŸèƒ½åŒ…æ‹¬ä¸ä»…ä»…åŒ…æ‹¬é˜²ç«å¢™çš„æ§åˆ¶å‡ºå…¥æµé‡ï¼Œè¿˜æœ‰ç«¯å£è½¬å‘ç­‰ç­‰ã€‚</p><h3 id="netfilter"><a href="#netfilter" class="headerlink" title="netfilter"></a>netfilter</h3><p>netfilter æ˜¯å†…æ ¸çš„ä¸€ä¸ªå­ç³»ç»Ÿï¼Œå…¶å·¥ä½œåœ¨å†…æ ¸ç©ºé—´ï¼Œæ ¸å¿ƒæ˜¯ä¸€ä¸ªæŠ¥æ–‡è¿‡æ»¤æ¶æ„ï¼Œå®ƒåŒ…å«äº†ä¸€ç»„åˆ†å¸ƒåœ¨æŠ¥æ–‡å¤„ç†å„ä¸ªé˜¶æ®µçš„é’©å­å‡½æ•°ï¼ŒæŠ¥æ–‡ç»è¿‡ç½‘ç»œåè®®æ ˆæ—¶è¿›å…¥ netfilter å¤„ç†æ¶æ„ï¼Œä¼šè°ƒç”¨å…¶ä»–æ¨¡å—åœ¨å„ä¸ªé˜¶æ®µæ³¨å†Œçš„é’©å­å‡½æ•°ï¼Œå¹¶è¿”å›å¤„ç†ç»“æœï¼Œnetfilter æ ¹æ®è¿”å›ç»“æœè¿›è¡Œä¸åŒçš„å¤„ç†ã€‚</p><h4 id="è¡¨-é“¾-è§„åˆ™"><a href="#è¡¨-é“¾-è§„åˆ™" class="headerlink" title="è¡¨/é“¾/è§„åˆ™"></a>è¡¨/é“¾/è§„åˆ™</h4><p>iptables å†…éƒ¨æœ‰è¡¨ tablesã€é“¾ chainsã€è§„åˆ™ rules è¿™ä¸‰ç§æ¦‚å¿µã€‚å…¶ä¸­æ¯ä¸€ä¸ª <code>è¡¨</code> éƒ½å’Œä¸åŒçš„æ•°æ®åŒ…å¤„ç†æœ‰å…³ï¼Œè€Œå†³å®šæ•°æ®åŒ…æ˜¯å¦å¯ä»¥ç©¿è¶Šçš„æ˜¯ <code>é“¾</code>ã€è€Œé“¾ä¸Šçš„ä¸€æ¡æ¡ <code>è§„åˆ™</code> å†³å®šäº†æ˜¯å¦é€å¾€ä¸‹ä¸€æ¡é“¾ï¼ˆæˆ–å…¶å®ƒçš„åŠ¨ä½œï¼‰ã€‚ netfilter/iptables å¯ä»¥ç†è§£æˆæ˜¯ <code>è¡¨</code> çš„å®¹å™¨ï¼›è¡¨åˆ™æ˜¯ <code>é“¾</code> çš„å®¹å™¨ï¼Œå³æ‰€æœ‰çš„<code>é“¾</code>éƒ½å±äºå…¶å¯¹åº”çš„<code>è¡¨</code>ï¼›<code>é“¾</code>æ˜¯ <code>è§„åˆ™</code> çš„å®¹å™¨ï¼Œå…¶é›†åˆä»å±å…³ç³»å¯ä»¥è¡¨è¿°ä¸ºï¼ˆè¡¨ï¼ˆé“¾ï¼ˆè§„åˆ™ï¼‰ï¼‰ï¼‰ã€‚</p><p>å¹¿ä¸ºæµä¼ çš„è¯´æ³•æ˜¯ iptables æœ‰å››è¡¨äº”é“¾ï¼Œå…¶ä¸­å››è¡¨ï¼ˆ rawã€filter, nat, mangle,ï¼‰äº”é“¾ï¼ˆINPUTã€OUTPUTã€FORWARDã€ PREROUTINGã€ POSTROUTINGï¼‰ï¼Œä¸è¿‡ä¹Ÿæœ‰è¯´æ³•ä¸ºäº”è¡¨ï¼ˆ rawã€filterã€natã€mangleã€securityï¼‰äº”é“¾ï¼Œä¸è¿‡ security è¡¨å¤§å¤šæ•°æƒ…å†µä¸‹ä¸ä¼šç”¨åˆ°ï¼Œå¸¸ç”¨çš„æ˜¯  filter å’Œ nat è¡¨ï¼Œmangle è¡¨æ¬¡ä¹‹ã€‚</p><h4 id="äº”è¡¨"><a href="#äº”è¡¨" class="headerlink" title="äº”è¡¨"></a>äº”è¡¨</h4><ul><li><p>raw è¡¨ï¼š ä¼˜å…ˆçº§æœ€é«˜ï¼Œé€šå¸¸ä¸<code>NOTRACK</code>ä¸€èµ·ä½¿ç”¨ï¼Œç”¨äºè·³è¿‡<code>è¿æ¥è·Ÿè¸ªï¼ˆconntrackï¼‰</code>å’Œ nat è¡¨çš„å¤„ç†ç”¨äºé…ç½®æ•°æ®åŒ…ï¼Œraw ä¸­çš„æ•°æ®åŒ…ä¸ä¼šè¢«ç³»ç»Ÿè·Ÿè¸ªã€‚è®¾ç½® raw æ—¶ä¸€èˆ¬æ˜¯ä¸ºäº†ä¸å†è®© iptables åšæ•°æ®åŒ…çš„é“¾æ¥è·Ÿè¸ªå¤„ç†ï¼Œæé«˜æ€§èƒ½ã€‚</p></li><li><p>filter è¡¨ï¼š ä¸º iptables é»˜è®¤çš„è¡¨ï¼Œç”¨äºè¿‡æ»¤æ•°æ®åŒ…ï¼Œæ¯”å¦‚ ACCEPTï¼ˆå…è®¸ï¼‰ï¼ŒDROPï¼ˆä¸¢å¼ƒï¼‰ã€REJECTï¼ˆæ‹’ç»ï¼‰ã€LOGï¼ˆè®°å½•æ—¥å¿—ï¼‰ï¼›åœ¨æ“ä½œæ—¶å¦‚æœæ²¡æœ‰æŒ‡å®šä½¿ç”¨å“ªä¸ªè¡¨ï¼Œiptables é»˜è®¤ä½¿ç”¨ filter è¡¨æ¥æ‰§è¡Œæ‰€æœ‰çš„å‘½ä»¤ã€‚filter è¡¨æ ¹æ®é¢„å®šä¹‰çš„ä¸€ç»„è§„åˆ™è¿‡æ»¤ç¬¦åˆæ¡ä»¶çš„æ•°æ®åŒ…ã€‚åœ¨ filter è¡¨ä¸­åªå…è®¸å¯¹æ•°æ®åŒ…è¿›è¡Œæ¥æ”¶ã€ä¸¢å¼ƒçš„æ“ä½œï¼Œè€Œæ— æ³•å¯¹æ•°æ®åŒ…è¿›è¡Œæ›´æ”¹ã€‚</p></li><li><p>nat è¡¨ï¼š å³ Network Address Translationï¼Œä¸»è¦æ˜¯ç”¨äºç½‘ç»œåœ°å€è½¬æ¢ï¼ˆä¾‹å¦‚ï¼šç«¯å£è½¬å‘ï¼‰ï¼Œè¯¥è¡¨å¯ä»¥å®ç°ä¸€å¯¹ä¸€ã€ä¸€å¯¹å¤šã€å¤šå¯¹å¤šç­‰ NAT å·¥ä½œï¼Œå¦‚ SNATï¼ˆä¿®æ”¹æºåœ°å€ï¼‰ã€DNATï¼ˆä¿®æ”¹ç›®çš„åœ°å€ï¼‰ã€REDIRECT é‡å®šå‘ç­‰ï¼›ã€‚</p></li><li><p>mangle è¡¨ï¼š ä¿®æ”¹åŒ…å¤´éƒ¨çš„æŸäº›ç‰¹æ®Šæ¡ç›®ï¼Œä¸»è¦ç”¨äºå¯¹æŒ‡å®šåŒ…çš„ä¼ è¾“ç‰¹æ€§è¿›è¡Œä¿®æ”¹ã€‚æŸäº›ç‰¹æ®Šåº”ç”¨å¯èƒ½éœ€è¦æ”¹å†™æ•°æ®åŒ…çš„ä¸€äº›ä¼ è¾“ç‰¹æ€§ï¼Œå¦‚ TOSã€TTLã€æ‰“ä¸Šç‰¹æ®Šæ ‡è®° MARK ç­‰ï¼Œä»¥å½±å“åé¢çš„è·¯ç”±å†³ç­–ã€‚</p></li><li><p>security è¡¨ï¼š ç”¨äºå¼ºåˆ¶è®¿é—®æ§åˆ¶ç½‘ç»œè§„åˆ™ï¼ˆä¾‹å¦‚ï¼š SELinuxï¼‰ã€‚</p></li></ul><p>è¡¨çš„å¤„ç†ä¼˜å…ˆçº§: raw &gt; mangle &gt; nat &gt; filterã€‚</p><blockquote><p>raw è¡¨é™¤äº† <code>-j NOTRACK</code> å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªå¸¸ç”¨çš„åŠ¨ä½œï¼Œé‚£å°±æ˜¯ <code>-j TRACE</code>ï¼Œç”¨äºè·Ÿè¸ªæ•°æ®åŒ…ï¼Œè¿›è¡Œè§„åˆ™çš„è°ƒè¯•ï¼Œä½¿ç”¨ dmesg æŸ¥çœ‹ã€‚</p><p><code>è¿æ¥è·Ÿè¸ª</code>ï¼Œé¡¾åæ€ä¹‰ï¼Œå°±æ˜¯è·Ÿè¸ªå¹¶è®°å½•ç½‘ç»œè¿æ¥çš„çŠ¶æ€ï¼ˆä½ å¯èƒ½è®¤ä¸ºåªæœ‰ TCP æ‰æœ‰â€œè¿æ¥â€è¿™ä¸ªæ¦‚å¿µï¼Œä½†æ˜¯åœ¨ netfilter ä¸­ï¼ŒTCPã€UDPã€ICMP ä¸€è§†åŒä»ï¼‰ã€‚netfilter ä¼šä¸ºæ¯ä¸ªç»è¿‡ç½‘ç»œå †æ ˆçš„è¿æ¥ç”Ÿæˆä¸€ä¸ª<strong>è¿æ¥è®°å½•é¡¹ï¼ˆConnection Entryï¼‰</strong>ï¼›æ­¤åæ‰€æœ‰å±äºæ­¤è¿æ¥çš„æ•°æ®åŒ…éƒ½è¢«å”¯ä¸€åœ°åˆ†é…ç»™è¿™ä¸ªè¿æ¥å¹¶æ ‡è¯†è¿æ¥çš„çŠ¶æ€ï¼›ç”±æ‰€æœ‰è¿æ¥è®°å½•é¡¹ç»„æˆçš„è¡¨å…¶å®å°±æ˜¯æ‰€è°“çš„<strong>è¿æ¥è·Ÿè¸ªè¡¨</strong>ã€‚</p><p>ä¸ºä»€ä¹ˆéœ€è¦è¿æ¥è·Ÿè¸ªï¼Ÿå› ä¸ºå®ƒæ˜¯<strong>çŠ¶æ€é˜²ç«å¢™å’Œ NAT çš„å®ç°åŸºç¡€</strong>ï¼</p><ul><li><code>çŠ¶æ€é˜²ç«å¢™</code>ï¼šiptables çš„ conntrack/state æ¨¡å—å…è®¸æˆ‘ä»¬æ ¹æ®è¿æ¥çš„çŠ¶æ€è¿›è¡Œè§„åˆ™é…ç½®ï¼Œå¦‚æœæ²¡æœ‰è¿æ¥è·Ÿè¸ªï¼Œé‚£æ˜¯åšä¸åˆ°çš„ã€‚</li><li><code>NAT</code>ï¼ŒNAT å…¶å®å°±æ˜¯ä¿®æ”¹æ•°æ®åŒ…çš„æºåœ°å€/ç«¯å£ã€ç›®çš„åœ°å€/ç«¯å£ï¼Œå¦‚æœæ²¡æœ‰è¿æ¥è·Ÿè¸ªï¼Œé‚£ä¹ˆä¹Ÿä¸å¯èƒ½å†æ‰¾å›ä¿®æ”¹å‰çš„åœ°å€ä¿¡æ¯ã€‚</li></ul></blockquote><h4 id="äº”é“¾"><a href="#äº”é“¾" class="headerlink" title="äº”é“¾"></a>äº”é“¾</h4><p>é“¾(chains)æ˜¯æ•°æ®åŒ…ä¼ è¾“çš„è·¯å¾„ï¼Œå¯¹åº”ç€æŠ¥æ–‡å¤„ç†çš„äº”ä¸ªä¸åŒé˜¶æ®µï¼š</p><ul><li>INPUTï¼š å¤„ç†å…¥ç«™æ•°æ®åŒ…ï¼Œå½“æ¥æ”¶åˆ°è®¿é—®æœ¬æœºåœ°å€çš„æ•°æ®åŒ…(å…¥ç«™)æ—¶ï¼Œåº”ç”¨æ­¤é“¾ä¸­çš„è§„åˆ™ã€‚</li><li>OUTPUTï¼š å¤„ç†å‡ºç«™æ•°æ®åŒ…ï¼Œå½“æœ¬æœºå‘å¤–å‘é€æ•°æ®åŒ…(å‡ºç«™)æ—¶ï¼Œåº”ç”¨æ­¤é“¾ä¸­çš„è§„åˆ™ã€‚</li><li>FORWARDï¼š å¤„ç†è½¬å‘æ•°æ®åŒ…ï¼Œå½“æ¥æ”¶åˆ°éœ€è¦é€šè¿‡æœ¬æœºå‘é€ç»™å…¶ä»–åœ°å€çš„æ•°æ®åŒ…(è½¬å‘)æ—¶ï¼Œåº”ç”¨æ­¤é“¾ä¸­çš„è§„åˆ™ã€‚ï¼ˆip_forward å’Œè·¯ç”±å™¨ä¼šç”¨åˆ°ï¼‰</li><li>PREROUTINGï¼š åœ¨å¯¹æ•°æ®åŒ…ä½œè·¯ç”±é€‰æ‹©ä¹‹å‰ï¼Œåº”ç”¨æ­¤é“¾ä¸­çš„è§„åˆ™ã€‚</li><li>POSTROUTINGï¼š åœ¨å¯¹æ•°æ®åŒ…ä½œè·¯ç”±é€‰æ‹©ä¹‹åï¼Œåº”ç”¨æ­¤é“¾ä¸­çš„è§„åˆ™ã€‚</li></ul><p>å…¶ä¸­ INPUT å’Œ OUTPUT é“¾ä¸»è¦åº”ç”¨åœ¨æœ¬æœºçš„ç½‘ç»œæ§åˆ¶ä¸­ï¼Œè€Œ FORWARDã€PREROUTINGã€ POSTROUTING é“¾æ›´å¤šåœ°åº”ç”¨åœ¨å¯¹å¤–çš„ç½‘ç»œæ§åˆ¶ä¸­ï¼Œç‰¹åˆ«æ˜¯æœºå™¨ä½œä¸ºç½‘å…³ä½¿ç”¨æ—¶çš„æƒ…å†µã€‚</p><h4 id="è§„åˆ™"><a href="#è§„åˆ™" class="headerlink" title="è§„åˆ™"></a>è§„åˆ™</h4><p>æ•°æ®åŒ…çš„è¿‡æ»¤åŸºäº <strong>è§„åˆ™</strong>ï¼Œè€Œè§„åˆ™æ˜¯ç”±åŒ¹é…æ¡ä»¶å’Œå¤„ç†åŠ¨ä½œç»„æˆã€‚è§„åˆ™åˆ†åˆ«æŒ‡å®šäº†æºåœ°å€ã€ç›®çš„åœ°å€ã€ä¼ è¾“åè®®ï¼ˆå¦‚TCPã€UDPã€ICMPï¼‰å’ŒæœåŠ¡ç±»å‹ï¼ˆå¦‚HTTPã€FTPå’ŒSMTPï¼‰ç­‰ã€‚å½“æ•°æ®åŒ…ä¸è§„åˆ™åŒ¹é…æ—¶ï¼Œiptables å°±æ ¹æ®è§„åˆ™æ‰€å®šä¹‰çš„æ–¹æ³•æ¥å¤„ç†è¿™äº›æ•°æ®åŒ…ï¼Œå¦‚æ”¾è¡Œï¼ˆacceptï¼‰ã€æ‹’ç»ï¼ˆrejectï¼‰å’Œä¸¢å¼ƒï¼ˆdropï¼‰ç­‰ã€‚é…ç½®é˜²ç«å¢™çš„ä¸»è¦å·¥ä½œå°±æ˜¯æ·»åŠ ã€ä¿®æ”¹å’Œåˆ é™¤è¿™äº›è§„åˆ™ã€‚</p><p><strong>å¸¸è§çš„å¤„ç†åŠ¨ä½œï¼š</strong></p><ul><li>ACCEPTï¼š å…è®¸æ•°æ®åŒ…é€šè¿‡ã€‚</li><li>DROPï¼š ç›´æ¥ä¸¢å¼ƒæ•°æ®åŒ…ï¼Œä¸ç»™ä»»ä½•å›åº”ä¿¡æ¯ã€‚</li><li>QUEUEï¼š å°†æ•°æ®åŒ…ç§»äº¤åˆ°ç”¨æˆ·ç©ºé—´ã€‚</li><li>RETURNï¼š åœæ­¢æ‰§è¡Œå½“å‰é“¾ä¸­çš„åç»­è§„åˆ™ï¼Œå¹¶è¿”å›åˆ°è°ƒç”¨é“¾(The Calling Chain)ä¸­ã€‚</li><li>REJECTï¼š æ‹’ç»æ•°æ®åŒ…é€šè¿‡ï¼Œå¿…è¦æ—¶ä¼šç»™æ•°æ®å‘é€ç«¯ä¸€ä¸ªå“åº”çš„ä¿¡æ¯ã€‚</li><li>DNATï¼š ç›®æ ‡åœ°å€è½¬æ¢ï¼ˆdocker ç½‘ç»œä¼šç”¨åˆ°ï¼‰ã€‚</li><li>SNATï¼š æºåœ°å€è½¬æ¢ï¼Œè§£å†³å†…ç½‘ç”¨æˆ·ç”¨åŒä¸€ä¸ªå…¬ç½‘åœ°å€ä¸Šç½‘çš„é—®é¢˜ ï¼ˆdocker ç½‘ç»œä¼šç”¨åˆ°ï¼‰ã€‚</li><li>MASQUERADEï¼š æ˜¯ SNAT çš„ä¸€ç§ç‰¹æ®Šå½¢å¼ï¼Œé€‚ç”¨äºåŠ¨æ€çš„ã€ä¸´æ—¶ä¼šå˜çš„ ip ä¸Šã€‚</li><li>REDIRECTï¼š åœ¨æœ¬æœºåšç«¯å£æ˜ å°„ï¼ˆé€æ˜ä»£ç†çš„æ—¶å€™ä¼šç”¨åˆ°ï¼‰ã€‚</li><li>LOGï¼š è®°å½•æ—¥å¿—ä¿¡æ¯ï¼Œé™¤è®°å½•å¤–ä¸å¯¹æ•°æ®åŒ…åšä»»ä½•å…¶ä»–æ“ä½œï¼Œä»ç„¶åŒ¹é…ä¸‹ä¸€æ¡è§„åˆ™ã€‚</li></ul><p><strong>æ€»ä½“é¡ºåºå¦‚ä¸‹ï¼š</strong></p><p>1.å½“ä¸€ä¸ªæ•°æ®åŒ…è¿›å…¥æŸä¸ªé“¾æ—¶ï¼Œé¦–å…ˆæŒ‰ç…§è¡¨çš„ä¼˜å…ˆçº§ä¾æ¬¡å¤„ç†ï¼›<br>2.æ¯ä¸ªè¡¨ä¸­çš„è§„åˆ™éƒ½æœ‰åºå·ï¼ˆä» 1 å¼€å§‹ï¼‰ï¼Œæ•°æ®åŒ…ä¼šæ ¹æ®è§„åˆ™åºå·ä¾æ¬¡è¿›è¡ŒåŒ¹é…ï¼›<br>3.å¦‚æœå‘½ä¸­ä¸€æ¡è§„åˆ™ï¼Œåˆ™æ‰§è¡Œç›¸åº”çš„åŠ¨ä½œï¼›å¦‚æœæ‰€æœ‰è¡¨çš„è§„åˆ™éƒ½æœªå‘½ä¸­ï¼Œåˆ™æ‰§è¡Œé»˜è®¤ç­–ç•¥ã€‚</p><h3 id="å…³ç³»"><a href="#å…³ç³»" class="headerlink" title="å…³ç³»"></a>å…³ç³»</h3><p>é“¾æ˜¯è§„åˆ™çš„å®¹å™¨ï¼Œä¸€æ¡é“¾ä¸­å¯èƒ½åŒ…å«ç€ä¼—å¤šçš„è§„åˆ™ï¼Œå½“ä¸€ä¸ªæ•°æ®åŒ…åˆ°è¾¾ä¸€ä¸ªé“¾æ—¶ï¼Œiptables å°±ä¼šä»é“¾ä¸­ç¬¬ä¸€æ¡è§„åˆ™å¼€å§‹åŒ¹é…ï¼Œå¦‚æœæ»¡è¶³è¯¥è§„åˆ™çš„æ¡ä»¶ï¼Œç³»ç»Ÿå°±ä¼šæ ¹æ®è¯¥æ¡è§„åˆ™æ‰€å®šä¹‰çš„æ–¹æ³•å¤„ç†è¯¥æ•°æ®åŒ…ï¼Œå¦åˆ™å°†ç»§ç»­åŒ¹é…ä¸‹ä¸€æ¡è§„åˆ™ï¼Œå¦‚æœè¯¥æ•°æ®åŒ…ä¸ç¬¦åˆé“¾ä¸­ä»»ä¸€æ¡è§„åˆ™ï¼Œiptables å°±ä¼šæ ¹æ®è¯¥é“¾é¢„å…ˆå®šä¹‰çš„é»˜è®¤ç­–ç•¥æ¥å¤„ç†æ•°æ®åŒ…ã€‚å¯ä»¥çœ‹åˆ° iptables éå†é“¾ä¸­çš„è§„åˆ™ç®—æ³•å¤æ‚åº¦ä¸º O(n)ï¼Œå³éšç€é“¾ä¸­çš„è§„åˆ™æ•°é‡å¢å¤§è€Œå¢å¤§ã€‚è€Œä¸”ï¼Œé“¾çš„åŒ¹é…æ˜¯æœ‰é¡ºåºçš„ï¼Œè¿™ä¸€ç‚¹éå¸¸é‡è¦ï¼Œåœ¨æ·»åŠ è§„åˆ™çš„æ—¶å€™ä¹Ÿè¦ä¸»è¦é¡ºåºï¼Œæé”™äº†å°±å¯èƒ½å¯¼è‡´ç³»ç»Ÿæ‰€æœ‰æµé‡éƒ½æ— æ³•è¿›å…¥ã€‚</p><h4 id="Filter-è¡¨"><a href="#Filter-è¡¨" class="headerlink" title="Filter è¡¨"></a>Filter è¡¨</h4><p>Filter è¡¨æ˜¯ iptables çš„é»˜è®¤è¡¨ï¼Œå› æ­¤å¦‚æœæ²¡æœ‰æŒ‡å®šè¡¨ï¼Œé‚£ä¹ˆé»˜è®¤æ“ä½œçš„æ˜¯ filter è¡¨ï¼Œå…¶åŒ…å«ä»¥ä¸‹ä¸‰ç§å†…å»ºé“¾ï¼š</p><ul><li>INPUT é“¾ï¼šå¤„ç†æ¥è‡ªå¤–éƒ¨çš„æ•°æ®</li><li>OUTPUT é“¾ï¼šå¤„ç†å‘å¤–å‘é€çš„æ•°æ®</li><li>FORWARD é“¾ï¼šå°†æ•°æ®è½¬å‘åˆ°æœ¬æœºçš„å…¶ä»–ç½‘å¡è®¾å¤‡ä¸Š</li></ul><h4 id="NAT-è¡¨"><a href="#NAT-è¡¨" class="headerlink" title="NAT è¡¨"></a>NAT è¡¨</h4><ul><li><p>PREROUTING é“¾ï¼šå¤„ç†åˆšåˆ°è¾¾æœ¬æœºå¹¶åœ¨è·¯ç”±è½¬å‘å‰çš„æ•°æ®åŒ…ã€‚å®ƒä¼šè½¬æ¢æ•°æ®åŒ…ä¸­çš„ç›®æ ‡ IP åœ°å€ï¼ˆdestination ip addressï¼‰ï¼Œé€šå¸¸ç”¨äº DNAT(destination NAT)</p></li><li><p>POSTROUTING é“¾ï¼šå¤„ç†å³å°†ç¦»å¼€æœ¬æœºçš„æ•°æ®åŒ…ã€‚å®ƒä¼šè½¬æ¢æ•°æ®åŒ…ä¸­çš„æº IP åœ°å€ï¼ˆsource ip addressï¼‰ï¼Œé€šå¸¸ç”¨äº SNATï¼ˆsource NATï¼‰</p></li><li><p>OUTPUT é“¾ï¼šå¤„ç†æœ¬æœºå‘å‡ºçš„æ•°æ®åŒ…</p></li></ul><h4 id="Mangle-è¡¨"><a href="#Mangle-è¡¨" class="headerlink" title="Mangle è¡¨"></a>Mangle è¡¨</h4><p>Mangle è¡¨åŒ…å«äº”ç§å†…å»ºé“¾ï¼šPREROUTINGã€OUTPUTã€FORWARDã€INPUTã€POSTROUTINGã€‚</p><h4 id="Raw-è¡¨"><a href="#Raw-è¡¨" class="headerlink" title="Raw è¡¨"></a>Raw è¡¨</h4><p>å«ä¸¤ä¸ªå†…å»ºé“¾ï¼šPREROUTING, OUTPUT.</p><h3 id="æ•°æ®åŒ…æµç¨‹"><a href="#æ•°æ®åŒ…æµç¨‹" class="headerlink" title="æ•°æ®åŒ…æµç¨‹"></a>æ•°æ®åŒ…æµç¨‹</h3><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/iptables.png" alt="img"></p><p>åœ¨ Linux ä¸‹ï¼Œä»ä»»ä½•ç½‘ç»œç«¯å£è¿›æ¥çš„æ¯ä¸€ä¸ª IP æ•°æ®åŒ…éƒ½è¦ä»ä¸Šåˆ°ä¸‹çš„ç©¿è¿‡è¿™å¼ å›¾ï¼Œiptabales å¯¹ä»ä»»ä½•ç«¯å£è¿›å…¥çš„æ•°æ®åŒ…éƒ½ä¼šé‡‡å–ç›¸åŒçš„å¤„ç†æ–¹å¼ã€‚</p><p>æ­¤å›¾æ‘˜è‡ª <a href="https://wiki.archlinux.org/index.php/Iptables" target="_blank" rel="noopener">Archlinux æ–‡æ¡£</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">                               XXXXXXXXXXXXXXXXXX</span><br><span class="line">                             XXX     Network    XXX</span><br><span class="line">                               XXXXXXXXXXXXXXXXXX</span><br><span class="line">                                       +</span><br><span class="line">                                       |</span><br><span class="line">                                       v</span><br><span class="line"> +-------------+              +------------------+</span><br><span class="line"> |table: filter| &lt;---+        | table: nat       |</span><br><span class="line"> |chain: INPUT |     |        | chain: PREROUTING|</span><br><span class="line"> +-----+-------+     |        +--------+---------+</span><br><span class="line">       |             |                 |</span><br><span class="line">       v             |                 v</span><br><span class="line"> [local process]     |           ****************          +--------------+</span><br><span class="line">       |             +---------+ Routing decision +------&gt; |table: filter |</span><br><span class="line">       v                         ****************          |chain: FORWARD|</span><br><span class="line">****************                                           +------+-------+</span><br><span class="line">Routing decision                                                  |</span><br><span class="line">****************                                                  |</span><br><span class="line">       |                                                          |</span><br><span class="line">       v                        ****************                  |</span><br><span class="line">+-------------+       +------&gt;  Routing decision  &lt;---------------+</span><br><span class="line">|table: nat   |       |         ****************</span><br><span class="line">|chain: OUTPUT|       |               +</span><br><span class="line">+-----+-------+       |               |</span><br><span class="line">      |               |               v</span><br><span class="line">      v               |      +-------------------+</span><br><span class="line">+--------------+      |      | table: nat        |</span><br><span class="line">|table: filter | +----+      | chain: POSTROUTING|</span><br><span class="line">|chain: OUTPUT |             +--------+----------+</span><br><span class="line">+--------------+                      |</span><br><span class="line">                                      v</span><br><span class="line">                               XXXXXXXXXXXXXXXXXX</span><br><span class="line">                             XXX    Network     XXX</span><br><span class="line">                               XXXXXXXXXXXXXXXXXX</span><br></pre></td></tr></table></figure><h3 id="éå†é“¾æµç¨‹å›¾"><a href="#éå†é“¾æµç¨‹å›¾" class="headerlink" title="éå†é“¾æµç¨‹å›¾"></a>éå†é“¾æµç¨‹å›¾</h3><p>è¯¥æµç¨‹å›¾æè¿°é“¾äº†åœ¨ä»»ä½•æ¥å£ä¸Šæ”¶åˆ°çš„ç½‘ç»œæ•°æ®åŒ…æ˜¯æŒ‰ç…§æ€æ ·çš„é¡ºåºç©¿è¿‡è¡¨çš„äº¤é€šç®¡åˆ¶é“¾ã€‚</p><p><img src="https://www.frozentux.net/iptables-tutorial/chunkyhtml/images/tables_traverse.jpg" alt="tables_traverse"></p><ul><li><p>ç¬¬ä¸€ä¸ªè·¯ç”±ç­–ç•¥åŒ…æ‹¬å†³å®šæ•°æ®åŒ…çš„ç›®çš„åœ°æ˜¯æœ¬åœ°ä¸»æœºï¼ˆè¿™ç§æƒ…å†µä¸‹ï¼Œæ•°æ®åŒ…ç©¿è¿‡ INPUT é“¾ï¼‰ï¼Œè¿˜æ˜¯å…¶ä»–ä¸»æœºï¼ˆæ•°æ®åŒ…ç©¿è¿‡ FORWARD é“¾ï¼‰ï¼›</p></li><li><p>ä¸­é—´çš„è·¯ç”±ç­–ç•¥åŒ…æ‹¬å†³å®šç»™ä¼ å‡ºçš„æ•°æ®åŒ…ä½¿ç”¨é‚£ä¸ªæºåœ°å€ã€åˆ†é…å“ªä¸ªæ¥å£ï¼›</p></li><li><p>æœ€åä¸€ä¸ªè·¯ç”±ç­–ç•¥å­˜åœ¨æ˜¯å› ä¸ºå…ˆå‰çš„ mangle ä¸ nat é“¾å¯èƒ½ä¼šæ”¹å˜æ•°æ®åŒ…çš„è·¯ç”±ä¿¡æ¯ã€‚</p></li></ul><p>æ•°æ®åŒ…é€šè¿‡è·¯å¾„ä¸Šçš„æ¯ä¸€æ¡é“¾æ—¶ï¼Œé“¾ä¸­çš„æ¯ä¸€æ¡è§„åˆ™æŒ‰é¡ºåºåŒ¹é…ï¼›æ— è®ºä½•æ—¶åŒ¹é…äº†ä¸€æ¡è§„åˆ™ï¼Œç›¸åº”çš„ target/jump åŠ¨ä½œå°†ä¼šæ‰§è¡Œã€‚æœ€å¸¸ç”¨çš„3ä¸ª target æ˜¯ ACCEPT, DROP ,æˆ–è€… jump åˆ°ç”¨æˆ·è‡ªå®šä¹‰çš„é“¾ã€‚å†…ç½®çš„é“¾æœ‰é»˜è®¤çš„ç­–ç•¥ï¼Œä½†æ˜¯ç”¨æˆ·è‡ªå®šä¹‰çš„é“¾æ²¡æœ‰é»˜è®¤çš„ç­–ç•¥ã€‚åœ¨ jump åˆ°çš„é“¾ä¸­ï¼Œè‹¥æ¯ä¸€æ¡è§„åˆ™éƒ½ä¸èƒ½æä¾›å®Œå…¨åŒ¹é…ï¼Œé‚£ä¹ˆæ•°æ®åŒ…åƒè¿™å¼ å›¾ç‰‡æè¿°çš„ä¸€æ ·è¿”å›åˆ°è°ƒç”¨é“¾ã€‚åœ¨ä»»ä½•æ—¶å€™ï¼Œè‹¥ DROP target çš„è§„åˆ™å®ç°å®Œå…¨åŒ¹é…ï¼Œé‚£ä¹ˆè¢«åŒ¹é…çš„æ•°æ®åŒ…ä¼šè¢«ä¸¢å¼ƒï¼Œä¸ä¼šè¿›è¡Œè¿›ä¸€æ­¥å¤„ç†ã€‚å¦‚æœä¸€ä¸ªæ•°æ®åŒ…åœ¨é“¾ä¸­è¢« ACCEPTï¼Œé‚£ä¹ˆå®ƒä¹Ÿä¼šè¢«æ‰€æœ‰çš„çˆ¶é“¾ ACCEPTï¼Œå¹¶ä¸”ä¸å†éå†å…¶ä»–çˆ¶é“¾ã€‚ç„¶è€Œï¼Œè¦æ³¨æ„çš„æ˜¯ï¼Œæ•°æ®åŒ…è¿˜ä¼šä»¥æ­£å¸¸çš„æ–¹å¼ç»§ç»­éå†å…¶ä»–è¡¨ä¸­çš„å…¶ä»–é“¾ã€‚</p><h4 id="æœ¬æœºå‘å‡ºçš„åŒ…"><a href="#æœ¬æœºå‘å‡ºçš„åŒ…" class="headerlink" title="æœ¬æœºå‘å‡ºçš„åŒ…"></a>æœ¬æœºå‘å‡ºçš„åŒ…</h4><p>æœ¬æœºè¿›ç¨‹ -&gt; OUTPUT é“¾ -&gt; è·¯ç”±é€‰æ‹© -&gt; POSTROUTING é“¾ -&gt; å‡ºå£ç½‘å¡</p><h4 id="æœ¬æœºæ”¶åˆ°çš„åŒ…"><a href="#æœ¬æœºæ”¶åˆ°çš„åŒ…" class="headerlink" title="æœ¬æœºæ”¶åˆ°çš„åŒ…"></a>æœ¬æœºæ”¶åˆ°çš„åŒ…</h4><p>å…¥å£ç½‘å¡ -&gt; PREROUTING é“¾ -&gt; è·¯ç”±é€‰æ‹© -&gt; æ­¤æ—¶æœ‰ä¸¤ç§å¯èƒ½çš„æƒ…å†µï¼š</p><ul><li>ç›®çš„åœ°å€ä¸ºæœ¬æœºï¼šINPUT é“¾ -&gt; æœ¬æœºè¿›ç¨‹</li><li>ç›®çš„åœ°å€ä¸ä¸ºæœ¬æœºï¼šFORWARD é“¾ -&gt; POSTROUTING é“¾ -&gt; ç½‘å¡å‡ºå£ï¼ˆå†…æ ¸å…è®¸ç½‘å¡è½¬å‘çš„æƒ…å†µä¸‹ï¼‰</li></ul><h2 id="iptables-å®æˆ˜"><a href="#iptables-å®æˆ˜" class="headerlink" title="iptables å®æˆ˜"></a>iptables å®æˆ˜</h2><p>iptables [-t è¡¨] å‘½ä»¤é€‰é¡¹ [é“¾] [åŒ¹é…é€‰é¡¹] [æ“ä½œé€‰é¡¹]</p><h3 id="å‘½ä»¤é€‰é¡¹"><a href="#å‘½ä»¤é€‰é¡¹" class="headerlink" title="å‘½ä»¤é€‰é¡¹"></a>å‘½ä»¤é€‰é¡¹</h3><table><thead><tr><th align="left">é€‰é¡¹å</th><th align="left">åŠŸèƒ½åŠç‰¹ç‚¹</th></tr></thead><tbody><tr><td align="left">-A â€“append</td><td align="left">åœ¨æŒ‡å®šé“¾çš„æœ«å°¾æ·»åŠ ä¸€æ¡æ–°çš„è§„åˆ™</td></tr><tr><td align="left">-D â€“delete</td><td align="left">åˆ é™¤æŒ‡å®šé“¾ä¸­çš„æŸä¸€æ¡è§„åˆ™ï¼ŒæŒ‰è§„åˆ™åºå·æˆ–å†…å®¹ç¡®å®šè¦åˆ é™¤çš„è§„åˆ™</td></tr><tr><td align="left">-I â€“insert</td><td align="left">åœ¨æŒ‡å®šé“¾ä¸­æ’å…¥ä¸€æ¡æ–°çš„è§„åˆ™ï¼Œé»˜è®¤åœ¨é“¾çš„å¼€å¤´æ’å…¥</td></tr><tr><td align="left">-R â€“replace</td><td align="left">ä¿®æ”¹ã€æ›¿æ¢æŒ‡å®šé“¾ä¸­çš„ä¸€æ¡è§„åˆ™ï¼ŒæŒ‰è§„åˆ™åºå·æˆ–å†…å®¹ç¡®å®š</td></tr><tr><td align="left">-F â€“flush</td><td align="left">æ¸…ç©ºæŒ‡å®šé“¾ä¸­çš„æ‰€æœ‰è§„åˆ™ï¼Œé»˜è®¤æ¸…ç©ºè¡¨ä¸­æ‰€æœ‰é“¾çš„å†…å®¹</td></tr><tr><td align="left">-N â€“new</td><td align="left">æ–°å»ºä¸€æ¡ç”¨æˆ·è‡ªå·±å®šä¹‰çš„è§„åˆ™é“¾</td></tr><tr><td align="left">-X â€“delete-chain</td><td align="left">åˆ é™¤æŒ‡å®šè¡¨ä¸­ç”¨æˆ·è‡ªå®šä¹‰çš„è§„åˆ™é“¾</td></tr><tr><td align="left">-P â€“policy</td><td align="left">è®¾ç½®æŒ‡å®šé“¾çš„é»˜è®¤ç­–ç•¥</td></tr><tr><td align="left">-F, â€“flush</td><td align="left">æ¸…ç©ºæŒ‡å®šé“¾ä¸Šé¢çš„æ‰€æœ‰è§„åˆ™ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šé“¾ï¼Œæ¸…ç©ºè¡¨ä¸Šæ‰€æœ‰é“¾çš„æ‰€æœ‰è§„åˆ™</td></tr><tr><td align="left">-Z, â€“zero</td><td align="left">æŠŠæŒ‡å®šé“¾æˆ–è¡¨ä¸­çš„æ‰€æœ‰é“¾ä¸Šçš„æ‰€æœ‰è®¡æ•°å™¨æ¸…é›¶</td></tr><tr><td align="left">-L â€“list</td><td align="left">åˆ—å‡ºæŒ‡å®šé“¾ä¸­çš„æ‰€æœ‰çš„è§„åˆ™è¿›è¡ŒæŸ¥çœ‹ï¼Œé»˜è®¤åˆ—å‡ºè¡¨ä¸­æ‰€æœ‰é“¾çš„å†…å®¹</td></tr><tr><td align="left">-S â€“list-rules</td><td align="left">ä»¥åŸå§‹æ ¼å¼åˆ—å‡ºé“¾ä¸­æ‰€æœ‰è§„åˆ™</td></tr><tr><td align="left">-v â€“verbose</td><td align="left">æŸ¥çœ‹è§„åˆ™åˆ—è¡¨æ—¶æ˜¾ç¤ºè¯¦ç»†çš„ä¿¡æ¯</td></tr><tr><td align="left">-n â€“numeric</td><td align="left">ç”¨æ•°å­—å½¢å¼æ˜¾ç¤ºè¾“å‡ºç»“æœï¼Œå¦‚æ˜¾ç¤ºä¸»æœºçš„ IP åœ°å€è€Œä¸æ˜¯ä¸»æœºå</td></tr><tr><td align="left">â€“line-number</td><td align="left">æŸ¥çœ‹è§„åˆ™åˆ—è¡¨æ—¶ï¼ŒåŒæ—¶æ˜¾ç¤ºè§„åˆ™åœ¨é“¾ä¸­çš„é¡ºåºå·</td></tr></tbody></table><h3 id="åŒ¹é…é€‰é¡¹"><a href="#åŒ¹é…é€‰é¡¹" class="headerlink" title="åŒ¹é…é€‰é¡¹"></a>åŒ¹é…é€‰é¡¹</h3><table><thead><tr><th align="left">é€‰é¡¹å</th><th align="left">åŠŸèƒ½åŠç‰¹ç‚¹</th></tr></thead><tbody><tr><td align="left">-i â€“in-interface</td><td align="left">åŒ¹é…è¾“å…¥æ¥å£ï¼Œå¦‚ eth0ï¼Œeth1</td></tr><tr><td align="left">-o â€“out-interface</td><td align="left">åŒ¹é…è¾“å‡ºæ¥å£</td></tr><tr><td align="left">-p â€“proto</td><td align="left">åŒ¹é…åè®®ç±»å‹ï¼Œå¦‚ TCPã€UDP å’Œ ICMPç­‰</td></tr><tr><td align="left">-s â€“source</td><td align="left">åŒ¹é…çš„æºåœ°å€</td></tr><tr><td align="left">â€“sport</td><td align="left">åŒ¹é…çš„æºç«¯å£å·</td></tr><tr><td align="left">-d â€“destination</td><td align="left">åŒ¹é…çš„ç›®çš„åœ°å€</td></tr><tr><td align="left">â€“dport</td><td align="left">åŒ¹é…çš„ç›®çš„ç«¯å£å·</td></tr><tr><td align="left">-m â€“match</td><td align="left">åŒ¹é…è§„åˆ™æ‰€ä½¿ç”¨çš„è¿‡æ»¤æ¨¡å—</td></tr></tbody></table><h3 id="æ“ä½œé€‰é¡¹"><a href="#æ“ä½œé€‰é¡¹" class="headerlink" title="æ“ä½œé€‰é¡¹"></a>æ“ä½œé€‰é¡¹</h3><p> ä¸€èˆ¬ä¸º <code>-j å¤„ç†åŠ¨ä½œ</code> çš„å½¢å¼ï¼Œå¤„ç†åŠ¨ä½œåŒ…æ‹¬ ACCEPTã€DROPã€RETURNã€REJECTã€DNATã€SNAT ç­‰ã€‚ä¸åŒçš„å¤„ç†åŠ¨ä½œå¯èƒ½è¿˜æœ‰é¢å¤–çš„é€‰é¡¹å‚æ•°ï¼Œå¦‚æŒ‡å®š DNATã€SNAT åŠ¨ä½œåˆ™è¿˜éœ€æŒ‡å®š <code>--to</code> å‚æ•°ç”¨ä»¥è¯´æ˜è¦è£…æ¢çš„åœ°å€ï¼ŒæŒ‡å®š REDIRECT åŠ¨ä½œåˆ™éœ€æŒ‡å®š â€“to-ports å‚æ•°ç”¨äºè¯´æ˜è¦è·³è½¬çš„ç«¯å£ã€‚</p><table><thead><tr><th>æ“ä½œå</th><th>åŠŸèƒ½</th></tr></thead><tbody><tr><td>ACCEPT</td><td>å…è®¸æ•°æ®åŒ…é€šè¿‡</td></tr><tr><td>DROP</td><td>ç›´æ¥ä¸¢å¼ƒæ•°æ®åŒ…ï¼Œä¸ç»™ä»»ä½•å›åº”ä¿¡æ¯</td></tr><tr><td>QUEUE</td><td>å°†æ•°æ®åŒ…ç§»äº¤åˆ°ç”¨æˆ·ç©ºé—´</td></tr><tr><td>RETURN</td><td>åœæ­¢æ‰§è¡Œå½“å‰é“¾ä¸­çš„åç»­è§„åˆ™ï¼Œå¹¶è¿”å›åˆ°è°ƒç”¨é“¾(The Calling Chain)ä¸­</td></tr><tr><td>REJECT</td><td>æ‹’ç»æ•°æ®åŒ…é€šè¿‡ï¼Œå¿…è¦æ—¶ä¼šç»™æ•°æ®å‘é€ç«¯ä¸€ä¸ªå“åº”çš„ä¿¡æ¯</td></tr><tr><td>DNAT</td><td>è¿›è¡Œç›®æ ‡åœ°å€è½¬æ¢</td></tr><tr><td>SNAT</td><td>æºåœ°å€è½¬æ¢ï¼Œè§£å†³å†…ç½‘ç”¨æˆ·ç”¨åŒä¸€ä¸ªå…¬ç½‘åœ°å€ä¸Šç½‘çš„é—®é¢˜</td></tr><tr><td>MASQUERADE</td><td>æ˜¯ SNAT çš„ä¸€ç§ç‰¹æ®Šå½¢å¼ï¼Œé€‚ç”¨äºåŠ¨æ€çš„ã€ä¸´æ—¶ä¼šå˜çš„ ip ä¸Š</td></tr><tr><td>REDIRECT</td><td>åœ¨æœ¬æœºåšç«¯å£æ˜ å°„</td></tr><tr><td>LOG</td><td>è®°å½•æ—¥å¿—ä¿¡æ¯ï¼Œé™¤è®°å½•å¤–ä¸å¯¹æ•°æ®åŒ…åšä»»ä½•å…¶ä»–æ“ä½œï¼Œä»ç„¶åŒ¹é…ä¸‹ä¸€æ¡è§„åˆ™</td></tr></tbody></table><h3 id="å‘½ä»¤è¯¦è§£"><a href="#å‘½ä»¤è¯¦è§£" class="headerlink" title="å‘½ä»¤è¯¦è§£"></a>å‘½ä»¤è¯¦è§£</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">### å‘½ä»¤ç”¨æ³• (man æ–‡æ¡£)</span></span><br><span class="line">iptables [-t table] &#123;-A|-C|-D&#125; chain rule-specification         <span class="comment"># (ipv4) è¿½åŠ |æ£€æŸ¥|åˆ é™¤ è§„åˆ™</span></span><br><span class="line">ip6tables [-t table] &#123;-A|-C|-D&#125; chain rule-specification        <span class="comment"># (ipv6) è¿½åŠ |æ£€æŸ¥|åˆ é™¤ è§„åˆ™</span></span><br><span class="line">iptables [-t table] -I chain [rulenum] rule-specification       <span class="comment"># åœ¨ rulenum å¤„æ’å…¥è§„åˆ™ (é»˜è®¤ä¸º 1)</span></span><br><span class="line">iptables [-t table] -R chain rulenum rule-specification         <span class="comment"># æ›¿æ¢ç¬¬ rulenum æ¡è§„åˆ™</span></span><br><span class="line">iptables [-t table] -D chain rulenum                            <span class="comment"># åˆ é™¤ç¬¬ rulenum æ¡è§„åˆ™</span></span><br><span class="line">iptables [-t table] -S [chain [rulenum]]                        <span class="comment"># æ‰“å°æŒ‡å®š table çš„è§„åˆ™</span></span><br><span class="line">iptables [-t table] &#123;-F|-L|-Z&#125; [chain [rulenum]] [options...]   <span class="comment"># æ¸…ç©º|åˆ—å‡º|ç½®é›¶ é“¾/è§„åˆ™</span></span><br><span class="line">iptables [-t table] -P chain target                             <span class="comment"># è®¾ç½®é»˜è®¤ç­–ç•¥</span></span><br><span class="line">iptables [-t table] -N chain                                    <span class="comment"># æ–°å»ºè‡ªå®šä¹‰é“¾</span></span><br><span class="line">iptables [-t table] -X [chain]                                  <span class="comment"># åˆ é™¤è‡ªå®šä¹‰é“¾</span></span><br><span class="line">iptables [-t table] -E old-chain-name new-chain-name            <span class="comment"># é‡å‘½åè‡ªå®šä¹‰é“¾</span></span><br><span class="line"></span><br><span class="line"><span class="comment">### ä¸€èˆ¬å½¢å¼</span></span><br><span class="line">iptables [-t è¡¨å] &#123;-A|I|D|R&#125; é“¾å [è§„åˆ™å·] åŒ¹é…è§„åˆ™ -j åŠ¨ä½œ</span><br><span class="line"></span><br><span class="line"><span class="comment">### æŸ¥çœ‹å¸®åŠ©</span></span><br><span class="line">iptables --<span class="built_in">help</span>             <span class="comment"># æŸ¥çœ‹ iptables çš„å¸®åŠ©</span></span><br><span class="line">iptables -m æ¨¡å—å --<span class="built_in">help</span>   <span class="comment"># æŸ¥çœ‹æŒ‡å®šæ¨¡å—çš„å¯ç”¨å‚æ•°</span></span><br><span class="line">iptables -j åŠ¨ä½œå --<span class="built_in">help</span>   <span class="comment"># æŸ¥çœ‹æŒ‡å®šåŠ¨ä½œçš„å¯ç”¨å‚æ•°</span></span><br><span class="line"></span><br><span class="line"><span class="comment">### æŒä¹…åŒ–è§„åˆ™</span></span><br><span class="line"><span class="comment"># åœ¨ RHEL/CentOS ä¸­ï¼Œé»˜è®¤è§„åˆ™æ–‡ä»¶ä¸º /etc/sysconfig/iptables</span></span><br><span class="line"><span class="comment"># åœ¨ iptables æœåŠ¡å¯åŠ¨æ—¶ï¼Œé»˜è®¤ä¼šåŠ è½½è¯¥é…ç½®æ–‡ä»¶ä¸­å®šä¹‰çš„è§„åˆ™</span></span><br><span class="line"><span class="comment"># å¦‚æœæƒ³è¦è®¾ç½®çš„è§„åˆ™åœ¨é‡å¯åæœ‰æ•ˆï¼Œå°±éœ€è¦ä¿å­˜è§„åˆ™åˆ°è¿™ä¸ªæ–‡ä»¶</span></span><br><span class="line"><span class="comment"># ä½¿ç”¨è¿™ä¸¤ä¸ªå·¥å…·ï¼šiptables-saveã€iptables-restore é‡å®šå‘å³å¯</span></span><br><span class="line"><span class="comment">## ä¿å­˜å½“å‰è§„åˆ™</span></span><br><span class="line">iptables-save &gt;/etc/sysconfig/iptables</span><br><span class="line">iptables-save &gt;/etc/sysconfig/iptables.20171125</span><br><span class="line"><span class="comment">## æ¢å¤å½“å‰è§„åˆ™</span></span><br><span class="line">iptables-restore &lt;/etc/sysconfig/iptables</span><br><span class="line">iptables-restore &lt;/etc/sysconfig/iptables.20171125</span><br><span class="line"></span><br><span class="line"><span class="comment">### å‘½ä»¤å’Œé€‰é¡¹</span></span><br><span class="line">-t              <span class="comment"># æŒ‡å®šè¦æ“ä½œçš„è¡¨ï¼Œå¦‚æœçœç•¥åˆ™é»˜è®¤ä¸º filter è¡¨</span></span><br><span class="line">-A              <span class="comment"># "è¿½åŠ " ä¸€æ¡è§„åˆ™ï¼Œåªèƒ½è¿½åŠ åˆ°æœ«å°¾</span></span><br><span class="line">-I              <span class="comment"># "æ’å…¥" ä¸€æ¡è§„åˆ™ï¼Œå¦‚æœçœç•¥åºå·åˆ™é»˜è®¤ä¸º 1</span></span><br><span class="line">-R              <span class="comment"># "æ›¿æ¢" ä¸€æ¡è§„åˆ™ï¼Œå¿…é¡»æŒ‡å®šåºå·</span></span><br><span class="line">-D              <span class="comment"># "åˆ é™¤" ä¸€æ¡è§„åˆ™ï¼Œå¿…é¡»æŒ‡å®šåºå·</span></span><br><span class="line">-C              <span class="comment"># "æ£€æŸ¥" è§„åˆ™æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨åˆ™è¿”å› 0</span></span><br><span class="line">-P              <span class="comment"># è®¾ç½®é“¾çš„ "é»˜è®¤ç­–ç•¥"ï¼Œnat è¡¨ä¸å…è®¸ä¿®æ”¹é»˜è®¤ç­–ç•¥</span></span><br><span class="line">-S              <span class="comment"># "æŸ¥çœ‹" è§„åˆ™ï¼ˆåŸå§‹æ ¼å¼ï¼‰</span></span><br><span class="line">-L              <span class="comment"># "æ‰“å°" è§„åˆ™ï¼ˆå‹å¥½æ ¼å¼ï¼‰</span></span><br><span class="line">-F              <span class="comment"># æ¸…ç©ºè¡¨ä¸­çš„è§„åˆ™å¹¶å°†åŒ…è®¡æ•°å™¨ã€å­—èŠ‚è®¡æ•°å™¨ç½®é›¶</span></span><br><span class="line">-Z              <span class="comment"># å°†æŸä¸ªé“¾æˆ–æŸæ¡è§„åˆ™çš„åŒ…è®¡æ•°å™¨ã€å­—èŠ‚è®¡æ•°å™¨ç½®é›¶</span></span><br><span class="line">-N              <span class="comment"># æ–°å»ºè‡ªå®šä¹‰é“¾</span></span><br><span class="line">-X              <span class="comment"># åˆ é™¤è‡ªå®šä¹‰é“¾</span></span><br><span class="line">-E              <span class="comment"># é‡å‘½åè‡ªå®šä¹‰é“¾</span></span><br><span class="line">-n              <span class="comment"># ä»¥æ•°å­—å½¢å¼æ˜¾ç¤ºåœ°å€å’Œç«¯å£</span></span><br><span class="line">-v              <span class="comment"># åœ¨æ‰“å°è§„åˆ™æ—¶æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯</span></span><br><span class="line">--line-numbers  <span class="comment"># åœ¨æ‰“å°è§„åˆ™æ—¶æ˜¾ç¤ºè§„åˆ™åºå·</span></span><br><span class="line"></span><br><span class="line"><span class="comment">### åå‘åŒ¹é…</span></span><br><span class="line"><span class="comment"># åªéœ€åœ¨é€‰é¡¹å‰é¢ä½¿ç”¨ ! å³å¯ï¼Œå¦‚: ! -s 192.168.0.0/16 è¡¨ç¤ºé™¤ 192.168/16 å¤–çš„æº IP</span></span><br><span class="line"></span><br><span class="line"><span class="comment">### é€šç”¨åŒ¹é…</span></span><br><span class="line">-s addr[/mask][...] <span class="comment"># æº IPï¼Œå¯ä»¥æœ‰å¤šä¸ªï¼Œä½¿ç”¨é€—å·éš”å¼€ï¼Œæœ‰å¤šå°‘ä¸ªåœ°å€å°±æœ‰å¤šå°‘æ¡è§„åˆ™</span></span><br><span class="line">-d addr[/mask][...] <span class="comment"># ç›®çš„ IPï¼Œå¯ä»¥æœ‰å¤šä¸ªï¼Œä½¿ç”¨é€—å·éš”å¼€ï¼Œæœ‰å¤šå°‘ä¸ªåœ°å€å°±æœ‰å¤šå°‘æ¡è§„åˆ™</span></span><br><span class="line">-i input-nic[+]     <span class="comment"># æ•°æ®åŒ…æ¥è‡ªå“ªä¸ªç½‘å¡ï¼Œ+ è¡¨ç¤ºé€šé…ç¬¦</span></span><br><span class="line">-o output-nic[+]    <span class="comment"># æ•°æ®åŒ…é€å¾€å“ªä¸ªç½‘å¡ï¼Œ+ è¡¨ç¤ºé€šé…ç¬¦</span></span><br><span class="line">-p &#123;tcp|udp|udplite|icmp|icmpv6|esp|ah|sctp|mh|all&#125;</span><br><span class="line">                    <span class="comment"># æŒ‡å®šåŒ¹é…çš„åè®®ï¼Œall è¡¨ç¤ºæ‰€æœ‰</span></span><br><span class="line"></span><br><span class="line"><span class="comment">### éšå¼æ‰©å±•åŒ¹é… (tcp/udp/icmp)</span></span><br><span class="line"><span class="comment">## tcp æ‰©å±•</span></span><br><span class="line">--sport port[:port]     <span class="comment"># æºç«¯å£å·ï¼Œ100:200 è¡¨ç¤ºç«¯å£èŒƒå›´</span></span><br><span class="line">--dport port[:port]     <span class="comment"># ç›®çš„ç«¯å£å·ï¼Œ100:200 è¡¨ç¤ºç«¯å£èŒƒå›´</span></span><br><span class="line">--tcp-flags mask comp   <span class="comment"># TCP æ ‡å¿—ä½ï¼Œflags=&#123;SYN|ACK|FIN|RST|URG|PSH|ALL|NONE&#125;</span></span><br><span class="line">--syn                   <span class="comment"># SYN æ ‡å¿—ä½ï¼Œç­‰åŒäº --tcp-flags SYN,RST,ACK,FIN SYN</span></span><br><span class="line">--tcp-option number     <span class="comment"># TCP é€‰é¡¹</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## udp æ‰©å±•</span></span><br><span class="line">--sport port[:port]     <span class="comment"># æºç«¯å£å·</span></span><br><span class="line">--dport port[:port]     <span class="comment"># ç›®çš„ç«¯å£å·</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## icmp æ‰©å±•</span></span><br><span class="line">--icmp-type name[/code] <span class="comment"># icmp ç±»å‹ï¼Œå¸¸ç”¨çš„ä¸¤ä¸ª: pingã€pongï¼Œè¯·æ±‚å’Œåº”ç­”</span></span><br><span class="line"></span><br><span class="line"><span class="comment">### æ˜¾å¼æ‰©å±•åŒ¹é… (-m module-name)</span></span><br><span class="line"><span class="comment">## multiport å¤šç«¯å£</span></span><br><span class="line">--sports port[,port:port,port...]   <span class="comment"># åŒ¹é…å¤šä¸ªæºç«¯å£[èŒƒå›´]</span></span><br><span class="line">--dports port[,port:port,port...]   <span class="comment"># åŒ¹é…å¤šä¸ªç›®çš„ç«¯å£[èŒƒå›´]</span></span><br><span class="line">--ports port[,port:port,port...]    <span class="comment"># åŒ¹é…å¤šä¸ªæºå’Œç›®çš„ç«¯å£[èŒƒå›´]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## owner æ‰€å±ç”¨æˆ·(ç»„)</span></span><br><span class="line">--uid-owner userid[-userid]     <span class="comment"># åŒ¹é… UID[èŒƒå›´]/username</span></span><br><span class="line">--gid-owner groupid[-groupid]   <span class="comment"># åŒ¹é… GID[èŒƒå›´]/groupname</span></span><br><span class="line">--socket-exists                 <span class="comment"># åŒ¹é…ä¸å¥—æ¥å­—ç›¸å…³è”çš„æ•°æ®åŒ…</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## state è¿æ¥çŠ¶æ€(åŸºæœ¬)</span></span><br><span class="line">--state [INVALID|ESTABLISHED|NEW|RELATED|UNTRACKED][,...]</span><br><span class="line"><span class="comment"># NEW           æ–°è¿æ¥</span></span><br><span class="line"><span class="comment"># ESTABLISHED   å·²å»ºç«‹çš„è¿æ¥</span></span><br><span class="line"><span class="comment"># RELATED       å…³è”çš„è¿æ¥ï¼Œå¦‚ ftp</span></span><br><span class="line"><span class="comment"># INVALID       æ— æ•ˆ/éæ³•çš„è¿æ¥</span></span><br><span class="line"><span class="comment"># UNTRACKED     æœªå¯ç”¨è¿æ¥è·Ÿè¸ªçš„è¿æ¥</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## conntrack è¿æ¥çŠ¶æ€</span></span><br><span class="line">--ctstate &#123;INVALID|ESTABLISHED|NEW|RELATED|UNTRACKED|SNAT|DNAT&#125;[,...]</span><br><span class="line"></span><br><span class="line"><span class="comment">## iprange IPèŒƒå›´</span></span><br><span class="line">--src-range ip[-ip]     <span class="comment"># åŒ¹é…æŒ‡å®šçš„æº IP èŒƒå›´</span></span><br><span class="line">--dst-range ip[-ip]     <span class="comment"># åŒ¹é…æŒ‡å®šçš„ç›®çš„ IP èŒƒå›´</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## mac æºMACåœ°å€</span></span><br><span class="line">--mac-source XX:XX:XX:XX:XX:XX  <span class="comment"># åŒ¹é…æº MAC åœ°å€</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## addrtype åœ°å€ç±»å‹</span></span><br><span class="line">--src-type <span class="built_in">type</span>[,...]   <span class="comment"># åŒ¹é… source ip åœ°å€çš„ç±»å‹</span></span><br><span class="line">--dst-type <span class="built_in">type</span>[,...]   <span class="comment"># åŒ¹é… destination ip åœ°å€çš„ç±»å‹</span></span><br><span class="line"><span class="comment"># UNSPEC       æœªæŒ‡å®šçš„åœ°å€ï¼Œå¦‚ 0.0.0.0</span></span><br><span class="line"><span class="comment"># UNICAST      å•æ’­åœ°å€</span></span><br><span class="line"><span class="comment"># LOCAL        æœ¬æœºåœ°å€</span></span><br><span class="line"><span class="comment"># BROADCAST    å¹¿æ’­åœ°å€</span></span><br><span class="line"><span class="comment"># ANYCAST      ä»»æ’­åœ°å€</span></span><br><span class="line"><span class="comment"># MULTICAST    å¤šæ’­åœ°å€</span></span><br><span class="line"><span class="comment"># BLACKHOLE    é»‘æ´åœ°å€</span></span><br><span class="line"><span class="comment"># UNREACHABLE  ä¸å¯è¾¾åœ°å€</span></span><br><span class="line"><span class="comment"># PROHIBIT     ç¦æ­¢è®¿é—®çš„åœ°å€</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## time æ—¶é—´</span></span><br><span class="line">--datestart time     <span class="comment"># èµ·å§‹æ—¥æœŸ YYYY[-MM[-DD[Thh[:mm[:ss]]]]]</span></span><br><span class="line">--datestop time      <span class="comment"># ç»“æŸæ—¥æœŸ YYYY[-MM[-DD[Thh[:mm[:ss]]]]]</span></span><br><span class="line">--timestart time     <span class="comment"># èµ·å§‹æ—¶é—´ hh:mm[:ss]</span></span><br><span class="line">--timestop time      <span class="comment"># ç»“æŸæ—¶é—´ hh:mm[:ss]</span></span><br><span class="line">--monthdays value    <span class="comment"># å‡ å·ï¼Œ1 è‡³ 31ï¼Œé»˜è®¤ä¸º all</span></span><br><span class="line">--weekdays value     <span class="comment"># æ˜ŸæœŸå‡ ï¼Œ1 è‡³ 7ï¼Œé»˜è®¤ä¸º all</span></span><br><span class="line">--kerneltz           <span class="comment"># ä½¿ç”¨å†…æ ¸æ—¶åŒºè€Œé UTC</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## string å…³é”®å­—åŒ¹é…</span></span><br><span class="line">--from offset       <span class="comment"># è®¾ç½®èµ·å§‹åç§»é‡</span></span><br><span class="line">--to offset         <span class="comment"># è®¾ç½®ç»“æŸåç§»é‡</span></span><br><span class="line">--algo &#123;bm|kmp&#125;     <span class="comment"># æŒ‡å®šä½¿ç”¨çš„ç®—æ³•</span></span><br><span class="line">--icase             <span class="comment"># å¿½ç•¥å¤§å°å†™åŒ¹é…</span></span><br><span class="line">--string string     <span class="comment"># è¦åŒ¹é…çš„å­—ç¬¦ä¸²</span></span><br><span class="line">--hex-string string <span class="comment"># è¦åŒ¹é…çš„å­—ç¬¦ä¸²ï¼Œåå…­è¿›åˆ¶</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## length æ•°æ®åŒ…å¤§å°</span></span><br><span class="line">--length length[:length]    <span class="comment"># åŒ¹é…æ•°æ®åŒ…å¤§å°[èŒƒå›´]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## mark é˜²ç«å¢™æ ‡è®°</span></span><br><span class="line">--mark value[/mask]     <span class="comment"># åŒ¹é…æœ‰æŒ‡å®šé˜²ç«å¢™æ ‡è®°çš„æ•°æ®åŒ…</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## connmark "è¿æ¥"æ ‡è®°</span></span><br><span class="line">--mark value[/mask]     <span class="comment"># å¦‚æœå½“å‰æ•°æ®åŒ…æ‰€å±çš„"è¿æ¥"æ‰“äº†ç»™å®šçš„æ ‡è®°ï¼Œåˆ™åŒ¹é…æˆåŠŸ</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## limit é€Ÿç‡é™åˆ¶</span></span><br><span class="line">--<span class="built_in">limit</span> avg             <span class="comment"># å¹³å‡é€Ÿç‡é™åˆ¶ï¼Œå¦‚ 3/hourï¼Œå•ä½: sec|minute|hour|day</span></span><br><span class="line">--<span class="built_in">limit</span>-burst number    <span class="comment"># å°é¡¶é€Ÿç‡é™åˆ¶ï¼Œé»˜è®¤ä¸º 5</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## connlimit å¹¶å‘è¿æ¥æ•°</span></span><br><span class="line">--connlimit-upto n      <span class="comment"># 0..n</span></span><br><span class="line">--connlimit-above n     <span class="comment"># &gt; n</span></span><br><span class="line"></span><br><span class="line"><span class="comment">### -j target åŠ¨ä½œ</span></span><br><span class="line"><span class="comment">## æ— å‚æ•°ç³»åˆ—</span></span><br><span class="line">ACCEPT      <span class="comment"># æ¥æ”¶æ•°æ®åŒ…</span></span><br><span class="line">DROP        <span class="comment"># ä¸¢å¼ƒæ•°æ®åŒ…</span></span><br><span class="line">CUST-CHAIN  <span class="comment"># è¿›å…¥è‡ªå®šä¹‰é“¾</span></span><br><span class="line">RETURN      <span class="comment"># é€€å‡ºå½“å‰é“¾ï¼Œåˆ†ä¸¤ç§æƒ…å†µï¼š</span></span><br><span class="line">            <span class="comment"># å¦‚æœå½“å‰é“¾æ˜¯è‡ªå®šä¹‰é“¾ï¼Œåˆ™è¿”å›è°ƒç”¨é“¾ï¼Œç»§ç»­åŒ¹é…è°ƒç”¨ç‚¹çš„ä¸‹ä¸€æ¡è§„åˆ™</span></span><br><span class="line">            <span class="comment"># å¦‚æœå½“å‰é“¾ä¸æ˜¯è‡ªå®šä¹‰é“¾ï¼Œåˆ™æ‰§è¡Œå½“å‰é“¾çš„é»˜è®¤ç­–ç•¥ï¼Œå¦‚ ACCEPTã€DROP</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## å¸¦å‚æ•°ç³»åˆ—</span></span><br><span class="line"><span class="comment"># REJECT æ‹’ç»ï¼ˆå¸¦åŸå› ï¼‰</span></span><br><span class="line">--reject-with <span class="built_in">type</span>              <span class="comment"># ä¸¢å¼ƒæ•°æ®åŒ…ï¼Œå¹¶å›å¤æºä¸»æœºï¼Œå¯ç”¨çš„ type å¦‚ä¸‹ï¼š</span></span><br><span class="line">    icmp-net-unreachable        <span class="comment"># ICMP ç½‘ç»œä¸å¯è¾¾</span></span><br><span class="line">    net-unreach                 <span class="comment"># åŒä¸Šï¼Œåˆ«å</span></span><br><span class="line">    icmp-host-unreachable       <span class="comment"># ICMP ä¸»æœºä¸å¯è¾¾</span></span><br><span class="line">    host-unreach                <span class="comment"># åŒä¸Šï¼Œåˆ«å</span></span><br><span class="line">    icmp-proto-unreachable      <span class="comment"># ICMP åè®®ä¸å¯è¾¾</span></span><br><span class="line">    proto-unreach               <span class="comment"># åŒä¸Šï¼Œåˆ«å</span></span><br><span class="line">    icmp-port-unreachable       <span class="comment"># ICMP ç«¯å£ä¸å¯è¾¾ï¼ˆé»˜è®¤ï¼‰</span></span><br><span class="line">    port-unreach                <span class="comment"># åŒä¸Šï¼Œåˆ«å</span></span><br><span class="line">    icmp-net-prohibited         <span class="comment"># ICMP ç½‘ç»œé™åˆ¶</span></span><br><span class="line">    net-prohib                  <span class="comment"># åŒä¸Šï¼Œåˆ«å</span></span><br><span class="line">    icmp-host-prohibited        <span class="comment"># ICMP ä¸»æœºé™åˆ¶</span></span><br><span class="line">    host-prohib                 <span class="comment"># åŒä¸Šï¼Œåˆ«å</span></span><br><span class="line">    icmp-admin-prohibited       <span class="comment"># ICMP ç®¡ç†å‘˜é™åˆ¶</span></span><br><span class="line">    admin-prohib                <span class="comment"># åŒä¸Šï¼Œåˆ«å</span></span><br><span class="line">    tcp-reset                   <span class="comment"># TCP RST è¿æ¥é‡ç½®</span></span><br><span class="line">    tcp-rst                     <span class="comment"># åŒä¸Šï¼Œåˆ«å</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># MARK æ‰“é˜²ç«å¢™æ ‡è®°</span></span><br><span class="line">--<span class="built_in">set</span>-mark value[/mask]   <span class="comment"># è®¾ç½®æ ‡è®°ï¼Œmask OR valueï¼ˆæ¨èï¼‰</span></span><br><span class="line">--<span class="built_in">set</span>-xmark value[/mask]  <span class="comment"># è®¾ç½®æ ‡è®°ï¼Œmask XOR value</span></span><br><span class="line">--and-mark bits           <span class="comment"># è®¾ç½®äºŒè¿›åˆ¶æ ‡è®°ï¼ŒAND</span></span><br><span class="line">--or-mark bits            <span class="comment"># è®¾ç½®äºŒè¿›åˆ¶æ ‡è®°ï¼ŒOR</span></span><br><span class="line">--xor-mask bits           <span class="comment"># è®¾ç½®äºŒè¿›åˆ¶æ ‡è®°ï¼ŒXOR</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># CONNMARK æ‰“"è¿æ¥"æ ‡è®°</span></span><br><span class="line">--<span class="built_in">set</span>-mark value[/mask]       <span class="comment"># è®¾ç½®å½“å‰æ•°æ®åŒ…æ‰€å±è¿æ¥çš„è¿æ¥æ ‡è®°</span></span><br><span class="line">--save-mark [--mask mask]     <span class="comment"># å°†å½“å‰æ•°æ®åŒ…çš„æ ‡è®°ä½œä¸ºå…¶æ‰€å±è¿æ¥çš„æ ‡è®°</span></span><br><span class="line">--restore-mark [--mask mask]  <span class="comment"># å°†å½“å‰æ•°æ®åŒ…æ‰€å±è¿æ¥çš„æ ‡è®°ä½œä¸ºè¯¥æ•°æ®åŒ…çš„æ ‡è®°</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># LOG é˜²ç«å¢™æ—¥å¿—ï¼Œdmesg å¯æŸ¥çœ‹</span></span><br><span class="line">--<span class="built_in">log</span>-level level       <span class="comment"># æ—¥å¿—çº§åˆ«ï¼ˆsyslog.confï¼‰</span></span><br><span class="line">--<span class="built_in">log</span>-prefix prefix     <span class="comment"># æ—¥å¿—å‰ç¼€å­—ç¬¦ä¸²</span></span><br><span class="line">--<span class="built_in">log</span>-tcp-sequence      <span class="comment"># è®°å½• TCP seq åºåˆ—å·</span></span><br><span class="line">--<span class="built_in">log</span>-tcp-options       <span class="comment"># è®°å½• TCP options é€‰é¡¹</span></span><br><span class="line">--<span class="built_in">log</span>-ip-options        <span class="comment"># è®°å½• IP options é€‰é¡¹</span></span><br><span class="line">--<span class="built_in">log</span>-uid               <span class="comment"># è®°å½•å¥—æ¥å­—ç›¸å…³è”çš„ UID</span></span><br><span class="line">--<span class="built_in">log</span>-macdecode         <span class="comment"># è§£æ MAC åœ°å€å’Œåè®®</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ULOG é˜²ç«å¢™æ—¥å¿—ï¼Œkernel 2.4+</span></span><br><span class="line">--ulog-nlgroup nlgroup  <span class="comment"># è®°å½•çš„ NETLINK ç»„</span></span><br><span class="line">--ulog-cprange size     <span class="comment"># è¦å¤åˆ¶çš„å­—èŠ‚æ•°</span></span><br><span class="line">--ulog-qthreshold       <span class="comment"># å†…æ ¸é˜Ÿåˆ—çš„æ¶ˆæ¯é˜ˆå€¼</span></span><br><span class="line">--ulog-prefix prefix    <span class="comment"># æ—¥å¿—å‰ç¼€å­—ç¬¦ä¸²</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># NFLOG é˜²ç«å¢™æ—¥å¿—ï¼Œkernel 2.6+</span></span><br><span class="line">--nflog-group NUM       <span class="comment"># è®°å½•çš„ NETLINK ç»„</span></span><br><span class="line">--nflog-size NUM        <span class="comment"># è¦å¤åˆ¶çš„å­—èŠ‚æ•°</span></span><br><span class="line">--nflog-threshold NUM   <span class="comment"># å†…æ ¸é˜Ÿåˆ—çš„æ¶ˆæ¯é˜ˆå€¼</span></span><br><span class="line">--nflog-prefix STRING   <span class="comment"># æ—¥å¿—å‰ç¼€å­—ç¬¦ä¸²</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># SNAT æºåœ°å€è½¬æ¢ï¼Œç”¨åœ¨ POSTROUTINGã€INPUT é“¾</span></span><br><span class="line">--to-source [&lt;ipaddr&gt;[-&lt;ipaddr&gt;]][:port[-port]]</span><br><span class="line">--random        <span class="comment"># æ˜ å°„åˆ°éšæœºç«¯å£å·</span></span><br><span class="line">--random-fully  <span class="comment"># æ˜ å°„åˆ°éšæœºç«¯å£å·ï¼ˆPRNG å®Œå…¨éšæœºåŒ–ï¼‰</span></span><br><span class="line">--persistent    <span class="comment"># æ˜ å°„åˆ°å›ºå®šåœ°å€</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># DNAT ç›®çš„åœ°å€è½¬æ¢ï¼Œç”¨åœ¨ PREROUTINGã€OUTPUT é“¾</span></span><br><span class="line">--to-destination [&lt;ipaddr&gt;[-&lt;ipaddr&gt;]][:port[-port]]</span><br><span class="line">--random        <span class="comment"># æ˜ å°„åˆ°éšæœºç«¯å£å·</span></span><br><span class="line">--persistent    <span class="comment"># æ˜ å°„åˆ°å›ºå®šåœ°å€</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># MASQUERADE æºåœ°å€è½¬æ¢ï¼ˆé€‚ç”¨äº DHCP åŠ¨æ€ IPï¼‰ï¼Œç”¨åœ¨ POSTROUTING é“¾</span></span><br><span class="line">--to-ports &lt;port&gt;[-&lt;port&gt;]  <span class="comment"># æ˜ å°„åˆ°æŒ‡å®šç«¯å£å·[èŒƒå›´]</span></span><br><span class="line">--random                    <span class="comment"># æ˜ å°„åˆ°éšæœºç«¯å£å·</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># REDIRECT ç›®çš„åœ°å€è½¬æ¢ï¼ˆé‡å®šå‘è‡³ localhost:ç«¯å£å·ï¼‰ï¼Œç”¨åœ¨ PREROUTINGã€OUTPUT é“¾</span></span><br><span class="line">--to-ports &lt;port&gt;[-&lt;port&gt;]  <span class="comment"># é‡å®šå‘åˆ°æŒ‡å®šç«¯å£å·[èŒƒå›´]</span></span><br><span class="line">--random                    <span class="comment"># é‡å®šå‘åˆ°éšæœºç«¯å£å·</span></span><br></pre></td></tr></table></figure><h3 id="å¸¸ç”¨å‘½ä»¤"><a href="#å¸¸ç”¨å‘½ä»¤" class="headerlink" title="å¸¸ç”¨å‘½ä»¤"></a>å¸¸ç”¨å‘½ä»¤</h3><h4 id="æŸ¥çœ‹å¸®åŠ©"><a href="#æŸ¥çœ‹å¸®åŠ©" class="headerlink" title="æŸ¥çœ‹å¸®åŠ©"></a>æŸ¥çœ‹å¸®åŠ©</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">iptables --<span class="built_in">help</span>             <span class="comment"># æŸ¥çœ‹ iptables çš„å¸®åŠ©</span></span><br><span class="line">iptables -m æ¨¡å—å --<span class="built_in">help</span>    <span class="comment"># æŸ¥çœ‹æŒ‡å®šæ¨¡å—çš„å¯ç”¨å‚æ•°</span></span><br><span class="line">iptables -j åŠ¨ä½œå --<span class="built_in">help</span>    <span class="comment"># æŸ¥çœ‹æŒ‡å®šåŠ¨ä½œçš„å¯ç”¨å‚æ•°</span></span><br></pre></td></tr></table></figure><h4 id="æŸ¥çœ‹è§„åˆ™"><a href="#æŸ¥çœ‹è§„åˆ™" class="headerlink" title="æŸ¥çœ‹è§„åˆ™"></a>æŸ¥çœ‹è§„åˆ™</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">iptables -nvL</span><br><span class="line">iptables -t nat -nvL</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ˜¾ç¤ºè§„åˆ™åºå·</span></span><br><span class="line">iptables -nvL INPUT --line-numbers</span><br><span class="line">iptables -t nat -nvL --line-numbers</span><br><span class="line">iptables -t nat -nvL PREROUTING --line-numbers</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹è§„åˆ™çš„åŸå§‹æ ¼å¼</span></span><br><span class="line">iptables -t filter -S</span><br><span class="line">iptables -t nat -S</span><br><span class="line">iptables -t mangle -S</span><br><span class="line">iptables -t raw -S</span><br></pre></td></tr></table></figure><h4 id="è®¾ç½®é»˜è®¤è§„åˆ™"><a href="#è®¾ç½®é»˜è®¤è§„åˆ™" class="headerlink" title="è®¾ç½®é»˜è®¤è§„åˆ™"></a>è®¾ç½®é»˜è®¤è§„åˆ™</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">iptables -P INPUT DROP     <span class="comment"># é…ç½®é»˜è®¤ä¸¢å¼ƒè®¿é—®çš„æ•°æ®è¡¨</span></span><br><span class="line">iptables -P FORWARD DROP   <span class="comment"># é…ç½®é»˜è®¤ç¦æ­¢è½¬å‘</span></span><br><span class="line">iptables -P OUTPUT ACCEPT  <span class="comment"># é…ç½®é»˜è®¤å…è®¸å‘å¤–çš„è¯·æ±‚</span></span><br></pre></td></tr></table></figure><h4 id="æ¸…é™¤æ‰€æœ‰è§„åˆ™"><a href="#æ¸…é™¤æ‰€æœ‰è§„åˆ™" class="headerlink" title="æ¸…é™¤æ‰€æœ‰è§„åˆ™"></a>æ¸…é™¤æ‰€æœ‰è§„åˆ™</h4><p>æ³¨æ„ï¼Œåœ¨ä½¿ç”¨çš„æ—¶å€™</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">iptables -F  <span class="comment"># æ¸…ç©ºè¡¨ä¸­æ‰€æœ‰çš„è§„åˆ™</span></span><br><span class="line">iptables -X  <span class="comment"># åˆ é™¤è¡¨ä¸­ç”¨æˆ·è‡ªå®šä¹‰çš„é“¾</span></span><br><span class="line">iptables -Z  <span class="comment"># æ¸…ç©ºè®¡æ•°</span></span><br><span class="line"></span><br><span class="line">iptables -t nat -F</span><br><span class="line">iptables -t nat -X</span><br><span class="line">iptables -t mangle -F</span><br><span class="line">iptables -t mangle -X</span><br><span class="line">iptables -t raw -F</span><br><span class="line">iptables -t raw -X</span><br><span class="line">iptables -t security -F</span><br><span class="line">iptables -t security -X</span><br></pre></td></tr></table></figure><h4 id="å¢åŠ è§„åˆ™"><a href="#å¢åŠ è§„åˆ™" class="headerlink" title="å¢åŠ è§„åˆ™"></a>å¢åŠ è§„åˆ™</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¢åŠ ä¸€æ¡è§„åˆ™åˆ°æœ€å</span></span><br><span class="line">iptables -A INPUT -i eth0 -p tcp --dport 80 -m state --state NEW,ESTABLISHED -j ACCEPT</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ³¨ï¼šä»¥ä¸‹å‡ æ¡æ“ä½œéƒ½éœ€è¦ä½¿ç”¨è§„åˆ™çš„åºå·ï¼Œéœ€è¦ä½¿ç”¨ -L --line-numbers å‚æ•°å…ˆæŸ¥çœ‹è§„åˆ™çš„é¡ºåºå·</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ ä¸€æ¡è§„åˆ™åˆ°æŒ‡å®šä½ç½®</span></span><br><span class="line">iptables -I INPUT 2 -i eth0 -p tcp --dport 80 -m state --state NEW,ESTABLISHED -j ACCEPT</span><br></pre></td></tr></table></figure><h4 id="åˆ é™¤è§„åˆ™"><a href="#åˆ é™¤è§„åˆ™" class="headerlink" title="åˆ é™¤è§„åˆ™"></a>åˆ é™¤è§„åˆ™</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å°†æ‰€æœ‰ iptables ä»¥åºå·æ ‡è®°æ˜¾ç¤º</span></span><br><span class="line">iptables -L -n --line-numbers</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ ¹æ®è§„åˆ™çš„åºå·æ¥åˆ é™¤</span></span><br><span class="line">iptabels -D INPUT <span class="variable">$&#123;line-numbers&#125;</span></span><br></pre></td></tr></table></figure><h4 id="ä¿®æ”¹è§„åˆ™"><a href="#ä¿®æ”¹è§„åˆ™" class="headerlink" title="ä¿®æ”¹è§„åˆ™"></a>ä¿®æ”¹è§„åˆ™</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -R INPUT 3 -i eth0 -p tcp --dport 80 -m state --state NEW,ESTABLISHED -j ACCEPT</span><br></pre></td></tr></table></figure><h4 id="å¼€æ”¾æŒ‡å®šç«¯å£"><a href="#å¼€æ”¾æŒ‡å®šç«¯å£" class="headerlink" title="å¼€æ”¾æŒ‡å®šç«¯å£"></a>å¼€æ”¾æŒ‡å®šç«¯å£</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å…è®¸æœ¬åœ°å›ç¯æ¥å£(å³è¿è¡Œæœ¬æœºè®¿é—®æœ¬æœº)</span></span><br><span class="line">iptables -A INPUT -i lo -j ACCEPT</span><br><span class="line"></span><br><span class="line"><span class="comment"># å…è®¸å·²å»ºç«‹çš„æˆ–ç›¸å…³è¿æ¥çš„é€šè¡Œ</span></span><br><span class="line">iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT</span><br><span class="line"></span><br><span class="line"><span class="comment"># å…è®¸æ‰€æœ‰æœ¬æœºå‘å¤–çš„è®¿é—®</span></span><br><span class="line">iptables -A OUTPUT -j ACCEPT</span><br><span class="line"></span><br><span class="line"><span class="comment"># å…è®¸ 22,80,443 ç«¯å£çš„è®¿é—®</span></span><br><span class="line">iptables -A INPUT -p tcp --dport 22 -j ACCEPT</span><br><span class="line">iptables -A INPUT -p tcp --dports 80,443 -j ACCEPT</span><br><span class="line"></span><br><span class="line"><span class="comment"># å…è®¸ ping</span></span><br><span class="line">iptables -A INPUT -p icmp -m icmp --icmp-type 8 -j ACCEPT</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¦æ­¢ ping</span></span><br><span class="line">iptables -A INPUT -p icmp -m icmp --icmp-type 8 -j DROP</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¦æ­¢å…¶ä»–æœªå…è®¸çš„è§„åˆ™è®¿é—®</span></span><br><span class="line">iptables -A INPUT -j REJECT</span><br><span class="line">iptables -A FORWARD -j REJECT</span><br></pre></td></tr></table></figure><h4 id="è®¾ç½®ç™½åå•"><a href="#è®¾ç½®ç™½åå•" class="headerlink" title="è®¾ç½®ç™½åå•"></a>è®¾ç½®ç™½åå•</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å…è®¸æœºæˆ¿å†…ç½‘æœºå™¨å¯ä»¥è®¿é—®</span></span><br><span class="line">iptables -A INPUT -p all -s 10.10.10.0/24 -j ACCEPT </span><br><span class="line"><span class="comment"># å…è®¸ 10.10.10.22 è®¿é—®æœ¬æœºçš„ 22 ç«¯å£</span></span><br><span class="line">iptables -A INPUT -p tcp -s 10.10.10.22 --dport 22 -j ACCEPT</span><br></pre></td></tr></table></figure><h4 id="å±è”½æŸ-IP"><a href="#å±è”½æŸ-IP" class="headerlink" title="å±è”½æŸ IP"></a>å±è”½æŸ IP</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment"># å±è”½æ¶æ„ä¸»æœºï¼ˆæ¯”å¦‚ï¼Œ114.114.114.114)</span></span><br><span class="line">iptables -A INPUT -p tcp -m tcp -s 114.114.114.114 -j DROP</span><br><span class="line"></span><br><span class="line"><span class="comment"># å±è”½å•ä¸ªIPçš„å‘½ä»¤</span></span><br><span class="line">iptables -I INPUT -s 123.45.6.7 -j DROP</span><br><span class="line"></span><br><span class="line"><span class="comment">#å°æ•´ä¸ªæ®µå³ä» 10.10.10.1 åˆ° 10.10.10.254çš„å‘½ä»¤</span></span><br><span class="line">iptables -I INPUT -s 10.10.10.0/24 -j DROP</span><br></pre></td></tr></table></figure><h4 id="æŒ‡å®šæ•°æ®åŒ…å‡ºå»çš„ç½‘ç»œæ¥å£"><a href="#æŒ‡å®šæ•°æ®åŒ…å‡ºå»çš„ç½‘ç»œæ¥å£" class="headerlink" title="æŒ‡å®šæ•°æ®åŒ…å‡ºå»çš„ç½‘ç»œæ¥å£"></a>æŒ‡å®šæ•°æ®åŒ…å‡ºå»çš„ç½‘ç»œæ¥å£</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åªå¯¹ OUTPUTï¼ŒFORWARDï¼ŒPOSTROUTING ä¸‰ä¸ªé“¾èµ·ä½œç”¨</span></span><br><span class="line">iptables -A FORWARD -o eth0</span><br></pre></td></tr></table></figure><h4 id="é˜²æ­¢SYNæ´ªæ°´æ”»å‡»"><a href="#é˜²æ­¢SYNæ´ªæ°´æ”»å‡»" class="headerlink" title="é˜²æ­¢SYNæ´ªæ°´æ”»å‡»"></a>é˜²æ­¢SYNæ´ªæ°´æ”»å‡»</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -A INPUT -p tcp --syn -m <span class="built_in">limit</span> --<span class="built_in">limit</span> 5/second -j ACCEPT</span><br></pre></td></tr></table></figure><h4 id="ç«¯å£æ˜ å°„"><a href="#ç«¯å£æ˜ å°„" class="headerlink" title="ç«¯å£æ˜ å°„"></a>ç«¯å£æ˜ å°„</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æœ¬æœºçš„ 2222 ç«¯å£æ˜ å°„åˆ°å†…ç½‘è™šæ‹Ÿæœºçš„22 ç«¯å£</span></span><br><span class="line">iptables -t nat -A PREROUTING -d 223.6.6.6 -p tcp --dport 2222  -j DNAT --to-dest 10.10.10.22:22</span><br></pre></td></tr></table></figure><h4 id="æŒä¹…åŒ–è§„åˆ™ï¼š"><a href="#æŒä¹…åŒ–è§„åˆ™ï¼š" class="headerlink" title="æŒä¹…åŒ–è§„åˆ™ï¼š"></a>æŒä¹…åŒ–è§„åˆ™ï¼š</h4><p><strong>RHEL/CentOS</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¿ç»´åƒä¸‡æ¡ï¼Œå¤‡ä»½ç¬¬ä¸€æ¡ï¼Œæ“ä½œä¸è§„èŒƒï¼Œæ•°æ®å…¨å®Œè›‹(å¤§é›¾</span></span><br><span class="line">cp /etc/sysconfig/iptables&#123;ï¼Œ.bak&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿å­˜å½“å‰è§„åˆ™</span></span><br><span class="line">iptables-save &gt; /etc/sysconfig/iptables</span><br><span class="line">cat /etc/sysconfig/iptables</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¢å¤å¤‡ä»½è§„åˆ™</span></span><br><span class="line">iptables-restore &lt; iptables</span><br></pre></td></tr></table></figure><p><strong>Debian/Ubuntu</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¤‡ä»½å½“å‰è§„åˆ™</span></span><br><span class="line">cp /etc/iptables/rules.v4&#123;,.bak&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŒä¹…åŒ–å½“å‰è§„åˆ™</span></span><br><span class="line">iptables-save &gt; /etc/iptables/rules.v4</span><br></pre></td></tr></table></figure><h4 id="åˆ‡è®°"><a href="#åˆ‡è®°" class="headerlink" title="åˆ‡è®°"></a>åˆ‡è®°</h4><p>åœ¨æ“ä½œ iptables è§„åˆ™æ—¶ä¸€å®šè¦ä¸»è¦å…ˆåé¡ºåºï¼Œå› ä¸ºé“¾ä¸Šçš„è§„åˆ™æ˜¯ä¸€æ¡æ¡è§„åˆ™éå†ä¸‹æ¥çš„ï¼Œæ‰€ä»¥é¡ºåºå‡ºé”™çš„è¯ï¼Œiptables ä½œç”¨çš„æ•ˆæœä¹Ÿæœ‰å¯èƒ½ä¸ä¸€æ ·çš„å“¦ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li><a href="http://cxd2014.github.io/2017/08/15/connection-tracking-system/" target="_blank" rel="noopener">Linuxåè®®æ ˆâ€“è¿æ¥è·Ÿè¸ªæºç åˆ†æ</a></li><li><a href="https://github.com/OSH-2019/x-xdp-on-android/blob/master/docs/research.md" target="_blank" rel="noopener">x-xdp-on-android</a></li><li><a href="http://abcdxyzk.github.io/blog/2015/03/04/kernel-net-ip/" target="_blank" rel="noopener">linux TCP/IPåè®®æ ˆ-IPå±‚</a></li><li><a href="https://nieyong.github.io/wiki_cpu/CPU%E4%BD%93%E7%B3%BB%E6%9E%B6%E6%9E%84-DMA.html" target="_blank" rel="noopener">CPUä½“ç³»æ¶æ„ DMA</a></li><li><a href="http://blog.konghy.cn/2019/07/21/iptables/" target="_blank" rel="noopener">iptables ä½¿ç”¨æ–¹å¼æ•´ç†</a></li><li><a href="https://wiki.archlinux.org/index.php/Iptables_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)" target="_blank" rel="noopener">Archlinuxï¼šIptables</a></li><li><a href="https://windard.com/opinion/2016/10/15/About-Iptables" target="_blank" rel="noopener">iptables é˜²ç«å¢™åŸºæœ¬é…ç½®å’Œä½¿ç”¨</a></li><li><a href="http://www.ha97.com/3928.html" target="_blank" rel="noopener">Linuxçš„ iptables å¸¸ç”¨é…ç½®èŒƒä¾‹ï¼ˆ1ï¼‰</a></li><li><a href="https://www.bennythink.com/ufw-iptables.html" target="_blank" rel="noopener">å¼€å¯ ufw å¯¼è‡´æ–­ç½‘ä¸èƒ½ ping? ufw å’Œ iptables çš„é‚£äº›å‘</a></li><li><a href="https://zhuanlan.zhihu.com/p/93630586" target="_blank" rel="noopener">Linux ç½‘ç»œå±‚æ”¶å‘åŒ…æµç¨‹åŠ Netfilter æ¡†æ¶æµ…æ</a></li><li><a href="http://www.mikewootc.com/wiki/linux/usage/linux_firewall_iptables_intro.html" target="_blank" rel="noopener">Linuxé˜²ç«å¢™ä¸iptablesä»‹ç»</a></li><li><a href="https://www.zfl9.com/iptables.html" target="_blank" rel="noopener">iptables è¯¦è§£</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        
        
          &lt;p&gt;æœ€è¿‘å‚åŠ äº†ä¸€åœºè§†é¢‘ä¼šè®®é¢è¯•ï¼Œè™½ç„¶ç»“æœå¯èƒ½ä¸å¤ªç†æƒ³ï¼Œä½†è¿˜æ˜¯å‘
        
      
    
    </summary>
    
    
      <category term="æŠ€æœ¯" scheme="https://blog.k8s.li/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="Linux ç½‘ç»œ" scheme="https://blog.k8s.li/tags/Linux-%E7%BD%91%E7%BB%9C/"/>
    
      <category term="é˜²ç«å¢™" scheme="https://blog.k8s.li/tags/%E9%98%B2%E7%81%AB%E5%A2%99/"/>
    
  </entry>
  
  <entry>
    <title>kubernets ç›¸å…³æŠ€æœ¯è°ƒç ”</title>
    <link href="https://blog.k8s.li/k8s-01.html"/>
    <id>https://blog.k8s.li/k8s-01.html</id>
    <published>2020-02-29T16:00:00.000Z</published>
    <updated>2020-02-29T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ä¿—è¯è¯´æ–‡æ¡£å†™å¾—å¥½ï¼ŒåŒè¡ŒæŠ„åˆ°è€ğŸ˜‚ã€‚</p></blockquote><p>åœ¨å‰æœŸçš„æŠ€æœ¯é€‰å‹è°ƒç ”è¿‡ç¨‹ä¸­ï¼Œå¯¹ K8s å¯†åˆ‡ç›¸å…³çš„è§£å†³æ–¹æ¡ˆï¼šç½‘ç»œæ’ä»¶ã€å­˜å‚¨è§£å†³æ–¹æ¡ˆã€ç›‘æ§å‘Šè­¦ç³»ç»Ÿã€æ—¥å¿—æ”¶é›†å’Œå¤„ç†ã€æŒç»­é›†æˆå’Œäº¤ä»˜ç³»ç»Ÿç­‰åšäº†å……åˆ†çš„è°ƒç ”å’Œæµ‹è¯•å·¥ä½œï¼Œç°å¦‚ä»Šæ€»ç»“ä¸€ä¸‹è°ƒç ”è¿‡ç¨‹ä¸­çš„è®°å½•ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p>ä¿—è¯è¯´æ–‡æ¡£å†™å¾—å¥½ï¼ŒåŒè¡ŒæŠ„åˆ°è€ğŸ˜‚ã€‚ä¸è¿‡å’±æœ¨å­è¿˜æ˜¯æœ‰ç‚¹åŸåˆ™çš„ï¼Œæœ€èµ·ç æ ‡æ³¨å¼•ç”¨æ¥æºï¼Œå°Šé‡åŸä½œè€…çš„ç‰ˆæƒã€‚æ‰€ä»¥å°±åœ¨æ­¤ç½—åˆ—äº†æœ¬æ–‡ <del>å‰½çªƒ</del> å¼•ç”¨çš„æ¥æºã€‚ç”±äºæ˜¯æŠ€æœ¯è°ƒç ”ï¼Œæ–‡ä¸­æåˆ°çš„ç›¸å…³å¼€æºè½¯ä»¶ä»‹ç»å¤šæ•°éƒ½æ˜¯å¼•ç”¨è‡ªå®˜æ–¹æ–‡æ¡£æˆ–è€…è‹±æ–‡ç¿»è¯‘çš„æ–‡æ¡£ã€‚å…·ä½“çš„ç»†èŠ‚ç¨åå†æ›´æ–°åšå®¢è¡¥å……ã€‚æœ¬æ–‡çš„å†…å®¹æ¶‰åŠæ¯”è¾ƒå¤šï¼Œä¸»è¦å‚è€ƒå’Œå¼•ç”¨äº†ä»¥ä¸‹ç«™ç‚¹ã€‚</p><table><thead><tr><th>ç«™ç‚¹</th><th>ä¸»è¦å†…å®¹</th><th>å°è±¡</th></tr></thead><tbody><tr><td><a href="https://jimmysong.io/" target="_blank" rel="noopener">Jimmy Song - å®‹å‡€è¶…çš„åšå®¢</a></td><td>å¾®æœåŠ¡ã€æœåŠ¡ç½‘æ ¼ã€äº‘åŸç”Ÿ</td><td>èš‚èšé‡‘æœäº‘åŸç”Ÿå¸ƒé“å¸ˆ</td></tr><tr><td><a href="https://jimmysong.io/cloud-native/" target="_blank" rel="noopener">Cloud Native Wiki</a></td><td>äº‘åŸç”Ÿç™¾ç§‘ã€å›¾ä¹¦ã€ç¼–å¹´å²</td><td>èš‚èšé‡‘æœäº‘åŸç”Ÿå¸ƒé“å¸ˆ</td></tr><tr><td><a href="https://skyao.io/" target="_blank" rel="noopener">æ•–å°å‰‘çš„åšå®¢</a></td><td>å¾®æœåŠ¡ã€æœåŠ¡ç½‘æ ¼ã€äº‘åŸç”Ÿ</td><td>èš‚èšé‡‘æœäº‘åŸç”Ÿå¸ƒé“å¸ˆ</td></tr><tr><td><a href="https://fuckcloudnative.io/" target="_blank" rel="noopener">äº‘åŸç”Ÿå®éªŒå®¤ - ç±³å¼€æœ—åŸºæ¨çš„åšå®¢</a></td><td>Cloud Native</td><td>äº‘åŸç”Ÿå¸ƒé“å¸ˆ</td></tr><tr><td><a href="https://zhangguanzhang.github.io/" target="_blank" rel="noopener">zhangguanzhangâ€™s Blog</a></td><td>Kubernetesã€åµŒå…¥å¼ã€Linux</td><td>å¼ é¦†é•¿ğŸ˜‚</td></tr><tr><td><a href="https://mritd.me/" target="_blank" rel="noopener">æ¼ ç„¶çš„åšå®¢mritd Blog</a></td><td>Kubernetesã€Golang</td><td>Java Web å¼€å‘è€… 1 æš</td></tr><tr><td><a href="https://moelove.info/" target="_blank" rel="noopener">MoeLove</a></td><td>Kubernetes ç”Ÿæ€ç›¸å…³ã€å¼€æº</td><td>æ¯å‘¨åšæŒå‘¨æŠ¥ğŸ‘</td></tr><tr><td><a href="https://k2r2bai.com/" target="_blank" rel="noopener">KaiRenâ€™s Blog</a></td><td>Kubernetesã€Docker å®¹å™¨</td><td>å°æ¹¾åšä¸»</td></tr><tr><td><a href="https://www.hwchiu.com/" target="_blank" rel="noopener">Hwchiu Learning Note</a></td><td>Kubernetesã€SDNã€DevOps</td><td>å°æ¹¾åšä¸»</td></tr><tr><td><a href="https://kkc.github.io/" target="_blank" rel="noopener">Kakashiâ€™s Blog</a></td><td>AWSã€Kubernetesã€Prometheus</td><td>å°æ¹¾åšä¸»</td></tr><tr><td><a href="https://aleiwu.com/" target="_blank" rel="noopener">Ayleiâ€™s Blog</a></td><td>Kubernetesã€äº‘åŸç”Ÿã€TiDB</td><td>åœ¨ <a href="https://www.pingcap.com/" target="_blank" rel="noopener">PingCAP</a> çš„é˜¿ç£Š</td></tr><tr><td><a href="https://qingmu.io/" target="_blank" rel="noopener">é’æœ¨ã®Javaå°å±‹</a></td><td><a href="https://qingmu.io/2019/09/03/Spring-cloud-on-Kubernetes-index/" target="_blank" rel="noopener">SpringCloud on Kubernetes</a></td><td>æ‰“æ‚ç¨‹åºçŒ¿</td></tr><tr><td><a href="https://nicksors.cc/" target="_blank" rel="noopener">å¼€å…ƒDevOpsçŸ¥è¯†åº“</a></td><td></td><td></td></tr><tr><td><a href="https://xuchao918.github.io/" target="_blank" rel="noopener">èµ·é£äº†</a></td><td></td><td></td></tr><tr><td><a href="https://maiyang.me/" target="_blank" rel="noopener">èŒ¶æ­‡é©¿ç«™ </a></td><td></td><td></td></tr><tr><td><a href="https://docs.lvrui.io/" target="_blank" rel="noopener">Polar Snow Documentation</a></td><td></td><td></td></tr><tr><td><a href="http://www.rhca.me/" target="_blank" rel="noopener">DevOps â€“ æˆé•¿ä¹‹è·¯</a></td><td></td><td></td></tr><tr><td><a href="https://blog.ihypo.net/index.html" target="_blank" rel="noopener">æ¢¦æ—­éšæƒ³</a></td><td>Kubernetes ã€å®¹å™¨</td><td>æ— æ ˆå·¥ç¨‹å¸ˆğŸ˜‚</td></tr><tr><td><a href="https://www.bladewan.com/" target="_blank" rel="noopener">æˆ‘çˆ±è¥¿çº¢æŸ¿</a></td><td></td><td></td></tr><tr><td><a href="https://bingohuang.com/" target="_blank" rel="noopener">Bingo Huang</a></td><td>Golangã€Docker</td><td>ä¸€ä¸ªç¨‹åºå‘˜çš„è‡ªæˆ‘ä¿®å…»</td></tr><tr><td><a href="https://hansedong.github.io/" target="_blank" rel="noopener">å›½å—ä¹‹å¢ƒ</a></td><td>CoreDNS ã€Kubernetesã€Golang</td><td></td></tr><tr><td><a href="http://gaocegege.com/Blog/" target="_blank" rel="noopener">åšå®¢é«˜ç­–</a></td><td>æœºå™¨å­¦ä¹ ã€Kubernetesã€kubebuilder</td><td>æ±Ÿæ¹–å°è™¾ç±³</td></tr><tr><td><a href="https://birdben.github.io/" target="_blank" rel="noopener">birdben</a></td><td></td><td></td></tr><tr><td><a href="https://fs.tn/" target="_blank" rel="noopener">æµ®ç”Ÿè‹¥æ¢¦</a></td><td></td><td></td></tr><tr><td><a href="http://www.yangguanjun.com/" target="_blank" rel="noopener">ictfox blog</a></td><td></td><td></td></tr><tr><td><a href="https://www.duyidong.com/" target="_blank" rel="noopener">æœå±¹ä¸œçš„åšå®¢å­¦æ— æ­¢å¢ƒ</a></td><td></td><td></td></tr><tr><td><a href="http://team.jiunile.com/" target="_blank" rel="noopener">CloudNative æ¶æ„</a></td><td></td><td></td></tr><tr><td><a href="https://notes.doublemine.me/" target="_blank" rel="noopener">Doublemine</a></td><td></td><td></td></tr><tr><td><a href="http://chunqi.li/" target="_blank" rel="noopener">Arthur Chunqi Liâ€™s Blog</a></td><td></td><td></td></tr><tr><td><a href="http://chunqi.li/archives/" target="_blank" rel="noopener">Archive Arthur Chunqi Liâ€™s Blog</a></td><td></td><td></td></tr><tr><td><a href="https://www.lijiaocn.com/" target="_blank" rel="noopener">ITæŠ€æœ¯å·¥ä½œå­¦ä¹ æŠ˜è…¾ç¬”è®° æä½¶æ¾³çš„åšå®¢</a></td><td></td><td></td></tr><tr><td><a href="http://moheqionglin.com/site/blogs/1/list.html" target="_blank" rel="noopener">å¢¨è·ç¼æ—å®˜ç½‘-ç¼–ç¨‹æ—¥å¿—</a></td><td></td><td></td></tr><tr><td><a href="https://cmgs.me/archive" target="_blank" rel="noopener">Archive - Nolla</a></td><td></td><td></td></tr><tr><td><a href="https://tomoyadeng.github.io/blog/" target="_blank" rel="noopener">Tomoyaâ€™s Blog</a></td><td></td><td></td></tr><tr><td><a href="https://youendless.com/" target="_blank" rel="noopener">å›æ— æ­¢å¢ƒ</a></td><td></td><td></td></tr><tr><td><a href="https://jaminzhang.github.io/" target="_blank" rel="noopener">Jamin Zhang</a></td><td></td><td></td></tr><tr><td><a href="https://imroc.io/" target="_blank" rel="noopener">roc çš„åšå®¢ - imroc.io</a></td><td><a href="https://k8s.imroc.io/" target="_blank" rel="noopener">ã€ŠKuberneteså®è·µæŒ‡å—ã€‹</a>ã€ ç®—æ³•</td><td></td></tr><tr><td><a href="https://sysdig.com/blog/" target="_blank" rel="noopener">Blog - Sysdig</a></td><td></td><td></td></tr><tr><td><a href="https://sleele.com/" target="_blank" rel="noopener">sleeleçš„åšå®¢</a></td><td></td><td></td></tr><tr><td><a href="https://www.tauceti.blog/" target="_blank" rel="noopener">TauCeti blog Â· TauCeti blog</a></td><td></td><td></td></tr><tr><td><a href="https://zhangchenchen.github.io/" target="_blank" rel="noopener">Solar</a></td><td></td><td></td></tr><tr><td><a href="https://www.infvie.com/" target="_blank" rel="noopener">Infvieâ€™s Blogè¿ç»´SREç¤¾åŒºåšå®¢</a></td><td></td><td></td></tr><tr><td><a href="http://ghoulich.xninja.org/" target="_blank" rel="noopener">æ°´æ™¶å‘½åŒ£</a></td><td></td><td></td></tr><tr><td><a href="https://soulteary.com/" target="_blank" rel="noopener">è‹æ´‹åšå®¢</a></td><td></td><td></td></tr><tr><td><a href="https://ieevee.com/" target="_blank" rel="noopener">Zlatan Eevee</a></td><td></td><td></td></tr></tbody></table><h2 id="å¼€æºå®¹å™¨å¹³å°"><a href="#å¼€æºå®¹å™¨å¹³å°" class="headerlink" title="å¼€æºå®¹å™¨å¹³å°"></a>å¼€æºå®¹å™¨å¹³å°</h2><h3 id="OpenShift"><a href="#OpenShift" class="headerlink" title="OpenShift"></a><a href="https://www.openshift.com/" target="_blank" rel="noopener">OpenShift</a></h3><h4 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h4><p>OpenShift æ˜¯çº¢å¸½çš„äº‘å¼€å‘å¹³å°å³æœåŠ¡ï¼ˆPaaSï¼‰ã€‚ é€šè¿‡ OpenShiftï¼Œä¼ä¸šå¯ä»¥å¿«é€Ÿæ­å»ºç¨³å®šã€å®‰å…¨ã€é«˜æ•ˆçš„å®¹å™¨åº”ç”¨å¹³å°ã€‚åœ¨è¿™ä¸ªå¹³å°ä¸Šï¼š</p><ul><li>å¯ä»¥æ„å»ºä¼ä¸šå†…éƒ¨çš„å®¹å™¨åº”ç”¨å¸‚åœºï¼Œä¸ºå¼€å‘äººå‘˜å¿«é€Ÿæä¾›åº”ç”¨å¼€å‘æ‰€ä¾èµ–çš„ä¸­é—´ä»¶ã€æ•°æ®åº“ç­‰æœåŠ¡ã€‚</li><li>é€šè¿‡è‡ªåŠ¨åŒ–çš„æµç¨‹ï¼Œå¼€å‘äººå‘˜å¯ä»¥å¿«é€Ÿè¿›è¡Œåº”ç”¨çš„æ„å»ºã€å®¹å™¨åŒ–åŠéƒ¨ç½²ã€‚</li><li>é€šè¿‡ OpenShiftï¼Œç”¨æˆ·å¯ä»¥è´¯é€šä»åº”ç”¨å¼€å‘åˆ°æµ‹è¯•ï¼Œå†åˆ°ä¸Šçº¿çš„å…¨æµç¨‹ï¼Œå¼€å‘ã€æµ‹è¯•å’Œè¿ç»´ç­‰ä¸åŒçš„è§’è‰²å¯ä»¥åœ¨ä¸€ä¸ªå¹³å°ä¸Šè¿›è¡Œåä½œã€‚</li><li>æ”¯æŒ LDAP ç”¨æˆ·æƒé™ç®¡ç†ï¼Œæ”¯æŒç»†ç²’åº¦çš„æƒé™èµ„æºç®¡ç†ã€‚</li><li>OpenShift å¯ä»¥æé«˜åº”ç”¨ä»ç ”å‘åˆ°ä¸Šçº¿çš„æ•ˆç‡å’Œé€Ÿåº¦ï¼Œç¼©çŸ­äº§å“ä¸Šå¸‚çš„æ—¶é—´ï¼Œå¯ä»¥æœ‰æ•ˆåœ°å¸®åŠ©ä¼ä¸šæ¨è¿›DevOpsï¼Œæé«˜èµ„æºåˆ©ç”¨ç‡ï¼Œæå‡ç”Ÿäº§æ•ˆç‡ã€‚</li></ul><h3 id="KubeSphere"><a href="#KubeSphere" class="headerlink" title="KubeSphere"></a><a href="https://kubesphere.io/zh-CN/projects/" target="_blank" rel="noopener">KubeSphere</a></h3><h4 id="ç®€ä»‹-1"><a href="#ç®€ä»‹-1" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h4><p><a href="https://kubesphere.io" target="_blank" rel="noopener">KubeSphere</a> æ˜¯åœ¨ç›®å‰ä¸»æµå®¹å™¨è°ƒåº¦å¹³å° <a href="https://kubernetes.io" target="_blank" rel="noopener">Kubernetes</a>  ä¹‹ä¸Šæ„å»ºçš„ä¼ä¸šçº§åˆ†å¸ƒå¼å¤šç§Ÿæˆ·å®¹å™¨å¹³å°ï¼Œæä¾›ç®€å•æ˜“ç”¨çš„æ“ä½œç•Œé¢ä»¥åŠå‘å¯¼å¼æ“ä½œæ–¹å¼ï¼Œåœ¨é™ä½ç”¨æˆ·ä½¿ç”¨å®¹å™¨è°ƒåº¦å¹³å°å­¦ä¹ æˆæœ¬çš„åŒæ—¶ï¼Œæå¤§å‡è½»å¼€å‘ã€æµ‹è¯•ã€è¿ç»´çš„æ—¥å¸¸å·¥ä½œçš„å¤æ‚åº¦ï¼Œæ—¨åœ¨è§£å†³ Kubernetes  æœ¬èº«å­˜åœ¨çš„å­˜å‚¨ã€ç½‘ç»œã€å®‰å…¨å’Œæ˜“ç”¨æ€§ç­‰ç—›ç‚¹ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œå¹³å°å·²ç»æ•´åˆå¹¶ä¼˜åŒ–äº†å¤šä¸ªé€‚ç”¨äºå®¹å™¨åœºæ™¯çš„åŠŸèƒ½æ¨¡å—ï¼Œä»¥å®Œæ•´çš„è§£å†³æ–¹æ¡ˆå¸®åŠ©ä¼ä¸šè½»æ¾åº”å¯¹æ•æ·å¼€å‘ä¸è‡ªåŠ¨åŒ–è¿ç»´ã€å¾®æœåŠ¡æ²»ç†ã€å¤šç§Ÿæˆ·ç®¡ç†ã€å·¥ä½œè´Ÿè½½å’Œé›†ç¾¤ç®¡ç†ã€æœåŠ¡ä¸ç½‘ç»œç®¡ç†ã€åº”ç”¨ç¼–æ’ä¸ç®¡ç†ã€é•œåƒä»“åº“ç®¡ç†å’Œå­˜å‚¨ç®¡ç†ç­‰ä¸šåŠ¡åœºæ™¯ã€‚</p><p>KubeSphere é«˜çº§ç‰ˆæä¾›ä¼ä¸šçº§å®¹å™¨åº”ç”¨ç®¡ç†æœåŠ¡ï¼Œæ”¯æŒæ›´å¼ºå¤§çš„åŠŸèƒ½å’Œçµæ´»çš„é…ç½®ï¼Œæ»¡è¶³ä¼ä¸šå¤æ‚çš„ä¸šåŠ¡éœ€æ±‚ã€‚æ¯”å¦‚æ”¯æŒ  Master å’Œ etcd èŠ‚ç‚¹é«˜å¯ç”¨ã€å¯è§†åŒ– CI/CD æµæ°´çº¿ã€å¤šç»´åº¦ç›‘æ§å‘Šè­¦æ—¥å¿—ã€å¤šç§Ÿæˆ·ç®¡ç†ã€LDAP é›†æˆã€æ–°å¢æ”¯æŒ HPA  (æ°´å¹³è‡ªåŠ¨ä¼¸ç¼©) ã€å®¹å™¨å¥åº·æ£€æŸ¥ä»¥åŠ Secretsã€ConfigMaps  çš„é…ç½®ç®¡ç†ç­‰åŠŸèƒ½ï¼Œæ–°å¢å¾®æœåŠ¡æ²»ç†ã€ç°åº¦å‘å¸ƒã€s2iã€ä»£ç è´¨é‡æ£€æŸ¥ç­‰ï¼Œåç»­è¿˜å°†æä¾›å’Œæ”¯æŒå¤šé›†ç¾¤ç®¡ç†ã€å¤§æ•°æ®ã€äººå·¥æ™ºèƒ½ç­‰æ›´ä¸ºå¤æ‚çš„ä¸šåŠ¡åœºæ™¯ã€‚</p><h3 id="Rancher"><a href="#Rancher" class="headerlink" title="Rancher"></a><a href="https://rancher.com/" target="_blank" rel="noopener">Rancher</a></h3><h4 id="ç®€ä»‹-2"><a href="#ç®€ä»‹-2" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h4><p>Rancher æ˜¯ä¸€ä¸ªå¼€æºçš„ä¼ä¸šçº§å¤šé›†ç¾¤ Kubernetes ç®¡ç†å¹³å°ã€‚é€šè¿‡ Rancherï¼Œä¼ä¸šå†ä¹Ÿä¸å¿…è‡ªå·±ä½¿ç”¨ä¸€ç³»åˆ—çš„å¼€æºè½¯ä»¶å»ä»å¤´æ­å»ºå®¹å™¨æœåŠ¡å¹³å°ã€‚å®ƒæä¾›äº†åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨çš„ç®¡ç† Docker å’Œ Kubernetes çš„å…¨æ ˆåŒ–å®¹å™¨éƒ¨ç½²ä¸ç®¡ç†å¹³å°ã€‚å®ƒå¯ä»¥å¸®åŠ©ä¼ä¸šåœ¨ç”Ÿäº§ç¯å¢ƒä¸­è½»æ¾å¿«æ·çš„éƒ¨ç½²å’Œç®¡ç†å®¹å™¨ï¼Œè½»æ¾åœ°ç®¡ç†å„ç§ç¯å¢ƒçš„ Kubernetes ï¼Œæ»¡è¶³ITéœ€æ±‚å¹¶ä¸ºDevOpså›¢é˜Ÿæä¾›æ”¯æŒã€‚</p><h2 id="éƒ¨ç½²å·¥å…·"><a href="#éƒ¨ç½²å·¥å…·" class="headerlink" title="éƒ¨ç½²å·¥å…·"></a>éƒ¨ç½²å·¥å…·</h2><h3 id="RKE"><a href="#RKE" class="headerlink" title="RKE"></a><a href="https://github.com/rancher/rke" target="_blank" rel="noopener">RKE</a></h3><p>RKE å…¨ç§°ä¸º Rancher Kubernetes Engineï¼Œæ˜¯ Rancher å¼€æºçš„è½»é‡çº§ K8s é›†ç¾¤éƒ¨ç½²å·¥å…·ï¼Œä½¿ç”¨å®ƒå¯ä»¥å¿«é€Ÿçš„éƒ¨ç½²ä¸€ä¸ª K8s é›†ç¾¤ã€‚å‚è€ƒæ–‡æ¡£ <a href="https://fs.tn/post/PmaL-uIiQ" target="_blank" rel="noopener">ä½¿ç”¨RKEéƒ¨ç½²ä¸€ä¸ªK8sé›†ç¾¤å¹¶éƒ¨ç½²Rancher HA</a> ã€‚</p><h3 id="Kops"><a href="#Kops" class="headerlink" title="Kops"></a><a href="https://github.com/kubernetes/kops" target="_blank" rel="noopener">Kops</a></h3><p><a href="https://github.com/kubernetes/kops" target="_blank" rel="noopener">kops</a> æ˜¯ä¸€ä¸ªç”Ÿäº§çº§ Kubernetes é›†ç¾¤éƒ¨ç½²å·¥å…·ï¼Œå¯ä»¥åœ¨ AWSã€GCEã€VMWare vSphere ç­‰å¹³å°ä¸Šè‡ªåŠ¨éƒ¨ç½²é«˜å¯ç”¨çš„ Kubernetes é›†ç¾¤ã€‚ä¸»è¦åŠŸèƒ½åŒ…æ‹¬ï¼š</p><ul><li><p>å‘½ä»¤è¡Œè‡ªåŠ¨è¡¥å…¨</p></li><li><p>å…¨è‡ªåŠ¨å®‰è£…æµç¨‹</p></li><li><p>ä½¿ç”¨ DNS è¯†åˆ«é›†ç¾¤</p></li><li><p>æ”¯æŒè‡ªå®šä¹‰æ‰©å±• add-ons</p></li><li><p>æ”¯æŒé«˜å¯ç”¨ - å‚è€ƒ <a href="https://github.com/kubernetes/kops/blob/master/docs/high_availability.md" target="_blank" rel="noopener">high_availability.md</a></p></li><li><p>dry-run å’Œè‡ªåŠ¨å¹‚ç­‰å‡çº§ç­‰åŸºäºçŠ¶æ€åŒæ­¥æ¨¡å‹</p></li><li><p>æ”¯æŒä» <a href="https://github.com/kubernetes/kops/blob/master/docs/upgrade_from_kubeup.md" target="_blank" rel="noopener">kube-up</a> åˆ›å»ºçš„é›†ç¾¤å‡çº§åˆ° kops ç‰ˆæœ¬</p></li><li><p>è‡ªåŠ¨éƒ¨ç½²é«˜å¯ç”¨çš„ Kubernetes é›†ç¾¤</p></li><li><p>è‡ªæˆ‘ä¿®å¤ï¼šä¸€åˆ‡éƒ½åœ¨è‡ªåŠ¨æ‰©å±•ç»„ä¸­è¿è¡Œ</p></li><li><p>å¯ä»¥ç›´æ¥æä¾›æˆ–è€…ç”Ÿæˆ terraform æ¸…å• - å‚è€ƒ <a href="https://github.com/kubernetes/kops/blob/master/docs/terraform.md" target="_blank" rel="noopener">terraform.md</a></p></li><li><p>æ”¯æŒå¤šç§æ“ä½œç³»ç»Ÿï¼ˆå¦‚ Debianã€Ubuntu 16.04ã€CentOSã€RHELã€Amazon Linux å’Œ CoreOSï¼‰</p></li></ul><h3 id="Kubeadm"><a href="#Kubeadm" class="headerlink" title="Kubeadm"></a><a href="https://github.com/kubernetes/kubeadm" target="_blank" rel="noopener">Kubeadm</a></h3><p>Kubeadm æ˜¯ Kubernetes å®˜æ–¹æ¨å‡ºçš„é›†ç¾¤éƒ¨ç½²å·¥å…·ï¼Œåœ¨ 1.14.0 ç‰ˆæœ¬ä¹‹åå°±å·²ç»è¾¾åˆ°ç”Ÿäº§å¯ç”¨ GA çš„ç¨³å®šæ€§ã€‚å¯¹äºåˆšåˆšæ¥è§¦ Kubernetes çš„äººå‘˜æ¥è¯´ï¼ŒKubeadm æ— ç–‘æ˜¯ä¸ªå¥½å·¥å…·ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ kubeadm æ‰€éœ€è¦çš„é•œåƒæ˜¯åœ¨ gcr.k8s.io ä¸Šçš„ï¼Œè¢« GFW ç»™å¢™æ‰äº†ï¼Œå¯ä»¥å°†é•œåƒä»å¢™å¤–çš„å°æœåŠ¡å™¨ä¸Šæä¸‹æ¥ï¼Œç„¶åé€šè¿‡ docker load çš„æ–¹å¼åŠ è½½é•œåƒï¼Œè¿™æ ·å°±ä¸ä¼šå› ä¸ºæ— æ³• pull é•œåƒ pod ä¸€ç›´å¤„åœ¨ pending çŠ¶æ€ã€‚</p><h3 id="sealos"><a href="#sealos" class="headerlink" title="sealos"></a><a href="https://github.com/fanux/sealos" target="_blank" rel="noopener">sealos</a></h3><p>sealos åŸºäº kubeadm æ¥éƒ¨ç½²ï¼Œæ—¨åœ¨åšä¸€ä¸ªç®€å•å¹²å‡€è½»é‡çº§ç¨³å®šçš„ kubernetes å®‰è£…å·¥å…·ï¼Œèƒ½å¾ˆå¥½çš„æ”¯æŒé«˜å¯ç”¨å®‰è£…ã€‚ç‰¹æ€§å¦‚ä¸‹ï¼š</p><ul><li>è¯ä¹¦å»¶æœŸ</li><li>ä½¿ç”¨ç®€å•ï¼Œæ”¯æŒè‡ªå®šä¹‰é…ç½®</li><li>å†…æ ¸è´Ÿè½½ï¼Œæå…¶ç¨³å®šï¼Œå› ä¸ºç®€å•æ‰€ä»¥æ’æŸ¥é—®é¢˜ä¹Ÿæå…¶ç®€å•</li><li>æ”¯æŒç¦»çº¿å®‰è£…ï¼Œå·¥å…·ä¸èµ„æºåŒ…ï¼ˆäºŒè¿›åˆ¶ç¨‹åº é…ç½®æ–‡ä»¶ é•œåƒ  yaml æ–‡ä»¶ç­‰ï¼‰åˆ†ç¦»,è¿™æ ·ä¸åŒç‰ˆæœ¬æ›¿æ¢ä¸åŒç¦»çº¿åŒ…å³å¯</li></ul><h3 id="kubeasz"><a href="#kubeasz" class="headerlink" title="kubeasz"></a><a href="https://github.com/easzlab/kubeasz" target="_blank" rel="noopener">kubeasz</a></h3><p>ä½¿ç”¨ Ansible è„šæœ¬å®‰è£… K8s é›†ç¾¤ï¼Œä»‹ç»ç»„ä»¶äº¤äº’åŸç†ï¼Œæ–¹ä¾¿ç›´æ¥ï¼Œä¸å—å›½å†…ç½‘ç»œç¯å¢ƒå½±å“ã€‚æ˜¯ç›®å‰ kubernetes ä¸­æ–‡ç¤¾åŒºæœ€ä¸ºçƒ­é—¨çš„éƒ¨ç½²å·¥å…·ï¼ŒGitHub ä¸Šçš„ start æ•°è¶…è¿‡äº† 4K5 ã€‚åŸºäºäºŒè¿›åˆ¶æ–¹å¼éƒ¨ç½²å’Œåˆ©ç”¨<code>ansible-playbook</code>å®ç°è‡ªåŠ¨åŒ–ï¼›æ—¢æä¾›ä¸€é”®å®‰è£…è„šæœ¬, ä¹Ÿå¯ä»¥æ ¹æ®<code>å®‰è£…æŒ‡å—</code>åˆ†æ­¥æ‰§è¡Œå®‰è£…å„ä¸ªç»„ä»¶ã€‚</p><ul><li>é›†ç¾¤ç‰¹æ€§ <code>TLS</code>åŒå‘è®¤è¯ã€<code>RBAC</code>æˆæƒã€<a href="https://github.com/easzlab/kubeasz/blob/master/docs/setup/00-planning_and_overall_intro.md#ha-architecture" target="_blank" rel="noopener">å¤šMasteré«˜å¯ç”¨</a>ã€æ”¯æŒ<code>Network Policy</code>ã€å¤‡ä»½æ¢å¤ã€<a href="https://github.com/easzlab/kubeasz/blob/master/docs/setup/offline_install.md" target="_blank" rel="noopener">ç¦»çº¿å®‰è£…</a></li><li>é›†ç¾¤ç‰ˆæœ¬ kubernetes v1.13, v1.14, v1.15, v1.16</li><li>æ“ä½œç³»ç»Ÿ CentOS/RedHat 7, Debian 9/10, Ubuntu 1604/1804</li><li>è¿è¡Œæ—¶ docker 18.06.x-ce, 18.09.x, <a href="https://github.com/easzlab/kubeasz/blob/master/docs/guide/containerd.md" target="_blank" rel="noopener">containerd</a> 1.2.6</li><li>ç½‘ç»œ <a href="https://github.com/easzlab/kubeasz/blob/master/docs/setup/network-plugin/calico.md" target="_blank" rel="noopener">calico</a>, <a href="https://github.com/easzlab/kubeasz/blob/master/docs/setup/network-plugin/cilium.md" target="_blank" rel="noopener">cilium</a>, <a href="https://github.com/easzlab/kubeasz/blob/master/docs/setup/network-plugin/flannel.md" target="_blank" rel="noopener">flannel</a>, <a href="https://github.com/easzlab/kubeasz/blob/master/docs/setup/network-plugin/kube-ovn.md" target="_blank" rel="noopener">kube-ovn</a>, <a href="https://github.com/easzlab/kubeasz/blob/master/docs/setup/network-plugin/kube-router.md" target="_blank" rel="noopener">kube-router</a></li></ul><h3 id="kubespray"><a href="#kubespray" class="headerlink" title="kubespray"></a><a href="https://github.com/kubernetes-sigs/kubespray" target="_blank" rel="noopener">kubespray</a></h3><p><a href="https://github.com/kubernetes-incubator/kubespray" target="_blank" rel="noopener">Kubespray</a> æ˜¯ Kubernetes incubator ä¸­çš„é¡¹ç›®ï¼Œä¹Ÿæ˜¯ kubernetes å®˜æ–¹å‡ºå“ã€‚ç›®æ ‡æ˜¯æä¾›ç”Ÿäº§å¯ç”¨ Kubernetes éƒ¨ç½²æ–¹æ¡ˆï¼Œè¯¥é¡¹ç›®åŸºç¡€æ˜¯é€šè¿‡ Ansible Playbook æ¥å®šä¹‰ç³»ç»Ÿä¸ Kubernetes é›†ç¾¤éƒ¨ç½²çš„ä»»åŠ¡ï¼Œå…·æœ‰ä»¥ä¸‹å‡ ä¸ªç‰¹ç‚¹ï¼š</p><ul><li>å¯ä»¥éƒ¨ç½²åœ¨ AWS, GCE, Azure, OpenStack ä»¥åŠè£¸æœºä¸Š.</li><li>éƒ¨ç½² High Available Kubernetes é›†ç¾¤.</li><li>å¯ç»„åˆæ€§ (Composable)ï¼Œå¯è‡ªè¡Œé€‰æ‹© Network Plugin (flannel, calico, canal, weave) æ¥éƒ¨ç½².</li><li>æ”¯æŒå¤šç§ Linux distributions(CoreOS, Debian Jessie, Ubuntu 16.04, CentOS/RHEL7).</li></ul><p>ä¸è¿‡ç”±äºæ˜¯å›½å¤–å¼€å‘è€…ç»´æŠ¤ï¼Œæœ‰äº›è½¯ä»¶åŒ…å› ä¸ºç½‘ç»œåŸå› æ— æ³•ä¸‹è½½ä¸‹æ¥æ‰€ä»¥ä¼šæ¯”è¾ƒéº»çƒ¦ã€‚æ‰€ä»¥å›½å†…ç”¨æˆ·ä¸å»ºè®®è§¦ç¢°ï¼Œé™¤éä½ å†å»æ‰‹åŠ¨ä¿®æ”¹é‚£äº›è½¯ä»¶åŒ…çš„æºä¸ºå›½å†…çš„ã€‚</p><h2 id="ç¨³å®šç‰ˆæœ¬é€‰æ‹©"><a href="#ç¨³å®šç‰ˆæœ¬é€‰æ‹©" class="headerlink" title="ç¨³å®šç‰ˆæœ¬é€‰æ‹©"></a>ç¨³å®šç‰ˆæœ¬é€‰æ‹©</h2><p>å¯ä»¥å‚ç…§è¿™å¼ è¡¨æ ¼ï¼Œæ¥é€‰æ‹©å°ç‰ˆæœ¬å·ä»‹äº 5~~8 ä¹‹é—´ä¸”è¿˜åœ¨ç»´æŠ¤çš„ç‰ˆæœ¬ã€‚æ¯”å¦‚ v1.16.7 ï¼Œæœ‰ CVE å®‰å…¨æ¼æ´ä¹‹å‰çš„ç‰ˆæœ¬ä¹Ÿä¸å»ºè®®ä½¿ç”¨ã€‚</p><table><thead><tr><th>month</th><th>stable</th><th>stable</th><th>stable</th><th>stable</th></tr></thead><tbody><tr><td>2020-02</td><td><a href="https://github.com/kubernetes/kubernetes/releases/tag/v1.17.3" target="_blank" rel="noopener">v1.17.3</a></td><td><a href="https://github.com/kubernetes/kubernetes/releases/tag/v1.16.7" target="_blank" rel="noopener">v1.16.7</a></td><td><a href="https://github.com/kubernetes/kubernetes/releases/tag/v1.15.10" target="_blank" rel="noopener">v1.15.10</a></td><td></td></tr><tr><td>2020-01</td><td><a href="https://github.com/kubernetes/kubernetes/releases/tag/v1.17.2" target="_blank" rel="noopener">v1.17.2</a><br> <a href="https://github.com/kubernetes/kubernetes/releases/tag/v1.17.1" target="_blank" rel="noopener">v1.17.1</a></td><td><a href="https://github.com/kubernetes/kubernetes/releases/tag/v1.16.6" target="_blank" rel="noopener">v1.16.6</a><br> <a href="https://github.com/kubernetes/kubernetes/releases/tag/v1.16.5" target="_blank" rel="noopener">v1.16.5</a></td><td><a href="https://github.com/kubernetes/kubernetes/releases/tag/v1.15.9" target="_blank" rel="noopener">v1.15.9</a><br> <a href="https://github.com/kubernetes/kubernetes/releases/tag/v1.15.8" target="_blank" rel="noopener">v1.15.8</a></td><td>CVE</td></tr><tr><td>2019-12</td><td><a href="https://github.com/kubernetes/kubernetes/releases/tag/v1.17.0" target="_blank" rel="noopener">v1.17.0</a></td><td><a href="https://github.com/kubernetes/kubernetes/releases/tag/v1.16.4" target="_blank" rel="noopener">v1.16.4</a></td><td><a href="https://github.com/kubernetes/kubernetes/releases/tag/v1.15.7" target="_blank" rel="noopener">v1.15.7</a></td><td><a href="https://github.com/kubernetes/kubernetes/releases/tag/v1.14.10" target="_blank" rel="noopener">v1.14.10</a></td></tr><tr><td>2019-11</td><td><a href="https://github.com/kubernetes/kubernetes/releases/tag/v1.16.3" target="_blank" rel="noopener">v1.16.3</a></td><td><a href="https://github.com/kubernetes/kubernetes/releases/tag/v1.15.6" target="_blank" rel="noopener">v1.15.6</a></td><td><a href="https://github.com/kubernetes/kubernetes/releases/tag/v1.14.9" target="_blank" rel="noopener">v1.14.9</a></td><td></td></tr><tr><td>2019-10</td><td><a href="https://github.com/kubernetes/kubernetes/releases/tag/v1.16.1" target="_blank" rel="noopener">v1.16.1</a>  <br><a href="https://github.com/kubernetes/kubernetes/releases/tag/v1.16.2" target="_blank" rel="noopener">v1.16.2</a></td><td><a href="https://github.com/kubernetes/kubernetes/releases/tag/v1.15.5" target="_blank" rel="noopener">v1.15.5</a></td><td><a href="https://github.com/kubernetes/kubernetes/releases/tag/v1.14.8" target="_blank" rel="noopener">v1.14.8</a></td><td><a href="https://github.com/kubernetes/kubernetes/releases/tag/v1.13.12" target="_blank" rel="noopener">v1.13.12</a></td></tr><tr><td>2019-09</td><td><a href="https://github.com/kubernetes/kubernetes/releases/tag/v1.16.0" target="_blank" rel="noopener">v1.16.0</a></td><td><a href="https://github.com/kubernetes/kubernetes/releases/tag/v1.15.4" target="_blank" rel="noopener">v1.15.4</a></td><td><a href="https://github.com/kubernetes/kubernetes/releases/tag/v1.14.7" target="_blank" rel="noopener">v1.14.7</a></td><td><a href="https://github.com/kubernetes/kubernetes/releases/tag/v1.13.11" target="_blank" rel="noopener">v1.13.11</a></td></tr><tr><td>2019-08</td><td><a href="https://github.com/kubernetes/kubernetes/releases/tag/v1.15.2" target="_blank" rel="noopener">v1.15.2</a><br> <a href="https://github.com/kubernetes/kubernetes/releases/tag/v1.15.3" target="_blank" rel="noopener">v1.15.3</a></td><td><a href="https://github.com/kubernetes/kubernetes/releases/tag/v1.14.5" target="_blank" rel="noopener">v1.14.5</a> <br> <a href="https://github.com/kubernetes/kubernetes/releases/tag/v1.14.6" target="_blank" rel="noopener">v1.14.6</a></td><td><a href="https://github.com/kubernetes/kubernetes/releases/tag/v1.13.9" target="_blank" rel="noopener">v1.13.9</a>  <br><a href="https://github.com/kubernetes/kubernetes/releases/tag/v1.13.10" target="_blank" rel="noopener">v1.13.10</a></td><td>CVE</td></tr><tr><td>2019-07</td><td><a href="https://github.com/kubernetes/kubernetes/releases/tag/v1.15.1" target="_blank" rel="noopener">v1.15.1</a></td><td><a href="https://github.com/kubernetes/kubernetes/releases/tag/v1.14.4" target="_blank" rel="noopener">v1.14.4</a></td><td><a href="https://github.com/kubernetes/kubernetes/releases/tag/v1.13.8" target="_blank" rel="noopener">v1.13.8</a></td><td><a href="https://github.com/kubernetes/kubernetes/releases/tag/v1.12.10" target="_blank" rel="noopener">v1.12.10</a></td></tr><tr><td>2019-06</td><td><a href="https://github.com/kubernetes/kubernetes/releases/tag/v1.15.0" target="_blank" rel="noopener">v1.15.0</a></td><td><a href="https://github.com/kubernetes/kubernetes/releases/tag/v1.14.3" target="_blank" rel="noopener">v1.14.3</a></td><td><a href="https://github.com/kubernetes/kubernetes/releases/tag/v1.13.7" target="_blank" rel="noopener">v1.13.7</a></td><td></td></tr></tbody></table><h3 id="1-14-10"><a href="#1-14-10" class="headerlink" title="1.14.10"></a>1.14.10</h3><h4 id="ä¸Šæ¸¸è¿›å±•"><a href="#ä¸Šæ¸¸è¿›å±•" class="headerlink" title="ä¸Šæ¸¸è¿›å±•"></a>ä¸Šæ¸¸è¿›å±•</h4><ul><li>å¯¹ Windows Node å’Œ container çš„æ”¯æŒè¾¾åˆ°ç”Ÿäº§çº§åˆ«ï¼Œæ”¯æŒ Windows Server 2019ï¼›</li><li>æœ¬åœ°æŒä¹…åŒ–æ•°æ®å·æ­£å¼å¯ç”¨ï¼Œè¿™å¯ä»¥æ–¹ä¾¿ä½¿ç”¨æœ¬åœ° SSD ä¹‹ç±»çš„å­˜å‚¨ï¼Œä½†æ³¨æ„è¿™ä¸ªç‰¹æ€§å®¹é”™æ€§è¾ƒå·®ï¼›</li><li>Pod ä¼˜å…ˆçº§å’ŒæŠ¢å æœºåˆ¶æ­£å¼å¯ç”¨ï¼Œ(å»ºè®®æ…é‡ä½¿ç”¨)ï¼›</li><li>Pod Ready++ (Pod Readiness Gates) è¾¾åˆ°ç¨³å®šï¼Œå¯ä»¥æ›´å¥½çš„åˆ¤æ–­ Pod åŠå…¶éœ€è¦çš„èµ„æºæ˜¯å¦å‡å·²å°±ç»ªï¼›</li></ul><h3 id="1-15-7"><a href="#1-15-7" class="headerlink" title="1.15.7"></a>1.15.7</h3><h4 id="ä¸Šæ¸¸è¿›å±•-1"><a href="#ä¸Šæ¸¸è¿›å±•-1" class="headerlink" title="ä¸Šæ¸¸è¿›å±•"></a>ä¸Šæ¸¸è¿›å±•</h4><ul><li><p>v1.15 ç‰ˆæœ¬ç”± 25 ä¸ªå¢å¼ºåŠŸèƒ½ç»„æˆï¼Œå…¶ä¸­ 2 ä¸ªç§»åŠ¨åˆ° stable ï¼Œ13 ä¸ª beta ä»¥åŠ 10 ä¸ª alpha ï¼Œæ•´ä½“ä¸Šé›†ä¸­äºç¨³å®šæ€§æ”¹è¿›å’Œæ‰©å±•çš„å¢å¼ºã€‚</p></li><li><p>CRD (Custom Resource Definition) æ˜¯ Kubernetes  æä¾›çš„ä¸€ç§å¯ç”¨äºæ‰©å±•å…¶èƒ½åŠ›çš„æ–¹å¼ï¼Œå½“å‰æœ‰å¾ˆå¤šä½¿ç”¨ CRD æ„å»ºäº Kubernetes ä¸Šçš„å¹³å°/ç³»ç»Ÿï¼Œå¯ä»¥è¯´ä¹‹åå¯¹ Kubernetes  çš„æ‰©å±•ï¼Œæˆ–è€…è¯´æƒ³è¦åŸºäº Kubernetes å¼€å‘ï¼ŒåŒæ—¶åˆæƒ³ä¸ä¸Šæ¸¸ä¿æŒåŒæ­¥çš„è¯ï¼ŒCRD æ˜¯ä¸ªæœ€ä½³çš„é€‰æ‹©ã€‚</p></li><li><p>Kubeadm åœ¨æ­¤ç‰ˆæœ¬å¼€å§‹æœ‰äº†è‡ªå·±ç‹¬ç«‹çš„ LOGO ï¼ŒåŒæ—¶åœ¨è¿™ä¸ªç‰ˆæœ¬ä¸­ kubeadm çš„åŠŸèƒ½ä¹Ÿå¾—åˆ°äº†å¾ˆå¤šçš„å®Œå–„å’Œè¡¥å……ã€‚è¿™ä½¿å¾— kubeadm æˆä¸ºæ›´æ™®é/æ›´å¥½ç”¨çš„æ­å»ºé›†ç¾¤çš„å·¥å…·ï¼ŒåŒæ—¶å¯¹é›†ç¾¤ç”Ÿå‘½å‘¨æœŸçš„ç®¡ç†ä¹Ÿåšçš„æ›´åŠ åˆ°ä½äº†ã€‚</p></li></ul><h3 id="1-16-5"><a href="#1-16-5" class="headerlink" title="1.16.5"></a>1.16.5</h3><h4 id="ä¸Šæ¸¸è¿›å±•-2"><a href="#ä¸Šæ¸¸è¿›å±•-2" class="headerlink" title="ä¸Šæ¸¸è¿›å±•"></a>ä¸Šæ¸¸è¿›å±•</h4><ul><li>CRD è¾¾åˆ° GA ï¼Œè¿™æ˜¯å½“å‰ç¤¾åŒºæœ€ä¸ºæ¨å´‡çš„ä¸€ç§æ‰©å±• Kubernetes çš„æ–¹å¼ï¼Œå¹¶ä¸”è‡ªä» 1.7 åŠ å…¥åï¼Œä¹Ÿè¢«è¶Šæ¥è¶Šå¹¿æ³›çš„ä½¿ç”¨äº†ï¼›</li><li>å‡†å…¥æ§åˆ¶ webhooks è¾¾åˆ° GA ï¼Œå‡†å…¥æ§åˆ¶åœ¨ Kubernetes ä¸­å¤ªè¿‡äºé‡è¦äº†ï¼Œè‡ª 1.9 è¯¥åŠŸèƒ½åŠ å…¥ä»¥æ¥ï¼Œè¢«å¹¿æ³›ç”¨äºæ‰©å±• Kubernetes ç›¸å…³åŠŸèƒ½ï¼›</li><li>ç°åœ¨ CSI è§„èŒƒä¸­æ”¯æŒè°ƒæ•´å·å¤§å°ï¼Œå½“å‰æ­£åœ¨è¿ç§»è‡³ Beta é˜¶æ®µï¼›</li><li>IPv4/IPv6 åŒæ ˆæ”¯æŒï¼›</li><li>ä¸ºäº†æ›´å¥½çš„æ§åˆ¶ kube-apiserver çš„ç½‘ç»œæµé‡ï¼Œæ­£åœ¨å°è¯•ç»™å®ƒå¢åŠ ä¸€ä¸ª<a href="https://github.com/kubernetes/enhancements/blob/master/keps/sig-api-machinery/20190226-network-proxy.md" target="_blank" rel="noopener">ä»£ç†</a>ï¼Œè¯¦æƒ…å¯ç‚¹å‡»é“¾æ¥æŸ¥çœ‹ï¼›</li><li>ç°åœ¨ kubeadm  åœ¨ TLS bootstrap ä¹‹åï¼Œå°†ä¼šåˆ é™¤ <code>bootstrap-kubelet.conf</code>ï¼Œå¦‚æœæœ‰ä¾èµ–æ­¤æ–‡ä»¶çš„å°ä¼™ä¼´ï¼Œè¯·å°½å¿«è¿ç§»ä½¿ç”¨ <code>kubelet.conf</code> ï¼Œæ­¤å¤–ä¹Ÿå»ºè®®å…ˆçœ‹çœ‹ RBAC ç›¸å…³çš„å†…å®¹ï¼Œäº†è§£ä¸‹åˆ‡æ¢çš„æ„ä¹‰ï¼›</li><li><code>beta.kubernetes.io/metadata-proxy-ready</code> å’Œ <code>beta.kubernetes.io/kube-proxy-ds-ready</code> éƒ½è¢«ç§»é™¤äº†ï¼›</li><li>è¿˜æœ‰ä¹‹å‰æåˆ°è¿‡çš„ <code>pps/v1beta1</code> å’Œ <code>apps/v1beta2</code> å·²ç»è¢« <code>apps/v1</code> å–ä»£ç­‰ï¼Œè¿™é‡Œä¸å†ä¸€ä¸€åˆ—ä¸¾äº†ï¼Œæœ‰å…´è¶£å¯å‚è€ƒä¹‹å‰çš„å‘¨æŠ¥å†…å®¹ã€‚</li></ul><h3 id="1-17-0"><a href="#1-17-0" class="headerlink" title="1.17.0"></a>1.17.0</h3><h4 id="ä¸Šæ¸¸è¿›å±•-3"><a href="#ä¸Šæ¸¸è¿›å±•-3" class="headerlink" title="ä¸Šæ¸¸è¿›å±•"></a>ä¸Šæ¸¸è¿›å±•</h4><ul><li><p>Kubernetes v1.17 åŒ…å« 22 ä¸ªå¢å¼ºåŠŸèƒ½ï¼Œå…¶ä¸­ 14 ä¸ªå·²ç» stable ï¼Œ4 ä¸ª beta ä»¥åŠå‰©ä½™ 4 ä¸ª alpha ã€‚</p></li><li><p><a href="https://github.com/kubernetes/kubernetes/pull/87714" target="_blank" rel="noopener">#87714</a> kubectl çš„ <code>--server-dry-run</code> è¢«æ ‡è®°ä¸ºåºŸå¼ƒï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡ä½¿ç”¨ <code>--dry-run=server</code> æ›¿ä»£ã€‚å¹¶ä¸” kubectl çš„ <code>--dry-run</code> å‚æ•°æ¥æ”¶çš„å€¼ï¼Œä¹Ÿå˜æˆäº† <code>client</code>, <code>server</code> ä»¥åŠ <code>none</code>ï¼›</p></li><li><p><a href="https://github.com/kubernetes/kubernetes/pull/86810" target="_blank" rel="noopener">#86810</a> <code>kubeadm config images list</code> å®ç°äº†ç»“æ„åŒ–è¾“å‡ºï¼Œæ”¯æŒæ–‡æœ¬ï¼ŒJSONï¼ŒYAML å’Œ GO æ¨¡æ¿ç­‰ã€‚ï¼ˆæˆ‘ä¸ªäººè®¤ä¸ºï¼Œè¿™ä¸ªåŠŸèƒ½ä¸é”™çš„ï¼Œä½†ç›®å‰æˆ‘è¿˜æ²¡æƒ³åˆ°ä»€ä¹ˆæƒ…å†µä¸‹æˆ‘ä¼šéœ€è¦å®ƒï¼‰ï¼›</p></li><li><p><a href="https://github.com/kubernetes/kubernetes/pull/87975" target="_blank" rel="noopener">#87975</a> <code>kubeadm upgrade node config</code> ä» v1.15 èµ·æ ‡è®°åºŸå¼ƒï¼Œç°åœ¨æ­£å¼ç§»é™¤ï¼Œè¯·ä½¿ç”¨ <code>kubeadm upgrade node phase kubelet-config</code> ä»£æ›¿ã€‚</p></li></ul><p><code>å…³äºä¸Šæœ‰è¿›å±•å¼•ç”¨è‡ª</code> <a href="https://moelove.info/" target="_blank" rel="noopener">K8sç”Ÿæ€å‘¨æŠ¥</a> ï¼Œæ¨èå„ä½å»å…³æ³¨ã€‚</p><h2 id="èŠ‚ç‚¹-OS"><a href="#èŠ‚ç‚¹-OS" class="headerlink" title="èŠ‚ç‚¹ OS"></a>èŠ‚ç‚¹ OS</h2><h3 id="Photon-OS"><a href="#Photon-OS" class="headerlink" title="Photon OS"></a><a href="https://vmware.github.io/photon/" target="_blank" rel="noopener">Photon OS</a></h3><h4 id="ç‰¹æ€§"><a href="#ç‰¹æ€§" class="headerlink" title="ç‰¹æ€§"></a>ç‰¹æ€§</h4><p>Photon OS æ˜¯ VMware å›¢é˜Ÿå¯¹ vSphere ESXi è™šæ‹ŸåŒ–å¹³å°ä¸“é—¨æ‰“é€ çš„å®¹å™¨ä¼˜åŒ–å‹æ“ä½œç³»ç»Ÿï¼Œä»ç›®å‰çš„ä½¿ç”¨æ¥çœ‹æ˜¯åŸºäº RHEL æˆ– CentOS ç³»çš„å‘è¡Œç‰ˆã€‚é’ˆå¯¹ ESXi è™šæ‹Ÿèƒ¡ä¼˜åŒ–å†…æ ¸ï¼Œç†è®ºä¸Šåœ¨ vSphere ESXi è™šæ‹ŸåŒ–ä¸Š Photon OS è¦æ¯”ä¼ ç»Ÿçš„ CentOS/Ubuntu å‘è¡Œç‰ˆæ€§èƒ½è¦å¥½ä¸€äº›ï¼Œç³»ç»Ÿå ç”¨çš„èµ„æºä¹Ÿå°‘ä¸€äº›ã€‚å¦å¤– Photon OS V3.0 çš„å†…æ ¸æ˜¯ 4.19 ç‰ˆæœ¬çš„ï¼Œä½¿ç”¨æ–¹å¼å’Œ CentOS å·®åˆ«ä¸å¤§ã€‚</p><blockquote><p>Photon OSâ„¢ is an open source Linux container host optimized for cloud-native applications, cloud platforms, and VMware infrastructure. Photon OS provides a secure run-time environment for efficiently running containers. Some of the key highlights of Photon OS are:</p><ul><li>Optimized for VMware hypervisor: The Linux kernel is tuned for performance when Photon OS runs on VMware ESXi.</li><li>Support for containers: Photon OS includes the Docker daemon and works with container orchestration frameworks, such as Mesos and Kubernetes.</li><li>Efficient lifecycle management: Photon OS is easy to manage, patch, and update, using the <a href="https://github.com/vmware/photon/blob/master/docs/photon-admin-guide.md#tiny-dnf-for-package-management" target="_blank" rel="noopener">tdnf package manager</a> and the <a href="https://github.com/vmware/pmd" target="_blank" rel="noopener">Photon Management Daemon (pmd)</a>.</li><li>Security hardened: Photon OS provides secure and up-to-date kernel and other packages, and its policies are designed to govern the system securely.</li></ul><p>For an overview of Photon OS, see <a href="https://vmware.github.io/photon/" target="_blank" rel="noopener">https://vmware.github.io/photon/</a></p></blockquote><h3 id="CoreOS"><a href="#CoreOS" class="headerlink" title="CoreOS"></a><a href="https://coreos.com/" target="_blank" rel="noopener">CoreOS</a></h3><p>CoreOS æ˜¯ä»¥å®‰å…¨æ€§ã€ä¸€è‡´æ€§ã€å¯é æ€§ä¸ºè®¾è®¡ç›®æ ‡çš„ä¸€æ¬¾æ“ä½œç³»ç»Ÿã€‚å› ä¸ºCoreOSçš„è®¾è®¡åˆè¡·åªä¸ºè¿è¡Œåº”ç”¨å®¹å™¨ï¼Œå› æ­¤éœ€è¦å®‰è£…å¾ˆå°‘ç³»ç»Ÿçº§åˆ«çš„ä¾èµ–åŒ…å³å¯ã€‚ç›¸æ¯”å…¸å‹çš„LinuxæœåŠ¡å™¨ï¼Œè¿™å°±æ„å‘³ç€CoreOSéœ€è¦å¾ˆä½è€—çš„CPUå’Œé«˜æ•ˆçš„RAMå³å¯æ»¡è¶³éœ€æ±‚ã€‚CoreOS å‡ ä¹å¯ä»¥è¿è¡Œåœ¨åŒ…æ‹¬ <a href="https://coreos.com/products/" target="_blank" rel="noopener">Vagrant</a>, <a href="https://coreos.com/os/docs/latest/booting-on-ec2.html" target="_blank" rel="noopener">Amazon EC2</a>, <a href="https://coreos.com/docs/qemu/" target="_blank" rel="noopener">QEMU/KVM</a>, <a href="https://coreos.com/docs/vmware/" target="_blank" rel="noopener">VMware</a>, <a href="https://coreos.com/docs/openstack/" target="_blank" rel="noopener">OpenStack</a> çš„ä»»ä½•å¹³å°ï¼Œç”šè‡³åœ¨æœªå®‰è£…ä»»ä½•è½¯ä»¶çš„è£¸æœºç¡¬ä»¶ç¯å¢ƒéƒ½å¯ä»¥ã€‚</p><ul><li>æœ€å°åŒ–æ“ä½œç³»ç»Ÿï¼šCoreOS è¢«è®¾è®¡æˆä¸€ä¸ªåŸºäºå®¹å™¨çš„æœ€å°åŒ–çš„ç°ä»£æ“ä½œç³»ç»Ÿã€‚å®ƒæ¯”ç°æœ‰çš„ Linux å®‰è£…å¹³å‡èŠ‚çœ 40% çš„ RAMï¼ˆå¤§çº¦ 114M ï¼‰å¹¶å…è®¸ä» PXE æˆ– iPXE éå¸¸å¿«é€Ÿçš„å¯åŠ¨ã€‚</li><li>CoreOS é‡‡ç”¨ä¸»åŠ¨/è¢«åŠ¨åŒåˆ†åŒºæ–¹æ¡ˆæ¥å®ç°è‡ªåŠ¨æ›´æ–°ã€‚è‡ªåŠ¨æ›´æ–°ä»¥å•ä¸€ä½“ä¸ºå•ä½ï¼Œè€Œä¸æ˜¯é€šè¿‡é€åŒ…æ›¿æ¢çš„æ–¹å¼è¿›è¡Œã€‚ç¨åæˆ‘ä»¬å°†è¯¦ç»†ä»‹ç»è¿™ä¸ªã€‚</li><li>CoreOS ä½¿ç”¨ Linux å®¹å™¨åœ¨æ›´é«˜æŠ½è±¡å±‚æ¬¡ä¸Šç®¡ç†æœåŠ¡ï¼Œè€Œæ²¡æœ‰é‡‡ç”¨é€šè¿‡ yum æˆ–è€… APT å·¥å…·åšåŒ…çš„å®‰è£…ç®¡ç†ã€‚å•ä¸€çš„æœåŠ¡ä»£ç ä»¥åŠå®ƒæ‰€æœ‰çš„ä¾èµ–ä¼šè¢«æ‰“åŒ…åˆ°ä¸€ä¸ªå®¹å™¨ä¸­ï¼Œæ‰“åŒ…è¿›å…¥å®¹å™¨åå°±å¯ä»¥è¿è¡Œåœ¨å•ä¸€çš„CoreOS æœºå™¨ï¼Œä¹Ÿå¯ä»¥è¿è¡Œåœ¨ CoreOS é›†ç¾¤ä¸­ã€‚</li><li>Linux å®¹å™¨æä¾›ä¸å®Œæ•´è™šæ‹Ÿæœºç›¸ä¼¼çš„åŠŸèƒ½ã€‚ä½†æ˜¯å®¹å™¨èšç„¦åœ¨åº”ç”¨ç¨‹åºå±‚æ¬¡ï¼Œè€Œä¸æ˜¯æ•´ä¸ªè™šæ‹Ÿä¸»æœºå±‚æ¬¡ã€‚å› ä¸ºå®¹å™¨ä¸èƒ½è¿è¡Œç‹¬ç«‹çš„Linuxå†…æ ¸ï¼Œä¸éœ€è¦ä¸€ä¸ªä¸­é—´ä»¶å±‚ï¼Œå› æ­¤å®ƒå‡ ä¹æ²¡æœ‰æ€§èƒ½ä¸Šçš„å¼€é”€ã€‚ä½æ€§èƒ½å¼€é”€çš„ç‰¹è´¨æ„å‘³ç€å¯ä»¥éƒ¨ç½²æ›´å°‘çš„æœºå™¨ã€ä½¿ç”¨é…ç½®ä½çš„æœºå™¨å°±å¯ä»¥å®Œæˆè™šæ‹ŸæœºåŒæ ·çš„åŠŸèƒ½ï¼Œä»è€Œé™ä½æˆæœ¬ã€‚</li></ul><h3 id="Rancher-OS"><a href="#Rancher-OS" class="headerlink" title="Rancher OS"></a>Rancher OS</h3><p>RancherOS æ˜¯ Rancher å›¢é˜Ÿæ‰€ç»´æŠ¤çš„å¼€æºé¡¹ç›®ï¼Œä¹Ÿæ˜¯å¯¹æ ‡ CoreOS ä¸€æ ·ï¼Œä¸“é—¨ç”¨æ¥è¿è¡Œå®¹å™¨ï¼Œå¹¶ä¸”å¯ä»¥è¿è¡Œåœ¨ç”Ÿäº§ç¯å¢ƒï¼ˆè‡³å°‘å®˜æ–¹åšäº†è¿™ä¹ˆæ ·çš„æ‰¿è¯ºï¼Œå’±ä¹Ÿæ²¡åœ¨ç”Ÿäº§ç”¨è¿‡ï¼Œä¸å¥½è¯´ã€‚åœ¨ RancherOS ä¸­æ‰€æœ‰çš„è¿›ç¨‹ï¼ˆåŒ…æ‹¬ç³»ç»Ÿæ‰€æœ‰çš„æœåŠ¡ï¼Œæ¯”å¦‚ udev å’Œ syslogï¼‰éƒ½æ˜¯ç”¨ docker æ¥ç®¡ç†ï¼Œè¿™ä¸€ç‚¹è¦æ¯” CoreOS æ›´åŠ æ¿€è¿›ä¸€äº›ï¼Œè€Œ CoreOS è¿˜æ˜¯ä½¿ç”¨ä¼ ç»Ÿ Linux å‘è¡Œç‰ˆä¸­çš„ systemd æ¥ç®¡ç†ç³»ç»Ÿä¸­çš„æœåŠ¡ã€‚é€šè¿‡ç§»é™¤ä¼ ç»Ÿ Linux å‘è¡Œç‰ˆä¸­ä¸å¿…è¦çš„æœåŠ¡å’Œåº“æ¥æœ€å°åŒ–ç³»ç»Ÿï¼Œä½¿ä»–ä¸“æ³¨å•ä¸€çš„åŠŸèƒ½ï¼Œå³è¿è¡Œ docker å®¹å™¨ã€‚</p><blockquote><p>RancherOS is the smallest, easiest way to run Docker in production. Every process in RancherOS is a container managed by Docker. This includes system services such as <code>udev</code> and <code>syslog</code>. Because it only includes the services necessary to run Docker, RancherOS is significantly smaller than most traditional operating systems. By removing unnecessary libraries and services, requirements for security patches and other maintenance are also reduced. This is possible because, with Docker, users typically package all necessary libraries into their containers.</p><p>Another way in which RancherOS is designed specifically for running Docker is that it always runs the latest version of Docker. This allows users to take advantage of the latest Docker capabilities and bug fixes.</p><p>Like other minimalist Linux distributions, RancherOS boots incredibly quickly. Starting Docker containers is nearly instant, similar to starting any other process. This speed is ideal for organizations adopting microservices and autoscaling.</p><p>Docker is an open-source platform designed for developers, system admins, and DevOps. It is used to build, ship, and run containers, using a simple and powerful command line interface (CLI). To get started with Docker, please visit the <a href="https://docs.docker.com/engine/userguide/" target="_blank" rel="noopener">Docker user guide</a>.</p></blockquote><h2 id="é«˜å¯ç”¨æ¶æ„"><a href="#é«˜å¯ç”¨æ¶æ„" class="headerlink" title="é«˜å¯ç”¨æ¶æ„"></a>é«˜å¯ç”¨æ¶æ„</h2><h3 id="å‚è€ƒ-1"><a href="#å‚è€ƒ-1" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><ul><li><a href="https://jishu.io/kubernetes/kubernetes-master-ha/" target="_blank" rel="noopener">å…³äºKubernetes Masteré«˜å¯ç”¨çš„ä¸€äº›ç­–ç•¥</a></li></ul><p>è¿™å¼ å›¾ä»ç®¡ç†å¹³é¢ã€æ‰§è¡Œå¹³é¢å’Œæ•°æ®å¹³é¢ ä¸‰ä¸ªéƒ¨åˆ†æ¥ç®€å•è¯´æ˜ä¸€ä¸‹è¯¥é«˜å¯ç”¨æ¶æ„æ–¹æ¡ˆä»¥åŠå„ä¸ªç»„ä»¶çš„åŠŸèƒ½ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/image-20191227151129673.png" alt="image-20191227151129673"></p><h3 id="etcd-é«˜å¯ç”¨"><a href="#etcd-é«˜å¯ç”¨" class="headerlink" title="etcd é«˜å¯ç”¨"></a>etcd é«˜å¯ç”¨</h3><p>etcd æ˜¯ Kubernetes å½“ä¸­å”¯ä¸€å¸¦çŠ¶æ€çš„æœåŠ¡ï¼Œä¹Ÿæ˜¯é«˜å¯ç”¨çš„éš¾ç‚¹ã€‚Kubernetes é€‰ç”¨ etcd ä½œä¸ºå®ƒçš„åç«¯æ•°æ®å­˜å‚¨ä»“åº“æ­£æ˜¯çœ‹é‡äº†å…¶ä½¿ç”¨åˆ†å¸ƒå¼æ¶æ„ï¼Œæ²¡æœ‰å•ç‚¹æ•…éšœçš„ç‰¹æ€§ã€‚etcd çš„é«˜å¯ç”¨åŸºæœ¬æœ‰ä¸‰ç§æ€è·¯ï¼š</p><h4 id="ç‹¬ç«‹çš„-etcd-é›†ç¾¤"><a href="#ç‹¬ç«‹çš„-etcd-é›†ç¾¤" class="headerlink" title="ç‹¬ç«‹çš„ etcd é›†ç¾¤"></a>ç‹¬ç«‹çš„ etcd é›†ç¾¤</h4><p>ä½¿ç”¨ 3 å°æˆ–è€… 5 å°æœåŠ¡å™¨åªè¿è¡Œ etcdï¼Œç‹¬ç«‹ç»´æŠ¤å’Œå‡çº§ã€‚ç”šè‡³å¯ä»¥ä½¿ç”¨ CoreOS çš„<code>update-engine</code>å’Œ<code>locksmith</code>ï¼Œè®©æœåŠ¡å™¨å®Œå…¨è‡ªä¸»çš„å®Œæˆå‡çº§ã€‚è¿™ä¸ª etcd é›†ç¾¤å°†ä½œä¸ºåŸºçŸ³ç”¨äºæ„å»ºæ•´ä¸ªé›†ç¾¤ã€‚ é‡‡ç”¨è¿™é¡¹ç­–ç•¥çš„ä¸»è¦åŠ¨æœºæ˜¯ etcd é›†ç¾¤çš„èŠ‚ç‚¹å¢å‡éƒ½éœ€è¦æ˜¾å¼çš„é€šçŸ¥é›†ç¾¤ï¼Œä¿è¯ etcd é›†ç¾¤èŠ‚ç‚¹ç¨³å®šå¯ä»¥æ›´æ–¹ä¾¿çš„ç”¨ç¨‹åºå®Œæˆé›†ç¾¤æ»šåŠ¨å‡çº§ï¼Œå‡è½»ç»´æŠ¤è´Ÿæ‹…ã€‚</p><h4 id="Master-èŠ‚ç‚¹-static-pod-å½¢å¼"><a href="#Master-èŠ‚ç‚¹-static-pod-å½¢å¼" class="headerlink" title="Master èŠ‚ç‚¹ static pod å½¢å¼"></a>Master èŠ‚ç‚¹ static pod å½¢å¼</h4><p>äºŒæ˜¯åœ¨ Kubernetes Masterä¸Šç”¨ static pod çš„å½¢å¼æ¥è¿è¡Œ etcdï¼Œå¹¶å°†å¤šå° Kubernetes Masterä¸Šçš„ etcd ç»„æˆé›†ç¾¤ã€‚ åœ¨è¿™ä¸€æ¨¡å¼ä¸‹ï¼Œå„ä¸ªæœåŠ¡å™¨çš„ etcd å®ä¾‹è¢«æ³¨å†Œè¿›äº† Kubernetes å½“ä¸­ï¼Œè™½ç„¶æ— æ³•ç›´æ¥ä½¿ç”¨<code>kubectl</code>æ¥ç®¡ç†è¿™éƒ¨åˆ†å®ä¾‹ï¼Œä½†æ˜¯ç›‘æ§ä»¥åŠæ—¥å¿—æœé›†ç»„ä»¶å‡å¯æ­£å¸¸å·¥ä½œã€‚åœ¨è¿™ä¸€æ¨¡å¼è¿è¡Œä¸‹çš„ etcd å¯ç®¡ç†æ€§æ›´å¼ºã€‚</p><h4 id="self-hosted-etcdæ–¹æ¡ˆ"><a href="#self-hosted-etcdæ–¹æ¡ˆ" class="headerlink" title="self-hosted etcdæ–¹æ¡ˆ"></a>self-hosted etcdæ–¹æ¡ˆ</h4><p>ä¸‰æ˜¯ä½¿ç”¨ CoreOS æå‡ºçš„ <a href="https://github.com/kubernetes-incubator/bootkube/issues/31" target="_blank" rel="noopener">self-hosted etcdæ–¹æ¡ˆ</a>ï¼Œå°†æœ¬åº”åœ¨åº•å±‚ä¸º Kubernetes æä¾›æœåŠ¡çš„ etcd è¿è¡Œåœ¨Kubernetes ä¹‹ä¸Šã€‚ å®ç° Kubernetes å¯¹è‡ªèº«ä¾èµ–ç»„ä»¶çš„ç®¡ç†ã€‚åœ¨è¿™ä¸€æ¨¡å¼ä¸‹çš„ etcd é›†ç¾¤å¯ä»¥ç›´æ¥ä½¿ç”¨ <a href="https://github.com/coreos/etcd-operator" target="_blank" rel="noopener">etcd-operator</a> æ¥è‡ªåŠ¨åŒ–è¿ç»´ï¼Œæœ€ç¬¦åˆ Kubernetes çš„ä½¿ç”¨ä¹ æƒ¯ã€‚</p><p>è¿™ä¸‰ç§æ€è·¯å‡å¯ä»¥å®ç° etcd é«˜å¯ç”¨çš„ç›®æ ‡ï¼Œä½†æ˜¯åœ¨é€‰æ‹©è¿‡ç¨‹ä¸­å´è¦æ ¹æ®å®é™…æƒ…å†µåšå‡ºä¸€äº›åˆ¤æ–­ã€‚ç®€å•æ¥è®²ç¡¬ä»¶èµ„æºå……è¶³ä½†ä¿å®ˆçš„é¡¹ç›®é€‰æ–¹æ¡ˆä¸€ï¼Œ æƒ³ä¸€æ­¥åˆ°ä½å¹¶æ„¿æ„æ‰¿æ‹…ä¸€å®šé£é™©çš„é¡¹ç›®é€‰æ–¹æ¡ˆä¸‰ã€‚æŠ˜ä¸­ä¸€ç‚¹é€‰æ–¹æ¡ˆäºŒã€‚</p><h3 id="kube-apiserver-é«˜å¯ç”¨"><a href="#kube-apiserver-é«˜å¯ç”¨" class="headerlink" title="kube-apiserver  é«˜å¯ç”¨"></a>kube-apiserver  é«˜å¯ç”¨</h3><p>apiserver æœ¬èº«æ˜¯ä¸€ä¸ªæ— çŠ¶æ€æœåŠ¡ï¼Œè¦å®ç°å…¶é«˜å¯ç”¨ç›¸å¯¹è¦å®¹æ˜“ä¸€äº›ï¼Œéš¾ç‚¹åœ¨äºå¦‚ä½•å°†è¿è¡Œåœ¨å¤šå°æœåŠ¡å™¨ä¸Šçš„apiserver ç”¨ä¸€ä¸ªç»Ÿä¸€çš„å¤–éƒ¨å…¥å£æš´éœ²ç»™æ‰€æœ‰NodeèŠ‚ç‚¹ã€‚</p><p>è¯´æ˜¯éš¾ç‚¹ï¼Œå…¶å®å¯¹äºè¿™ç§æ— çŠ¶æ€æœåŠ¡çš„é«˜å¯ç”¨ï¼Œæˆ‘ä»¬åœ¨è®¾è®¡ä¸šåŠ¡ç³»ç»Ÿçš„é«˜å¯ç”¨æ–¹æ¡ˆæ—¶å·²ç»æœ‰äº†ç›¸å½“å¤šçš„ç»éªŒç§¯ç´¯ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ apiserver æ‰€ä½¿ç”¨çš„ SSL è¯ä¹¦è¦åŒ…å«å¤–éƒ¨å…¥å£çš„åœ°å€ï¼Œä¸ç„¶ Node èŠ‚ç‚¹æ— æ³•æ­£å¸¸è®¿é—® apiserverã€‚</p><p>apiserver çš„é«˜å¯ç”¨ä¹Ÿæœ‰ä¸‰ç§åŸºæœ¬æ€è·¯ï¼š</p><h4 id="ä½¿ç”¨å¤–éƒ¨è´Ÿè½½å‡è¡¡å™¨"><a href="#ä½¿ç”¨å¤–éƒ¨è´Ÿè½½å‡è¡¡å™¨" class="headerlink" title="ä½¿ç”¨å¤–éƒ¨è´Ÿè½½å‡è¡¡å™¨"></a>ä½¿ç”¨å¤–éƒ¨è´Ÿè½½å‡è¡¡å™¨</h4><p>ä¸€æ˜¯ä½¿ç”¨å¤–éƒ¨è´Ÿè½½å‡è¡¡å™¨ï¼Œä¸ç®¡æ˜¯ä½¿ç”¨å…¬æœ‰äº‘æä¾›çš„è´Ÿè½½å‡è¡¡å™¨æœåŠ¡æˆ–æ˜¯åœ¨ç§æœ‰äº‘ä¸­ä½¿ç”¨<code>LVS</code>æˆ–è€…<code>HaProxy</code>è‡ªå»ºè´Ÿè½½å‡è¡¡å™¨éƒ½å¯ä»¥å½’åˆ°è¿™ä¸€ç±»ã€‚ è´Ÿè½½å‡è¡¡å™¨æ˜¯éå¸¸æˆç†Ÿçš„æ–¹æ¡ˆï¼Œåœ¨è¿™é‡Œç•¥è¿‡ä¸åšè¿‡å¤šä»‹ç»ã€‚å¦‚ä½•ä¿è¯è´Ÿè½½å‡è¡¡å™¨çš„é«˜å¯ç”¨ï¼Œåˆ™æ˜¯é€‰æ‹©è¿™ä¸€æ–¹æ¡ˆéœ€è¦è€ƒè™‘çš„æ–°é—®é¢˜ã€‚</p><h4 id="åœ¨ç½‘ç»œå±‚åšè´Ÿè½½å‡è¡¡"><a href="#åœ¨ç½‘ç»œå±‚åšè´Ÿè½½å‡è¡¡" class="headerlink" title="åœ¨ç½‘ç»œå±‚åšè´Ÿè½½å‡è¡¡"></a>åœ¨ç½‘ç»œå±‚åšè´Ÿè½½å‡è¡¡</h4><p>äºŒæ˜¯åœ¨ç½‘ç»œå±‚åšè´Ÿè½½å‡è¡¡ã€‚æ¯”å¦‚åœ¨ Master èŠ‚ç‚¹ä¸Šç”¨<code>BGP</code>åš<code>ECMP</code>ï¼Œæˆ–è€…åœ¨NodeèŠ‚ç‚¹ä¸Šç”¨<code>iptables</code>åšNATéƒ½å¯ä»¥å®ç°ã€‚é‡‡ç”¨è¿™ä¸€æ–¹æ¡ˆä¸éœ€è¦é¢å¤–çš„å¤–éƒ¨æœåŠ¡ï¼Œä½†æ˜¯å¯¹ç½‘ç»œé…ç½®æœ‰ä¸€å®šçš„è¦æ±‚ã€‚</p><h4 id="åœ¨-Node-èŠ‚ç‚¹ä¸Šä½¿ç”¨åå‘ä»£ç†å¯¹å¤šä¸ª-Master-åšè´Ÿè½½å‡è¡¡"><a href="#åœ¨-Node-èŠ‚ç‚¹ä¸Šä½¿ç”¨åå‘ä»£ç†å¯¹å¤šä¸ª-Master-åšè´Ÿè½½å‡è¡¡" class="headerlink" title="åœ¨ Node èŠ‚ç‚¹ä¸Šä½¿ç”¨åå‘ä»£ç†å¯¹å¤šä¸ª Master åšè´Ÿè½½å‡è¡¡"></a>åœ¨ Node èŠ‚ç‚¹ä¸Šä½¿ç”¨åå‘ä»£ç†å¯¹å¤šä¸ª Master åšè´Ÿè½½å‡è¡¡</h4><p>ä¸‰æ˜¯åœ¨ Node èŠ‚ç‚¹ä¸Šä½¿ç”¨åå‘ä»£ç†å¯¹å¤šä¸ª Master åšè´Ÿè½½å‡è¡¡ã€‚è¿™ä¸€æ–¹æ¡ˆåŒæ ·ä¸éœ€è¦ä¾èµ–å¤–éƒ¨çš„ç»„ä»¶ï¼Œä½†æ˜¯å½“Master èŠ‚ç‚¹æœ‰å¢å‡æ—¶ï¼Œå¦‚ä½•åŠ¨æ€é…ç½® Node èŠ‚ç‚¹ä¸Šçš„è´Ÿè½½å‡è¡¡å™¨æˆä¸ºäº†å¦å¤–ä¸€ä¸ªéœ€è¦è§£å†³çš„é—®é¢˜ã€‚</p><p>ä»ç›®å‰å„ä¸ªé›†ç¾¤ç®¡ç†å·¥å…·çš„é€‰æ‹©æ¥çœ‹ï¼Œè¿™ä¸‰ç§æ¨¡å¼éƒ½æœ‰è¢«ä½¿ç”¨ï¼Œç›®å‰è¿˜æ²¡æœ‰æ˜ç¡®çš„æ¨èæ–¹æ¡ˆäº§ç”Ÿã€‚å»ºè®®åœ¨å…¬æœ‰äº‘ä¸Šçš„é›†ç¾¤å¤šè€ƒè™‘ç¬¬ä¸€ç§æ¨¡å¼ï¼Œåœ¨ç§æœ‰äº‘ç¯å¢ƒä¸­ç”±äºç»´æŠ¤é¢å¤–çš„è´Ÿè½½å‡è¡¡å™¨ä¹Ÿæ˜¯ä¸€é¡¹è´Ÿæ‹…ï¼Œå»ºè®®è€ƒè™‘ç¬¬äºŒç§æˆ–æ˜¯ç¬¬ä¸‰ç§æ–¹æ¡ˆã€‚</p><h3 id="Kube-dns-é«˜å¯ç”¨"><a href="#Kube-dns-é«˜å¯ç”¨" class="headerlink" title="Kube-dns  é«˜å¯ç”¨"></a>Kube-dns  é«˜å¯ç”¨</h3><p>ä¸¥æ ¼æ¥è¯´ kube-dns å¹¶ä¸ç®—æ˜¯ Master ç»„ä»¶çš„ä¸€éƒ¨åˆ†ï¼Œå› ä¸ºå®ƒæ˜¯å¯ä»¥è·‘åœ¨ Node èŠ‚ç‚¹ä¸Šï¼Œå¹¶ç”¨<code>Service</code>å‘é›†ç¾¤å†…éƒ¨æä¾›æœåŠ¡çš„ã€‚ä½†åœ¨å®é™…ç¯å¢ƒä¸­ï¼Œ ç”±äºé»˜è®¤é…ç½®åªè¿è¡Œäº†ä¸€ä»½ kube-dns å®ä¾‹ï¼Œåœ¨å…¶å‡çº§æˆ–æ˜¯æ‰€åœ¨èŠ‚ç‚¹å½“æœºæ—¶ï¼Œä¼šå‡ºç°é›†ç¾¤å†…éƒ¨ dns æœåŠ¡ä¸å¯ç”¨çš„æƒ…å†µï¼Œä¸¥é‡æ—¶ä¼šå½±å“åˆ°çº¿ä¸ŠæœåŠ¡çš„æ­£å¸¸è¿è¡Œã€‚</p><p>ä¸ºäº†é¿å…æ•…éšœï¼Œè¯·å°† kube-dns çš„<code>replicas</code>å€¼è®¾ä¸º 2 æˆ–è€…æ›´å¤šï¼Œå¹¶ç”¨<code>anti-affinity</code>å°†ä»–ä»¬éƒ¨ç½²åœ¨ä¸åŒçš„ Node èŠ‚ç‚¹ä¸Šã€‚è¿™é¡¹æ“ä½œæ¯”è¾ƒå®¹æ˜“è¢«ç–å¿½ï¼Œç›´åˆ°å‡ºç°æ•…éšœæ—¶æ‰å‘ç°åŸæ¥æ˜¯ kube-dns åªè¿è¡Œäº†ä¸€ä»½å®ä¾‹å¯¼è‡´çš„æ•…éšœã€‚</p><h3 id="kube-controller-manager-ä¸-kube-scheduleré«˜å¯ç”¨"><a href="#kube-controller-manager-ä¸-kube-scheduleré«˜å¯ç”¨" class="headerlink" title="kube-controller-manager ä¸ kube-scheduleré«˜å¯ç”¨"></a>kube-controller-manager ä¸ kube-scheduleré«˜å¯ç”¨</h3><p>è¿™ä¸¤é¡¹æœåŠ¡æ˜¯ Master èŠ‚ç‚¹çš„ä¸€éƒ¨åˆ†ï¼Œä»–ä»¬çš„é«˜å¯ç”¨ç›¸å¯¹å®¹æ˜“ï¼Œä»…éœ€è¦è¿è¡Œå¤šä»½å®ä¾‹å³å¯ã€‚è¿™äº›å®ä¾‹ä¼šé€šè¿‡å‘ apiserver ä¸­çš„<code>Endpoint</code>åŠ é”çš„æ–¹å¼æ¥è¿›è¡Œ leader electionï¼Œ å½“ç›®å‰æ‹¿åˆ° leader çš„å®ä¾‹æ— æ³•æ­£å¸¸å·¥ä½œæ—¶ï¼Œåˆ«çš„å®ä¾‹ä¼šæ‹¿åˆ°é”ï¼Œå˜ä¸ºæ–°çš„leaderã€‚</p><p>ç›®å‰åœ¨å¤šä¸ª Master èŠ‚ç‚¹ä¸Šé‡‡ç”¨ static pod æ¨¡å¼éƒ¨ç½²è¿™ä¸¤é¡¹æœåŠ¡çš„æ–¹æ¡ˆæ¯”è¾ƒå¸¸è§ï¼Œæ¿€è¿›ä¸€ç‚¹ä¹Ÿå¯ä»¥é‡‡ç”¨ self-hosted çš„æ¨¡å¼ï¼Œåœ¨ Kubernetes ä¹‹ä¸Šç”¨<code>DaemonSet</code>æˆ–è€…<code>Deployment</code>æ¥éƒ¨ç½²ã€‚</p><h2 id="ç½‘ç»œæ’ä»¶"><a href="#ç½‘ç»œæ’ä»¶" class="headerlink" title="ç½‘ç»œæ’ä»¶"></a>ç½‘ç»œæ’ä»¶</h2><h3 id="å‚è€ƒ-2"><a href="#å‚è€ƒ-2" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><ul><li><a href="https://ieevee.com/tech/2017/08/12/k8s-flannel-src.html" target="_blank" rel="noopener">kubernetes flannelä»£ç è§£æ</a></li><li><a href="https://cizixs.com/2016/07/16/flannel-source-code-insight/" target="_blank" rel="noopener">flannel æºç åˆ†æ</a></li><li><a href="http://www.sel.zju.edu.cn/?p=690" target="_blank" rel="noopener">æŠ€æœ¯å¹²è´§|æ·±å…¥ç†è§£flannel</a></li><li><a href="http://dockone.io/article/618" target="_blank" rel="noopener">DockOneæŠ€æœ¯åˆ†äº«ï¼ˆåå…«ï¼‰ï¼šä¸€ç¯‡æ–‡ç« å¸¦ä½ äº†è§£Flannel</a></li><li><a href="http://wsfdl.com/kubernetes/2018/07/09/why_not_flanneld.html" target="_blank" rel="noopener">è˜‘è‡è¡— K8S ä¸ºä»€ä¹ˆä¸é€‰æ‹© flannel ç½‘ç»œæ¨¡å‹</a></li><li><a href="https://ggaaooppeenngg.github.io/zh-CN/2017/09/21/flannel-%E7%BD%91%E7%BB%9C%E6%9E%B6%E6%9E%84/" target="_blank" rel="noopener">flannel ç½‘ç»œæ¶æ„</a></li><li><a href="https://ieevee.com/tech/2017/01/18/k8s-flannel.html#k8s%E7%9A%84flannel%E6%A8%A1%E5%BC%8F" target="_blank" rel="noopener">kubernetsçš„ç½‘ç»œæ’ä»¶ï¼šflannel</a></li><li><a href="https://cizixs.com/2017/10/19/docker-calico-network/" target="_blank" rel="noopener">docker å®¹å™¨ç½‘ç»œæ–¹æ¡ˆï¼šcalico ç½‘ç»œæ¨¡å‹</a></li><li><a href="https://mritd.me/2017/07/31/calico-yml-bug/" target="_blank" rel="noopener">Calico éƒ¨ç½²è¸©å‘è®°å½•</a></li><li><a href="https://chunqi.li/2015/11/15/Battlefield-Calico-Flannel-Weave-and-Docker-Overlay-Network/#Conclusion" target="_blank" rel="noopener">Battlefield: Calico, Flannel, Weave and Docker Overlay Network</a></li><li><a href="https://chunqi.li/2015/09/06/calico-docker/" target="_blank" rel="noopener">Calico: A Solution of Multi-host Network For Docker</a></li><li><a href="https://www.lijiaocn.com/%E9%A1%B9%E7%9B%AE/2017/04/11/calico-usage.html" target="_blank" rel="noopener">Calicoç½‘ç»œçš„åŸç†ã€ç»„ç½‘æ–¹å¼ä¸ä½¿ç”¨</a></li></ul><h3 id="é™æ€è·¯ç”±"><a href="#é™æ€è·¯ç”±" class="headerlink" title="é™æ€è·¯ç”±"></a>é™æ€è·¯ç”±</h3><p>äº‹å…ˆè®¾ç½®å¥½è·¯ç”±å™¨å’Œä¸»æœºä¸­çš„è·¯ç”±è¡¨ä¿¡æ¯ï¼Œç½‘ç»œæ€§èƒ½æœ€ä½³çš„æ–¹æ¡ˆï¼Œä½†ä¸ä¾¿äºç®¡ç†è·¯ç”±è¡¨ã€‚</p><h3 id="flannel"><a href="#flannel" class="headerlink" title="flannel"></a><a href="https://github.com/coreos/flannel" target="_blank" rel="noopener">flannel</a></h3><ul><li>Flannel æ˜¯ CoreOS å›¢é˜Ÿé’ˆå¯¹ Kubernetes è®¾è®¡çš„ä¸€ä¸ªç½‘ç»œè§„åˆ’æœåŠ¡ï¼Œç®€å•æ¥è¯´ï¼Œå®ƒçš„åŠŸèƒ½æ˜¯è®©é›†ç¾¤ä¸­çš„ä¸åŒèŠ‚ç‚¹ä¸»æœºåˆ›å»ºçš„ Docker å®¹å™¨éƒ½å…·æœ‰å…¨é›†ç¾¤å”¯ä¸€çš„è™šæ‹ŸIPåœ°å€ã€‚</li><li>åœ¨é»˜è®¤çš„ Docker é…ç½®ä¸­ï¼Œæ¯ä¸ªèŠ‚ç‚¹ä¸Šçš„ Docker æœåŠ¡ä¼šåˆ†åˆ«è´Ÿè´£æ‰€åœ¨èŠ‚ç‚¹å®¹å™¨çš„IPåˆ†é…ã€‚è¿™æ ·å¯¼è‡´çš„ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œä¸åŒèŠ‚ç‚¹ä¸Šå®¹å™¨å¯èƒ½è·å¾—ç›¸åŒçš„å†…å¤– IP åœ°å€ã€‚å¹¶ä½¿è¿™äº›å®¹å™¨ä¹‹é—´èƒ½å¤Ÿä¹‹é—´é€šè¿‡IPåœ°å€ç›¸äº’æ‰¾åˆ°ï¼Œä¹Ÿå°±æ˜¯ç›¸äº’ ping é€šã€‚</li><li>Flannel çš„è®¾è®¡ç›®çš„å°±æ˜¯ä¸ºé›†ç¾¤ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹é‡æ–°è§„åˆ’ IP åœ°å€çš„ä½¿ç”¨è§„åˆ™ï¼Œä»è€Œä½¿å¾—ä¸åŒèŠ‚ç‚¹ä¸Šçš„å®¹å™¨èƒ½å¤Ÿè·å¾—â€œåŒå±ä¸€ä¸ªå†…ç½‘â€ä¸”â€ä¸é‡å¤çš„â€ IP åœ°å€ï¼Œå¹¶è®©å±äºä¸åŒèŠ‚ç‚¹ä¸Šçš„å®¹å™¨èƒ½å¤Ÿç›´æ¥é€šè¿‡å†…ç½‘ IP é€šä¿¡ã€‚</li><li>Flannel å®è´¨ä¸Šæ˜¯ä¸€ç§â€œè¦†ç›–ç½‘ç»œï¼ˆoverlaynetworkï¼‰â€ï¼Œä¹Ÿå°±æ˜¯å°†TCPæ•°æ®åŒ…è£…åœ¨å¦ä¸€ç§ç½‘ç»œåŒ…é‡Œé¢è¿›è¡Œè·¯ç”±è½¬å‘å’Œé€šä¿¡ï¼Œç›®å‰å·²ç»æ”¯æŒ UDPã€VXLANã€host-gwã€aws-vpcã€GCE å’Œ Alloc è·¯ç”±ç­‰æ•°æ®è½¬å‘æ–¹å¼ï¼Œé»˜è®¤çš„èŠ‚ç‚¹é—´æ•°æ®é€šä¿¡æ–¹å¼æ˜¯ UDP è½¬å‘ã€‚</li></ul><h4 id="hostgw-æ¨¡å¼"><a href="#hostgw-æ¨¡å¼" class="headerlink" title="hostgw æ¨¡å¼"></a>hostgw æ¨¡å¼</h4><p>æ€§èƒ½æœ€é«˜ï¼ŒåŸç†éå¸¸ç®€å•ï¼Œç›´æ¥æ·»åŠ è·¯ç”±ï¼Œå°†ç›®çš„ä¸»æœºå½“åšç½‘å…³ï¼Œç›´æ¥è·¯ç”±åŸå§‹å°åŒ…ã€‚è¿™æ­£æ˜¯ host-gw çš„å«ä¹‰ã€‚æ‰€æœ‰çš„å­ç½‘å’Œä¸»æœºçš„ä¿¡æ¯ï¼Œéƒ½ä¿å­˜åœ¨ etcd ä¸­ï¼Œflanneld åªéœ€è¦ watch è¿™äº›æ•°æ®çš„å˜åŒ– ï¼Œå®æ—¶æ›´æ–°è·¯ç”±è¡¨å°±è¡Œäº†ã€‚ æ ¸å¿ƒæ˜¯ IP åŒ…åœ¨å°è£…æˆæ¡¢çš„æ—¶å€™ï¼Œä½¿ç”¨è·¯ç”±è¡¨çš„â€œä¸‹ä¸€è·³â€è®¾ç½®ä¸Šçš„ MAC åœ°å€ï¼Œè¿™æ ·å¯ä»¥ç»è¿‡äºŒå±‚ç½‘ç»œåˆ°è¾¾ç›®çš„å®¿ä¸»æœºã€‚</p><p>ä¾‹å¦‚ï¼Œæˆ‘ä»¬ä» etcd ä¸­ç›‘å¬åˆ°ä¸€ä¸ª Event Added äº‹ä»¶ subnet ä¸º 10.1.15.0/24 è¢«åˆ†é…ç»™ä¸»æœº Public IP 192.168.0.100ï¼Œhostgw è¦åšçš„å·¥ä½œå°±æ˜¯åœ¨æœ¬ä¸»æœºä¸Šæ·»åŠ ä¸€æ¡ç›®çš„åœ°å€ä¸º 10.1.15.0/24ï¼Œç½‘å…³åœ°å€ä¸º192.168.0.100ï¼Œè¾“å‡ºè®¾å¤‡ä¸ºä¸Šæ–‡ä¸­é€‰æ‹©çš„é›†ç¾¤é—´äº¤äº’çš„ç½‘å¡å³å¯ã€‚å¯¹äº Event Removed äº‹ä»¶ï¼Œåªéœ€åˆ é™¤å¯¹åº”çš„è·¯ç”±ã€‚</p><h4 id="udp-æ¨¡å¼"><a href="#udp-æ¨¡å¼" class="headerlink" title="udp æ¨¡å¼"></a>udp æ¨¡å¼</h4><p>æ ¸å¿ƒå°±æ˜¯é€šè¿‡ TUN è®¾å¤‡ flannel0 å®ç°ï¼ˆ TUN è®¾å¤‡æ˜¯å·¥ä½œåœ¨ä¸‰å±‚çš„è™šæ‹Ÿç½‘ç»œè®¾å¤‡ï¼ŒåŠŸèƒ½æ˜¯ï¼šåœ¨æ“ä½œç³»ç»Ÿå†…æ ¸å’Œç”¨æˆ·åº”ç”¨ç¨‹åºä¹‹é—´ä¼ é€’ IP åŒ…ï¼‰ç›¸æ¯”ä¸¤å°å®¿ä¸»æœºç›´æ¥é€šä¿¡ï¼Œå¤šå‡ºäº† flanneld çš„å¤„ç†è¿‡ç¨‹ï¼Œè¿™ä¸ªè¿‡ç¨‹ï¼Œä½¿ç”¨äº†flannel0 è¿™ä¸ª TUN è®¾å¤‡ï¼Œä»…åœ¨å‘å‡ºIPåŒ…çš„è¿‡ç¨‹ä¸­å°±è¦ç»è¿‡äº†ä¸‰æ¬¡ç”¨æˆ·æ€åˆ°å†…æ ¸æ€çš„æ•°æ®æ‹·è´ï¼ˆ linux çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ä»£ä»·æ¯”è¾ƒå¤§ï¼‰ï¼Œæ‰€ä»¥æ€§èƒ½éå¸¸å·®ã€‚</p><h4 id="vxlan-æ¨¡å¼"><a href="#vxlan-æ¨¡å¼" class="headerlink" title="vxlan æ¨¡å¼"></a>vxlan æ¨¡å¼</h4><p>VXLANï¼Œå³ Virtual Extensible LANï¼ˆè™šæ‹Ÿå¯æ‰©å±•å±€åŸŸç½‘ï¼‰ï¼Œæ˜¯ Linux æœ¬èº«æ”¯æŒçš„ä¸€ç½‘ç§ç½‘ç»œè™šæ‹ŸåŒ–æŠ€æœ¯ã€‚VXLAN å¯ä»¥å®Œå…¨åœ¨å†…æ ¸æ€å®ç°å°è£…å’Œè§£å°è£…å·¥ä½œï¼Œä»è€Œé€šè¿‡â€œéš§é“â€æœºåˆ¶ï¼Œæ„å»ºå‡ºè¦†ç›–ç½‘ç»œï¼ˆOverlay Networkï¼‰</p><p>VXLAN çš„è®¾è®¡æ€æƒ³æ˜¯ï¼šåœ¨ç°æœ‰çš„ä¸‰å±‚ç½‘ç»œä¹‹ä¸Šï¼Œâ€œè¦†ç›–â€ä¸€å±‚è™šæ‹Ÿçš„ã€ç”±å†…æ ¸ VXLAN æ¨¡å—è´Ÿè´£ç»´æŠ¤çš„äºŒå±‚ç½‘ç»œï¼Œä½¿å¾—è¿æ¥åœ¨è¿™ä¸ª VXLAN äºŒ nfcu ç½‘ç»œä¸Šçš„â€œä¸»æœºâ€ï¼ˆè™šæ‹Ÿæœºæˆ–å®¹å™¨éƒ½å¯ä»¥ï¼‰ï¼Œå¯ä»¥åƒåœ¨åŒä¸€ä¸ªå±€åŸŸç½‘ï¼ˆLANï¼‰é‡Œé‚£æ ·è‡ªç”±é€šä¿¡ã€‚ä¸ºäº†èƒ½å¤Ÿåœ¨äºŒ nfcu ç½‘ç»œä¸Šæ‰“é€šâ€œéš§é“â€ï¼ŒVXLAN ä¼šåœ¨å®¿ä¸»æœºä¸Šè®¾ç½®ä¸€ä¸ªç‰¹æ®Šçš„ç½‘ç»œè®¾å¤‡ä½œä¸ºâ€œéš§é“â€çš„ä¸¤ç«¯ï¼Œå«VTEPï¼šVXLAN Tunnel End Pointï¼ˆè™šæ‹Ÿéš§é“ç«¯ç‚¹ï¼‰</p><h3 id="Calico"><a href="#Calico" class="headerlink" title="Calico"></a><a href="https://www.projectcalico.org/" target="_blank" rel="noopener">Calico</a></h3><ul><li>Calico æ˜¯ä¸€ä¸ªçº¯ 3 å±‚çš„æ•°æ®ä¸­å¿ƒç½‘ç»œæ–¹æ¡ˆï¼Œè€Œä¸”æ— ç¼é›†æˆåƒ OpenStack è¿™ç§ IaaS äº‘æ¶æ„ï¼Œèƒ½å¤Ÿæä¾›å¯æ§çš„VMã€å®¹å™¨ã€è£¸æœºä¹‹é—´çš„IPé€šä¿¡ã€‚Calico ä¸ä½¿ç”¨å åŠ ç½‘ç»œæ¯”å¦‚ Flannel å’Œ Libnetwork å åŠ ç½‘ç»œé©±åŠ¨ï¼Œå®ƒæ˜¯ä¸€ä¸ªçº¯ä¸‰å±‚çš„æ–¹æ³•ï¼Œä½¿ç”¨è™šæ‹Ÿè·¯ç”±ä»£æ›¿è™šæ‹Ÿäº¤æ¢ï¼Œæ¯ä¸€å°è™šæ‹Ÿè·¯ç”±é€šè¿‡ BGP åè®®ä¼ æ’­å¯è¾¾ä¿¡æ¯ï¼ˆè·¯ç”±ï¼‰åˆ°å‰©ä½™æ•°æ®ä¸­å¿ƒã€‚</li><li>Calico åœ¨æ¯ä¸€ä¸ªè®¡ç®—èŠ‚ç‚¹åˆ©ç”¨ Linux Kernel å®ç°äº†ä¸€ä¸ªé«˜æ•ˆçš„ vRouter æ¥è´Ÿè´£æ•°æ®è½¬å‘ï¼Œè€Œæ¯ä¸ª vRouter é€šè¿‡ BGP åè®®è´Ÿè´£æŠŠè‡ªå·±ä¸Šè¿è¡Œçš„ workload çš„è·¯ç”±ä¿¡æ¯åƒæ•´ä¸ª Calico ç½‘ç»œå†…ä¼ æ’­â€”â€”å°è§„æ¨¡éƒ¨ç½²å¯ä»¥ç›´æ¥äº’è”ï¼Œå¤§è§„æ¨¡ä¸‹å¯é€šè¿‡æŒ‡å®šçš„ BGP route reflector æ¥å®Œæˆã€‚</li><li>Calico èŠ‚ç‚¹ç»„ç½‘å¯ä»¥ç›´æ¥åˆ©ç”¨æ•°æ®ä¸­å¿ƒçš„ç½‘ç»œç»“æ„ï¼ˆæ— è®ºæ˜¯ L2 æˆ–è€… L3ï¼‰ï¼Œä¸éœ€è¦é¢å¤–çš„ NATï¼Œéš§é“æˆ–è€…Overlay Network ã€‚</li><li>Calico åŸºäº iptables è¿˜æä¾›äº†ä¸°å¯Œè€Œçµæ´»çš„ç½‘ç»œ Policyï¼Œä¿è¯é€šè¿‡å„ä¸ªèŠ‚ç‚¹ä¸Šçš„ ACLs æ¥æä¾› Workload çš„å¤šç§Ÿæˆ·éš”ç¦»ã€å®‰å…¨ç»„ä»¥åŠå…¶ä»–å¯è¾¾æ€§é™åˆ¶ç­‰åŠŸèƒ½ã€‚</li></ul><h3 id="NSX-T"><a href="#NSX-T" class="headerlink" title="NSX-T"></a><a href="https://docs.vmware.com/cn/VMware-NSX-T-Data-Center/index.html" target="_blank" rel="noopener">NSX-T</a></h3><p>ä¸»è¦é€‚ç”¨äº vSphere è™šæ‹ŸåŒ–å¹³å°ï¼ŒESXi è™šæ‹ŸåŒ–çš„ä¸äºŒä¹‹é€‰ã€‚ä»¥ä¸‹å†…å®¹æ‘˜è‡ªå®˜æ–¹æ–‡æ¡£ <a href="https://docs.vmware.com/cn/VMware-NSX-T-Data-Center/2.4/nsxt_24_ncp_kubernetes.pdf" target="_blank" rel="noopener">é€‚ç”¨äº Kubernetes å’Œ Cloud Foundry çš„ NSX Container Plug-in - å®‰è£…å’Œç®¡ç†æŒ‡å—</a> ã€‚</p><p>VMware NSX-Tâ„¢ Data Centerï¼ˆä»¥å‰ç§°ä¸º NSX-Tï¼‰æä¾›äº†ä¸€ä¸ªæ•æ·å¼è½¯ä»¶å®šä¹‰åŸºç¡€æ¶æ„ï¼Œç”¨æ¥æ„å»ºäº‘åŸç”Ÿåº”ç”¨ç¨‹åºç¯å¢ƒã€‚ä¸“æ³¨äºä¸ºå…·æœ‰å¼‚æ„ç«¯ç‚¹ç¯å¢ƒå’ŒæŠ€æœ¯å †æ ˆçš„æ–°å…´åº”ç”¨ç¨‹åºæ¡†æ¶å’Œæ¶æ„æä¾›ç½‘ç»œã€å®‰å…¨å’Œè‡ªåŠ¨åŒ–å¹¶ç®€åŒ–æ“ä½œã€‚NSX-T Data Center æ”¯æŒäº‘åŸç”Ÿåº”ç”¨ç¨‹åºã€è£¸æœºå·¥ä½œè´Ÿè½½ã€å¤šç®¡ç†ç¨‹åºç¯å¢ƒã€å…¬æœ‰äº‘å’Œå¤šä¸ªäº‘ã€‚æ—¨åœ¨ç”±å¼€å‘ç»„ç»‡ç®¡ç†ã€æ“ä½œå’Œä½¿ç”¨ã€‚NSX-T Data Center å…è®¸ IT å’Œå¼€å‘å›¢é˜Ÿé€‰æ‹©æœ€é€‚åˆå…¶åº”ç”¨ç¨‹åºçš„æŠ€æœ¯ã€‚</p><p>NSX Container Plug-in(NCP) æä¾› NSX-T Data Center ä¸å®¹å™¨åè°ƒå™¨ï¼ˆå¦‚ Kubernetesï¼‰ä¹‹é—´çš„é›†æˆä»¥åŠ NSX-T Data Center ä¸åŸºäºå®¹å™¨çš„ PaaSï¼ˆå¹³å°å³æœåŠ¡ï¼‰äº§å“ï¼ˆå¦‚ OpenShift å’Œ Pivotal Cloud Foundryï¼‰ä¹‹é—´çš„é›†æˆã€‚NCP çš„ä¸»è¦ç»„ä»¶åœ¨å®¹å™¨ä¸­è¿è¡Œï¼Œå¹¶ä¸ NSX Manager å’Œ Kubernetes æ§åˆ¶å±‚é¢è¿›è¡Œé€šä¿¡ã€‚NCP è°ƒç”¨ NSX API ä»¥ç›‘æ§å¯¹å®¹å™¨å’Œå…¶ä»–èµ„æºçš„æ›´æ”¹ä»¥åŠç®¡ç†ç½‘ç»œèµ„æºï¼Œå¦‚å®¹å™¨çš„é€»è¾‘ç«¯å£ã€äº¤æ¢æœºã€è·¯ç”±å™¨å’Œå®‰å…¨ç»„ã€‚NSX CNI æ’ä»¶åœ¨æ¯ä¸ª Kubernetes èŠ‚ç‚¹ä¸Šè¿è¡Œã€‚å®ƒç›‘æ§å®¹å™¨ç”Ÿå‘½å‘¨æœŸäº‹ä»¶ï¼Œå°†å®¹å™¨æ¥å£è¿æ¥åˆ°å®¢æˆ·æœº vSwitchï¼Œå¹¶å¯¹å®¢æˆ·æœº vSwitch è¿›è¡Œç¼–ç¨‹ä»¥æ ‡è®°å’Œè½¬å‘å®¹å™¨æ¥å£å’Œ vNIC ä¹‹é—´çš„å®¹å™¨æµé‡ã€‚</p><h4 id="åŠŸèƒ½ç‰¹æ€§"><a href="#åŠŸèƒ½ç‰¹æ€§" class="headerlink" title="åŠŸèƒ½ç‰¹æ€§"></a>åŠŸèƒ½ç‰¹æ€§</h4><ul><li><p>è‡ªåŠ¨ä¸º Kubernetes ç¾¤é›†åˆ›å»º NSX-T Data Center é€»è¾‘æ‹“æ‰‘ï¼Œå¹¶ä¸ºæ¯ä¸ª Kubernetes å‘½åç©ºé—´åˆ›å»ºä¸€ä¸ªå•ç‹¬çš„é€»è¾‘ç½‘ç»œã€‚</p></li><li><p>å°† Kubernetes pod è¿æ¥åˆ°é€»è¾‘ç½‘ç»œï¼Œå¹¶åˆ†é… IP å’Œ MAC åœ°å€ã€‚</p></li><li><p>æ”¯æŒç½‘ç»œåœ°å€è½¬æ¢ (NAT) å¹¶ä¸ºæ¯ä¸ª Kubernetes å‘½åç©ºé—´åˆ†é…ä¸€ä¸ªå•ç‹¬çš„ SNAT IPã€‚</p></li><li><p>ä½¿ç”¨ NSX-T Data Center åˆ†å¸ƒå¼é˜²ç«å¢™å®ç° Kubernetes ç½‘ç»œç­–ç•¥ã€‚</p></li><li><p>æ”¯æŒè¾“å…¥å’Œè¾“å‡ºç½‘ç»œç­–ç•¥ã€‚</p></li><li><p>æ”¯æŒç½‘ç»œç­–ç•¥ä¸­çš„ IPBlock é€‰æ‹©å™¨ã€‚</p></li><li><p>ä¸ºç½‘ç»œç­–ç•¥æŒ‡å®šæ ‡ç­¾é€‰æ‹©å™¨æ—¶ï¼Œæ”¯æŒ matchLabels å’Œ matchExpressionã€‚</p></li><li><p>æ”¯æŒåœ¨å…¶ä»–å‘½åç©ºé—´ä¸­é€‰æ‹© podã€‚</p></li><li><p>å®ç° ClusterIP ç±»å‹çš„ Kubernetes æœåŠ¡å’Œ LoadBalancer ç±»å‹çš„æœåŠ¡ã€‚</p></li><li><p>ä½¿ç”¨ NSX-T ç¬¬ 7 å±‚è´Ÿè½½å¹³è¡¡å™¨å®ç° Kubernetes Ingressã€‚</p></li><li><p>é€šè¿‡ TLS Edge ç»ˆæ­¢æ”¯æŒ HTTP Ingress å’Œ HTTPS Ingressã€‚</p></li><li><p>æ”¯æŒ Ingress é»˜è®¤åç«¯é…ç½®ã€‚</p></li><li><p>æ”¯æŒ Ingress URI é‡å†™ã€‚</p></li><li><p>åœ¨ NSX-T Data Center é€»è¾‘äº¤æ¢æœºç«¯å£ä¸Šä¸ºå‘½åç©ºé—´ã€pod åç§°å’Œ pod æ ‡ç­¾åˆ›å»ºæ ‡è®°ï¼Œå¹¶å…è®¸ç®¡ç†å‘˜æ ¹æ®æ ‡è®°å®šä¹‰ NSX-T å®‰å…¨ç»„å’Œç­–ç•¥ã€‚</p></li></ul><h2 id="æŒä¹…åŒ–å­˜å‚¨æ–¹æ¡ˆ"><a href="#æŒä¹…åŒ–å­˜å‚¨æ–¹æ¡ˆ" class="headerlink" title="æŒä¹…åŒ–å­˜å‚¨æ–¹æ¡ˆ"></a>æŒä¹…åŒ–å­˜å‚¨æ–¹æ¡ˆ</h2><h3 id="å‚è€ƒ-3"><a href="#å‚è€ƒ-3" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><ul><li><p><a href="http://www.taocloudx.com/index.php?a=shows&catid=4&id=102" target="_blank" rel="noopener">GlusterFSå°æ–‡ä»¶åº”ç”¨è°ƒä¼˜ - æŠ€æœ¯ - TaoCloud - è½¯ä»¶å®šä¹‰æ™ºèƒ½å­˜å‚¨</a></p></li><li><p><a href="https://czero000.github.io/2016/04/05/glusterfs-technical-explanation.html" target="_blank" rel="noopener">GlusterFSæŠ€æœ¯è¯¦è§£ | Zeroâ€™s Blog</a></p></li><li><p><a href="http://ceph.org.cn/2018/06/05/redhat-cephå­˜å‚¨-ã€Šé¢å‘ç”Ÿäº§ç¯å¢ƒçš„ceph-å¯¹è±¡ç½‘å…³æŒ‡å—ã€‹/" target="_blank" rel="noopener">RedHat Cephå­˜å‚¨â€”â€”ã€Šé¢å‘ç”Ÿäº§ç¯å¢ƒçš„Ceph å¯¹è±¡ç½‘å…³æŒ‡å—ã€‹ â€“ Cephå¼€æºç¤¾åŒº</a></p></li><li><p><a href="http://www.strugglesquirrel.com/2018/03/09/cephè¿ç»´å¸¸ç”¨å‘½ä»¤/" target="_blank" rel="noopener">cephè¿ç»´å¸¸ç”¨å‘½ä»¤ | å¥‹æ–—çš„æ¾é¼  - blog</a></p></li><li><p><a href="http://ceph.org.cn/2018/06/29/red-hat-cephå­˜å‚¨-ã€Šæ·±å…¥ç†è§£cephæ¶æ„ã€‹/" target="_blank" rel="noopener">Red Hat Cephå­˜å‚¨â€”ã€Šæ·±å…¥ç†è§£Cephæ¶æ„ã€‹ â€“ Cephå¼€æºç¤¾åŒº</a></p></li><li><p><a href="http://ceph.org.cn/2019/04/29/k8s-å­˜å‚¨çš„é‚£ç‚¹äº‹å„¿ï¼š3-ç§-ceph-rbd-ç¾å¤‡æ–¹æ¡ˆå¯¹æ¯”/" target="_blank" rel="noopener">K8S å­˜å‚¨çš„é‚£ç‚¹äº‹å„¿ï¼š3 ç§ Ceph RBD ç¾å¤‡æ–¹æ¡ˆå¯¹æ¯” â€“ Cephå¼€æºç¤¾åŒº</a></p></li><li><p><a href="https://cloud.tencent.com/info/f66bfb4df31ac6e6c52c0180c02ebcc8.html" target="_blank" rel="noopener">å¦‚ä½•åŸºäº Ceph æ”»ç ´æµ·é‡å°æ–‡ä»¶å­˜å‚¨éš¾é¢˜-è…¾è®¯äº‘èµ„è®¯</a></p></li><li><p><a href="https://cloud.tencent.com/developer/news/137215" target="_blank" rel="noopener">æµ·é‡å°æ–‡ä»¶çš„å¼€æºå­˜å‚¨æ–¹æ¡ˆé€‰å‹å»ºè®® - äº‘+ç¤¾åŒº - è…¾è®¯äº‘</a></p></li><li><p><a href="https://vmware.github.io/vsphere-storage-for-kubernetes/documentation/overview.html#vsphere-storage-concepts" target="_blank" rel="noopener">vSphere Cloud Provider | vSphere Storage for Kubernetes</a></p></li><li><p><a href="https://docs.openshift.com/container-platform/3.6/install_config/configuring_vsphere.html" target="_blank" rel="noopener">Configuring for VMWare vSphere | Installation and Configuration | OpenShift Container Platform 3.6</a></p></li><li><p><a href="https://docs.openshift.com/container-platform/3.6/install_config/persistent_storage/persistent_storage_vsphere.html#install-config-persistent-storage-persistent-storage-vsphere" target="_blank" rel="noopener">Using VMware vSphere volumes for persistent storage - Configuring Persistent Storage | Installation and Configuration | OpenShift Container Platform 3.6</a></p></li><li><p><a href="https://www.kancloud.cn/ningjing_home/ceph/462428" target="_blank" rel="noopener">GlusterFSæ­å»º Â· ç‹åº·å®çš„ç¬”è®° Â· çœ‹äº‘</a></p></li><li><p><a href="https://win-man.github.io/2017/08/25/NFSæ€»ç»“/" target="_blank" rel="noopener">NFSæ€»ç»“ | Win-Manâ€™s Blog</a></p></li><li><p><a href="http://www.chinastor.com/distristor/012J01022019.html" target="_blank" rel="noopener">çº¢å¸½ Cephå‘å¸ƒæœ€æ–°3.2ç‰ˆæœ¬_åˆ†å¸ƒå¼å­˜å‚¨_ä¸­å›½å­˜å‚¨ç½‘</a></p></li><li><p><a href="https://mritd.me/2017/06/03/use-ceph-storage-on-kubernetes/" target="_blank" rel="noopener">Kubernetes ä½¿ç”¨ Ceph å­˜å‚¨ - æ¼ ç„¶çš„åšå®¢ | mritd Blog</a></p></li><li><p><a href="https://rancher.com/docs/rancher/v2.x/en/cluster-admin/volumes-and-storage/examples/vsphere/" target="_blank" rel="noopener">vSphere Storage</a></p></li></ul><h3 id="NFS"><a href="#NFS" class="headerlink" title="NFS"></a><a href="https://kubernetes.io/docs/concepts/storage/persistent-volumes/" target="_blank" rel="noopener">NFS</a></h3><h3 id="vSphere-vSAN"><a href="#vSphere-vSAN" class="headerlink" title="vSphere vSAN"></a><a href="https://vmware.github.io/vsphere-storage-for-kubernetes/documentation/overview.html" target="_blank" rel="noopener">vSphere vSAN</a></h3><h3 id="Gluster"><a href="#Gluster" class="headerlink" title="Gluster"></a><a href="https://www.gluster.org/" target="_blank" rel="noopener">Gluster</a></h3><h3 id="Ceph"><a href="#Ceph" class="headerlink" title="Ceph"></a><a href="https://ceph.io/" target="_blank" rel="noopener">Ceph</a></h3><h4 id="Rook"><a href="#Rook" class="headerlink" title="Rook"></a><a href="https://rook.io/" target="_blank" rel="noopener">Rook</a></h4><h2 id="æ—¥å¿—æ–¹æ¡ˆ"><a href="#æ—¥å¿—æ–¹æ¡ˆ" class="headerlink" title="æ—¥å¿—æ–¹æ¡ˆ"></a>æ—¥å¿—æ–¹æ¡ˆ</h2><h3 id="é‡‡é›†æ–¹å¼ï¼š"><a href="#é‡‡é›†æ–¹å¼ï¼š" class="headerlink" title="é‡‡é›†æ–¹å¼ï¼š"></a>é‡‡é›†æ–¹å¼ï¼š</h3><h4 id="åœ¨å®¿ä¸»æœºä¸Šå®ç°æ—¥å¿—é‡‡é›†"><a href="#åœ¨å®¿ä¸»æœºä¸Šå®ç°æ—¥å¿—é‡‡é›†" class="headerlink" title="åœ¨å®¿ä¸»æœºä¸Šå®ç°æ—¥å¿—é‡‡é›†"></a>åœ¨å®¿ä¸»æœºä¸Šå®ç°æ—¥å¿—é‡‡é›†</h4><h4 id="åœ¨å®¹å™¨é•œåƒä¸­æ·»åŠ é‡‡é›†-Agent"><a href="#åœ¨å®¹å™¨é•œåƒä¸­æ·»åŠ é‡‡é›†-Agent" class="headerlink" title="åœ¨å®¹å™¨é•œåƒä¸­æ·»åŠ é‡‡é›† Agent"></a>åœ¨å®¹å™¨é•œåƒä¸­æ·»åŠ é‡‡é›† Agent</h4><h4 id="åŸºäºSidecaræ—¥å¿—é‡‡é›†æ–¹å¼"><a href="#åŸºäºSidecaræ—¥å¿—é‡‡é›†æ–¹å¼" class="headerlink" title="åŸºäºSidecaræ—¥å¿—é‡‡é›†æ–¹å¼"></a>åŸºäºSidecaræ—¥å¿—é‡‡é›†æ–¹å¼</h4><h3 id="ELK-æ–¹æ¡ˆ"><a href="#ELK-æ–¹æ¡ˆ" class="headerlink" title="ELK æ–¹æ¡ˆ"></a><a href="https://www.elastic.co/cn/what-is/elk-stack" target="_blank" rel="noopener">ELK</a> æ–¹æ¡ˆ</h3><h4 id="Elasticsearch"><a href="#Elasticsearch" class="headerlink" title="Elasticsearch"></a><a href="https://www.elastic.co/cn/" target="_blank" rel="noopener">Elasticsearch</a></h4><h4 id="Logstash"><a href="#Logstash" class="headerlink" title="Logstash"></a><a href="https://www.elastic.co/cn/products/logstash" target="_blank" rel="noopener">Logstash</a></h4><h4 id="Kibana"><a href="#Kibana" class="headerlink" title="Kibana"></a><a href="https://www.elastic.co/cn/products/kibana" target="_blank" rel="noopener">Kibana</a></h4><h3 id="EFK-æ–¹æ¡ˆ"><a href="#EFK-æ–¹æ¡ˆ" class="headerlink" title="EFK æ–¹æ¡ˆ"></a><a href="https://github.com/kubernetes/kubernetes/tree/master/cluster/addons/fluentd-elasticsearch" target="_blank" rel="noopener">EFK</a> æ–¹æ¡ˆ</h3><p>å’Œ ELK ä¸åŒçš„æ˜¯  EFK æ–¹æ¡ˆä¸­ä½¿ç”¨ Fluentd æ¥é‡‡é›†æ—¥å¿—ã€‚</p><h4 id="Fluentd"><a href="#Fluentd" class="headerlink" title="Fluentd"></a><a href="https://www.fluentd.org" target="_blank" rel="noopener">Fluentd</a></h4><h2 id="ç›‘æ§æ–¹æ¡ˆ"><a href="#ç›‘æ§æ–¹æ¡ˆ" class="headerlink" title="ç›‘æ§æ–¹æ¡ˆ"></a>ç›‘æ§æ–¹æ¡ˆ</h2><h3 id="Cadvisor-InfluxDB-Grafana"><a href="#Cadvisor-InfluxDB-Grafana" class="headerlink" title="Cadvisor+InfluxDB+Grafana"></a>Cadvisor+InfluxDB+Grafana</h3><h3 id="Heapster-InfluxDB-Grafana"><a href="#Heapster-InfluxDB-Grafana" class="headerlink" title="Heapster+InfluxDB+Grafana"></a>Heapster+InfluxDB+Grafana</h3><h3 id="Promethus-metrics-Grafana"><a href="#Promethus-metrics-Grafana" class="headerlink" title="Promethus+metrics+Grafana"></a>Promethus+metrics+Grafana</h3><table><thead><tr><th align="center">é‡‡é›†</th><th>cAdvisorã€Heapster,ã€collectd,ã€Statsdã€ Tcollectorã€ Scout</th></tr></thead><tbody><tr><td align="center">å­˜å‚¨</td><td>InfluxDbã€OpenTSDBã€ Elasticsearch</td></tr><tr><td align="center">å±•ç¤º</td><td>Graphiteã€Grafanaã€facetteã€ Cactiã€Gangliaã€DataDog</td></tr><tr><td align="center">å‘Šè­¦</td><td>Nagiosã€prometheusã€Icingaã€Zabbix</td></tr></tbody></table><h4 id="Grafana"><a href="#Grafana" class="headerlink" title="Grafana"></a><a href="https://grafana.com" target="_blank" rel="noopener">Grafana</a></h4><p>å¼€æºDashBoardï¼Œåç«¯æ”¯æŒå¤šç§æ•°æ®åº“ï¼Œå¦‚ï¼šInfluxdbã€Prometheusâ€¦ï¼Œæ’ä»¶ä¹Ÿæ¯”è¾ƒå¤šï¼ŒåŠŸèƒ½å¼ºå¤§ã€‚éå¸¸é€‚åˆç”¨äºåšå±•ç¤ºã€‚</p><h4 id="InfluxDB"><a href="#InfluxDB" class="headerlink" title="InfluxDB"></a><a href="https://www.influxdata.com" target="_blank" rel="noopener">InfluxDB</a></h4><p>å¼€æºåˆ†å¸ƒå¼æ—¶é—´æ—¶åºã€äº‹ä»¶å’ŒæŒ‡æ ‡æ•°æ®åº“ï¼Œä½¿ç”¨ Go è¯­è¨€ç¼–å†™ï¼Œæ€§èƒ½é«˜æ•ˆï¼Œæ— éœ€å¤–éƒ¨ä¾èµ–ï¼Œå…¶è®¾è®¡ç›®æ ‡æ˜¯å®ç°åˆ†å¸ƒå¼å’Œæ°´å¹³ä¼¸ç¼©æ‰©å±•ã€‚</p><h5 id="ç‰¹æ€§-1"><a href="#ç‰¹æ€§-1" class="headerlink" title="ç‰¹æ€§"></a>ç‰¹æ€§</h5><ul><li>ä½¿ç”¨ç±» SQL è¯­å¥ï¼›</li><li>æä¾› min, max, sum, count, mean ç­‰èšåˆå‡½æ•°ï¼›</li><li>é‡‡ç”¨ Schemaless ï¼Œåˆ—å­˜å‚¨ï¼Œå‹ç¼©ç‡é«˜ï¼Œå¯ä»¥å­˜å‚¨ä»»æ„æ•°é‡çš„åˆ—ï¼›</li><li>å¯ä»¥å°†ç§’çº§ç›‘æ§åœ¨åå°è½¬æ¢ä¸ºåˆ†é’Ÿçº§ï¼Œå‡å°å­˜å‚¨ç©ºé—´ (Continuous Queries)ï¼›</li><li>Built-in Explorer è‡ªå¸¦ç®¡ç†å·¥å…·ï¼Œé»˜è®¤ä¸æ‰“å¼€ï¼Œéœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®ï¼›</li><li>Native HTTP APIï¼Œé‡‡ç”¨å†…ç½® HTTP æœåŠ¡ (Protobuf API æš‚æ—¶ä¸æä¾›)ã€‚</li><li>æ”¯æŒ Regular Timeseries ä»¥åŠ Irregular Timeseriesï¼Œå‰è€…æ˜¯æŒ‡æ—¶é—´é—´éš”å›ºå®šï¼Œåè€…æŒ‡ä¸å›ºå®šï¼Œä¾‹å¦‚æŠ¥è­¦ã€å…¥ä¾µäº‹ä»¶ç­‰ï¼›</li></ul><h4 id="cAdvisor"><a href="#cAdvisor" class="headerlink" title="cAdvisor"></a><a href="https://github.com/google/cadvisor" target="_blank" rel="noopener">cAdvisor</a></h4><p> æ¥è‡ª Google çš„å®¹å™¨ç›‘æ§å·¥å…·ï¼Œä¹Ÿæ˜¯ Kubelet å†…ç½®çš„å®¹å™¨èµ„æºæ”¶é›†å·¥å…·ã€‚å®ƒä¼šè‡ªåŠ¨æ”¶é›†æœ¬æœºå®¹å™¨ CPUã€å†…å­˜ã€ç½‘ç»œå’Œæ–‡ä»¶ç³»ç»Ÿçš„èµ„æºå ç”¨æƒ…å†µï¼Œå¹¶å¯¹å¤–æä¾› cAdvisor åŸç”Ÿçš„ APIã€‚</p><h4 id="Heapster"><a href="#Heapster" class="headerlink" title="Heapster"></a><a href="https://github.com/kubernetes-retired/heapster" target="_blank" rel="noopener">Heapster</a></h4><p>ç”±äº cAdvisor åªæä¾›äº†å•æœºçš„å®¹å™¨èµ„æºå ç”¨æƒ…å†µï¼Œè€Œ Heapster åˆ™æä¾›äº†æ•´ä¸ªé›†ç¾¤çš„èµ„æºç›‘æ§ï¼ˆkubernetes 1.11 ä¹‹å‰ï¼Œhpaéƒ½æ˜¯ä»heapsterè·å–æ•°æ®ï¼‰ï¼Œå¹¶æ”¯æŒæŒä¹…åŒ–æ•°æ®å­˜å‚¨åˆ° InfluxDB</p><h4 id="kube-state-metrics"><a href="#kube-state-metrics" class="headerlink" title="kube-state-metrics"></a><a href="https://github.com/kubernetes/kube-state-metrics" target="_blank" rel="noopener">kube-state-metrics</a></h4><p>åœ¨è¿™é‡Œä½œä¸ºprometheusçš„ä¸€ä¸ªexporteræ¥ä½¿ç”¨ï¼Œæä¾›deploymentã€daemonsetã€cronjobç­‰æœåŠ¡çš„ç›‘æ§æ•°æ®ï¼Œç”±kubernesteså®˜æ–¹æä¾›ï¼Œä¸prometheusç´§å¯†ç»“åˆã€‚</p><h4 id="Promethues"><a href="#Promethues" class="headerlink" title="Promethues"></a><a href="https://prometheus.io" target="_blank" rel="noopener">Promethues</a></h4><p>åœ¨Kubernetesç¤¾åŒºä¸­ï¼Œå¾ˆå¤šäººè®¤ä¸º Prometheus æ˜¯å®¹å™¨åœºæ™¯ä¸­ç›‘æ§çš„ç¬¬ä¸€æ–¹æ¡ˆï¼Œæˆä¸ºå®¹å™¨ç›‘æ§æ ‡å‡†çš„åˆ¶å®šè€…ã€‚å…¶æä¾›å¼ºå¤§çš„æ•°æ®é‡‡é›†ã€æ•°æ®å­˜å‚¨ã€æ•°æ®å±•ç¤ºã€å‘Šè­¦ç­‰ï¼Œå¤©ç”Ÿå®Œç¾æ”¯æŒ kubernetesï¼ŒCNCFåŸºé‡‘ä¼šçš„ç¬¬äºŒä¸ªæˆå‘˜ï¼Œç¬¬ä¸€ä¸ªæ˜¯ Kubernetes ã€‚è€Œä¸” Prometheus é‡Œé¢å¾ˆå¤šæ€æƒ³éƒ½æ¥æºäº Google å†…éƒ¨çš„ç›‘æ§ç³»ç»Ÿ Borgmonï¼Œå…¶æ–¹æ¡ˆç›¸å½“æˆç†Ÿã€‚</p><h5 id="ç‰¹æ€§-2"><a href="#ç‰¹æ€§-2" class="headerlink" title="ç‰¹æ€§"></a>ç‰¹æ€§</h5><ul><li>å¤šç»´æ•°æ®æ¨¡å‹ï¼ˆæœ‰metricåç§°å’Œé”®å€¼å¯¹ç¡®å®šçš„æ—¶é—´åºåˆ—ï¼‰</li><li>çµæ´»çš„æŸ¥è¯¢è¯­è¨€</li><li>ä¸ä¾èµ–åˆ†å¸ƒå¼å­˜å‚¨</li><li>é€šè¿‡pullæ–¹å¼é‡‡é›†æ—¶é—´åºåˆ—ï¼Œé€šè¿‡httpåè®®ä¼ è¾“</li><li>æ”¯æŒé€šè¿‡ä¸­ä»‹ç½‘å…³çš„pushæ—¶é—´åºåˆ—çš„æ–¹å¼</li><li>ç›‘æ§æ•°æ®é€šè¿‡æœåŠ¡æˆ–è€…é™æ€é…ç½®æ¥å‘ç°</li><li>æ”¯æŒå¤šç»´åº¦å¯è§†åŒ–åˆ†æå’Œdashboardç­‰</li></ul><h5 id="ç›‘æ§å±‚é¢"><a href="#ç›‘æ§å±‚é¢" class="headerlink" title="ç›‘æ§å±‚é¢"></a>ç›‘æ§å±‚é¢</h5><ul><li>åŸºç¡€è®¾æ–½å±‚ï¼šç›‘æ§å„ä¸ªä¸»æœºæœåŠ¡å™¨èµ„æº(åŒ…æ‹¬Kubernetesçš„Nodeå’ŒéKubernetesçš„Node)ï¼Œå¦‚CPU,å†…å­˜,ç½‘ç»œååå’Œå¸¦å®½å ç”¨,ç£ç›˜I/Oå’Œç£ç›˜ä½¿ç”¨ç­‰æŒ‡æ ‡ã€‚</li><li>ä¸­é—´ä»¶å±‚ï¼šç›‘æ§ç‹¬ç«‹éƒ¨ç½²äºKubernetesé›†ç¾¤ä¹‹å¤–çš„ä¸­é—´ä»¶ï¼Œä¾‹å¦‚ï¼šMySQLã€Redisã€RabbitMQã€ElasticSearchã€Nginxç­‰ã€‚</li><li>Kubernetes é›†ç¾¤ï¼šç›‘æ§Kubernetesé›†ç¾¤æœ¬èº«çš„å…³é”®æŒ‡æ ‡</li><li>Kubernetes é›†ç¾¤ä¸Šéƒ¨ç½²çš„åº”ç”¨ï¼šç›‘æ§éƒ¨ç½²åœ¨Kubernetesé›†ç¾¤ä¸Šçš„åº”ç”¨</li></ul><h5 id="ç»„ä»¶"><a href="#ç»„ä»¶" class="headerlink" title="ç»„ä»¶"></a>ç»„ä»¶</h5><ul><li>prometheus-serverï¼šæ•°æ®å­˜å‚¨ä»¥åŠç›‘æ§æ•°æ®èšåˆ</li><li>prometheus-config-reloaderï¼šåŠ¨æ€æ›´æ–°prometheusé…ç½®</li><li>rules-configmap-reloaderï¼šåŠ¨æ€æ›´æ–°prometheusæŠ¥è­¦é…ç½®</li><li>alert managerï¼šæŠ¥è­¦ç»„ä»¶</li><li>node-exporterï¼šèŠ‚ç‚¹èµ„æºä¿¡æ¯é‡‡é›†ç»„ä»¶</li><li>kube-state-metricsï¼šåŠ¨æ€å‘ç°endpointï¼Œä¸‰æ–¹ç›‘æ§çš„æ ¸å¿ƒç»„ä»¶</li><li>prometheus-operatorï¼šprometheusé…ç½®çš„operator</li><li>grafanaï¼šæ•°æ®å±•ç°</li></ul><h2 id="CI-CD-æ–¹æ¡ˆ"><a href="#CI-CD-æ–¹æ¡ˆ" class="headerlink" title="CI/CD æ–¹æ¡ˆ"></a>CI/CD æ–¹æ¡ˆ</h2><h3 id="å‚è€ƒ-4"><a href="#å‚è€ƒ-4" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><h3 id="Jenkins"><a href="#Jenkins" class="headerlink" title="Jenkins"></a><a href="https://jenkins.io/" target="_blank" rel="noopener">Jenkins</a></h3><h3 id="Gitlab-CI"><a href="#Gitlab-CI" class="headerlink" title="Gitlab CI"></a><a href="https://docs.gitlab.com/ee/ci/" target="_blank" rel="noopener">Gitlab CI</a></h3><h3 id="Drone"><a href="#Drone" class="headerlink" title="Drone"></a><a href="https://drone.io/" target="_blank" rel="noopener">Drone</a></h3><h2 id="é•œåƒ-registry"><a href="#é•œåƒ-registry" class="headerlink" title="é•œåƒ registry"></a>é•œåƒ registry</h2><p>é•œåƒä»“åº“è´Ÿè´£å­˜å‚¨å’Œå‘å¸ƒåº”ç”¨çš„é•œåƒéƒ¨ç½²ç‰ˆæœ¬ï¼Œåœ¨åŠŸèƒ½ä¸Šå¹¶ä¸å¤æ‚ï¼Œä½†ç”±äºå®‰å…¨æ€§çš„è¦æ±‚ã€‚ç”¨äºç”Ÿäº§å‘å¸ƒçš„é•œåƒç‰ˆæœ¬å¿…é¡»é€šè¿‡ä¸¥æ ¼çš„æµ‹è¯•é˜¶æ®µï¼Œä»¥åŠä¸¥å¯†çš„å®‰å…¨æ£€æŸ¥æ­¥éª¤ï¼Œå› æ­¤å»ºè®®å¯¹ç”Ÿäº§ç¯å¢ƒè¿è¡Œä¸“ç”¨çš„ç”Ÿäº§é•œåƒä»“åº“ï¼›åŒæ—¶ï¼Œåœ¨æŒç»­é›†æˆè¶Šæ¥è¶Šæ™®éçš„æƒ…å†µä¸‹ï¼Œä¸ºäº†ä¿è¯å¼€å‘å’Œæµ‹è¯•çš„æ–¹ä¾¿ï¼Œæˆ‘ä»¬éœ€è¦æµ‹è¯•é•œåƒä»“åº“ã€‚å»ºè®®ç”Ÿäº§é•œåƒåº“å’Œæµ‹è¯•é•œåƒåº“åœ¨ç‰©ç†ä¸Šåˆ†å¼€ã€ç½‘ç»œä¸Šçš„è¿é€šé€šè¿‡é˜²ç«å¢™ç­–ç•¥åšé™åˆ¶ï¼ˆåªå¼€æ”¾å¿…é¡»çš„ç«¯å£ç”¨äºé•œåƒåŒæ­¥ï¼‰ã€‚</p><p>åœ¨ä½¿ç”¨è§„åˆ™ä¸Šï¼Œæµ‹è¯•é•œåƒä»“åº“å…è®¸éšæ—¶çš„é•œåƒä¸Šä¼ å’Œæ›´æ–°ï¼Œé€šå¸¸éƒ½ä¼šå¯¹æ¥æŒç»­é›†æˆç³»ç»Ÿï¼›è€Œå¯¹äºç”Ÿäº§é•œåƒä»“åº“ï¼Œä¸ºäº†ä¿è¯é•œåƒæ¥æºçš„å®‰å…¨ã€å¯æ§ï¼Œå»ºè®®é™åˆ¶ä¸ºåªèƒ½ä»æµ‹è¯•é•œåƒåŒæ­¥ï¼Œè§„å®šåªæœ‰åœ¨æµ‹è¯•é•œåƒä»“åº“ä¸­æ ‡è®°ä¸ºå®Œæˆæµ‹è¯•ã€ç»è¿‡å®‰å…¨æ£€æŸ¥çš„é•œåƒï¼Œç”±æœ‰ç›¸åº”æƒé™çš„è´¦å·ï¼Œåœ¨ç»è¿‡å¿…è¦çš„å®¡æ‰¹æˆ–è€…æ»¡è¶³ä¸€å®šè§„åˆ™çš„æƒ…å†µä¸‹ï¼Œä»æµ‹è¯•é•œåƒä»“åº“ä¸­æŠŠé•œåƒåŒæ­¥åˆ°ç”Ÿäº§é•œåƒä»“åº“ã€‚ä¸€æ—¦é•œåƒè¿›å…¥ç”Ÿäº§é•œåƒä»“åº“ï¼Œå°±è¢«å½“åšæ­£å¼çš„ç”Ÿäº§å‘å¸ƒç‰ˆæœ¬ï¼Œæ¥ä¸‹æ¥å°±æŒ‰ç…§ç°æœ‰çš„ç”Ÿäº§å‘å¸ƒå’Œå˜æ›´æµç¨‹ï¼Œåœ¨æŒ‡å®šçš„å˜æ›´çª—å£ï¼Œä»ç”Ÿäº§é•œåƒåº“ä¸­æ‹‰å–é•œåƒè¿›è¡Œéƒ¨ç½²ï¼Œè¿™æ ·åšä¹Ÿå¾ˆå¥½åœ°æ»¡è¶³å®‰å…¨ç›‘ç®¡è¦æ±‚ã€‚</p><h3 id="harbor"><a href="#harbor" class="headerlink" title="harbor"></a><a href="https://goharbor.io/" target="_blank" rel="noopener">harbor</a></h3><p>Harboræ˜¯ä¸€ä¸ªç”¨äºå­˜å‚¨å’Œåˆ†å‘Dockeré•œåƒçš„ä¼ä¸šçº§RegistryæœåŠ¡å™¨ã€‚é€šè¿‡æ·»åŠ ä¸€äº›ä¼ä¸šå¿…éœ€çš„åŠŸèƒ½ç‰¹æ€§ï¼Œä¾‹å¦‚å®‰å…¨ã€æ ‡è¯†å’Œç®¡ç†ç­‰ï¼Œæ‰©å±•äº†å¼€æº Docker Distributionã€‚ä½œä¸ºä¸€ä¸ªä¼ä¸šçº§ç§æœ‰RegistryæœåŠ¡å™¨ï¼ŒHarboræä¾›äº†æ›´å¥½çš„æ€§èƒ½å’Œå®‰å…¨ã€‚æå‡ç”¨æˆ·ä½¿ç”¨Registryæ„å»ºå’Œè¿è¡Œç¯å¢ƒä¼ è¾“é•œåƒçš„æ•ˆç‡ã€‚Harboræ”¯æŒå®‰è£…åœ¨å¤šä¸ªRegistryèŠ‚ç‚¹çš„é•œåƒèµ„æºå¤åˆ¶ï¼Œé•œåƒå…¨éƒ¨ä¿å­˜åœ¨ç§æœ‰Registryä¸­ï¼Œ ç¡®ä¿æ•°æ®å’ŒçŸ¥è¯†äº§æƒåœ¨å…¬å¸å†…éƒ¨ç½‘ç»œä¸­ç®¡æ§ã€‚å¦å¤–ï¼ŒHarborä¹Ÿæä¾›äº†é«˜çº§çš„å®‰å…¨ç‰¹æ€§ï¼Œè¯¸å¦‚ç”¨æˆ·ç®¡ç†ï¼Œè®¿é—®æ§åˆ¶å’Œæ´»åŠ¨å®¡è®¡ç­‰ã€‚</p><h4 id="ç‰¹æ€§-3"><a href="#ç‰¹æ€§-3" class="headerlink" title="ç‰¹æ€§"></a>ç‰¹æ€§</h4><ul><li>é•œåƒæ³¨å†Œä¸­å¿ƒ:æ”¯æŒå®¹å™¨é•œåƒå’ŒHelmã€‚ä¸ºé•œåƒæä¾›ä¸€ä¸ªæ³¨å†ŒæœåŠ¡å’Œç¼–æ’å¹³å°ã€‚</li><li>åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶: ç”¨æˆ·å¯ä»¥åˆ›å»ºä¸åŒçš„â€˜é¡¹ç›®â€˜ï¼Œå¹¶ä¸”æ‹¥æœ‰ä¸åŒæƒé™ã€‚</li><li>é•œåƒå¤åˆ¶:Harborä¼šåœ¨å¤åˆ¶é‡åˆ°ä»»ä½•é”™è¯¯æ—¶è‡ªåŠ¨é‡è¯•ã€‚ é€‚ç”¨äºè´Ÿè½½å‡è¡¡ã€é«˜å¯ç”¨æ€§ã€å¤šæ•°æ®ä¸­å¿ƒã€æ··åˆå’Œå¤šäº‘åœºæ™¯</li><li>æ¼æ´æ‰«æï¼šHarborå®šæœŸæ‰«æé•œåƒå¹¶è­¦å‘Šç”¨æˆ·å­˜åœ¨æ¼æ´ã€‚</li><li>AD/LDAP æ”¯æŒ:Harborå¯ä»¥é›†æˆä¼ä¸šå†…éƒ¨å·²æœ‰çš„AD/LDAPï¼Œç”¨äºé‰´æƒè®¤è¯ç®¡ç†ã€‚</li><li>OIDCæ”¯æŒ:ä¸€ç§åŸºäºOAuth2çš„åè®®</li><li>åƒåœ¾å›æ”¶:é•œåƒè¢«åˆ é™¤çš„æ—¶å€™å¯ä»¥è‡ªåŠ¨åƒåœ¾å›æ”¶ã€‚å¹¶ä¸”å¯ä»¥å®šæ—¶è®¾ç½®åƒåœ¾æ¸…ç†ã€‚</li><li>å‹å¥½çš„ç•Œé¢æ“ä½œ:ç”¨æˆ·å¯ä»¥è½»æ¾æ–¹ä¾¿çš„é•œåƒç®¡ç†ï¼Œæ”¯æŒä¸­è‹±æ–‡ç­‰å¤šè¯­è¨€ã€‚</li><li>å®¡è®¡:è·Ÿè¸ªç”¨æˆ·å¯¹é•œåƒçš„æ“ä½œå†å²</li><li>RESTful APIï¼šå¤§å¤šæ•°ç®¡ç†æ“ä½œçš„RESTful Apiï¼Œæ˜“äºä¸å¤–éƒ¨ç³»ç»Ÿé›†æˆã€‚ åµŒå…¥å¼Swagger UIå¯ç”¨äºæ¢ç´¢å’Œæµ‹è¯•APIï¼ˆç®¡ç†ç•Œé¢å·¦ä¸‹è§’çš„â€˜APIæ§åˆ¶ä¸­å¿ƒ)</li><li>è½»æ¾éƒ¨ç½²ï¼šæä¾›è”æœºå’Œè„±æœºå®‰è£…ç¨‹åºã€‚ æ­¤å¤–ï¼ŒHelm Chartç”¨äºåœ¨Kubernetesä¸Šéƒ¨ç½²Harborã€‚</li></ul><h3 id="quay"><a href="#quay" class="headerlink" title="quay"></a><a href="https://quay.io/" target="_blank" rel="noopener">quay</a></h3><p>åœ¨ 11 æœˆä»½çº¢å¸½å®£å¸ƒå¼€æº quay</p><h4 id="ç‰¹æ€§-4"><a href="#ç‰¹æ€§-4" class="headerlink" title="ç‰¹æ€§"></a>ç‰¹æ€§</h4><ol><li>é•œåƒä»“åº“é«˜å¯ç”¨å’Œç¾å¤‡ï¼šæ•°æ®ä¸­å¿ƒå†…éƒ¨ HAï¼Œåœ¨æ•°æ®ä¸­å¿ƒä¹‹é—´åŒæ­¥é•œåƒ</li><li>æ”¯æŒ CIï¼šå½“å¼€å‘äººå‘˜æäº¤ä»£ç ä»¥åï¼Œè‡ªåŠ¨è§¦å‘ä»£ç æ„å»ºã€‚</li><li>æ”¯æŒå®‰å…¨æ‰«æï¼šè‡ªåŠ¨æ‰«æå®¹å™¨é•œåƒï¼Œä»¥æŸ¥æ‰¾å·²çŸ¥çš„å®‰å…¨æ¼æ´ã€‚</li><li>ä¼ä¸šè®¤è¯ï¼šé›†æˆåˆ°ç°æœ‰çš„èº«ä»½åŸºç¡€æ¶æ„ï¼šLDAPï¼ŒKeystone ç­‰</li><li>çµæ´»çš„å­˜å‚¨åç«¯ï¼šå°†å®¹å™¨å­˜å‚¨åœ¨ Amazon S3ï¼ŒOpenStack Swiftï¼ŒGoogle äº‘ç«¯å­˜å‚¨ä¸­ï¼Œæˆ–ç›´æ¥å­˜å‚¨åˆ°ç£ç›˜ã€‚</li><li>è®°å½•å’Œå®¡è®¡ å®¡è®¡å¯¹äº CI ç®¡é“ä¸­çš„æ‰€æœ‰å†…å®¹éƒ½è‡³å…³é‡è¦ã€‚è·Ÿè¸ªé€šè¿‡ API å’Œ UI æ‰§è¡Œçš„æ“ä½œã€‚</li></ol><h5 id="Quayçš„ä¼ä¸šçº§åŠŸèƒ½"><a href="#Quayçš„ä¼ä¸šçº§åŠŸèƒ½" class="headerlink" title="Quayçš„ä¼ä¸šçº§åŠŸèƒ½"></a>Quayçš„ä¼ä¸šçº§åŠŸèƒ½</h5><ul><li>å¼‚åœ°å¤åˆ¶</li><li>é«˜å¯ç”¨æ€§å’Œå¯æ‰©å±•æ€§</li><li>å®‰å…¨æ‰«æ</li><li>è‡ªåŠ¨æ„å»ºè§¦å‘å™¨</li><li>æ—¶é—´æœºå™¨imageå›æ»šï¼ˆåŸºäºbuildç‰ˆæœ¬çš„å›é€€ï¼‰</li><li>ç»†ç²’åº¦çš„è®¿é—®æ§åˆ¶</li><li>è‡ªåŠ¨è¿ç»­åƒåœ¾æ”¶é›†ï¼Œæ— éœ€åœæœº</li><li>ä¸å¤šä¸ªå­˜å‚¨åç«¯é›†æˆï¼ˆcephç­‰ï¼‰</li><li>åŠ å¯†çš„CLIå¯†ç </li><li>æ´ªæµåˆ†å¸ƒ</li><li>å®¹å™¨å’Œåº”ç”¨ç¨‹åºæ³¨å†Œ</li><li>ä¸Quay.ioä¿æŒä¸€è‡´çš„UIå’Œä»£ç åº“</li></ul><h5 id="é•œåƒæ‰«æï¼š"><a href="#é•œåƒæ‰«æï¼š" class="headerlink" title="é•œåƒæ‰«æï¼š"></a>é•œåƒæ‰«æï¼š</h5><p>quayçš„é•œåƒå®‰å…¨æ‰«æåŸºäºclairï¼šClairé¡¹ç›®æ˜¯ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œä½¿Quay Security Scannerèƒ½å¤Ÿæ£€æµ‹Quay Enterpriseä¸­æ‰€æœ‰å›¾åƒçš„æ¼æ´ï¼Œå¹¶åœ¨å‘ç°è¿™äº›é—®é¢˜æ—¶é€šçŸ¥å¼€å‘äººå‘˜ã€‚</p><h5 id="è‡ªåŠ¨æ„å»ºï¼š"><a href="#è‡ªåŠ¨æ„å»ºï¼š" class="headerlink" title="è‡ªåŠ¨æ„å»ºï¼š"></a>è‡ªåŠ¨æ„å»ºï¼š</h5><p>é€šè¿‡é›†æˆåˆ°GitHubï¼ŒBitbucketç­‰ï¼Œè‡ªåŠ¨æ„å»ºå­˜å‚¨åº“æ¨é€æ“ä½œä¸Šçš„æ˜ åƒã€‚éšç€ä»£ç ï¼ˆGitHubï¼ŒBitbucketï¼ŒGitLabå’ŒGitï¼‰ä¸­çš„æ¨é€æ“ä½œå‘ç”Ÿï¼ŒQuayå°†è‡ªåŠ¨æ„å»ºæ–°ç‰ˆæœ¬çš„åº”ç”¨ç¨‹åº</p><h5 id="imageå›æ»š"><a href="#imageå›æ»š" class="headerlink" title="imageå›æ»š:"></a>imageå›æ»š:</h5><p>Time Machineæä¾›å›¾åƒå›æ»šï¼ŒæŸ¥çœ‹æ ‡ç­¾å†å²è®°å½•ï¼Œå¿«é€Ÿè½»æ¾åœ°åˆ‡æ¢å›¾åƒæ„å»ºã€‚</p><p>æŸ¥çœ‹image buildå†å²è®°å½•ï¼Œå¹¶å¯ä»¥é€‰æ‹©æŸä¸ªç‰ˆæœ¬çš„æ„å»ºè¿›è¡Œå›é€€;</p><h5 id="ç»†é¢—ç²’åº¦çš„RBACé…ç½®"><a href="#ç»†é¢—ç²’åº¦çš„RBACé…ç½®" class="headerlink" title="ç»†é¢—ç²’åº¦çš„RBACé…ç½®:"></a>ç»†é¢—ç²’åº¦çš„RBACé…ç½®:</h5><p>æ”¯æŒè®¸å¤šèº«ä»½æä¾›å•†ï¼šLDAPï¼ŒOAuthï¼ŒOpenStack Keystoneç­‰ã€‚</p><h5 id="äº‹ä»¶å’Œä½¿ç”¨æ—¥å¿—ï¼š"><a href="#äº‹ä»¶å’Œä½¿ç”¨æ—¥å¿—ï¼š" class="headerlink" title="äº‹ä»¶å’Œä½¿ç”¨æ—¥å¿—ï¼š"></a>äº‹ä»¶å’Œä½¿ç”¨æ—¥å¿—ï¼š</h5><ul><li>é’ˆå¯¹å­˜å‚¨åº“æ•è·æ‰€æœ‰äº‹ä»¶</li><li>Pull, push events</li><li>æƒé™æ›´æ”¹</li><li>buildäº‹ä»¶</li><li>æ ‡ç­¾æ›´æ”¹</li></ul><h5 id="è‡ªåŠ¨å‹ç¼©imageï¼š"><a href="#è‡ªåŠ¨å‹ç¼©imageï¼š" class="headerlink" title="è‡ªåŠ¨å‹ç¼©imageï¼š"></a>è‡ªåŠ¨å‹ç¼©imageï¼š</h5><p>å°†å¤šä¸ªdocker layerå‹ç¼©æˆä¸€ä¸ªï¼Œä»¥åˆ›å»ºä¸€ä¸ªlayeræ›´å°‘çš„imageï¼š</p><h5 id="è‡ªåŠ¨è¿›è¡ŒK8Såº”ç”¨éƒ¨ç½²ï¼š"><a href="#è‡ªåŠ¨è¿›è¡ŒK8Såº”ç”¨éƒ¨ç½²ï¼š" class="headerlink" title="è‡ªåŠ¨è¿›è¡ŒK8Såº”ç”¨éƒ¨ç½²ï¼š"></a>è‡ªåŠ¨è¿›è¡ŒK8Såº”ç”¨éƒ¨ç½²ï¼š</h5><p>$ helm registry install quay.io/jzelinskie/nginx</p><h5 id="äº‹ä»¶é€šçŸ¥"><a href="#äº‹ä»¶é€šçŸ¥" class="headerlink" title="äº‹ä»¶é€šçŸ¥"></a>äº‹ä»¶é€šçŸ¥</h5><p>å‘å¸ƒç”µå­é‚®ä»¶ã€quayé€šçŸ¥ã€webhookå‘å¸ƒã€flowdockï¼Œhipchatï¼ŒåŸºäºQuay Enterpriseå†…éƒ¨å„ç§äº‹ä»¶çš„é€šçŸ¥</p><h2 id="é›†ç¾¤ä¼˜åŒ–"><a href="#é›†ç¾¤ä¼˜åŒ–" class="headerlink" title="é›†ç¾¤ä¼˜åŒ–"></a>é›†ç¾¤ä¼˜åŒ–</h2><h3 id="ç½‘ç»œ-MTU"><a href="#ç½‘ç»œ-MTU" class="headerlink" title="ç½‘ç»œ MTU"></a>ç½‘ç»œ MTU</h3><h3 id="å†…æ ¸ç‰ˆæœ¬"><a href="#å†…æ ¸ç‰ˆæœ¬" class="headerlink" title="å†…æ ¸ç‰ˆæœ¬"></a>å†…æ ¸ç‰ˆæœ¬</h3><h4 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h4><ul><li><a href="https://mp.weixin.qq.com/s/bSNWPnFZ3g_gciOv_qNhIQ" target="_blank" rel="noopener">å¹²è´§ | æºç¨‹å®¹å™¨å¶å‘æ€§è¶…æ—¶é—®é¢˜æ¡ˆä¾‹åˆ†æï¼ˆä¸€ï¼‰</a></li><li><a href="https://mp.weixin.qq.com/s/7ZZqWPE1XNf9Mn_wj1HjUw" target="_blank" rel="noopener">å¹²è´§ | æºç¨‹å®¹å™¨å¶å‘æ€§è¶…æ—¶é—®é¢˜æ¡ˆä¾‹åˆ†æï¼ˆäºŒ)</a></li><li><a href="https://github.blog/2019-11-21-debugging-network-stalls-on-kubernetes/" target="_blank" rel="noopener">Debugging network stalls on Kubernetes</a></li></ul><h3 id="service-å®ç°å½¢å¼"><a href="#service-å®ç°å½¢å¼" class="headerlink" title="service å®ç°å½¢å¼"></a>service å®ç°å½¢å¼</h3><p>æ€§èƒ½å¯¹æ¯”å‚è€ƒæ–‡ç«   <a href="https://blog.fleeto.us/post/iptables-or-ipvs/" target="_blank" rel="noopener">kube-proxy æ¨¡å¼å¯¹æ¯”ï¼šiptables è¿˜æ˜¯ IPVS</a></p><p>kube-proxy æ˜¯ Kubernetes ä¸­çš„å…³é”®ç»„ä»¶ã€‚ä»–çš„è§’è‰²å°±æ˜¯åœ¨æœåŠ¡ï¼ˆClusterIP å’Œ NodePortï¼‰å’Œå…¶åç«¯ Pod ä¹‹é—´è¿›è¡Œè´Ÿè½½å‡è¡¡ã€‚kube-proxy æœ‰ä¸‰ç§è¿è¡Œæ¨¡å¼ï¼Œæ¯ç§éƒ½æœ‰ä¸åŒçš„å®ç°æŠ€æœ¯ï¼šuserspaceã€iptables æˆ–è€… IPVSã€‚</p><p>userspace æ¨¡å¼éå¸¸é™ˆæ—§ã€ç¼“æ…¢ï¼Œå·²ç»ä¸æ¨èä½¿ç”¨ã€‚ä½†æ˜¯ iptables å’Œ IPVS è¯¥å¦‚ä½•é€‰æ‹©å‘¢ï¼Ÿæœ¬æ–‡ä¸­æˆ‘ä»¬ä¼šå¯¹è¿™ä¸¤ç§æ¨¡å¼è¿›è¡Œæ¯”è¾ƒï¼Œçœ‹çœ‹ä»–ä»¬åœ¨çœŸæ­£çš„å¾®æœåŠ¡ä¸Šä¸‹æ–‡ä¸­çš„è¡¨ç°ï¼Œå¹¶è§£é‡Šåœ¨ç‰¹å®šæƒ…å†µä¸‹çš„é€‰æ‹©æ–¹æ³•ã€‚</p><h4 id="æ€§èƒ½å¯¹æ¯”"><a href="#æ€§èƒ½å¯¹æ¯”" class="headerlink" title="æ€§èƒ½å¯¹æ¯”"></a>æ€§èƒ½å¯¹æ¯”</h4><p>iptables çš„è¿æ¥å¤„ç†ç®—æ³•å¤æ‚åº¦æ˜¯ O(n)ï¼Œè€Œ IPVS æ¨¡å¼æ˜¯ O(1)ï¼Œä½†æ˜¯åœ¨å¾®æœåŠ¡ç¯å¢ƒä¸­ï¼Œå…¶å…·ä½“è¡¨ç°å¦‚ä½•å‘¢ï¼Ÿ</p><p>åœ¨å¤šæ•°åœºæ™¯ä¸­ï¼Œæœ‰ä¸¤ä¸ªå…³é”®å±æ€§éœ€è¦å…³æ³¨ï¼š</p><ul><li>å“åº”æ—¶é—´ï¼šä¸€ä¸ªå¾®æœåŠ¡å‘å¦ä¸€ä¸ªå¾®æœåŠ¡å‘èµ·è°ƒç”¨æ—¶ï¼Œç¬¬ä¸€ä¸ªå¾®æœåŠ¡å‘é€è¯·æ±‚ï¼Œå¹¶ä»ç¬¬äºŒä¸ªå¾®æœåŠ¡ä¸­å¾—åˆ°å“åº”ï¼Œä¸­é—´æ¶ˆè€—äº†å¤šå°‘æ—¶é—´ï¼Ÿ</li><li>CPU æ¶ˆè€—ï¼šè¿è¡Œå¾®æœåŠ¡çš„è¿‡ç¨‹ä¸­ï¼Œæ€»ä½“ CPU ä½¿ç”¨æƒ…å†µå¦‚ä½•ï¼ŸåŒ…æ‹¬ç”¨æˆ·å’Œæ ¸å¿ƒç©ºé—´çš„ CPU ä½¿ç”¨ï¼ŒåŒ…å«æ‰€æœ‰ç”¨äºæ”¯æŒå¾®æœåŠ¡çš„è¿›ç¨‹ï¼ˆä¹ŸåŒ…æ‹¬ kube-proxyï¼‰ã€‚</li></ul><p>ä¸ºäº†è¯´æ˜é—®é¢˜ï¼Œæˆ‘ä»¬è¿è¡Œä¸€ä¸ªå¾®æœåŠ¡ä½œä¸ºå®¢æˆ·ç«¯ï¼Œè¿™ä¸ªå¾®æœåŠ¡ä»¥ Pod çš„å½¢å¼è¿è¡Œåœ¨ä¸€ä¸ªç‹¬ç«‹çš„èŠ‚ç‚¹ä¸Šï¼Œæ¯ç§’é’Ÿå‘å‡º 1000 ä¸ªè¯·æ±‚ï¼Œè¯·æ±‚çš„ç›®æ ‡æ˜¯ä¸€ä¸ª Kubernetes æœåŠ¡ï¼Œè¿™ä¸ªæœåŠ¡ç”± 10 ä¸ª Pod ä½œä¸ºåç«¯ï¼Œè¿è¡Œåœ¨å…¶å®ƒçš„èŠ‚ç‚¹ä¸Šã€‚æ¥ä¸‹æ¥æˆ‘ä»¬åœ¨å®¢æˆ·ç«¯èŠ‚ç‚¹ä¸Šè¿›è¡Œäº†æµ‹é‡ï¼ŒåŒ…æ‹¬ iptables ä»¥åŠ IPVS æ¨¡å¼ï¼Œè¿è¡Œäº†æ•°é‡ä¸ç­‰çš„ Kubernetes æœåŠ¡ï¼Œæ¯ä¸ªæœåŠ¡éƒ½æœ‰ 10 ä¸ª Podï¼Œæœ€å¤§æœ‰ 10,000 ä¸ªæœåŠ¡ï¼ˆä¹Ÿå°±æ˜¯ 100,000 ä¸ª Podï¼‰ã€‚æˆ‘ä»¬ç”¨ golang ç¼–å†™äº†ä¸€ä¸ªç®€å•çš„æµ‹è¯•å·¥å…·ä½œä¸ºå®¢æˆ·ç«¯ï¼Œç”¨æ ‡å‡†çš„ NGINX ä½œä¸ºåç«¯æœåŠ¡ã€‚</p><h4 id="å“åº”æ—¶é—´"><a href="#å“åº”æ—¶é—´" class="headerlink" title="å“åº”æ—¶é—´"></a>å“åº”æ—¶é—´</h4><p>å“åº”æ—¶é—´å¾ˆé‡è¦ï¼Œæœ‰åŠ©äºæˆ‘ä»¬ç†è§£è¿æ¥å’Œè¯·æ±‚çš„å·®å¼‚ã€‚å…¸å‹æƒ…å†µä¸‹ï¼Œå¤šæ•°å¾®æœåŠ¡éƒ½ä¼šä½¿ç”¨æŒä¹…æˆ–è€… <code>keepalive</code> è¿æ¥ï¼Œè¿™æ„å‘³ç€æ¯ä¸ªè¿æ¥éƒ½ä¼šè¢«å¤šä¸ªè¯·æ±‚å¤ç”¨ï¼Œè€Œä¸æ˜¯æ¯ä¸ªè¯·æ±‚ä¸€æ¬¡è¿æ¥ã€‚è¿™å¾ˆé‡è¦ï¼Œå› ä¸ºå¤šæ•°è¿æ¥çš„æ–°å»ºè¿‡ç¨‹éƒ½éœ€è¦å®Œæˆä¸‰æ¬¡ TCP æ¡æ‰‹çš„è¿‡ç¨‹ï¼Œè¿™éœ€è¦æ¶ˆè€—æ—¶é—´ï¼Œä¹Ÿéœ€è¦åœ¨ Linux ç½‘ç»œæ ˆä¸­è¿›è¡Œæ›´å¤šæ“ä½œï¼Œä¹Ÿå°±ä¼šæ¶ˆè€—æ›´å¤š CPU å’Œæ—¶é—´ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/Picture1.png" alt="Round-Trip Response TIme vs Number of Services"></p><p>è¿™å¼ å›¾å±•ç¤ºäº†ä¸¤ä¸ªå…³é”®ç‚¹ï¼š</p><ul><li>iptables å’Œ IPVS çš„å¹³å‡å“åº”æ—¶é—´åœ¨ 1000 ä¸ªæœåŠ¡ï¼ˆ10000 ä¸ª Podï¼‰ä»¥ä¸Šæ—¶ï¼Œä¼šå¼€å§‹è§‚å¯Ÿåˆ°å·®å¼‚ã€‚</li><li>åªæœ‰åœ¨æ¯æ¬¡è¯·æ±‚éƒ½å‘èµ·æ–°è¿æ¥çš„æƒ…å†µä¸‹ï¼Œä¸¤ç§æ¨¡å¼çš„å·®å¼‚æ‰æ¯”è¾ƒæ˜æ˜¾ã€‚</li></ul><p>ä¸ç®¡æ˜¯ iptables è¿˜æ˜¯ IPVSï¼Œkube-proxy çš„å“åº”æ—¶é—´å¼€é”€éƒ½æ˜¯å’Œå»ºç«‹è¿æ¥çš„æ•°é‡ç›¸å…³çš„ï¼Œè€Œä¸æ˜¯æ•°æ®åŒ…æˆ–è€…è¯·æ±‚æ•°é‡ï¼Œè¿™æ˜¯å› ä¸º Linux ä½¿ç”¨äº† Conntrackï¼Œèƒ½å¤Ÿé«˜æ•ˆåœ°å°†æ•°æ®åŒ…å’Œç°å­˜è¿æ¥å…³è”èµ·æ¥ã€‚å¦‚æœæ•°æ®åŒ…èƒ½å¤Ÿè¢« Conntrack æˆåŠŸåŒ¹é…ï¼Œé‚£å°±ä¸éœ€è¦é€šè¿‡ kube-proxy çš„ iptables æˆ– IPVS è§„åˆ™æ¥æ¨ç®—å»å‘ã€‚Linux conntrack éå¸¸æ£’ï¼ï¼ˆç»å¤§å¤šæ•°æ—¶å€™ï¼‰</p><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œä¾‹å­ä¸­çš„æœåŠ¡ç«¯å¾®æœåŠ¡ä½¿ç”¨ NGINX æä¾›ä¸€ä¸ªé™æ€å°é¡µé¢ã€‚å¤šæ•°å¾®æœåŠ¡è¦åšæ›´å¤šæ“ä½œï¼Œå› æ­¤ä¼šäº§ç”Ÿæ›´é«˜çš„å“åº”æ—¶é—´ï¼Œä¹Ÿå°±æ˜¯ kube-proxy å¤„ç†è¿‡ç¨‹åœ¨æ€»ä½“æ—¶é—´ä¸­çš„å æ¯”ä¼šå‡å°‘ã€‚</p><p>è¿˜æœ‰ä¸ªéœ€è¦è§£é‡Šçš„å¤æ€ªé—®é¢˜ï¼šæ—¢ç„¶ IPVS çš„è¿æ¥è¿‡ç¨‹å¤æ‚åº¦æ˜¯ O(1)ï¼Œä¸ºä»€ä¹ˆåœ¨ 10,000 æœåŠ¡çš„æƒ…å†µä¸‹ï¼Œé Keepalive çš„å“åº”æ—¶é—´è¿˜æ˜¯æé«˜äº†ï¼Ÿæˆ‘ä»¬éœ€è¦æ·±å…¥æŒ–æ˜æ›´å¤šå†…å®¹æ‰èƒ½è§£é‡Šè¿™ä¸€é—®é¢˜ï¼Œä½†æ˜¯å…¶ä¸­ä¸€ä¸ªå› ç´ å°±æ˜¯å› ä¸ºä¸Šå‡çš„ CPU ç”¨é‡æ‹–æ…¢äº†æ•´ä¸ªç³»ç»Ÿã€‚è¿™å°±æ˜¯ä¸‹ä¸€ä¸ªä¸»é¢˜éœ€è¦æ¢ç©¶çš„å†…å®¹ã€‚</p><h4 id="CPU-ç”¨é‡"><a href="#CPU-ç”¨é‡" class="headerlink" title="CPU ç”¨é‡"></a>CPU ç”¨é‡</h4><p>ä¸ºäº†æè¿° CPU ç”¨é‡ï¼Œä¸‹å›¾å…³æ³¨çš„æ˜¯æœ€å·®æƒ…å†µï¼šä¸ä½¿ç”¨æŒä¹…/keepalive è¿æ¥çš„æƒ…å†µä¸‹ï¼Œkube-proxy ä¼šæœ‰æœ€å¤§çš„å¤„ç†å¼€é”€ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/Picture2.png" alt="Total CPU"></p><p>ä¸Šå›¾è¯´æ˜äº†ä¸¤ä»¶äº‹ï¼š</p><ul><li>åœ¨è¶…è¿‡ 1000 ä¸ªæœåŠ¡ï¼ˆä¹Ÿå°±æ˜¯ 10,000 ä¸ª Podï¼‰çš„æƒ…å†µä¸‹ï¼ŒCPU ç”¨é‡å·®å¼‚æ‰å¼€å§‹æ˜æ˜¾ã€‚</li><li>åœ¨ä¸€ä¸‡ä¸ªæœåŠ¡çš„æƒ…å†µä¸‹ï¼ˆåä¸‡ä¸ªåç«¯ Podï¼‰ï¼Œiptables æ¨¡å¼å¢é•¿äº† 0.35 ä¸ªæ ¸å¿ƒçš„å ç”¨ï¼Œè€Œ IPVS æ¨¡å¼ä»…å¢é•¿äº† 8%ã€‚</li></ul><p>æœ‰ä¸¤ä¸ªä¸»è¦å› ç´ é€ æˆ CPU ç”¨é‡å¢é•¿ï¼š</p><p>ç¬¬ä¸€ä¸ªå› ç´ æ˜¯ï¼Œç¼ºçœæƒ…å†µä¸‹ kube-proxy æ¯ 30 ç§’ä¼šç”¨æ‰€æœ‰æœåŠ¡å¯¹å†…æ ¸é‡æ–°ç¼–ç¨‹ã€‚è¿™ä¹Ÿè§£é‡Šäº†ä¸ºä»€ä¹ˆ IPVS æ¨¡å¼ä¸‹ï¼Œæ–°å»ºè¿æ¥çš„ O(1) å¤æ‚åº¦ä¹Ÿä»ç„¶ä¼šäº§ç”Ÿæ›´å¤šçš„ CPU å ç”¨ã€‚å¦å¤–ï¼Œå¦‚æœæ˜¯æ—§ç‰ˆæœ¬å†…æ ¸ï¼Œé‡æ–°ç¼–ç¨‹ iptables çš„ API ä¼šæ›´æ…¢ã€‚æ‰€ä»¥å¦‚æœä½ ç”¨çš„å†…æ ¸è¾ƒæ—§ï¼Œiptables æ¨¡å¼å¯èƒ½ä¼šå ç”¨æ›´å¤šçš„ CPUã€‚</p><p>å¦ä¸€ä¸ªå› ç´ æ˜¯ï¼Œkube-proxy ä½¿ç”¨ IPVS æˆ–è€… iptables å¤„ç†æ–°è¿æ¥çš„æ¶ˆè€—ã€‚å¯¹ iptables æ¥è¯´ï¼Œé€šå¸¸æ˜¯ O(n) çš„å¤æ‚åº¦ã€‚åœ¨å­˜åœ¨å¤§é‡æœåŠ¡çš„æƒ…å†µä¸‹ï¼Œä¼šå‡ºç°æ˜¾è‘—çš„ CPU å ç”¨å‡é«˜ã€‚ä¾‹å¦‚åœ¨ 10,000 æœåŠ¡ï¼ˆ100,000 ä¸ªåç«¯ Podï¼‰çš„æƒ…å†µä¸‹ï¼Œiptables ä¼šä¸ºæ¯ä¸ªè¯·æ±‚çš„æ¯ä¸ªè¿æ¥å¤„ç†å¤§çº¦ 20000 æ¡è§„åˆ™ã€‚å¦‚æœä½¿ç”¨ NINGX ç¼ºçœæ¯è¿æ¥ 100 è¯·æ±‚çš„ keepalive è®¾ç½®ï¼Œkube-proxy çš„ iptables è§„åˆ™æ‰§è¡Œæ¬¡æ•°ä¼šå‡å°‘ä¸º 1%ï¼Œä¼šæŠŠ iptables çš„ CPU æ¶ˆè€—é™ä½åˆ°å’Œ IPVS ç±»ä¼¼çš„æ°´å¹³ã€‚</p><p>å®¢æˆ·ç«¯å¾®æœåŠ¡ä¼šç®€å•çš„ä¸¢å¼ƒå“åº”å†…å®¹ã€‚çœŸå®ä¸–ç•Œä¸­è‡ªç„¶ä¼šè¿›è¡Œæ›´å¤šå¤„ç†ï¼Œä¹Ÿä¼šé€ æˆæ›´å¤šçš„ CPU æ¶ˆè€—ï¼Œä½†æ˜¯ä¸ä¼šå½±å“ CPU æ¶ˆè€—éšæœåŠ¡æ•°é‡å¢é•¿çš„äº‹å®ã€‚</p><h4 id="ç»“è®º"><a href="#ç»“è®º" class="headerlink" title="ç»“è®º"></a>ç»“è®º</h4><p>åœ¨è¶…è¿‡ 1000 æœåŠ¡çš„è§„æ¨¡ä¸‹ï¼Œkube-proxy çš„ IPVS æ¨¡å¼ä¼šæœ‰æ›´å¥½çš„æ€§èƒ½è¡¨ç°ã€‚è™½ç„¶å¯èƒ½æœ‰å¤šç§ä¸åŒæƒ…å†µï¼Œä½†æ˜¯é€šå¸¸æ¥è¯´ï¼Œè®©å¾®æœåŠ¡ä½¿ç”¨æŒä¹…è¿æ¥ã€è¿è¡Œç°ä»£å†…æ ¸ï¼Œä¹Ÿèƒ½å–å¾—è¾ƒå¥½çš„æ•ˆæœã€‚å¦‚æœè¿è¡Œçš„å†…æ ¸è¾ƒæ—§ï¼Œæˆ–è€…æ— æ³•ä½¿ç”¨æŒä¹…è¿æ¥ï¼Œé‚£ä¹ˆ IPVS æ¨¡å¼å¯èƒ½æ˜¯ä¸ªæ›´å¥½çš„é€‰æ‹©ã€‚</p><p>æŠ›å¼€æ€§èƒ½é—®é¢˜ä¸è°ˆï¼ŒIPVS æ¨¡å¼è¿˜æœ‰ä¸ªå¥½å¤„å°±æ˜¯å…·æœ‰æ›´å¤šçš„è´Ÿè½½å‡è¡¡ç®—æ³•å¯ä¾›é€‰æ‹©ã€‚</p><p>å¦‚æœä½ è¿˜ä¸ç¡®å®š IPVS æ˜¯å¦åˆé€‚ï¼Œé‚£å°±ç»§ç»­ä½¿ç”¨ iptables æ¨¡å¼å¥½äº†ã€‚è¿™ç§ä¼ ç»Ÿæ¨¡å¼æœ‰å¤§é‡çš„ç”Ÿäº§æ¡ˆä¾‹æ”¯æ’‘ï¼Œä»–æ˜¯ä¸€ä¸ªä¸å®Œç¾çš„ç¼ºçœé€‰é¡¹ã€‚</p><h4 id="è¡¥å……ï¼šCalico-å’Œ-kube-proxy-çš„-iptables-æ¯”è¾ƒ"><a href="#è¡¥å……ï¼šCalico-å’Œ-kube-proxy-çš„-iptables-æ¯”è¾ƒ" class="headerlink" title="è¡¥å……ï¼šCalico å’Œ kube-proxy çš„ iptables æ¯”è¾ƒ"></a>è¡¥å……ï¼šCalico å’Œ kube-proxy çš„ iptables æ¯”è¾ƒ</h4><p>æœ¬æ–‡ä¸­æˆ‘ä»¬çœ‹åˆ°ï¼Œkube-proxy ä¸­çš„ iptables ç”¨æ³•åœ¨å¤§è§„æ¨¡é›†ç¾¤ä¸­å¯èƒ½ä¼šäº§ç”Ÿæ€§èƒ½é—®é¢˜ã€‚æœ‰äººé—®æˆ‘ Calico ä¸ºä»€ä¹ˆæ²¡æœ‰ç±»ä¼¼çš„é—®é¢˜ã€‚ç­”æ¡ˆæ˜¯ Calico ä¸­ kube-proxy çš„ç”¨æ³•æ˜¯ä¸åŒçš„ã€‚kube-proxy ä½¿ç”¨äº†ä¸€ä¸ªå¾ˆé•¿çš„è§„åˆ™é“¾æ¡ï¼Œé“¾æ¡é•¿åº¦ä¼šéšç€é›†ç¾¤è§„æ¨¡è€Œå¢é•¿ï¼ŒCalico ä½¿ç”¨çš„æ˜¯ä¸€ä¸ªå¾ˆçŸ­çš„ä¼˜åŒ–è¿‡çš„è§„åˆ™é“¾ï¼Œç»ç”± ipsets çš„åŠ æŒï¼Œä¹Ÿå…·å¤‡äº† O(1) å¤æ‚åº¦çš„æŸ¥è¯¢èƒ½åŠ›ã€‚</p><p>ä¸‹å›¾è¯æ˜äº†è¿™ä¸€è§‚ç‚¹ï¼Œå…¶ä¸­å±•ç¤ºäº†æ¯æ¬¡è¿æ¥è¿‡ç¨‹ä¸­ï¼Œkube-proxy å’Œ Calico ä¸­ iptables è§„åˆ™æ•°é‡çš„å¹³å‡å€¼ã€‚è¿™é‡Œå‡è®¾é›†ç¾¤ä¸­çš„èŠ‚ç‚¹å¹³å‡æœ‰ 30 ä¸ª Podï¼Œæ¯ä¸ª Pod å…·æœ‰ 3 ä¸ªç½‘ç»œè§„åˆ™ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/Picture3.png" alt="calico vs kube-proxy"></p><p>å³ä½¿æ˜¯ä½¿ç”¨ 10,000 ä¸ªæœåŠ¡å’Œ 100,000 ä¸ª Pod çš„æƒ…å†µä¸‹ï¼ŒCalico æ¯è¿æ¥æ‰§è¡Œçš„ iptables è§„åˆ™ä¹Ÿåªæ˜¯å’Œ kube-proxy åœ¨ 20 æœåŠ¡ 200 ä¸ª Pod çš„æƒ…å†µåŸºæœ¬ä¸€è‡´ã€‚</p><h2 id="å®‰å…¨åŠ å›º"><a href="#å®‰å…¨åŠ å›º" class="headerlink" title="å®‰å…¨åŠ å›º"></a>å®‰å…¨åŠ å›º</h2><h3 id="ç®€ä»‹ï¼šCIS-Kubernetes-å®‰å…¨åŸºå‡†æŒ‡å—"><a href="#ç®€ä»‹ï¼šCIS-Kubernetes-å®‰å…¨åŸºå‡†æŒ‡å—" class="headerlink" title="ç®€ä»‹ï¼šCIS Kubernetes å®‰å…¨åŸºå‡†æŒ‡å—"></a><a href="https://blog.fleeto.us/post/cis-benchmark-brief/" target="_blank" rel="noopener">ç®€ä»‹ï¼šCIS Kubernetes å®‰å…¨åŸºå‡†æŒ‡å—</a></h3><h3 id="33-ä¸ª-Kubernetes-å®‰å…¨å·¥å…·"><a href="#33-ä¸ª-Kubernetes-å®‰å…¨å·¥å…·" class="headerlink" title="33 ä¸ª Kubernetes å®‰å…¨å·¥å…·"></a><a href="https://blog.fleeto.us/post/33-kubernetes-security-tools/" target="_blank" rel="noopener">33 ä¸ª Kubernetes å®‰å…¨å·¥å…·</a></h3><h3 id="å·¥å…·"><a href="#å·¥å…·" class="headerlink" title="å·¥å…·"></a>å·¥å…·</h3><h4 id="TUF"><a href="#TUF" class="headerlink" title="TUF"></a><a href="https://theupdateframework.github.io/" target="_blank" rel="noopener">TUF</a></h4><p>TUF æ˜¯ä¸€é¡¹ç”¨äºä¿æŠ¤è½¯ä»¶æ›´æ–°ç³»ç»Ÿçš„å¼€æºå®‰å…¨æŠ€æœ¯ï¼Œä¹Ÿæ˜¯ä»äº‘åŸç”Ÿè®¡ç®—åŸºé‡‘ä¼šæ¯•ä¸šçš„ç¬¬ä¸€ä¸ªä»¥è§„èŒƒä¸å®‰å…¨æ€§ä¸ºé‡ç‚¹çš„é¡¹ç›®ã€‚ä¸æ­¤åŒæ—¶ï¼ŒTUF è¿˜æ˜¯é¦–ä¸ªæºè‡ªé«˜æ ¡çš„ CNCF æ¯•ä¸šé¡¹ç›®ã€‚</p><h4 id="kube-score"><a href="#kube-score" class="headerlink" title="kube-score"></a><a href="https://github.com/zegl/kube-score" target="_blank" rel="noopener">kube-score</a></h4><p>kube-score æ˜¯ K8s å¯¹è±¡é™æ€æ£€æŸ¥å·¥å…·ï¼Œé€šè¿‡åˆ†æ K8s å¯¹è±¡çš„ Yaml æ–‡ä»¶åšä¸€äº›æ¨èï¼Œä»¥æå‡å¯é æ€§å’Œå®‰å…¨æ€§ã€‚</p><h2 id="Ingress"><a href="#Ingress" class="headerlink" title="Ingress"></a>Ingress</h2><h3 id="å¸¸è§-ingress-å¯¹æ¯”åˆ—è¡¨"><a href="#å¸¸è§-ingress-å¯¹æ¯”åˆ—è¡¨" class="headerlink" title="å¸¸è§ ingress å¯¹æ¯”åˆ—è¡¨"></a>å¸¸è§ ingress å¯¹æ¯”åˆ—è¡¨</h3><table><thead><tr><th><a href="https://medium.com/flant-com/comparing-ingress-controllers-for-kubernetes-9b397483b46b" target="_blank" rel="noopener">å…¨æ–‡</a></th><th>Kubernetes Ingress</th><th>NGINX Ingress</th><th>Traefik</th><th>HAproxy</th><th>Contour</th></tr></thead><tbody><tr><td>Protocol</td><td>http/https, http2, grpc, tcp/udp (partial)</td><td>http/https, http2, grpc, tcp/udp</td><td>http/https, http2 (h2c), grpc, tcp, tcp+tls</td><td>http/https, http2, grpc, tcp, tcp+tls</td><td>http/https, http2, grpc, tcp/udp, tcp+tls</td></tr><tr><td>base</td><td>nginx</td><td>nginx/nginx plus</td><td>traefik</td><td>haproxy</td><td>envoy</td></tr><tr><td>Traffic routing</td><td>host, path (with regex)</td><td>host, path</td><td>host (regex), path (regex), headers (regex), query, path prefix, method</td><td>host, path</td><td>host, path</td></tr><tr><td>Namespace limitations</td><td>All cluster or specified namespaces</td><td>All cluster or specified namespaces</td><td>All cluster or specified namespaces</td><td>All cluster or specified namespaces</td><td>All cluster or specified namespaces</td></tr><tr><td>Traffic distribution</td><td>canary, a/b (cookie balancing)</td><td>-</td><td>canary, blue-green, shadowing</td><td>blue-green, shadowing</td><td>canary, blue-green</td></tr><tr><td>Upstream probes</td><td>retry, timeouts</td><td>retry, active health checks (based on http probe for pod)</td><td>retry, timeouts, active, circuit breaker</td><td>check-uri, check-address, check-port</td><td>timeouts, active</td></tr><tr><td>è´Ÿè½½å‡è¡¡</td><td>round-robin, sticky sessions, least-conn, ip-hash, ewma</td><td>round-robin, least-conn, least-time, random, sticky sessions</td><td>weighted-round-robin, dynamic-round-robin, sticky sessions</td><td>round-robin, static-rr, leastconn, first, source, uri, url_param, header, sticky sessions</td><td>round-robin, sticky sessions, weighted-least-request, ring hash, maglev, random</td></tr><tr><td>Authentication</td><td>Basic, Client cert, external Basic, external OAuth</td><td>Basic</td><td>Basic, auth-url, auth-tls, external auth</td><td>Basic, OAuth, Auth TLS</td><td>-</td></tr><tr><td>Paid subscription</td><td>-</td><td>+</td><td>+</td><td>+</td><td>-</td></tr><tr><td>GUI</td><td>-</td><td>+</td><td>+</td><td>-</td><td>-</td></tr><tr><td>JWT validation</td><td>-</td><td>+</td><td>-</td><td>+</td><td>-</td></tr><tr><td>Basic DDoS protection</td><td>rate limit, limit conn, liimt rps, limit rpm, limit-rate-after, limit-whitelist</td><td>rate limit, rate-limit-burst</td><td>max-conn, rate limit, ip whitelist</td><td>limit-rps, limit-connections, limit-whitelist</td><td>max-conn, max-request</td></tr><tr><td>Requests tracing</td><td>+</td><td>-</td><td>+</td><td>-</td><td>-</td></tr><tr><td>Config customization</td><td>+</td><td>+</td><td>+</td><td>+</td><td>-</td></tr><tr><td>WAF</td><td>lua-resty-waf, ModSecurity</td><td>+</td><td>-</td><td>ModSecurity</td><td>-</td></tr></tbody></table><h3 id="Ingress-NGINX"><a href="#Ingress-NGINX" class="headerlink" title="Ingress NGINX"></a><a href="https://github.com/kubernetes/ingress-nginx" target="_blank" rel="noopener">Ingress NGINX</a></h3><p>Kubernetes å®˜æ–¹ç»´æŠ¤çš„æ–¹æ¡ˆ</p><h3 id="Traefik"><a href="#Traefik" class="headerlink" title="Traefik"></a><a href="https://github.com/containous/traefik" target="_blank" rel="noopener">Traefik</a></h3><p>æ˜¯ä¸€ä¸ªç”¨ Golang å¼€å‘çš„è½»é‡çº§çš„ http åå‘ä»£ç†å’Œè´Ÿè½½å‡è¡¡å™¨ï¼Œè™½ç„¶ç›¸æ¯”äº nginx ï¼Œå®ƒæ˜¯åèµ·ä¹‹ç§€ï¼Œä½†æ˜¯å®ƒå¤©ç„¶æ‹¥æŠ± Kubernetesï¼Œç›´æ¥ä¸é›†ç¾¤ K8s çš„ api Serveré€šä¿¡ï¼Œååº”éå¸¸è¿…é€Ÿï¼Œå®æ—¶æ„ŸçŸ¥é›†ç¾¤ä¸­ ingress å®šä¹‰çš„è·¯ç”±è§„åˆ™é›†åˆå’Œåç«¯ Serviceã€Pod çš„å˜åŒ–ï¼Œè‡ªåŠ¨çƒ­æ›´æ–° Traefik åç«¯é…ç½®ï¼Œæ ¹æœ¬ä¸ç”¨åˆ›å»º ingress controller å¯¹è±¡ï¼ŒåŒæ—¶è¿˜æä¾›äº†å‹å¥½çš„æ§åˆ¶é¢æ¿å’Œç›‘æ§ç•Œé¢ï¼Œä¸ä»…å¯ä»¥æ–¹ä¾¿åœ°æŸ¥çœ‹ Traefik æ ¹æ® ingress ç”Ÿæˆçš„è·¯ç”±é…ç½®ä¿¡æ¯ï¼Œè¿˜å¯ä»¥æŸ¥çœ‹ç»Ÿè®¡çš„ä¸€äº›æ€§èƒ½æŒ‡æ ‡æ•°æ®ï¼Œå¦‚ï¼šæ€»å“åº”æ—¶é—´ã€å¹³å‡å“åº”æ—¶é—´ã€ä¸åŒçš„å“åº”ç è¿”å›çš„æ€»æ¬¡æ•°ç­‰ã€‚</p><h3 id="Contour"><a href="#Contour" class="headerlink" title="Contour"></a><a href="https://github.com/projectcontour/contour" target="_blank" rel="noopener">Contour</a></h3><p>Contour ä¸ä»…åŸºäº Envoyï¼Œè€Œä¸”è¿˜ä¸è¯¥æµè¡Œä»£ç†çš„ä½œè€…å…±åŒå¼€å‘ã€‚é€šè¿‡ç‰¹æ®Šçš„ CRDï¼ˆç§°ä¸º Ingress Route çš„æ–°API ï¼‰ç®¡ç† Ingress èµ„æºçš„èƒ½åŠ›æ˜¯å…¶ç‰¹æ®ŠåŠŸèƒ½ã€‚å¯¹äºå…·æœ‰å¤šä¸ªå¼€å‘å›¢é˜Ÿå¹¶å‘ä½¿ç”¨ä¸€ä¸ªé›†ç¾¤çš„ç»„ç»‡ï¼Œè¿™æœ‰åŠ©äºä¿æŠ¤ç›¸é‚»ç¯å¢ƒä¸­çš„æµé‡å¹¶ä¿æŠ¤å®ƒä»¬å…å— Ingress èµ„æºæ›´æ”¹æ—¶äº§ç”Ÿçš„é”™è¯¯çš„å½±å“ã€‚</p><p>å®ƒè¿˜æä¾›äº†ä¸€ç»„æ‰©å±•çš„å¹³è¡¡ç®—æ³•ï¼ˆé•œåƒï¼Œè‡ªåŠ¨é‡å¤ï¼Œé™åˆ¶è¯·æ±‚ç‡ç­‰ç­‰ï¼‰ï¼Œè¯¦ç»†çš„æµé‡å’Œæ•…éšœç›‘æ§ã€‚å¯¹äºæŸäº›äººæ¥è¯´ï¼Œä¹Ÿè®¸ç¼ºå°‘å¯¹ç²˜æ€§ä¼šè®®çš„æ”¯æŒå°†æ˜¯ä¸€ä¸ªä¸¥é‡çš„ç¼ºé™·ï¼ˆæœè¿™ä¸ªæ–¹å‘çš„ <a href="https://link.zhihu.com/?target=https%3A//github.com/projectcontour/contour/issues/361">æŒç»­åŠªåŠ›</a> å·²ç»èµ°äº†å¾ˆé•¿ä¸€æ®µè·¯ï¼‰ã€‚</p><h4 id="F5-BIG-IP-Controller"><a href="#F5-BIG-IP-Controller" class="headerlink" title="F5 BIG-IP Controller"></a><a href="https://clouddocs.f5.com/products/connectors/K8s-bigip-ctlr/v1.5/" target="_blank" rel="noopener">F5 BIG-IP Controller</a></h4><p>F5 æ‰€å¼€å‘çš„æ§åˆ¶å™¨ï¼Œå®ƒèƒ½å¤Ÿè®©ç®¡ç†å‘˜é€šè¿‡ CLI æˆ– API è®© Kubernetes ä¸ OpenShift ç®¡ç† F5 BIG-IP è®¾å¤‡ã€‚</p><h2 id="æ€§èƒ½æµ‹è¯•"><a href="#æ€§èƒ½æµ‹è¯•" class="headerlink" title="æ€§èƒ½æµ‹è¯•"></a>æ€§èƒ½æµ‹è¯•</h2><h3 id="é«˜å¯ç”¨æµ‹è¯•"><a href="#é«˜å¯ç”¨æµ‹è¯•" class="headerlink" title="é«˜å¯ç”¨æµ‹è¯•"></a>é«˜å¯ç”¨æµ‹è¯•</h3><h4 id="åº”ç”¨é«˜å¯ç”¨"><a href="#åº”ç”¨é«˜å¯ç”¨" class="headerlink" title="åº”ç”¨é«˜å¯ç”¨"></a>åº”ç”¨é«˜å¯ç”¨</h4><p>ä½¿ç”¨å·¥å…·éšæœºæ€æ­»é›†ç¾¤ä¸­ä¸€åŠçš„ Pod ï¼Œæ¥æµ‹è¯•å·¥ä½œè´Ÿè½½çš„å¯ç”¨æ€§ã€‚</p><ul><li><p><a href="https://github.com/berkay-dincer/kubethanos" target="_blank" rel="noopener">berkay-dincer/kubethanos</a></p></li><li><p><a href="https://github.com/asobti" target="_blank" rel="noopener">asobti</a>/<a href="https://github.com/asobti/kube-monkey" target="_blank" rel="noopener">kube-monkey</a></p></li><li><p><a href="https://github.com/linki" target="_blank" rel="noopener">linki</a>/<a href="https://github.com/linki/chaoskube" target="_blank" rel="noopener">chaoskube</a></p></li></ul><h3 id="ç½‘ç»œæ€§èƒ½æµ‹è¯•"><a href="#ç½‘ç»œæ€§èƒ½æµ‹è¯•" class="headerlink" title="ç½‘ç»œæ€§èƒ½æµ‹è¯•"></a>ç½‘ç»œæ€§èƒ½æµ‹è¯•</h3><h4 id="End-to-End-Testing-in-Kubernetes"><a href="#End-to-End-Testing-in-Kubernetes" class="headerlink" title="End-to-End Testing in Kubernetes"></a><a href="https://github.com/kubernetes/community/blob/master/contributors/devel/sig-testing/e2e-tests.md" target="_blank" rel="noopener">End-to-End Testing in Kubernetes</a></h4><h3 id="å­˜å‚¨æ€§èƒ½æµ‹è¯•"><a href="#å­˜å‚¨æ€§èƒ½æµ‹è¯•" class="headerlink" title="å­˜å‚¨æ€§èƒ½æµ‹è¯•"></a>å­˜å‚¨æ€§èƒ½æµ‹è¯•</h3><ul><li><a href="https://blog.fleeto.us/post/kubernetes-storage-performance-comparison/" target="_blank" rel="noopener">Kubernetes å­˜å‚¨æ€§èƒ½å¯¹æ¯”</a>_</li><li><a href="https://www.v2ex.com/t/453961" target="_blank" rel="noopener">K8såˆ†å¸ƒå¼å­˜å‚¨æ–¹æ¡ˆçš„é€‰æ‹©</a></li><li><a href="http://www.youruncloud.com/blog/131.html" target="_blank" rel="noopener">Kubernetesç½‘ç»œåŸç†åŠæ–¹æ¡ˆ</a></li><li><a href="http://www.yangguanjun.com/2017/09/04/kubernetes-storage-confuse/" target="_blank" rel="noopener">kubernetesé‡Œå­˜å‚¨æ¦‚å¿µçš„è§£ç–‘</a></li><li><a href="https://www.ibm.com/developerworks/cn/opensource/os-cn-glusterfs-docker-volume/index.html" target="_blank" rel="noopener">åŸºäº GlusterFS å®ç° Docker é›†ç¾¤çš„åˆ†å¸ƒå¼å­˜å‚¨</a></li><li><a href="http://storage.it168.com/a2019/0114/5145/000005145601.shtml" target="_blank" rel="noopener">ä¸ºä»€ä¹ˆKubernetesçš„å­˜å‚¨å¦‚æ­¤è‰°éš¾?</a></li><li><a href="https://blog.fleeto.us/post/the-ultimate-rook-and-ceph-survival-guide/" target="_blank" rel="noopener">Rook &amp; Ceph ç®€ä»‹</a></li><li><a href="https://blog.gmem.cc/rook-based-K8s-storage-solution" target="_blank" rel="noopener">åŸºäºRookçš„Kuberneteså­˜å‚¨æ–¹æ¡ˆ</a></li><li><a href="http://www.strugglesquirrel.com/2018/08/09/cephå­˜å‚¨ä¸‰åäº¿ä¸ªå°æ–‡ä»¶çš„å®è·µ/" target="_blank" rel="noopener">cephå­˜å‚¨ä¸‰åäº¿ä¸ªå°æ–‡ä»¶çš„å®è·µ</a></li><li><a href="https://tech.meituan.com/2016/03/11/block-store.html" target="_blank" rel="noopener">åˆ†å¸ƒå¼å—å­˜å‚¨ç³»ç»ŸUrsaçš„è®¾è®¡ä¸å®ç°</a></li><li><a href="http://www.yangguanjun.com/2017/09/04/kubernetes-storage-confuse/" target="_blank" rel="noopener">æœ€è¿‘ä¹Ÿåœ¨æŠ˜è…¾ kubernetesç»™ä½ ä¸€ä¸ªåˆ†äº«</a></li></ul><h2 id="å‘¨è¾¹"><a href="#å‘¨è¾¹" class="headerlink" title="å‘¨è¾¹"></a>å‘¨è¾¹</h2><h3 id="dashboard"><a href="#dashboard" class="headerlink" title="dashboard"></a><a href="https://github.com/kubernetes/dashboard" target="_blank" rel="noopener">dashboard</a></h3><h3 id="Octant"><a href="#Octant" class="headerlink" title="Octant"></a><a href="https://github.com/vmware/octant" target="_blank" rel="noopener">Octant</a></h3><h3 id="Kuboard"><a href="#Kuboard" class="headerlink" title="Kuboard"></a><a href="https://kuboard.cn/" target="_blank" rel="noopener">Kuboard</a></h3><h3 id="Kustomize"><a href="#Kustomize" class="headerlink" title="Kustomize"></a><a href="https://github.com/kubernetes-sigs/kustomize/releases" target="_blank" rel="noopener">Kustomize</a></h3><p><strong>ç‰¹æ€§ï¼š</strong></p><ul><li>åŠŸèƒ½ç®€å•æ¸…æ™°ï¼Œkubectl ç›´æ¥æ”¯æŒã€‚</li><li>ä¸è€ƒè™‘æ´¾ç”Ÿï¼Œä»…ä½œä¸ºåº”ç”¨çš„ YAML ç»„ç»‡æ–¹å¼ä¹Ÿå¾ˆæœ‰å¸®åŠ©ã€‚</li><li>ä¹Ÿæœ‰è‡ªå·±çš„æ’ä»¶ç³»ç»Ÿã€‚ä¾‹å¦‚å¯ä»¥ç”¨ç®€å•çš„ YAML å®šä¹‰ï¼Œä½¿ç”¨æ–‡ä»¶ç”Ÿæˆ Configmap/Secretã€‚</li></ul><h3 id="helm"><a href="#helm" class="headerlink" title="helm"></a><a href="https://helm.sh/" target="_blank" rel="noopener">helm</a></h3><p><strong>ç‰¹æ€§ï¼š</strong></p><ul><li><p>å¼ºå¤§çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼šæœ‰ Tiller çš„å¸®åŠ©ï¼Œå¯ä»¥å®ç°å¯¹åº”ç”¨ç¨‹åºå®ä¾‹ï¼ˆReleaseï¼‰çš„æŸ¥è¯¢ã€å®‰è£…ã€å¸è½½ã€å‡çº§ã€å›æ»šç­‰å¤æ‚æ“ä½œã€‚</p></li><li><p>ä¸¥æ ¼çš„åŸºç¡€ç‰ˆæœ¬ç®¡æ§ï¼šChart æ˜¯ä¸€ç§æ¨¡æ¿ï¼ŒChart çš„ç”¨æˆ·ä»…èƒ½é€šè¿‡å¯¹ <code>values</code> çš„æ§åˆ¶æ¥å®šåˆ¶åº”ç”¨çš„éƒ¨ç½²è¡Œä¸ºï¼Œæ¨¡æ¿ä¸­æ²¡æœ‰æä¾›å˜é‡çš„ä½ç½®ï¼Œæ˜¯æ— æ³•åœ¨ä¸‹æ¸¸ç›´æ¥è¿›è¡Œå˜æ›´çš„ã€‚</p></li><li><p>æ–¹ä¾¿çš„å‘½ä»¤è¡Œï¼šå¯¹äºç®€å•å˜é‡ï¼Œå¯ä»¥åœ¨éƒ¨ç½²çš„åŒæ—¶ç›´æ¥æŒ‡å®šå†…å®¹ï¼Œæ–¹ä¾¿éƒ¨ç½²ã€‚</p></li><li><p>æ’ä»¶å’Œå·¥å…·ï¼šHelm æ‹¥è¶¸ä¼—å¤šï¼Œæä¾›äº†ä¸å°‘ç”¨äº CICD æˆ–è€…å…¶å®ƒæ–¹é¢è¾…åŠ©åŠŸèƒ½çš„æ’ä»¶å’Œå·¥å…·ã€‚</p><p><strong>V3</strong></p></li><li><p>ç§»é™¤Tiller ç»„ä»¶ï¼šåªæœ‰helmè¿™ä¸ªå®¢æˆ·ç«¯æ¥å’Œkubernetesé›†ç¾¤è¿›è¡Œäº¤äº’æ“ä½œã€‚helm2çš„äº¤äº’æµç¨‹ï¼š <code>helm client â€“gRPCâ€“&gt; helm server (Tiller) â€“&gt; kubernetes api (install chart)</code></p></li><li><p>Release name å¯ç¼©å°è‡³NamespaceèŒƒå›´ï¼ˆæ„å‘³ç€release name å¯é‡å¤ï¼‰ï¼šhelm2 ä¸­çš„ release name æ˜¯å…¨å±€çš„ï¼Œæ„å‘³ç€å³ä½¿å®‰è£…æŸä¸ªchartåˆ°ä¸åŒçš„Namespaceï¼Œrelease nameåå­—ä¹Ÿä¸èƒ½ä¸€æ ·ã€‚Chart Release è®°å½•éƒ½å’Œ Tiller æœåŠ¡ä¸€èµ·ï¼Œåœ¨ä¸€ä¸ª Namespace ä¸­ã€‚ç°åœ¨ç”±äºç§»é™¤äº† Tiller ç»„ä»¶ï¼Œæ¯ä¸ª chart çš„ Release è®°å½•ä¸å®ƒéƒ¨ç½²åˆ°å“ªä¸ª namespace ä¸€æ ·ï¼Œå­˜åœ¨åŒä¸€ä¸ª Namespaceä¸­ ã€‚è¿™æ ·å°±å¯ä»¥åœ¨ä¸åŒ Namespace ä¸­ä½¿ç”¨åŒä¸€ä¸ªRelease nameã€‚</p></li><li><p>é»˜è®¤å…³é—­éšæœºç”Ÿæˆrelease nameï¼Œéœ€è¦æ˜¾ç¤ºå¯ç”¨é€‰é¡¹ <code>--generate-name</code></p></li><li><p>ç§»é™¤ helm serve æä¾›æœ¬åœ°repository åŠŸèƒ½</p></li><li><p>å°†requirements.yamlçš„å†…å®¹ç§»åˆ°Chart.yamlæ–‡ä»¶ä¸­</p></li><li><p>æ”¯æŒ helm push åˆ°è¿œç«¯ chart repositoryï¼Œæ”¯æŒç™»é™†è®¤è¯</p></li><li><p>æ”¯æŒ Chart Libraryï¼ˆkeeping charts DRY.ï¼‰</p></li><li><p>ç®€åŒ–å†…ç½®æ¨¡ç‰ˆé‡Œé¢çš„å¯¹è±¡</p></li><li><p>ä½¿ç”¨JSONSchemaéªŒè¯chartçš„Values</p></li></ul><h3 id="Operator"><a href="#Operator" class="headerlink" title="Operator"></a><a href="https://coreos.com/operators/" target="_blank" rel="noopener">Operator</a></h3><p>Operator æ˜¯ç”± CoreOS å¼€å‘çš„ï¼Œç”¨æ¥æ‰©å±• Kubernetes APIï¼Œç‰¹å®šçš„åº”ç”¨ç¨‹åºæ§åˆ¶å™¨ï¼Œå®ƒç”¨æ¥åˆ›å»ºã€é…ç½®å’Œç®¡ç†å¤æ‚çš„æœ‰çŠ¶æ€åº”ç”¨ï¼Œå¦‚æ•°æ®åº“ã€ç¼“å­˜å’Œç›‘æ§ç³»ç»Ÿã€‚Operator åŸºäº Kubernetes çš„èµ„æºå’Œæ§åˆ¶å™¨æ¦‚å¿µä¹‹ä¸Šæ„å»ºï¼Œä½†åŒæ—¶åˆåŒ…å«äº†åº”ç”¨ç¨‹åºç‰¹å®šçš„é¢†åŸŸçŸ¥è¯†ã€‚åˆ›å»ºOperator çš„å…³é”®æ˜¯CRDï¼ˆè‡ªå®šä¹‰èµ„æºï¼‰çš„è®¾è®¡ã€‚</p><p>Kubernetes 1.7 ç‰ˆæœ¬ä»¥æ¥å°±å¼•å…¥äº†<a href="https://kubernetes.io/docs/concepts/api-extension/custom-resources/" target="_blank" rel="noopener">è‡ªå®šä¹‰æ§åˆ¶å™¨</a>çš„æ¦‚å¿µï¼Œè¯¥åŠŸèƒ½å¯ä»¥è®©å¼€å‘äººå‘˜æ‰©å±•æ·»åŠ æ–°åŠŸèƒ½ï¼Œæ›´æ–°ç°æœ‰çš„åŠŸèƒ½ï¼Œå¹¶ä¸”å¯ä»¥è‡ªåŠ¨æ‰§è¡Œä¸€äº›ç®¡ç†ä»»åŠ¡ï¼Œè¿™äº›è‡ªå®šä¹‰çš„æ§åˆ¶å™¨å°±åƒ Kubernetes åŸç”Ÿçš„ç»„ä»¶ä¸€æ ·ï¼ŒOperator ç›´æ¥ä½¿ç”¨ Kubernetes APIè¿›è¡Œå¼€å‘ï¼Œä¹Ÿå°±æ˜¯è¯´ä»–ä»¬å¯ä»¥æ ¹æ®è¿™äº›æ§åˆ¶å™¨å†…éƒ¨ç¼–å†™çš„è‡ªå®šä¹‰è§„åˆ™æ¥ç›‘æ§é›†ç¾¤ã€æ›´æ”¹ Pods/Servicesã€å¯¹æ­£åœ¨è¿è¡Œçš„åº”ç”¨è¿›è¡Œæ‰©ç¼©å®¹ã€‚</p><p>Operator Framework åŒæ ·ä¹Ÿæ˜¯ CoreOS å¼€æºçš„ä¸€ä¸ªç”¨äºå¿«é€Ÿå¼€å‘ Operator çš„å·¥å…·åŒ…ï¼Œè¯¥æ¡†æ¶åŒ…å«ä¸¤ä¸ªä¸»è¦çš„éƒ¨åˆ†ï¼š</p><ul><li><p>Operator SDK: æ— éœ€äº†è§£å¤æ‚çš„ Kubernetes API ç‰¹æ€§ï¼Œå³å¯è®©ä½ æ ¹æ®ä½ è‡ªå·±çš„ä¸“ä¸šçŸ¥è¯†æ„å»ºä¸€ä¸ª Operator åº”ç”¨ã€‚</p></li><li><p>Operator Lifecycle Manager OLM: å¸®åŠ©ä½ å®‰è£…ã€æ›´æ–°å’Œç®¡ç†è·¨é›†ç¾¤çš„è¿è¡Œä¸­çš„æ‰€æœ‰ Operatorï¼ˆä»¥åŠä»–ä»¬çš„ç›¸å…³æœåŠ¡ï¼‰</p><p><strong>å·¥ä½œæµç¨‹ï¼š</strong></p></li></ul><ol><li>ä½¿ç”¨ SDK åˆ›å»ºä¸€ä¸ªæ–°çš„ Operator é¡¹ç›®</li><li>é€šè¿‡æ·»åŠ è‡ªå®šä¹‰èµ„æºï¼ˆCRDï¼‰å®šä¹‰æ–°çš„èµ„æº API</li><li>æŒ‡å®šä½¿ç”¨ SDK API æ¥ watch çš„èµ„æº</li><li>å®šä¹‰ Operator çš„åè°ƒï¼ˆreconcileï¼‰é€»è¾‘</li><li>ä½¿ç”¨ Operator SDK æ„å»ºå¹¶ç”Ÿæˆ Operator éƒ¨ç½²æ¸…å•æ–‡ä»¶</li></ol><h3 id="kubebuilder"><a href="#kubebuilder" class="headerlink" title="kubebuilder"></a><a href="https://github.com/kubernetes-sigs/kubebuilder/releases" target="_blank" rel="noopener">kubebuilder</a></h3><p>ç›®å‰æ‰©å±• Kubernetes çš„ API çš„æ–¹å¼æœ‰åˆ›å»º <a href="https://jimmysong.io/kubernetes-handbook/concepts/crd.html" target="_blank" rel="noopener">CRD</a>ã€ä½¿ç”¨ <a href="https://jimmysong.io/kubernetes-handbook/develop/operator.html" target="_blank" rel="noopener">Operator</a> SDK ç­‰æ–¹å¼ï¼Œéƒ½éœ€è¦å†™å¾ˆå¤šçš„æ ·æœ¬æ–‡ä»¶ï¼ˆboilerplateï¼‰ï¼Œä½¿ç”¨èµ·æ¥ååˆ†éº»çƒ¦ã€‚ä¸ºäº†èƒ½å¤Ÿæ›´æ–¹ä¾¿æ„å»º Kubernetes API å’Œå·¥å…·ï¼Œå°±éœ€è¦ä¸€æ¬¾èƒ½å¤Ÿäº‹åŠåŠŸå€çš„å·¥å…·ï¼Œä¸å…¶ä»– Kubernetes API æ‰©å±•æ–¹æ¡ˆç›¸æ¯”ï¼Œkubebuilder æ›´åŠ ç®€å•æ˜“ç”¨ï¼Œå¹¶è·å¾—äº†ç¤¾åŒºçš„å¹¿æ³›æ”¯æŒã€‚</p><p>é€šè¿‡ Operator çš„æ–¹æ¡ˆï¼Œå¯ä»¥å¯¹ Kubernetes çš„åŠŸèƒ½è¿›è¡Œå‹å¥½åœ°æ‰©å±•ã€‚Operatpr = CRD + Controllerã€‚é¦–å…ˆé€šè¿‡ yaml å®šä¹‰ï¼Œç”Ÿæˆ CRD ï¼Œç„¶å Controller ä¸æ–­åœ°ç›‘å¬ etcd ä¸­çš„æ•°æ®ï¼Œæ‰§è¡Œç›¸åº”åŠ¨ä½œã€‚å¼€å‘ Operator æ—¶ï¼Œæœ‰å¾ˆå¤šç¹çä¸”é‡å¤çš„äº‹æƒ…ã€‚KubeBuilder å¯ä»¥å¸®åŠ©æˆ‘ä»¬å¿«é€Ÿç”Ÿæˆéª¨æ¶ä»£ç ï¼Œå¼€å‘ä¸€ä¸ª Kubernetes çš„æ‰©å±•åŠŸèƒ½ï¼Œ æ›´å¤šä»‹ç»å¯ä»¥å‚è€ƒæ–‡æ¡£ï¼š<a href="https://www.chenshaowen.com/blog/complex-application-management-framework-operator-for-kubernetes.html" target="_blank" rel="noopener">Kubernetes å¤æ‚æœ‰çŠ¶æ€åº”ç”¨ç®¡ç†æ¡†æ¶ â€“ Operator</a></p><p><strong>å·¥ä½œæµç¨‹ï¼š</strong></p><ol><li>åˆ›å»ºä¸€ä¸ªæ–°çš„å·¥ç¨‹ç›®å½•</li><li>åˆ›å»ºä¸€ä¸ªæˆ–å¤šä¸ªèµ„æº API CRD ç„¶åå°†å­—æ®µæ·»åŠ åˆ°èµ„æº</li><li>åœ¨æ§åˆ¶å™¨ä¸­å®ç°åè°ƒå¾ªç¯ï¼ˆreconcile loopï¼‰ï¼Œwatch é¢å¤–çš„èµ„æº</li><li>åœ¨é›†ç¾¤ä¸­è¿è¡Œæµ‹è¯•ï¼ˆè‡ªåŠ¨å®‰è£… CRD å¹¶è‡ªåŠ¨å¯åŠ¨æ§åˆ¶å™¨ï¼‰</li><li>æ›´æ–°å¼•å¯¼é›†æˆæµ‹è¯•æµ‹è¯•æ–°å­—æ®µå’Œä¸šåŠ¡é€»è¾‘</li><li>ä½¿ç”¨ç”¨æˆ·æä¾›çš„ Dockerfile æ„å»ºå’Œå‘å¸ƒå®¹å™¨</li></ol>]]></content>
    
    <summary type="html">
    
      
      
        
        
          &lt;blockquote&gt;
&lt;p&gt;ä¿—è¯è¯´æ–‡æ¡£å†™å¾—å¥½ï¼ŒåŒè¡ŒæŠ„åˆ°è€ğŸ˜‚
        
      
    
    </summary>
    
    
      <category term="æŠ€æœ¯" scheme="https://blog.k8s.li/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="å®¹å™¨" scheme="https://blog.k8s.li/tags/%E5%AE%B9%E5%99%A8/"/>
    
      <category term="K8s" scheme="https://blog.k8s.li/tags/K8s/"/>
    
      <category term="è°ƒç ”" scheme="https://blog.k8s.li/tags/%E8%B0%83%E7%A0%94/"/>
    
  </entry>
  
  <entry>
    <title>çŸ¥åè½¯ä»¶åŸºé‡‘ä¼šæ¦‚è§ˆ</title>
    <link href="https://blog.k8s.li/nonprofit-foundation-overview.html"/>
    <id>https://blog.k8s.li/nonprofit-foundation-overview.html</id>
    <published>2020-02-27T16:00:00.000Z</published>
    <updated>2020-02-29T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>For the benefit of all. â€”â€“ <a href="https://en.wikiquote.org/wiki/NASA" target="_blank" rel="noopener">NASA motto.</a></p></blockquote><p>åœ¨å»å¹´çš„æ—¶å€™å°±è®¡åˆ’ç€å†™ä¸€äº›å…³äºç¾å›½éè¥åˆ©æ€§ç»„ç»‡çš„ä¸€äº›æ–‡ç« ï¼Œæ¯”å¦‚å…³äº Linux  åŸºé‡‘ä¼šã€è‡ªç”±è½¯ä»¶åŸºé‡‘ä¼šã€ç”µå­å‰å“¨åŸºé‡‘ä¼šï¼Œæ‹–å»¶ç—‡çŠ¯äº†ä¸€ç›´æœªèƒ½æ›´æ–°ã€‚æœ€è¿‘å› ä¸ºç–«æƒ…å½±å“å§ï¼Œä¹Ÿè®©æˆ‘çœ‹åˆ°äº†è¿™ä¸ªç¤¾ä¼šå…¬æ°‘è‡ªå‘è‡ªæ•‘çš„èƒ½åŠ›åœ¨å®˜åƒšä½“åˆ¶ä¸‹è¢«ä¸¥æ ¼é™åˆ¶ï¼Œå‡ ä¹çœ‹ä¸åˆ°ç‹¬ç«‹çš„éç›ˆåˆ©ç»„ç»‡æ¥è¿›è¡Œè‡ªæ•‘ã€‚é¢å¯¹å¤©ç¾äººç¥¸ï¼Œè®©æˆ‘æƒ³èµ·äº† BBC çš„ä¸€éæŠ¥é“ <a href="https://www.bbc.com/zhongwen/simp/chinese-news-43972586" target="_blank" rel="noopener">æ±¶å·åœ°éœ‡åå¹´ç³»åˆ—â€”å…¬æ°‘ç¤¾ä¼šä»çˆ†å‘åˆ°æ²‰å¯‚çš„è‰°éš¾ä¹‹è·¯</a> ã€‚æ‰€ä»¥æœ€è¿‘å°±å¼€å§‹æ‰“ç®—å†™ä¸€äº›å…³äºéè¥åˆ©æ€§ç»„ç»‡çš„äº‹å„¿ï¼Œä»Šå¤©å°±å…ˆå¼€ä¸ªå¤´å†™ä¸ªç®€å•çš„ä»‹ç»ä¸€ä¸‹æˆ‘æ‰€ç†ŸçŸ¥çš„éè¥åˆ©æ€§ç»„ç»‡ï¼Œç»å¤§å¤šæ•°éƒ½æ˜¯å’Œå¼€æºè½¯ä»¶ã€è‡ªç”±è½¯ä»¶ã€äº’è”ç½‘ç­‰ç›¸å…³çš„ã€‚ä¹Ÿç®—æ˜¯ä¸ªæ™®åŠï¼Œè®©å¤§å®¶çŸ¥é“è‡ªå·±æ‰€ä½¿ç”¨çš„å¼€æºè½¯ä»¶/è‡ªç”±è½¯ä»¶å±äºå“ªä¸€äº›éç›ˆåˆ©ç»„ç»‡åœ¨ç»´æŠ¤å’Œæ”¯æŒã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/image-20200224135131632.png" alt="image-20200224135131632"></p><h2 id="éè¥åˆ©ç»„ç»‡ä¸åŸºé‡‘ä¼š"><a href="#éè¥åˆ©ç»„ç»‡ä¸åŸºé‡‘ä¼š" class="headerlink" title="éè¥åˆ©ç»„ç»‡ä¸åŸºé‡‘ä¼š"></a>éè¥åˆ©ç»„ç»‡ä¸åŸºé‡‘ä¼š</h2><h3 id="åŸºé‡‘ä¼š"><a href="#åŸºé‡‘ä¼š" class="headerlink" title="åŸºé‡‘ä¼š"></a>åŸºé‡‘ä¼š</h3><blockquote><p>åœ¨ç»´åŸºç™¾ç§‘ä¸­æè¿°åˆ°ï¼šåŸºé‡‘ä¼šæ˜¯åˆ©ç”¨è‡ªç„¶äººã€æ³•äººæˆ–è€…å…¶ä»–ç»„ç»‡æèµ çš„è´¢äº§ï¼Œä»äº‹æ…ˆå–„ã€å…¬ç›Šäº‹ä¸šçš„éè¥åˆ©æ€§è´¢å›¢æ³•äººï¼ˆStiftungï¼‰ã€‚æ³•äººï¼ˆJuristische Personï¼‰æ˜¯è‡ªç„¶äººä»¥å¤–ï¼Œç”±æ³•å¾‹æ‰€åˆ›è®¾ï¼Œå¾—ä¸ºæƒåˆ©åŠä¹‰åŠ¡ä¸»ä½“çš„å›¢ä½“ã€‚è‡ªæ³•äººä¹‹ç»„ç»‡å†…å®¹è§‚å¯Ÿï¼Œæœ‰ä»¥ç¤¾å‘˜çš„é›†åˆä¸ºä¸­å¿ƒè€…ç§°ä¸ºâ€œç¤¾å›¢â€ï¼Œæœ‰ä»¥ç‹¬ç«‹è´¢äº§ä¸ºä¸­å¿ƒè€…ç§°ä¸ºâ€œè´¢å›¢â€ã€‚æ³•äººæœ¬èº«ä¸ºæŠ½è±¡çš„â€œå•ä¸€ä½“â€ï¼ˆEinheitï¼‰ï¼Œä¸å„ç¤¾å‘˜æˆ–è´¢äº§åˆ†ç¦»ï¼Œå…·æœ‰ç‹¬ç«‹çš„æ³•äººæ ¼ï¼Œå¯ä»¥ç‹¬ç«‹ä¸ºæ³•å¾‹è¡Œä¸ºã€‚</p></blockquote><h3 id="éç›ˆåˆ©ç»„ç»‡"><a href="#éç›ˆåˆ©ç»„ç»‡" class="headerlink" title="éç›ˆåˆ©ç»„ç»‡"></a>éç›ˆåˆ©ç»„ç»‡</h3><blockquote><p>éè¥åˆ©ç»„ç»‡ï¼ˆè‹±è¯­ï¼šNonprofit  Organizationï¼ŒNPOï¼‰æ˜¯æŒ‡ä¸ä»¥è¥åˆ©ä¸ºç›®çš„ç»„ç»‡æˆ–å›¢ä½“[1]ï¼Œå…¶æ ¸å¿ƒç›®æ ‡é€šå¸¸æ˜¯æ”¯æŒæˆ–å¤„ç†ä¸ªäººå…³å¿ƒæˆ–è€…å…¬ä¼—å…³æ³¨çš„è®®é¢˜æˆ–äº‹ä»¶ï¼Œå› æ­¤å…¶æ‰€æ¶‰åŠçš„é¢†åŸŸéå¸¸å¹¿ï¼Œä»è‰ºæœ¯ã€æ…ˆå–„ã€æ•™è‚²ã€æ”¿æ²»ã€å…¬å…±æ”¿ç­–ã€å®—æ•™ã€å­¦æœ¯ã€ç¯ä¿ç­‰ï¼Œåˆ†åˆ«æ‹…ä»»èµ·å¼¥è¡¥ç¤¾ä¼šéœ€æ±‚ä¸æ”¿åºœä¾›ç»™é—´çš„è½å·®ã€‚</p></blockquote><p>æ‘˜è‡ªç»´åŸºç™¾ç§‘ <a href="https://zh.wikipedia.org/wiki/éç‡Ÿåˆ©çµ„ç¹”" target="_blank" rel="noopener">éè¥åˆ©ç»„ç»‡</a></p><p>é€šä¿—æ¥è®²ï¼Œéè¥åˆ©ç»„ç»‡çš„ç›®çš„ä¸æ˜¯ä¸ºäº†èµšé’±ï¼Œç›®çš„æ˜¯å‡ºäºæ”¯æŒå…¬ä¼—åˆ©ç›Šæ´»ç€ä¸ªäººè€ƒè™‘ï¼Œæ¯”å¦‚å®—æ•™ã€æ•™è‚²ã€æ…ˆå–„ã€ç¤¾ä¼šäº‹åŠ¡ã€å•†ä¸šåä¼šã€ç ”ç©¶æœºæ„ã€è‰ºæœ¯ä½“è‚²ç­‰ï¼Œå¯æ¶‰åŠçš„èŒƒå›´ç›¸å½“å¹¿ã€‚å…¶æœ€é‡è¦çš„ç‰¹å¾ä¹‹ä¸€æ˜¯å®ƒå¹¶ä¸ä¸ºæˆç«‹äººæ‰€æ‹¥æœ‰ï¼Œä¹Ÿä¸èƒ½ä¸ºæ”¿åºœæ‰€æ‹¥æœ‰ã€‚ä¸æˆç«‹è¥åˆ©å…¬å¸ä¸åŒï¼Œéè¥åˆ©ç»„ç»‡æˆç«‹äººä¸èƒ½æ¥å—å…¬å¸åˆ©æ¶¦åˆ†çº¢ã€‚ä½†æ˜¯ï¼Œæˆç«‹äººå¯ä»¥ç»™è‡ªå·±å‘æ”¾åˆç†çš„å·¥èµ„ã€‚å› ä¸ºéè¥åˆ©ç»„ç»‡æ˜¯é¢å‘å…¬ä¼—ï¼Œå› æ­¤å…¬å¸çš„è´¢åŠ¡å’Œç¨åŠ¡ä¹Ÿè¦å‘å…¬ä¼—å¼€æ”¾ã€‚</p><p><strong>ç‹¬ç«‹è‡ªä¸»ã€å…¬å¼€é€æ˜</strong> è¿™æ˜¯æˆ‘ä¸ªäººè®¤ä¸ºçš„éè¥åˆ©æ€§ç»„ç»‡æœ€é‡è¦çš„ä»·å€¼åŸåˆ™ã€‚</p><h3 id="åŸºé‡‘ä¼šä¸éç›ˆåˆ©ç»„ç»‡çš„å…³ç³»"><a href="#åŸºé‡‘ä¼šä¸éç›ˆåˆ©ç»„ç»‡çš„å…³ç³»" class="headerlink" title="åŸºé‡‘ä¼šä¸éç›ˆåˆ©ç»„ç»‡çš„å…³ç³»"></a>åŸºé‡‘ä¼šä¸éç›ˆåˆ©ç»„ç»‡çš„å…³ç³»</h3><p>æœ‰äººè¯´ä¸€å›¾èƒœåƒè¨€ï¼Œä»¥ä¸‹è¿™å¼ å›¾æ¥è‡ª SiobhÃ¡n çš„ç ”ç©¶ï¼šã€ŠNonprofit Foundations And Their Role In Community-Firm Software Collaborationã€‹è®ºæ–‡ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/nonprofit_foundation.png" alt="img"></p><h3 id="ç¨æ”¶æ¡æ¬¾"><a href="#ç¨æ”¶æ¡æ¬¾" class="headerlink" title="ç¨æ”¶æ¡æ¬¾"></a>ç¨æ”¶æ¡æ¬¾</h3><p>ä¾æ®ä¸åŒçš„å®—æ—¨å’Œæ´»åŠ¨ç±»å‹ï¼Œéè¥åˆ©ç»„ç»‡çš„ç›¸å…³ç¨æ³•æ¡æ¬¾å¤§è‡´å¯åˆ†ä¸º 501(c) ä»¥ä¸‹å‡ ç§ç±»å‹ã€‚</p><table><thead><tr><th>ç¨æ”¶ä»£ç </th><th>ç®€ä»‹</th><th>ç¨æ”¶ä¼˜æƒ </th></tr></thead><tbody><tr><td>501 (c) (1)</td><td>æ ¹æ®å›½ä¼šæ³•æ¡ˆï¼ŒåŒ…æ‹¬è”é‚¦ä¿¡ç”¨åˆä½œç¤¾æ³•å»ºç«‹çš„æ³•äººå›¢ä½“</td><td>Yes</td></tr><tr><td>501 (c) (2)</td><td>ä¸ºå…ç¨ç»„ç»‡ç®¡ç†èµ„äº§çš„æ³•äººå›¢ä½“</td><td>No</td></tr><tr><td>501 (c) (3)</td><td>å®—æ•™ã€æ•™è‚²ã€æ…ˆå–„ã€ç§‘å­¦ã€æ–‡å­¦ å›½é™…ä½“è‚²èµ›äº‹ç»„ç»‡ã€é˜²æ­¢è™å¾…å„¿ç«¥æˆ–åŠ¨ç‰©ç»„ç»‡</td><td>Yes</td></tr><tr><td>501 (c) (4)</td><td>å…¬æ°‘è”ç›Ÿã€ç¤¾ä¼šç¦åˆ©æœºæ„å’Œåœ°æ–¹é›‡å‘˜åä¼š</td><td>No, generally</td></tr><tr><td>501 (c) (5)</td><td>åŠ³åŠ¨ã€å†œä¸šå’Œå›­è‰ºç»„ç»‡</td><td>No</td></tr><tr><td>501 (c) (6)</td><td>å•†ä¸šè”ç›Ÿã€äº§ä¸šåä¼šã€æˆ¿åœ°äº§è”ç›Ÿç­‰ç»„ç»‡</td><td>No</td></tr><tr><td>501 (c) (7)</td><td>ç¤¾äº¤å›¢ä½“å’Œåº·ä¹ä¼š</td><td>No</td></tr></tbody></table><p>åœ¨è®¸å¤šç±»å‹çš„éè¥åˆ©ç»„ç»‡ä¸­ï¼Œäº«å—æœ€å¤šç¨æ”¶ä¼˜æƒ çš„æ˜¯ 501(c)(3)  ç±»å‹çš„ç»„ç»‡ï¼Œå³æŒ‰ç¨æ³•ç¬¬ 501(c)(3)  æ¡æ¬¾æˆç«‹çš„ç»„ç»‡ã€‚å®ƒå¯è±å…æ”¶å…¥ç¨ã€é”€å”®ç¨ç”šè‡³è´¢äº§ç¨ã€‚è¿™ä¸ªç»„ç»‡ä¹Ÿå¯ä»¥æ¥å—æŠµç¨æèµ ï¼Œäº«å—è¾ƒä½é‚®è´¹å’Œå¯ä»¥æ¥å—èµ„åŠ©ã€‚å› æ­¤ï¼Œè¿™ç±»ç»„ç»‡æ˜¯æœ€å¤šäººå¸Œæœ›æˆç«‹çš„ç»„ç»‡ï¼Œä¹Ÿæ˜¯æœ€éš¾è·å¾—æ‰¹å‡†çš„ç»„ç»‡ã€‚æ…ˆå–„æœºæ„è¾ƒèƒ½è·å¾—è¿™ç±»å…ç¨å¾…é‡ï¼Œç¾å›½å…¬æ°‘å‡å¦‚å‘è¿™äº›ç»„ç»‡ææ¬¾ï¼Œçº³ç¨äººèƒ½å¤Ÿåœ¨è‡ªå·±çš„æ”¶å…¥ç¨ä¸­æŠµç¨ã€‚æ²¡æœ‰è¿™ä¸€æ¡ï¼Œè®¸å¤šéè¥åˆ©ç»„ç»‡å°±ä¸èƒ½æ”¶åˆ°è¶³å¤Ÿçš„ææ¬¾ã€‚</p><blockquote><p>æ ¹æ®ç¾å›½æ³•å…¸ç¬¬ 26 ç«  501 æ¡ï¼ˆä¸¥è°¨çš„å†™æ³•æ˜¯ <a href="https://www.law.cornell.edu/uscode/text/26/501" target="_blank" rel="noopener">26 U.S. Code Â§â€¯501(c)(3)</a>ï¼‰ çš„è§„å®šï¼Œå¦‚æœä¸€ä¸ªæœºæ„è¿è¥çš„ç›®çš„é™å®šäºä¸€äº›ç‰¹å®šé¢†åŸŸï¼Œé‚£ä¹ˆè¿™ä¸ªæœºæ„å¯ä»¥è·å¾—ç¨åŠ¡å‡å…ã€‚è¿™äº›ç‰¹å®šé¢†åŸŸåŒ…æ‹¬ï¼ˆä½†ä¸é™äºï¼‰ï¼šå®—æ•™ï¼Œæ…ˆå–„ï¼Œç§‘å­¦ï¼Œæ–‡å­¦ï¼Œæ•™è‚²ï¼Œä¿æŠ¤å¦‡å¥³å„¿ç«¥å’ŒåŠ¨ç‰©ã€‚åŒæ—¶æ ¹æ®ç›¸å…³æ³•å¾‹ï¼Œçº³ç¨äººå¯¹éƒ¨åˆ†501(c)(3)ç»„ç»‡çš„ææ¬¾å¯ä»¥æŠµæ‰£ä¸ªäººæ‰€å¾—ç¨ã€‚</p></blockquote><p><code>æ­¤å¤„å¼•ç”¨</code> <a href="https://leonson.me/2019/12/us-501c3" target="_blank" rel="noopener">æ°‘é—´æœ‰é«˜æ‰‹â€”â€”è¯´è¯´ç¾å›½çš„501(c)(3)ç»„ç»‡</a></p><blockquote><p>è¿™ä¸ªç”±äºç‰¹æ®Šçš„ç¯å¢ƒå› ç´ ï¼Œæ¯”è¾ƒéš¾ä»¥ç†è§£ï¼Œå› ä¸ºéƒ½æ˜¯ç¾å›½çš„ç»„ç»‡ï¼Œä¸è¿‡æˆ‘ä»¬åœ¨é˜…è¯»è¿™äº›åŸºé‡‘ä¼šå¹´åº¦æŠ¥è¡¨çš„åªéœ€è¦çŸ¥é“ä¸€ç‚¹å³å¯ï¼Œé‚£å°±æ˜¯ 501Â©(6) å’Œ 501Â©(3)ä¹‹é—´çš„åŒºåˆ«ã€‚</p><p>æ¯”å¦‚Linux åŸºé‡‘ä¼šå°±æ˜¯ 501Â©(6) ï¼Œè€ŒApache è½¯ä»¶åŸºé‡‘ä¼šå°±æ˜¯ 501Â©(3) ç±»å‹çš„ã€‚å…·ä½“æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œè¯·æœ‰å¿ƒçš„çœ‹å®˜æŸ¥é˜…ç›¸å…³èµ„æ–™ã€‚ä½†æ˜¯åœ¨å¹´åº¦æŠ¥å‘Šä½“ç°å‡ºæ¥çš„å°±æ˜¯Apache è½¯ä»¶åŸºé‡‘ä¼šä¼šäº‹æ— å·¨ç»†çš„å°†è´¢åŠ¡æŠ¥å‘Šå†™ä¸Šï¼Œè€ŒCNCFå°±ä¸ä¼šæœ‰è¿™æ–¹é¢çš„ä»»ä½•ææ–™ã€‚</p></blockquote><p><code>æ­¤å¤„å¼•ç”¨</code> <a href="http://opensourceway.community/posts/foundation_introduce/review-cncf-2018-annual-report/" target="_blank" rel="noopener">äº‘åŸç”Ÿçš„æ—­æ—¥ä¸œå‡ â€”â€” CNCF 2018å¹´åº¦æŠ¥å‘Šè§£è¯»</a></p><h3 id="å®Œæ•´çš„-501ï¼ˆCï¼‰"><a href="#å®Œæ•´çš„-501ï¼ˆCï¼‰" class="headerlink" title="å®Œæ•´çš„ 501ï¼ˆCï¼‰"></a>å®Œæ•´çš„ 501ï¼ˆCï¼‰</h3><p>æš‚æ—¶æ²¡æ‰¾åˆ°ä¸­æ–‡ç‰ˆï¼Œæˆ‘å°±ä¸ç¿»è¯‘äº†ğŸ˜‚ï¼ˆæ‡’</p><table><thead><tr><th><strong>Type</strong></th><th><strong>Description</strong></th><th><strong>Contributions Deductible?</strong></th></tr></thead><tbody><tr><td>501(c)(1)</td><td>Corporations Organized under Act of Congress (including Federal Credit Unions)</td><td>Yes</td></tr><tr><td>501(c)(2)</td><td>Title Holding Corporation For Exempt Organization</td><td>No</td></tr><tr><td>501(c)(3)</td><td>Religious, Educational, Charitable, Scientific, Literary, Testing  for Public Safety, to Foster National or International Amateur Sports  Competition, or Prevention of Cruelty to Children or Animals  Organizations</td><td>Yes</td></tr><tr><td>501(c)(4)</td><td>Civic Leagues, Social Welfare Organizations, and Local Associations of Employees</td><td>No, generally*</td></tr><tr><td>501(c)(5)</td><td>Labor, Agricultural, and Horticultural Organizations</td><td>No</td></tr><tr><td>501(c)(6)</td><td>Business Leagues, Chambers of Commerce, Real Estate Boards, etc.</td><td>No</td></tr><tr><td>501(c)(7)</td><td>Social and Recreational Clubs</td><td>No</td></tr><tr><td>501(c)(8)</td><td>Fraternal Beneficiary Societies and Associations</td><td>Yes</td></tr><tr><td>501(c)(9)</td><td>Voluntary Employees Beneficiary Associations</td><td>No</td></tr><tr><td>501(c)(10)</td><td>Domestic Fraternal Societies and Associations</td><td>Yes</td></tr><tr><td>501(c)(11)</td><td>Teachersâ€™ Retirement Fund Associations</td><td>No</td></tr><tr><td>501(c)(12)</td><td>Benevolent Life Insurance Associations, Mutual Ditch or Irrigation Companies, Mutual or Cooperative Telephone Companies, etc.</td><td>No</td></tr><tr><td>501(c)(13)</td><td>Cemetery Companies</td><td>Yes</td></tr><tr><td>501(c)(14)</td><td>State-Chartered Credit Unions, Mutual Reserve Funds</td><td>No</td></tr><tr><td>501(c)(15)</td><td>Mutual Insurance Companies or Associations</td><td>No</td></tr><tr><td>501(c)(16)</td><td>Cooperative Organizations to Finance Crop Operations</td><td>No</td></tr><tr><td>501(c)(17)</td><td>Supplemental Unemployment Benefit Trusts</td><td>No</td></tr><tr><td>501(c)(18)</td><td>Employee Funded Pension Trust (created before June 25, 1959)</td><td>No</td></tr><tr><td>501(c)(19)</td><td>Post or Organization of Past or Present Members of the Armed Forces</td><td>No, generally*</td></tr><tr><td>501(c)(21)</td><td>Black Lung Benefit Trusts</td><td>No</td></tr><tr><td>501(c)(22)</td><td>Withdrawal Liability Payment Fund</td><td>No</td></tr><tr><td>501(c)(23)</td><td>Veteransâ€™ Organization (created before 1880)</td><td>No, generally*</td></tr><tr><td>501(c)(25)</td><td>Title Holding Corporations or Trusts with Multiple Parent Corporations</td><td>No</td></tr><tr><td>501(c)(26)</td><td>State-Sponsored Organization Providing Health Coverage for High-Risk Individuals</td><td>No</td></tr><tr><td>501(c)(27)</td><td>State-Sponsored Workersâ€™ Compensation Reinsurance Organization</td><td>No</td></tr><tr><td>501(c)(28)</td><td>National Railroad Retirement Investment Trust</td><td>No</td></tr><tr><td>501(c)(29)</td><td>CO-OP health insurance issuers</td><td>No</td></tr></tbody></table><h2 id="çŸ¥åçš„è½¯ä»¶åŸºé‡‘ä¼š"><a href="#çŸ¥åçš„è½¯ä»¶åŸºé‡‘ä¼š" class="headerlink" title="çŸ¥åçš„è½¯ä»¶åŸºé‡‘ä¼š"></a>çŸ¥åçš„è½¯ä»¶åŸºé‡‘ä¼š</h2><h3 id="åŸºé‡‘ä¼šåŠç»´æŠ¤çš„é¡¹ç›®"><a href="#åŸºé‡‘ä¼šåŠç»´æŠ¤çš„é¡¹ç›®" class="headerlink" title="åŸºé‡‘ä¼šåŠç»´æŠ¤çš„é¡¹ç›®"></a>åŸºé‡‘ä¼šåŠç»´æŠ¤çš„é¡¹ç›®</h3><table><thead><tr><th>åŸºé‡‘ä¼šåç§°</th><th>ç¨æ”¶ä»£ç </th><th>è¡Œä¸š/é¢†åŸŸ/é¡¹ç›®/æœåŠ¡</th></tr></thead><tbody><tr><td><a href="https://www.linuxfoundation.org/" target="_blank" rel="noopener">Linux åŸºé‡‘ä¼š</a></td><td>501(c)(6)</td><td><a href="https://kernel.org" target="_blank" rel="noopener">kernel</a>  <a href="http://127.0.0.1:8000/[https://nodejs.org" target="_blank" rel="noopener">NodeJs</a>  <a href="https://xenproject.org/" target="_blank" rel="noopener">Xen</a>   <a href="https://www.dpdk.org/" target="_blank" rel="noopener">DPDK</a>  <a href="http://127.0.0.1:8000/[https://etcd.io" target="_blank" rel="noopener">etcd</a>   <a href="http://127.0.0.1:8000/[https://jenkins.io" target="_blank" rel="noopener">Jenkins</a>  <a href="http://127.0.0.1:8000/[https://kubernetes.io" target="_blank" rel="noopener">kubernetes</a> <a href="https://ceph.com/foundation/" target="_blank" rel="noopener">Ceph</a>  <a href="https://github.com/containernetworking/cni" target="_blank" rel="noopener">CNI</a>  <a href="https://www.fluentd.org/" target="_blank" rel="noopener">Fluentd</a>   <a href="https://letsencrypt.org/" target="_blank" rel="noopener">Letâ€™s Encrypt</a>  <a href="https://prometheus.io/" target="_blank" rel="noopener">Prometheus</a>  <a href="https://coredns.io/" target="_blank" rel="noopener">CoreDNS</a></td></tr><tr><td><a href="https://www.gnu.org" target="_blank" rel="noopener">FSF è‡ªç”±è½¯ä»¶åŸºé‡‘ä¼š</a></td><td>501(c)(3)</td><td><a href="https://www.gnu.org/" target="_blank" rel="noopener">GNU</a> <a href="https://www.gnu.org/software/libc/" target="_blank" rel="noopener">libc</a> <a href="https://www.gnu.org/software/glib/" target="_blank" rel="noopener">glib</a> <a href="https://www.gnu.org/software/bash/" target="_blank" rel="noopener">bash</a> <a href="https://www.gnu.org/software/gzip/" target="_blank" rel="noopener">gzip</a> <a href="https://www.gnu.org/software/wget/" target="_blank" rel="noopener">wget</a>  <a href="https://www.gnu.org/software/gcc/" target="_blank" rel="noopener">gcc</a>  <a href="https://www.gnu.org/software/grub/" target="_blank" rel="noopener">grub</a> <a href="https://www.gnu.org/software/sed/" target="_blank" rel="noopener">sed</a>  <a href="https://www.gnu.org/software/tar/" target="_blank" rel="noopener">tar</a>  <a href="https://www.gnu.org/software/grep/" target="_blank" rel="noopener">grep</a></td></tr><tr><td><a href="https://foundation.mozilla.org" target="_blank" rel="noopener">Mozilla åŸºé‡‘ä¼š</a></td><td>501(c)(3)</td><td><a href="http://127.0.0.1:8000/[https://www.mozilla.org" target="_blank" rel="noopener">Firefox</a>  <a href="http://127.0.0.1:8000/[https://www.thunderbird.net" target="_blank" rel="noopener">Thunderbird</a></td></tr><tr><td><a href="https://wikimediafoundation.org/" target="_blank" rel="noopener">ç»´åŸºåª’ä½“åŸºé‡‘ä¼š</a></td><td>501(c)(3)</td><td><a href="https://www.mediawiki.org/wiki/MediaWiki" target="_blank" rel="noopener">MediaWiki</a></td></tr><tr><td><a href="https://www.openssl.org/" target="_blank" rel="noopener">OpenSSL åŸºé‡‘ä¼š</a></td><td>501(c)(3)</td><td><a href="https://www.openssl.org/source/" target="_blank" rel="noopener">OpenSSL</a></td></tr><tr><td><a href="https://www.spi-inc.org/" target="_blank" rel="noopener">SPI ç»„ç»‡</a></td><td>501(c)(3)</td><td><a href="https://www.debian.org/distrib/" target="_blank" rel="noopener">Debian</a>  <a href="https://ffmpeg.org/" target="_blank" rel="noopener">FFmpeg</a>  <a href="https://openwrt.org/" target="_blank" rel="noopener">OpenWrt</a>  <a href="http://127.0.0.1:8000/[https://www.postgresql.org" target="_blank" rel="noopener">PostgreSQL</a>   <a href="https://www.libreoffice.org/" target="_blank" rel="noopener">LibreOffice</a> <a href="http://127.0.0.1:8000/[https://jenkins.io" target="_blank" rel="noopener">Jenkins</a>  <a href="https://www.archlinux.org/" target="_blank" rel="noopener">Arch Linux</a> <a href="https://www.spi-inc.org/projects/mingw" target="_blank" rel="noopener">MinGW</a>  <a href="https://www.spi-inc.org/projects/x.org" target="_blank" rel="noopener">X.Org</a> <a href="https://www.spi-inc.org/projects/haskell" target="_blank" rel="noopener">haskell.org</a> <a href="https://www.spi-inc.org/projects/gallery" target="_blank" rel="noopener">Gallery</a> <a href="https://www.spi-inc.org/projects/openzfs" target="_blank" rel="noopener">OpenZFS</a></td></tr><tr><td><a href="https://www.eff.org/" target="_blank" rel="noopener">EFF ç”µå­å‰å“¨åŸºé‡‘ä¼š</a></td><td>501(c)(3)</td><td><a href="https://www.eff.org/https-everywhere" target="_blank" rel="noopener">HTTPS Everywhere</a>  <a href="https://www.eff.org/privacybadger" target="_blank" rel="noopener">Privacy Badger</a>  <a href="https://letsencrypt.org/about/" target="_blank" rel="noopener">Letâ€™s Encrypt</a></td></tr><tr><td><a href="https://www.openstack.org/foundation/" target="_blank" rel="noopener">OpenStack åŸºé‡‘ä¼š</a></td><td>501(c)(6)</td><td><a href="https://www.openstack.org/software/project-navigator/openstack-components/#openstack-services" target="_blank" rel="noopener">OpenStack </a> <a href="https://www.openstack.org/software/releases/stein/components/nova" target="_blank" rel="noopener">nova</a></td></tr><tr><td><a href="https://www.cncf.io/" target="_blank" rel="noopener">CNCF åŸºé‡‘ä¼š</a></td><td>501(c)(6)</td><td><a href="http://kubernetes.io/" target="_blank" rel="noopener">Kubernetes</a></td></tr><tr><td><a href="https://www.cloudfoundry.org" target="_blank" rel="noopener">Cloud Foundry åŸºé‡‘ä¼š</a></td><td>501(c)(6)</td><td><a href="http://127.0.0.1:8000/org.html" target="_blank" rel="noopener">Cloud Foundry</a></td></tr><tr><td><a href="https://www.apache.org/" target="_blank" rel="noopener">Apache è½¯ä»¶åŸºé‡‘ä¼š</a></td><td>501(c)(3)</td><td><a href="https://www.apache.org/" target="_blank" rel="noopener">Apache</a>  <a href="https://hadoop.apache.org/" target="_blank" rel="noopener">Hadoop</a>  <a href="http://kafka.apache.org/" target="_blank" rel="noopener">Kafka</a>   <a href="http://zookeeper.apache.org/" target="_blank" rel="noopener">Zookeeper</a>  <a href="http://hbase.apache.org/" target="_blank" rel="noopener">HBase</a>  <a href="http://maven.apache.org/" target="_blank" rel="noopener">Maven</a></td></tr><tr><td><a href="https://www.gnome.org/foundation/" target="_blank" rel="noopener">GNOME åŸºé‡‘ä¼š</a></td><td>501(c)(3)</td><td><a href="http://127.0.0.1:8000/[https://www.gnome.org" target="_blank" rel="noopener">GNOME</a>  <a href="http://www.freedesktop.org/wiki/Software/systemd/" target="_blank" rel="noopener">systemd</a>  <a href="https://developer.gnome.org/glib/" target="_blank" rel="noopener">GLib</a>  <a href="http://www.gtk.org/" target="_blank" rel="noopener">GTK+</a>   <a href="http://www.freedesktop.org/wiki/Software/dbus/" target="_blank" rel="noopener">D-Bus</a>  <a href="https://www.kernel.org/" target="_blank" rel="noopener">Linux Kernel</a>  <a href="https://wiki.gnome.org/Projects/GDM" target="_blank" rel="noopener">GDM</a></td></tr><tr><td><a href="https://www.opennetworking.org/" target="_blank" rel="noopener">ONF å¼€æ”¾ç½‘ç»œåŸºé‡‘ä¼š</a></td><td>501(c)(6)</td><td><a href="https://www.opennetworking.org/onos/" target="_blank" rel="noopener">onos</a> <a href="https://www.opennetworking.org/omec/" target="_blank" rel="noopener">OMEC</a></td></tr><tr><td><a href="https://www.freebsdfoundation.org/" target="_blank" rel="noopener">FreeBSD åŸºé‡‘ä¼š</a></td><td>501(c)(3)</td><td><a href="https://www.freebsd.org" target="_blank" rel="noopener">FreeBSD</a></td></tr><tr><td><a href="http://www.openbsdfoundation.org/" target="_blank" rel="noopener">OpenBSD åŸºé‡‘ä¼š</a></td><td>Canadian</td><td><a href="http://www.openssh.com/" target="_blank" rel="noopener"> OpenSSH</a>  <a href="http://www.libressl.org/" target="_blank" rel="noopener">LibreSSL</a>  <a href="http://www.openbsd.org/" target="_blank" rel="noopener">OpenBSD</a></td></tr><tr><td><a href="https://opensource.org/" target="_blank" rel="noopener">OSI å¼€æ”¾æºä»£ç ç»„ç»‡</a></td><td>501(c)(3)</td><td><a href="https://opensource.org/" target="_blank" rel="noopener">Open Source</a></td></tr><tr><td><a href="https://freedom.press/" target="_blank" rel="noopener">FPF æ–°é—»è‡ªç”±åŸºé‡‘ä¼š</a></td><td>501(c)(3)</td><td><a href="https://securedrop.org/" target="_blank" rel="noopener">SecureDrop</a>  <a href="https://securethe.news/" target="_blank" rel="noopener">Secure the News</a>   <a href="https://freedom.press/news/archiving-alternative-press-threatened-wealthy-buyers/" target="_blank" rel="noopener">Archive the News</a> <a href="https://twitter.com/foiafeed" target="_blank" rel="noopener">FOIAFeed</a></td></tr><tr><td><a href="https://cpj.org" target="_blank" rel="noopener">OPJ ä¿æŠ¤è®°è€…å§”å‘˜ä¼š</a></td><td>501(c)3</td><td><a href="https://cpj.org/safety-kit/" target="_blank" rel="noopener">Safety Kit</a>  <a href="https://cpj.org/safety-advisories/" target="_blank" rel="noopener">Safety Advisories</a></td></tr><tr><td><a href="https://webfoundation.org/" target="_blank" rel="noopener">Web Foundation ä¸‡ç»´ç½‘åŸºé‡‘ä¼š</a></td><td>501(c)3</td><td><a href="https://webfoundation.org/our-work/projects/alliance-for-affordable-internet/" target="_blank" rel="noopener">Alliance for Affordable Internet</a> <a href="https://webfoundation.org/our-work/projects/open-data-barometer/" target="_blank" rel="noopener">Open Data Barometer</a>   <a href="https://webfoundation.org/our-work/projects/womens-rights-online/" target="_blank" rel="noopener">Womenâ€™s Rights Online</a>  <a href="https://webfoundation.org/our-work/projects/the-web-index/" target="_blank" rel="noopener">The Web Index</a></td></tr><tr><td><a href="https://epic.org/" target="_blank" rel="noopener">EPIC ç”µå­éšç§ä¿¡æ¯ä¸­å¿ƒ</a></td><td>501(c)3</td><td><a href="https://epic.org/privacy/litigation/" target="_blank" rel="noopener">Litigation Docket</a> <a href="https://epic.org/campaigns/" target="_blank" rel="noopener">Privacy Campaigns</a>  <a href="https://epic.org/privacy/surveillance/spotlight/" target="_blank" rel="noopener">Spotlight on Surveillance</a></td></tr><tr><td><a href="https://sfconservancy.org/" target="_blank" rel="noopener">SFC è½¯ä»¶è‡ªç”±ä¿æŠ¤ç»„ç»‡</a></td><td>501(c)3</td><td><a href="https://busybox.net/" target="_blank" rel="noopener">BusyBox</a>  <a href="https://git-scm.com/" target="_blank" rel="noopener">Git</a>  <a href="https://phpmyadmin.net/" target="_blank" rel="noopener">phpMyAdmin</a>   <a href="http://qemu.org/" target="_blank" rel="noopener">QEMU</a>  <a href="https://www.samba.org/samba/" target="_blank" rel="noopener">Samba</a>  <a href="http://www.winehq.org/" target="_blank" rel="noopener">Wine</a></td></tr><tr><td><a href="https://www.softwarefreedom.org/" target="_blank" rel="noopener">SFLC è½¯ä»¶è‡ªç”±æ³•å¾‹ä¸­å¿ƒ</a></td><td>501(c)3</td><td><a href="https://www.softwarefreedom.org/services/" target="_blank" rel="noopener">services</a></td></tr><tr><td><a href="https://archive.org/" target="_blank" rel="noopener">Internet Archive äº’è”ç½‘æ¡£æ¡ˆé¦†</a></td><td>501(c)3</td><td><a href="https://archive.org/projects/" target="_blank" rel="noopener">Building Libraries Together</a>   <a href="https://openlibrary.org/" target="_blank" rel="noopener">Open Library</a>  <a href="https://archive.org/details/301works" target="_blank" rel="noopener">301Works.org</a>   <a href="https://archive.org/web/sflan.php" target="_blank" rel="noopener">Open Community Networks</a></td></tr><tr><td><a href="https://creativecommons.org/" target="_blank" rel="noopener">Creative Commons</a></td><td>501(c)3</td><td><a href="https://creativecommons.org/" target="_blank" rel="noopener">CC çŸ¥è¯†å…±äº«è®¸å¯åè®®</a></td></tr><tr><td><a href="https://www.abetterinternet.org/" target="_blank" rel="noopener">ISRG äº’è”ç½‘å®‰å…¨ç ”ç©¶å°ç»„</a></td><td>501(c)3</td><td><a href="https://letsencrypt.org/" target="_blank" rel="noopener">Letâ€™s Encrypt</a></td></tr></tbody></table><h3 id="æèµ æ€»æ”¶å…¥æ’åï¼ˆ2017ï¼‰"><a href="#æèµ æ€»æ”¶å…¥æ’åï¼ˆ2017ï¼‰" class="headerlink" title="æèµ æ€»æ”¶å…¥æ’åï¼ˆ2017ï¼‰"></a>æèµ æ€»æ”¶å…¥æ’åï¼ˆ2017ï¼‰</h3><table><thead><tr><th>åŸºé‡‘ä¼šåç§°</th><th>å¹´æ€»æ”¶å…¥ $</th><th>å¹´æ€»æ”¯å‡º $</th><th>å¹´å‡€æ”¶å…¥ $</th></tr></thead><tbody><tr><td><a href="https://wikimediafoundation.org/" target="_blank" rel="noopener">ç»´åŸºåª’ä½“åŸºé‡‘ä¼š</a></td><td>$89,973,967</td><td>$69,076,192</td><td>$20,897,775</td></tr><tr><td><a href="https://www.linuxfoundation.org/" target="_blank" rel="noopener">Linux   åŸºé‡‘ä¼š</a></td><td>$81,616,265</td><td>$68,997,604</td><td>$12,618,661</td></tr><tr><td><a href="https://www.openstack.org/foundation/" target="_blank" rel="noopener">OpenStack   åŸºé‡‘ä¼š</a></td><td>$22,829,442</td><td>$29,047,402</td><td>-$6,217,960)</td></tr><tr><td><a href="https://foundation.mozilla.org/" target="_blank" rel="noopener">Mozilla   åŸºé‡‘ä¼š</a></td><td>$20,586,446</td><td>$24,206,401</td><td>-$3,619,955)</td></tr><tr><td><a href="https://archive.org/" target="_blank" rel="noopener">Internet   Archive äº’è”ç½‘æ¡£æ¡ˆé¦†</a></td><td>$17,811,981</td><td>$18,468,621</td><td>-$656,640)</td></tr><tr><td><a href="https://www.eff.org/" target="_blank" rel="noopener">EFF   ç”µå­å‰å“¨åŸºé‡‘ä¼š</a></td><td>$17,392,426</td><td>$11,398,529</td><td>$5,993,897</td></tr><tr><td><a href="https://cpj.org/" target="_blank" rel="noopener">CPJ   ä¿æŠ¤è®°è€…å§”å‘˜ä¼š</a></td><td>$9,625,276</td><td>$7,345,573</td><td>$2,279,703</td></tr><tr><td><a href="https://www.opennetworking.org/" target="_blank" rel="noopener">ONF   å¼€æ”¾ç½‘ç»œåŸºé‡‘ä¼š</a></td><td>$7,722,940</td><td>$6,525,599</td><td>$1,197,341</td></tr><tr><td><a href="https://freedom.press/" target="_blank" rel="noopener">FPF   æ–°é—»è‡ªç”±åŸºé‡‘ä¼š</a></td><td>$5,949,008</td><td>$2,960,503</td><td>$2,988,505</td></tr><tr><td><a href="https://www.torproject.org/" target="_blank" rel="noopener">Tor   é¡¹ç›®</a></td><td>$4,130,882</td><td>$4,078,419</td><td>$52,463</td></tr><tr><td><a href="https://webfoundation.org/" target="_blank" rel="noopener">Web   Foundation ä¸‡ç»´ç½‘åŸºé‡‘ä¼š</a></td><td>$3,579,820</td><td>$3,966,177</td><td>-$386,357</td></tr><tr><td><a href="https://www.python.org/psf/" target="_blank" rel="noopener">Python   åŸºé‡‘ä¼š</a></td><td>$2,870,521</td><td>$2,475,335</td><td>$395,186</td></tr><tr><td><a href="https://www.abetterinternet.org/" target="_blank" rel="noopener">ISRG   äº’è”ç½‘å®‰å…¨ç ”ç©¶å°ç»„</a></td><td>$2,732,486</td><td>$2,599,681</td><td>$132,805</td></tr><tr><td><a href="https://sfconservancy.org/" target="_blank" rel="noopener">SFC   è½¯ä»¶è‡ªç”±ä¿æŠ¤ç»„ç»‡</a></td><td>$2,125,670</td><td>$1,500,209</td><td>$625,461</td></tr><tr><td><a href="https://epic.org/" target="_blank" rel="noopener">EPIC   ç”µå­éšç§ä¿¡æ¯ä¸­å¿ƒ</a></td><td>$1,715,419</td><td>$1,523,199</td><td>$192,220</td></tr><tr><td><a href="https://creativecommons.org/" target="_blank" rel="noopener">Creative   Commons</a></td><td>$1,639,408</td><td>$3,600,414</td><td>-$1,961,006</td></tr><tr><td><a href="https://www.gnu.org/" target="_blank" rel="noopener">FSF   è‡ªç”±è½¯ä»¶åŸºé‡‘ä¼š</a></td><td>$1,373,574</td><td>$1,233,394</td><td>$140,180</td></tr><tr><td><a href="https://www.softwarefreedom.org/" target="_blank" rel="noopener">SFLC   è½¯ä»¶è‡ªç”±æ³•å¾‹ä¸­å¿ƒ</a></td><td>$1,237,816</td><td>$1,359,324</td><td>-$121,508</td></tr><tr><td><a href="https://www.freebsdfoundation.org/" target="_blank" rel="noopener">FreeBSD   åŸºé‡‘ä¼š</a></td><td>$1,101,562</td><td>$993,701</td><td>$107,861</td></tr><tr><td><a href="https://www.apache.org/" target="_blank" rel="noopener">Apache   è½¯ä»¶åŸºé‡‘ä¼š</a></td><td>$917,715</td><td>$1,205,831</td><td>-$288,116</td></tr><tr><td><a href="https://riscv.org/" target="_blank" rel="noopener">RISC-V   åŸºé‡‘ä¼š</a></td><td>$636,438</td><td>$456,755</td><td>$179,683</td></tr><tr><td><a href="https://www.spi-inc.org/" target="_blank" rel="noopener">SPI   ç»„ç»‡</a></td><td>$635,312</td><td>$612,941</td><td>$22,371</td></tr><tr><td><a href="https://www.gnome.org/foundation/" target="_blank" rel="noopener">GNOME   åŸºé‡‘ä¼š</a></td><td>$291,955</td><td>$329,955</td><td>-$38,000</td></tr><tr><td><a href="https://opensource.org/" target="_blank" rel="noopener">OSI   å¼€æ”¾æºä»£ç ç»„ç»‡</a></td><td>$209,500</td><td>$187,884</td><td>$21,616</td></tr></tbody></table><h3 id="æŒ‰å‡€æ”¶å…¥æ’å"><a href="#æŒ‰å‡€æ”¶å…¥æ’å" class="headerlink" title="æŒ‰å‡€æ”¶å…¥æ’å"></a>æŒ‰å‡€æ”¶å…¥æ’å</h3><table><thead><tr><th>åŸºé‡‘ä¼šåç§°</th><th>å¹´æ€»æ”¶å…¥ $</th><th>å¹´æ€»æ”¯å‡º $</th><th>å¹´å‡€æ”¶å…¥ $</th></tr></thead><tbody><tr><td><a href="https://wikimediafoundation.org/" target="_blank" rel="noopener">ç»´åŸºåª’ä½“åŸºé‡‘ä¼š</a></td><td>$89,973,967</td><td>$69,076,192</td><td>$20,897,775</td></tr><tr><td><a href="https://www.linuxfoundation.org/" target="_blank" rel="noopener">Linux   åŸºé‡‘ä¼š</a></td><td>$81,616,265</td><td>$68,997,604</td><td>$12,618,661</td></tr><tr><td><a href="https://www.eff.org/" target="_blank" rel="noopener">EFF   ç”µå­å‰å“¨åŸºé‡‘ä¼š</a></td><td>$17,392,426</td><td>$11,398,529</td><td>$5,993,897</td></tr><tr><td><a href="https://freedom.press/" target="_blank" rel="noopener">FPF   æ–°é—»è‡ªç”±åŸºé‡‘ä¼š</a></td><td>$5,949,008</td><td>$2,960,503</td><td>$2,988,505</td></tr><tr><td><a href="https://cpj.org/" target="_blank" rel="noopener">CPJ   ä¿æŠ¤è®°è€…å§”å‘˜ä¼š</a></td><td>$9,625,276</td><td>$7,345,573</td><td>$2,279,703</td></tr><tr><td><a href="https://www.opennetworking.org/" target="_blank" rel="noopener">ONF   å¼€æ”¾ç½‘ç»œåŸºé‡‘ä¼š</a></td><td>$7,722,940</td><td>$6,525,599</td><td>$1,197,341</td></tr><tr><td><a href="https://sfconservancy.org/" target="_blank" rel="noopener">SFC   è½¯ä»¶è‡ªç”±ä¿æŠ¤ç»„ç»‡</a></td><td>$2,125,670</td><td>$1,500,209</td><td>$625,461</td></tr><tr><td><a href="https://www.python.org/psf/" target="_blank" rel="noopener">Python   åŸºé‡‘ä¼š</a></td><td>$2,870,521</td><td>$2,475,335</td><td>$395,186</td></tr><tr><td><a href="https://epic.org/" target="_blank" rel="noopener">EPIC   ç”µå­éšç§ä¿¡æ¯ä¸­å¿ƒ</a></td><td>$1,715,419</td><td>$1,523,199</td><td>$192,220</td></tr><tr><td><a href="https://riscv.org/" target="_blank" rel="noopener">RISC-V   åŸºé‡‘ä¼š</a></td><td>$636,438</td><td>$456,755</td><td>$179,683</td></tr><tr><td><a href="https://www.gnu.org/" target="_blank" rel="noopener">FSF   è‡ªç”±è½¯ä»¶åŸºé‡‘ä¼š</a></td><td>$1,373,574</td><td>$1,233,394</td><td>$140,180</td></tr><tr><td><a href="https://www.abetterinternet.org/" target="_blank" rel="noopener">ISRG   äº’è”ç½‘å®‰å…¨ç ”ç©¶å°ç»„</a></td><td>$2,732,486</td><td>$2,599,681</td><td>$132,805</td></tr><tr><td><a href="https://www.freebsdfoundation.org/" target="_blank" rel="noopener">FreeBSD   åŸºé‡‘ä¼š</a></td><td>$1,101,562</td><td>$993,701</td><td>$107,861</td></tr><tr><td><a href="https://www.torproject.org/" target="_blank" rel="noopener">Tor   é¡¹ç›®</a></td><td>$4,130,882</td><td>$4,078,419</td><td>$52,463</td></tr><tr><td><a href="https://www.spi-inc.org/" target="_blank" rel="noopener">SPI   ç»„ç»‡</a></td><td>$635,312</td><td>$612,941</td><td>$22,371</td></tr><tr><td><a href="https://opensource.org/" target="_blank" rel="noopener">OSI   å¼€æ”¾æºä»£ç ç»„ç»‡</a></td><td>$209,500</td><td>$187,884</td><td>$21,616</td></tr><tr><td><a href="https://www.gnome.org/foundation/" target="_blank" rel="noopener">GNOME   åŸºé‡‘ä¼š</a></td><td>$291,955</td><td>$329,955</td><td>-$38,000</td></tr><tr><td><a href="https://www.softwarefreedom.org/" target="_blank" rel="noopener">SFLC   è½¯ä»¶è‡ªç”±æ³•å¾‹ä¸­å¿ƒ</a></td><td>$1,237,816</td><td>$1,359,324</td><td>-$121,508</td></tr><tr><td><a href="https://www.apache.org/" target="_blank" rel="noopener">Apache   è½¯ä»¶åŸºé‡‘ä¼š</a></td><td>$917,715</td><td>$1,205,831</td><td>-$288,116</td></tr><tr><td><a href="https://webfoundation.org/" target="_blank" rel="noopener">Web   Foundation ä¸‡ç»´ç½‘åŸºé‡‘ä¼š</a></td><td>$3,579,820</td><td>$3,966,177</td><td>-$386,357</td></tr><tr><td><a href="https://archive.org/" target="_blank" rel="noopener">Internet   Archive äº’è”ç½‘æ¡£æ¡ˆé¦†</a></td><td>$17,811,981</td><td>$18,468,621</td><td>-$656,640</td></tr><tr><td><a href="https://creativecommons.org/" target="_blank" rel="noopener">Creative   Commons</a></td><td>$1,639,408</td><td>$3,600,414</td><td>-$1,961,006</td></tr><tr><td><a href="https://foundation.mozilla.org/" target="_blank" rel="noopener">Mozilla   åŸºé‡‘ä¼š</a></td><td>$20,586,446</td><td>$24,206,401</td><td>-$3,619,955</td></tr><tr><td><a href="https://www.openstack.org/foundation/" target="_blank" rel="noopener">OpenStack   åŸºé‡‘ä¼š</a></td><td>$22,829,442</td><td>$29,047,402</td><td>-$6,217,960</td></tr></tbody></table><p>æœ¬æ‰“ç®—åœ¨è¿™ä¸€ç¯‡åšå®¢é‡ŒæŠŠä»¥ä¸Šæåˆ°çš„åŸºé‡‘ä¼šéƒ½åšä¸€ä¸‹ä»‹ç»ï¼Œä½†æœ€è¿‘æ—¶é—´æœ‰é™ï¼Œæ­¤ä¸¾å·¥ä½œé‡å®åœ¨å¤ªå¤§ï¼Œæ‰€ä»¥ä»Šå¤©æˆ‘å°±åœ¨è¿™é‡Œç®€å•åœ°ä»‹ç»ä¸€ä¸‹æˆ‘æ¯”è¾ƒæ¨å´‡çš„ EFF ç”µå­å‰å“¨åŸºé‡‘ä¼šã€‚å…¶ä½™çš„æ‰“ç®—ä»¥åå†è¡¥å……ï¼ˆæŒ–å‘ğŸ˜‚</p><h2 id="EFF-ç”µå­å‰å“¨åŸºé‡‘ä¼š"><a href="#EFF-ç”µå­å‰å“¨åŸºé‡‘ä¼š" class="headerlink" title="EFF ç”µå­å‰å“¨åŸºé‡‘ä¼š"></a>EFF ç”µå­å‰å“¨åŸºé‡‘ä¼š</h2><h3 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h3><p>Electronic Frontier Foundation ç®€ç§° EFF ï¼Œä¸­æ–‡è¯‘åç”µå­å‰å“¨åŸºé‡‘ä¼šã€ç”µå­å‰çº¿åŸºé‡‘ä¼šã€‚è¯¥åŸºé‡‘ä¼šæˆç«‹äº 1990 å¹´ 7 æœˆï¼Œåœ¨æˆç«‹çš„å½“å¤©å°± <a href="https://en.wikipedia.org/wiki/Steve_Jackson_Games,_Inc._v._United_States_Secret_Service" target="_blank" rel="noopener">å²è’‚å¤«â€¢æ°å…‹é€Šæ¸¸æˆæ¡ˆ</a> å®£å¸ƒå¯¹ç¾å›½ç‰¹å‹¤å±€æèµ·è¯‰è®¼ï¼Œç»™æ”¿åºœæ‰¾éº»çƒ¦ğŸ˜‚ã€‚ä»¥åŠåæ¥çš„ <a href="https://en.wikipedia.org/wiki/Bernstein_v._United_States" target="_blank" rel="noopener">ä¼¯æ©æ–¯å¦è¯‰ç¾å›½æ”¿åºœæ¡ˆ</a> ã€‚EFF ä»£ç†çš„è¿™ä¸¤ä¸ªæ¡ˆä»¶çš„èƒœè¯‰æœ‰ç€åŠå…¶é‡è¦çš„å½±å“ï¼šå²è’‚å¤«Â·æ°å…‹é€Šæ¸¸æˆæ¡ˆç¬¬ä¸€æ¬¡ç¡®ç«‹äº†æ‰§æ³•éƒ¨é—¨åœ¨æ‰£æŠ¼å’Œé˜…è¯»æ‰€æœ‰ç”µå­é‚®ä»¶ä¹‹å‰ï¼Œå¿…é¡»æŒæœ‰ç‰¹åˆ«æè¿°æ‰€æœ‰ç”µå­é‚®ä»¶çš„æœæŸ¥ä»¤ï¼›ä¼¯æ©æ–¯å¦è¯‰ç¾å›½æ”¿åºœæ¡ˆç¬¬ä¸€æ¬¡è£å®šè½¯ä»¶æºä»£ç æ˜¯å—å®ªæ³•ç¬¬ä¸€ä¿®æ­£æ¡ˆä¿æŠ¤çš„è¨€è®ºã€‚å½“ç„¶å¯¹äºæŸäº›æ‘¸ç€çŸ³å¤´è¿‡æ²³çš„å›½å®¶æ¥è¯´ï¼Œè¿™ä¸¤ä¸ªæ³•æ¡ˆå°±æ˜¯åƒç—´äººè¯´æ¢¦ã€‚</p><ul><li><p>1990 å¹´ 3 æœˆ 1 æ—¥ï¼šç¾å›½ç‰¹å‹¤å±€çªè¢­å²è’‚å¤«Â·æ°å…‹é€Šæ¸¸æˆå…¬å¸</p></li><li><p>1990 å¹´ 4 æœˆï¼šå·´æ´›å—åˆ°ç¾å›½ <a href="https://zh.wikipedia.org/wiki/è”é‚¦è°ƒæŸ¥å±€" target="_blank" rel="noopener">è”é‚¦è°ƒæŸ¥å±€</a> æœ‰å…³ Macintosh ç³»åˆ— ROM æºä»£ç ç›—çªƒå’Œåˆ†å‘çš„è°ƒæŸ¥</p></li><li><p>1990 å¹´ 6 æœˆï¼šå·´æ´›å…¬å¸ƒäº†â€œç½ªä¸ç½šâ€ä¸€æ–‡ å¹¶å®£å¸ƒä»–å’Œå¡æ™®å°”è®¡åˆ’å»ºç«‹ä¸€ä¸ªç»„ç»‡ ï¼Œ æ¥â€œä¸ºæ•™è‚²ã€æ¸¸è¯´å’Œè¯‰è®¼ä¸ç½‘ä¸Šè¨€è®ºç›¸å…³çš„é¢†åŸŸä»¥åŠå…³äºå®ªæ³•è¿›å…¥ç½‘ç»œç©ºé—´çš„æ‰©å……ç­¹é›†å’Œæ”¯ä»˜ç»è´¹ã€‚</p></li><li><p>1990 å¹´ 7 æœˆ 6 æ—¥ï¼šEFF ç”µå­å‰å“¨åŸºé‡‘ä¼šæˆç«‹å¹¶å®£å¸ƒå¸®åŠ©å²è’‚å¤«Â·æ°å…‹èµ·è¯‰ç¾å›½ç‰¹å‹¤å±€</p></li><li><p>1990å¹´7æœˆ10æ—¥ï¼šç”µå­å‰çº¿åŸºé‡‘ä¼šï¼Œç”±å¡æ™®å°”ã€<a href="https://zh.wikipedia.org/w/index.php?title=çº¦ç¿°Â·å‰å°”æ‘©&action=edit&redlink=1" target="_blank" rel="noopener">çº¦ç¿°Â·å‰å°”æ‘©</a> å’Œå·´æ´›ï¼Œæ­£å¼æˆç«‹äºã€‚åˆå§‹èµ„é‡‘ç”±å¡æ™®å°”ï¼Œ<a href="https://zh.wikipedia.org/wiki/æ–¯è’‚å¤«Â·æ²ƒå…¹å°¼äºšå…‹" target="_blank" rel="noopener">æ–¯è’‚å¤«Â·æ²ƒå…¹å°¼äºšå…‹</a> ï¼ˆè‹¹æœåˆ›å§‹äººä¹‹ä¸€ï¼‰å’Œä¸€ä¸ªåŒ¿åäººå£«æä¾›ã€‚</p></li><li><p>2002 å¹´ï¼šä¸ºåŸŸåç³»ç»Ÿçš„å¼€æ”¾ï¼Œé€æ˜æ²»ç†è€Œæ–—äº‰ã€‚</p></li><li><p>2004 å¹´ï¼šTor é¡¹ç›®</p></li><li><p>2020 å¹´ï¼šæ‹¯æ•‘ org åŸŸåè¡ŒåŠ¨  <a href="https://savedotorg.org/" target="_blank" rel="noopener">SaveDotOrg</a> ã€‚PSï¼šå¸Œæœ›å¤§å®¶éƒ½èƒ½ç‚¹è¿›å»è¿™ä¸ªç½‘ç«™æ¥æ”¯æŒè¿™ä¸ªè¡ŒåŠ¨ã€‚</p></li></ul><h3 id="å‚ä¸çš„ç«‹æ³•æ–—äº‰"><a href="#å‚ä¸çš„ç«‹æ³•æ–—äº‰" class="headerlink" title="å‚ä¸çš„ç«‹æ³•æ–—äº‰"></a>å‚ä¸çš„ç«‹æ³•æ–—äº‰</h3><ul><li><p>DOPA (Deleting Online Predators Act of 2006) åˆ é™¤åœ¨çº¿ä¾µçŠ¯è€…æ³•æ¡ˆã€‚<a href="https://www.govtrack.us/congress/bills/110/hr1120/text" target="_blank" rel="noopener">æ³•æ¡ˆè¯¦æƒ…</a> ä¸ <a href="https://en.wikipedia.org/wiki/Deleting_Online_Predators_Act_of_2006" target="_blank" rel="noopener">ç»´åŸºç™¾ç§‘</a></p></li><li><p>PCNAA (Protecting Cyberspace as a National Asset Act )å°†ç½‘ç»œç©ºé—´ä½œä¸ºå›½å®¶è´¢äº§ä¿æŠ¤æ³•ã€‚<a href="https://www.govtrack.us/congress/bills/111/hr5548/text" target="_blank" rel="noopener">æ³•æ¡ˆè¯¦æƒ…</a> ä¸ [ç»´åŸºç™¾ç§‘](Protecting Cyberspace as a National Asset Act)</p></li><li><p>COICA (Combating Online Infringement and Counterfeits Act )æ‰“å‡»åœ¨çº¿ä¾µæƒå’Œå‡å†’æ³•æ¡ˆã€‚<a href="https://www.govtrack.us/congress/bills/111/s3804/text" target="_blank" rel="noopener">æ³•æ¡ˆè¯¦æƒ…</a> ä¸ <a href="https://en.wikipedia.org/wiki/Combating_Online_Infringement_and_Counterfeits_Act" target="_blank" rel="noopener">ç»´åŸºç™¾ç§‘</a></p></li><li><p>SOPAï¼ˆStop Online Piracy Act ï¼‰ç¦æ­¢ç½‘ç»œç›—ç‰ˆæ³•æ¡ˆã€‚<a href="https://www.congress.gov/bill/112th-congress/house-bill/3261" target="_blank" rel="noopener">æ³•æ¡ˆè¯¦æƒ…</a> ä¸ <a href="https://en.wikipedia.org/wiki/Stop_Online_Piracy_Act" target="_blank" rel="noopener">ç»´åŸºç™¾ç§‘</a></p></li><li><p>PIPA ï¼ˆPreventing Real Online Threats to Economic Creativity and Theft of Intellectual Property Act ï¼‰ä¿æŠ¤çŸ¥è¯†äº§æƒæ³•æ¡ˆã€‚<a href="https://en.wikipedia.org/wiki/PROTECT_IP_Act" target="_blank" rel="noopener">ç»´åŸºç™¾ç§‘</a>ä¸<a href="https://www.govtrack.us/congress/bills/112/s968/text" target="_blank" rel="noopener">æ³•æ¡ˆè¯¦æƒ…</a></p></li><li><p>CISPAï¼ˆCyber Intelligence Sharing and Protection Actï¼‰ç½‘ç»œæƒ…æŠ¥å…±äº«ä¸ä¿æŠ¤æ³•æ¡ˆã€‚<a href="https://www.congress.gov/bill/114th-congress/house-bill/234" target="_blank" rel="noopener">æ³•æ¡ˆè¯¦æƒ…</a>ä¸<a href="https://en.wikipedia.org/wiki/Cyber_Intelligence_Sharing_and_Protection_Act" target="_blank" rel="noopener">ç»´åŸºç™¾ç§‘</a></p></li></ul><p>å¤§å®¶æœ‰æ²¡æœ‰è§‰ç€è¿™äº›æ³•æ¡ˆå¬èµ·æ¥åˆè¡·å¾ˆç¾å¥½ï¼Ÿä½†æ˜¯ï¼Œç¾å›½ç½‘æ°‘éƒ½å¾ˆæ¸…æ¥šï¼Œè¿™äº›æ³•æ¡ˆç»å¯¹ä¼šè¢«æ»¥ç”¨ï¼Œç”¨æ¥é™åˆ¶äº’è”ç½‘è‡ªç”±ï¼Œæ‰€ä»¥åæŠ—çš„äººä¹Ÿç‰¹åˆ«å¤šã€‚å…¶ä¸­æœ€è‡­åæ˜­è‘—çš„è«è¿‡äº SOPA æ³•æ¡ˆå’Œ PIPA æ³•æ¡ˆã€‚åœ¨è¿™äº›åå¯¹çš„å£°éŸ³ä¸­ï¼Œæœ€å…·å½±å“åŠ›ä»£è¡¨äººç‰©çš„å½“å±äºäº’è”ç½‘ä¹‹å­ Aaron Swartz  ï¼Œäºšä¼¦Â·æ–¯æ²ƒèŒ¨é€šè¿‡ä»–çš„æ±‚è¿›ä¼šç½‘èšä¼—åå¯¹SOPA æ³•æ¡ˆå’Œæ”¿åºœåšæ–—äº‰ï¼Œæœ€ç»ˆå¯¼è‡´äº†æ•´ä¸ªç¤¾ä¼šéƒ½åœ¨åå¯¹SOPAï¼Œä¹Ÿå¯¼è‡´äº†é‚£äº›è®®å‘˜çº·çº·æ”¹å˜è‡ªå·±çš„æƒ³æ³•ï¼Œå¹¶å¯¼è‡´äº†ç™½å®«æœ€ç»ˆæ”¾å¼ƒäº†è¿™ä¸ªæ³•æ¡ˆã€‚</p><blockquote><p>ä»–åœ¨è‡ªæ€å‰æ›¾ç»é¢†å¯¼è¿‡ä¸€åœºæ¼‚äº®çš„èƒœåˆ©ï¼Œé‚£å°±æ˜¯åå¯¹ <a href="https://link.zhihu.com/?target=http%3A//en.wikipedia.org/wiki/Stop_Online_Piracy_Act">SOPA ï¼ˆç¦æ­¢ç½‘ç»œç›—ç‰ˆæ³•æ¡ˆï¼‰</a>çš„è¿åŠ¨ã€‚è¿™æ˜¯äºšä¼¦çŸ­æš‚ä¸€ç”Ÿä¸­çš„é«˜å…‰æ—¶åˆ»ï¼Œä¹Ÿæ˜¯äº’è”ç½‘åŠ›é‡åœ¨æ¨åŠ¨ç¤¾ä¼šé©æ–°ä¸Šçš„ä¸€æ¬¡é—ªè€€ã€‚SOPA çš„åˆè¡·æ˜¯ä¿æŠ¤ç‰ˆæƒï¼Œä½†å®é™…çš„å¤„ç†æ–¹å¼ä¸¥é‡åŠ¨æ‘‡äº†äº’è”ç½‘ä¿¡æ¯å¼€æ”¾çš„æ ¹åŸºï¼Œå¹¶è¦æ±‚äº’è”ç½‘å¹³å°è¿›è¡Œè‡ªæˆ‘å®¡æŸ¥ï¼Œè¿™æ˜¯ç»å¤§éƒ¨åˆ†äº’è”ç½‘å…¬å¸æ‰€ä¸èƒ½å®¹å¿çš„ã€‚è€Œæ”¯æŒ  SOPA çš„åˆ™æ˜¯ä¼ ç»Ÿçš„ç‰ˆæƒæ–¹ï¼ŒåŒ…æ‹¬å‡ºç‰ˆå…¬å¸ï¼Œå”±ç‰‡å…¬å¸ï¼Œç”µå½±å…¬å¸ç­‰ï¼Œè¿™èƒŒåè•´è—ç€å·¨å¤§çš„åˆ©ç›Šã€‚SOPA  æå‡ºæ—¶å¾—åˆ°äº†å¾ˆå¤šå›½ä¼šè®®å‘˜çš„æ”¯æŒï¼Œä¿¡å¥‰ä¿¡æ¯è‡ªç”±çš„äºšä¼¦è‡ªç„¶ä¸å¸Œæœ›è¿™ä¸ªæ³•æ¡ˆé€šè¿‡ï¼Œä¸ºæ­¤ä»–åˆ›åŠäº†ã€Œæ±‚è¿›ä¼šã€ï¼ˆDemand  Progressï¼‰ï¼Œé€šè¿‡ç»„ç»‡ç¾¤ä¼—æ¸¸è¯´å·å¬æ™®é€šæ°‘ä¼—ä¸€èµ·ç»™å›½ä¼šè¯·æ„¿åå¯¹ SOPAã€‚</p></blockquote><blockquote><p>åœ¨ SOPA ä¸Šï¼Œå›½ä¼šè®®å‘˜ä»¬æ˜¾ç„¶ä½ä¼°äº†ç½‘æ°‘çš„åŠ›é‡ã€‚ä»å…¨çƒè‘—ååŸŸåå•† GoDaddy çš„å€’æˆˆä¾¿èƒ½çœ‹å‡ºæ¥ï¼šGoDaddy æœ€åˆæ”¯æŒ  SOPAï¼Œè€Œè¿™ä¸€ä¸¾åŠ¨å¼•èµ·äº†ä¼—å¤šç«™é•¿çš„æŠ—è®®ï¼ŒåŒ…æ‹¬ç»´åŸºç™¾ç§‘åœ¨å†…çš„è®¸å¤šç½‘ç«™åœ¨ä¸¤å¤©ä¹‹å†…è¿…é€Ÿä» GoDaddy æ’¤å‡ºäº†37000å¤šä¸ªåŸŸåï¼ŒGoDaddy  äºæ˜¯è¿…é€Ÿè¡¨ç¤ºè½¬æŠ•åå¯¹é˜µè¥ã€‚2012å¹´1æœˆ18æ—¥ï¼Œç»´åŸºç™¾ç§‘ï¼ŒRedditï¼ŒCraigslistï¼Œ Mozilla  ç­‰ç½‘ç«™å†³å®šå…³ç«™24å°æ—¶ä»¥è¡¨ç¤ºæŠ—è®®ï¼Œè¿™ä¸€å¤©å›½ä¼šçš„ç”µè¯è¢«æ‰“çˆ†ï¼Œå½¢åŠ¿è¿…é€Ÿå‘ç”Ÿé€†è½¬ï¼Œç¬¬äºŒå¤©è®¸å¤šåŸæ¥æ”¯æŒ SOPA çš„è®®å‘˜è¢«æ’¼åŠ¨ï¼Œç«™åˆ°äº†åå¯¹çš„ä¸€è¾¹ï¼Œæœ€ç»ˆ  SOPA æ²¡æœ‰è¢«å›½ä¼šé€šè¿‡ã€‚äºšä¼¦éå¸¸é«˜å…´ï¼Œè¿™æ˜¯ä»–ä¸€ç”Ÿå½“ä¸­ä¸ºæ•°ä¸å¤šçš„èƒœåˆ©æ—¶åˆ»ï¼Œè¿™ä¸€åˆ»è®©ä»–è§‰å¾—è‡ªå·±çš„ç†å¿µåœ¨ç°å®ä¸–ç•Œä¸­æ˜¯è¡Œå¾—é€šçš„ã€‚</p></blockquote><blockquote><p>æ¯«æ— ç–‘é—®ï¼Œäº’è”ç½‘å·²ç»æ¸—å…¥åˆ°æˆ‘ä»¬ç”Ÿæ´»çš„æ–¹æ–¹é¢é¢ã€‚å³ä¾¿æ˜¯ SOPA  è¿™æ ·æœ‰å·¨å¤§åˆ©ç›Šé›†å›¢å’Œæ”¿æ²»åŠ›é‡æ‰€æ¨è¿›çš„æ³•æ¡ˆä¹Ÿæ•Œä¸è¿‡åƒåƒä¸‡ä¸‡ä½¿ç”¨äº’è”ç½‘çš„æ™®é€šæ°‘ä¼—ã€‚å¦‚æœä¸€ä¸ªç½‘ç»œå…¬å¸æ”¯æŒ  SOPAï¼Œç”¨æˆ·å¯ä»¥ç”¨è„šæŠ•ç¥¨è®©å®ƒæ— æ³•å­˜æ´»ï¼›å¦‚æœæœ‰äººåŠ¨æ‘‡äº’è”ç½‘çš„æ ¹åŸºï¼Œå„å¤§äº’è”ç½‘å…¬å¸ä¼šæ¯«ä¸çŠ¹è±«åœ°è¿›è¡Œè”åˆæŠ—è®®ï¼Œå®ƒä»¬é€ æˆçš„æ”¾å¤§æ•ˆåº”æ¯”è¡—å¤´æŠ—è®®å¼ºä¸Šæ•°ç™¾å€ã€‚SOPA  çš„æ¨è¡Œè€…ä»¬æ²¡æœ‰æ„è¯†åˆ°è¿™æ ·ä¸€ä¸ªé€†æµè€ŒåŠ¨çš„æ³•æ¡ˆæ‰€é¢å¯¹çš„é˜»åŠ›æ˜¯å¦‚æ­¤ä¹‹å¤§ï¼Œè€Œäºšä¼¦ä¹Ÿæ²¡æœ‰æ„è¯†åˆ°äº’è”ç½‘çš„åŠ›é‡åœ¨æ”¿æ²»ä¸Šå·²ç»ç›¸å½“æˆç†Ÿï¼Œä»–åˆšå¼€å§‹å¹¶æ²¡æœ‰æŠ±å¤ªå¤§å¸Œæœ›ã€‚æ— è®ºå¦‚ä½•ï¼Œè¿™æ˜¯ç¾å›½æ”¿æ²»å²ä¸Šçš„å¤§äº‹ä»¶ï¼Œäºšä¼¦ä¹Ÿæˆä¸ºäº†è¿™ä¸ªå¤§äº‹ä»¶ä¸­çš„å¤§äººç‰©ã€‚</p><p>æ­¤å¤„å¼•ç”¨è‡ª <a href="https://www.zhihu.com/question/24928691" target="_blank" rel="noopener">æ”¯ä¹</a></p></blockquote><p>å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒAaron Swartz åœ¨é’å¹´æ—¶æœŸå°±æ·±æ·±å—åˆ°  John Perry Barlowï¼ˆç”µå­å‰çº¿åŸºé‡‘ä¼š EFF çš„åˆ›å§‹äººï¼‰çš„å½±å“ğŸ˜‚ã€‚è¿™ä¹Ÿä¸éš¾æƒ³è±¡ï¼Œåœ¨å½“æ—¶ï¼Œä¸€ä¸ªåäº”å…­å²çš„é’å°‘å¹´å°±å·²ç»å¼€å§‹æ€è€ƒç½‘ç»œå®¡æŸ¥çš„å¼Šç«¯è¿™ç§é—®é¢˜äº†ã€‚å¯¹æ¯”æŸäº›æ¯”è¾ƒå†å®³çš„å›½å®¶ï¼Œæˆé•¿åœ¨ GFW ä¸‹çš„ä¸€ä»£ï¼Œä»–ä»¬åäº”å…­å²æ—¶åœ¨æƒ³ä»€ä¹ˆï¼Ÿ</p><blockquote><p>Aaron æ·±å— John Perry Barlowï¼ˆç”µå­å‰çº¿åŸºé‡‘ä¼š EFF çš„åˆ›å§‹äººï¼‰çš„å½±å“ã€‚åœ¨ Aaron ä¸­å­¦æ—¶ä»£ï¼ŒJohnåˆ°ä»–ä»¬å­¦æ ¡æ¼”è®²ï¼ŒAaron å¬äº†è¿™ä¸ªæ¼”è®²ä¹‹åï¼Œæ·±å—å½±å“ã€‚åæ¥ Aaron çš„çˆ¸çˆ¸è¯´é‚£å¤©ä»–å›å®¶å°±åƒå˜äº†ä¸€ä¸ªäººä¸€æ ·ã€‚ä»¥åŠåæ¥ Aaron å’Œ Tim Berners-Lee åœ¨ä¸€èµ·å·¥ä½œï¼Œç­‰ç­‰ã€‚æŒ‰ç…§ä»–çš„å¹´é¾„ï¼Œå¾ˆéš¾æƒ³è±¡å’Œè¿™äº›äº’è”ç½‘çš„åˆ›å»ºè€…ä»¬ä¸€èµ·å·¥ä½œå’Œæ´»åŠ¨ã€‚ä½†æ˜¯ä»–å’Œä»–ä»¬ç›¸å¤„å¾ˆå¥½ï¼Œè¿™äº›äººä¹Ÿéƒ½å–œæ¬¢ä»–ã€‚</p></blockquote><p><code>æ­¤å¤„å¼•ç”¨</code> <a href="https://medium.com/@blockchaineconomicsstudio/%E5%AF%B9%E8%AF%9D%E9%9C%8D%E7%82%AC-%E4%BA%92%E8%81%94%E7%BD%91%E4%B9%8B%E5%AD%90-aaron-swartz-%E6%83%B3%E8%A6%81%E7%9C%8B%E5%88%B0%E7%9A%84%E4%B8%96%E7%95%8C-dc2dccd08cca" target="_blank" rel="noopener">å¯¹è¯éœç‚¬ | äº’è”ç½‘ä¹‹å­ Aaron Swartz æƒ³è¦çœ‹åˆ°çš„ä¸–ç•Œ</a></p><h3 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><ul><li><p><a href="https://zh.wikipedia.org/wiki/ç¾å›½ç½‘ç»œå®¡æŸ¥" target="_blank" rel="noopener">ç¾å›½ç½‘ç»œå®¡æŸ¥</a></p></li><li><p><a href="https://www.eff.org/zh-hans/cases" target="_blank" rel="noopener">EFF å—ç†æ¡ˆä»¶åˆ—è¡¨</a></p></li><li><p><a href="https://www.govtrack.us/" target="_blank" rel="noopener">https://www.govtrack.us</a></p></li><li><p><a href="http://btlj.org/2011/03/internet-kill-switch-legislation-can-obama-turn-off-the-internet/" target="_blank" rel="noopener">Internet â€œKill Switchâ€ Legislation: Can Obama Turn Off the Internet?</a></p></li><li><p><a href="https://www.eff.org/zh-hans/cases/steve-jackson-games-v-secret-service-case-archive" target="_blank" rel="noopener">steve-jackson-games-v-secret-service-case-archive</a></p></li><li><p><a href="https://blog.k8s.li/archives/A-History-of-Protecting-Freedom-Where-Law-and-Technology-Collide">ä¸€æ®µåœ¨æ³•å¾‹ä¸æŠ€æœ¯å†²çªçš„åœ°æ–¹æå«è‡ªç”±çš„å†å²</a></p></li><li><p><a href="https://www.eff.org/about/history" target="_blank" rel="noopener">A History of Protecting Freedom Where Law and Technology Collide</a></p></li></ul><h2 id="å¯ç¤º"><a href="#å¯ç¤º" class="headerlink" title="å¯ç¤º"></a>å¯ç¤º</h2><blockquote><p>â€œå¦‚æœå‡ºé—®é¢˜ï¼Œä»–ä»¬éšæ—¶ä¼šæŠŠæˆ‘ä»¬èµ¶èµ°ï¼Œâ€é™ˆå¥æ°‘è¯´ï¼šâ€œä½†ä¸€åšå‡ºç‚¹æ•ˆæœï¼Œä»–ä»¬å°±å‡ºæ¥â€˜æ’æ——â€™claim creditï¼ˆé¢†åŠŸï¼‰ã€‚â€</p><p>è¿™ä¸€å¹•ï¼Œæ˜¯å½“æ—¶ä¸­å›½æ°‘é—´ç»„ç»‡ä¸æ”¿åºœä¹‹é—´å…³ç³»çš„å†™ç…§ã€‚</p></blockquote><p><code>æ­¤å¤„å¼•ç”¨</code> <a href="https://www.bbc.com/zhongwen/simp/chinese-news-43972586" target="_blank" rel="noopener">æ±¶å·åœ°éœ‡åå¹´ç³»åˆ—â€”å…¬æ°‘ç¤¾ä¼šä»çˆ†å‘åˆ°æ²‰å¯‚çš„è‰°éš¾ä¹‹è·¯</a></p><p>äº‹å®ä¸Šï¼Œè¶Šæ˜¯è‡ªç”±æ°‘ä¸»çš„å›½å®¶ï¼Œè¶Šä¼šå­˜åœ¨å¾ˆå¤šç›‘ç£é—®è´£æ”¿åºœã€å¯¹æŠ—å•†ä¸šå…¬å¸ã€ä¿æŠ¤ä¸ªäººéšç§ã€æå«è¨€è®ºè‡ªç”±ã€ç‹¬ç«‹äºæ”¿åºœçš„éè¥åˆ©æ€§ç»„ç»‡ã€‚æ¯”å¦‚æå«äº’è”ç½‘è‡ªç”±çš„ç”µå­å‰å“¨åŸºé‡‘ä¼šï¼›å¯¹æŠ—å•†ä¸šå…¬å¸ç›‘æ§çš„è‡ªç”±è½¯ä»¶åŸºé‡‘ä¼šï¼›æå«è¨€è®ºè‡ªç”±çš„æ–°é—»è‡ªç”±åŸºé‡‘ä¼šã€å‡ºç‰ˆè‡ªç”±åŸºé‡‘ä¼šã€ä¿æŠ¤è®°è€…å§”å‘˜ä¼šï¼›ä¿æŠ¤ Web ä¿¡æ¯å®‰å…¨ä¼ è¾“çš„ OpenSSL åŸºé‡‘ä¼šï¼›æä¾›åŒ¿åè®¿é—®çš„ Tor é¡¹ç›®ï¼›ä¿æŠ¤ä¸ªäººéšç§çš„ç²‰ç¢æ£±é•œè®¡åˆ’ï¼›åæŠ—å•†ä¸šè½¯ä»¶ç›‘æ§çš„è‡ªç”±è½¯ä»¶è¿åŠ¨ç­‰ç­‰ã€‚è¿™äº›ç»„ç»‡éœ€è¦ç‹¬ç«‹è‡ªä¸»ï¼Œè‡ªç”±å¼€æ”¾ï¼Œå…¬å¼€é€æ˜çš„ç”Ÿå­˜ç¯å¢ƒã€‚ç¾å›½è¿™ç§ä»¥åŸºé‡‘ä¼šã€ç¤¾åŒºè¿ä½œçš„æ–¹å¼å·²ç»å¾ˆæˆç†Ÿäº†ï¼Œä½¿ç”¨å¼€æºè½¯ä»¶è‡ªç”±è½¯ä»¶çš„å…¬å¸å’Œä¸ªäººä¹æ„æèµ ï¼Œå¼€å‘è€…æœ‰ç¨³å®šçš„æ”¶å…¥ï¼Œä»è€Œä½¿è½¯ä»¶èƒ½å¤Ÿç¨³å®šåœ°ç»´æŠ¤ï¼Œå½¢æˆäº†è‰¯æ€§å¾ªç¯ã€‚</p><h2 id="å‚è€ƒ-1"><a href="#å‚è€ƒ-1" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li><a href="https://projects.propublica.org/nonprofits/organizations/460503801" target="_blank" rel="noopener">The Linux Foundation - Nonprofit Explorer - ProPublica</a></li><li><a href="https://projects.propublica.org/nonprofits/organizations/42888848" target="_blank" rel="noopener">Free Software Foundation Inc - Nonprofit Explorer - ProPublica</a></li><li><a href="https://projects.propublica.org/nonprofits/organizations/200097189" target="_blank" rel="noopener">Mozilla Foundation - Nonprofit Explorer - ProPublica</a></li><li><a href="https://projects.propublica.org/nonprofits/organizations/200049703" target="_blank" rel="noopener">Wikimedia Foundation Inc - Nonprofit Explorer - ProPublica</a></li><li><a href="https://projects.propublica.org/nonprofits/organizations/113390208" target="_blank" rel="noopener">Software In The Public Interest Inc - Nonprofit Explorer - ProPublica</a></li><li><a href="https://projects.propublica.org/nonprofits/organizations/460618689" target="_blank" rel="noopener">Openstack Foundation - Nonprofit Explorer - ProPublica</a></li><li><a href="https://projects.propublica.org/nonprofits/organizations/470825376" target="_blank" rel="noopener">Apache Software Foundation - Nonprofit Explorer - ProPublica</a></li><li><a href="https://projects.propublica.org/nonprofits/organizations/43594598" target="_blank" rel="noopener">Python Software Foundation - Nonprofit Explorer - ProPublica</a></li><li><a href="https://projects.propublica.org/nonprofits/organizations/43572618" target="_blank" rel="noopener">Gnome Foundation Inc - Nonprofit Explorer - ProPublica</a></li><li><a href="https://projects.propublica.org/nonprofits/organizations/273327530" target="_blank" rel="noopener">Open Networking Foundation - Nonprofit Explorer - ProPublica</a></li><li><a href="https://projects.propublica.org/nonprofits/organizations/841545163" target="_blank" rel="noopener">The Freebsd Foundation - Nonprofit Explorer - ProPublica</a></li><li><a href="https://projects.propublica.org/nonprofits/organizations/912037395" target="_blank" rel="noopener">Open Source Initiative - Nonprofit Explorer - ProPublica</a></li><li><a href="https://projects.propublica.org/nonprofits/organizations/208096820" target="_blank" rel="noopener">Tor Project Inc - Nonprofit Explorer - ProPublica</a></li><li><a href="https://projects.propublica.org/nonprofits/organizations/460967274" target="_blank" rel="noopener">Freedom Of The Press Foundation - Nonprofit Explorer - ProPublica</a></li><li><a href="https://projects.propublica.org/nonprofits/organizations/133081500" target="_blank" rel="noopener">Committee To Protect Journalists Inc - Nonprofit Explorer - ProPublica</a></li><li><a href="https://projects.propublica.org/nonprofits/organizations/262852431" target="_blank" rel="noopener">World Wide Web Foundation - Nonprofit Explorer - ProPublica</a></li><li><a href="https://projects.propublica.org/nonprofits/organizations/370794792" target="_blank" rel="noopener">Epic - Nonprofit Explorer - ProPublica</a></li><li><a href="https://projects.propublica.org/nonprofits/organizations/522225921" target="_blank" rel="noopener">Electronic Privacy Information Center - Nonprofit Explorer - ProPublica</a></li><li><a href="https://projects.propublica.org/nonprofits/organizations/260707261" target="_blank" rel="noopener">Epic Foundation Inc - Nonprofit Explorer - ProPublica</a></li><li><a href="https://projects.propublica.org/nonprofits/organizations/412203632" target="_blank" rel="noopener">Software Freedom Conservancy Inc - Nonprofit Explorer - ProPublica</a></li><li><a href="https://projects.propublica.org/nonprofits/organizations/412165986" target="_blank" rel="noopener">Software Freedom Law Center Inc - Nonprofit Explorer - ProPublica</a></li><li><a href="https://projects.propublica.org/nonprofits/organizations/943242767" target="_blank" rel="noopener">Internet Archive - Nonprofit Explorer - ProPublica</a></li><li><a href="https://projects.propublica.org/nonprofits/organizations/474893089" target="_blank" rel="noopener">Risc V Foundation - Nonprofit Explorer - ProPublica</a></li><li><a href="https://projects.propublica.org/nonprofits/organizations/43585301" target="_blank" rel="noopener">Creative Commons Corporation - Nonprofit Explorer - ProPublica</a></li><li><a href="https://projects.propublica.org/nonprofits/organizations/463344200" target="_blank" rel="noopener">Internet Security Research Group - Nonprofit Explorer - ProPublica</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        
        
          &lt;blockquote&gt;
&lt;p&gt;For the benefit
        
      
    
    </summary>
    
    
      <category term="äº’è”ç½‘" scheme="https://blog.k8s.li/categories/%E4%BA%92%E8%81%94%E7%BD%91/"/>
    
    
      <category term="éç›ˆåˆ©ç»„ç»‡" scheme="https://blog.k8s.li/tags/%E9%9D%9E%E7%9B%88%E5%88%A9%E7%BB%84%E7%BB%87/"/>
    
      <category term="org" scheme="https://blog.k8s.li/tags/org/"/>
    
  </entry>
  
  <entry>
    <title>è‡´æœªæ¥åŠæ€æƒ³è‡ªç”±çš„æ—¶ä»£</title>
    <link href="https://blog.k8s.li/March.html"/>
    <id>https://blog.k8s.li/March.html</id>
    <published>2020-02-19T16:00:00.000Z</published>
    <updated>2020-02-29T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>è‡´æœªæ¥ã€è¿‡å»ä»¥åŠæ€æƒ³è‡ªç”±çš„æ—¶ä»£ï¼šäººäººå„ä¸ç›¸åŒï¼Œä¸å†å­¤å¯‚ä¸€ç”Ÿã€‚çŒ®ç»™çœŸç†æ°¸å­˜çš„æ—¶ä»£ï¼ŒçŒ®ç»™äº‹æƒ…æ—¢å·²å‘ç”Ÿè€Œæ— éœ€ç¯¡æ”¹çš„æ—¶ä»£ã€‚æˆ‘ä»¬è¿™ç¾¤æ´»åœ¨æ²¡æœ‰è‡ªç”±å¯è¨€ã€å­¤è‹¦æ½¦å€’çš„å²æœˆçš„äººï¼Œæ´»åœ¨è€å¤§å“¥åŠåŒé‡æ€æƒ³é˜´å½±ä¸‹çš„äººå‘ä½ ä»¬è‡´æ•¬ï¼â€”â€”ä¹”æ²»Â·å¥¥å¨å°”ã€Š1984ã€‹</p></blockquote><h2 id="3-æœˆ-1-æ—¥"><a href="#3-æœˆ-1-æ—¥" class="headerlink" title="3 æœˆ 1 æ—¥"></a>3 æœˆ 1 æ—¥</h2><p>è¿™ä¸ªæ˜¯ä»€ä¹ˆæ—¥å­å‘¢ï¼Ÿä¸å¦¨é˜…è¯»ä¸€ä¸‹ <a href="https://terminus2049.github.io/archive/2020/02/19/interpretation-new-rule.html" target="_blank" rel="noopener">æ¥å¼ºè¡Œè§£è¯»ä¸€ä¸‹3æœˆ1æ—¥äº’è”ç½‘è¨€è®ºç®¡æ§æ–°è§„</a> ã€‚è™½ç„¶å¢™ã€è¨€è®ºå®¡æŸ¥ä¸å±è”½æ—©å·²ç»å­˜åœ¨å¾ˆé•¿æ—¶é—´äº†ï¼Œä½†è¿™æ¬¡<code>å¢™å†…çš„å¢™</code>æ— ç–‘åˆé«˜äº†ä¸€ä¸ˆã€‚å…·ä½“æœ‰ä»€ä¹ˆå½±å“æ¨èå»è¯»è¯»è¿™ç¯‡æ–‡ç« å§ï¼Œæˆ‘è¿™é‡Œä¹Ÿä¸æƒ³åºŸè¯äº†ã€‚å€¼å¾—ä¸€æçš„æ˜¯å‡¤å‡°å«è§†å› ä¸ºåšäº†ä¸€æœŸ <a href="https://www.youtube.com/watch?v=YFbEG1PiLAo" target="_blank" rel="noopener">é€åˆ«ææ–‡äº®</a> é‡‡è®¿æŠ¥é“å°±è¢«è´£ä»¤æ•´æ”¹ï¼Œä»…ä»…æ˜¯åšäº†å®¢è§‚å¦‚å®åœ°é‡‡è®¿æŠ¥é“è€Œå·²ã€‚æ—¥ä»–å¦ˆè¿å®¢è§‚çš„äº‹å®éƒ½ä¸è®©æŠ¥é“è®©æ–°é—»åª’ä½“å”±èµæ­Œå˜›ï¼Ÿè¿™ä¸€åœºç¾éš¾ï¼Œæ˜¯å…¨æ°‘æ—ç—›å½»å¿ƒæ‰‰çš„æ‚²å‰§ï¼Œä½ ä»–å¦ˆè¿˜å¥½æ„æ€å‡ºç‰ˆä¸€æœ¬ã€Šå¤§å›½æˆ˜ç–«ã€‹æ¥ä¸ºä½ ä»¬æƒè´µæ­ŒåŠŸèµå¾·ï¼Œåšäººè¿˜èƒ½æœ‰ç‚¹è‰¯å¿ƒå—ï¼Ÿ</p><p>çœ‹åˆ°å›½å†…çš„å…šåª’æ‰­æ›²æ˜¯éã€æ··æ·†è§†å¬ã€æ„šæ°‘æ´—è„‘ã€è°è¨€æ¬ºéª—ï¼Œæœ‰æ—¶å€™å°±æ°”å¾—å°±æƒ³æ€æ¡Œå„¿ã€ç ¸é”®ç›˜ã€æ‘”é¼ æ ‡ï¼è¿™ä»–å¦ˆè¿˜æ˜¯äººå†™çš„å—ï¼Ÿæˆ‘æ— æ³•æƒ³è±¡æ—¢å¾—åˆ©ç›Šè€…ä¸ºäº†ç»™æƒè´µå”±èµæ­Œäººæ€§å±…ç„¶æ‰­æ›²åˆ°å¦‚æ­¤åœ°æ­¥ï¼Ÿ</p><blockquote><p>â€œA GOOD newspaper, I suppose, is a nation talking to itself,â€ mused Arthur Miller in 1961.</p></blockquote><p><strong>ä¸€ä»½å¥½çš„æŠ¥çº¸åº”å½“æ˜¯ä¸€ä¸ªå›½å®¶è¯šå®çš„ç‹¬ç™½</strong></p><p>å½“ä¸€ä¸ªå›½å®¶çš„æ–°é—»åª’ä½“å¼€å§‹ä¸çŸ¥ç¾è€»åœ°å…¬ç„¶é€ è°£ç²‰é¥°æ„šæ°‘æ´—è„‘çš„æ—¶å€™ï¼Œè¿™ä¸ªä»¥è°è¨€ä¸ºç»Ÿæ²»æ ¹åŸºçš„æ°‘æ—ä¹Ÿå°±æ— è¯å¯æ•‘äº†ã€‚</p><blockquote><p>åœ¨æˆ‘ä»¬è‹è”ï¼Œè°è¨€å·²ä¸ä»…ä»…æ˜¯é“å¾·é—®é¢˜ï¼Œè°è¨€æ˜¯å›½å®¶çš„æ”¯æŸ±ã€‚</p><p>â€”â€”ã€Šå¤æ‹‰æ ¼ç¾¤å²›ã€‹ä½œè€…ã€è‹è”æœ€è‘—åçš„æ”¿æ²»å¼‚è®®äººå£« <a href="https://zh.wikipedia.org/wiki/äºšå†å±±å¤§Â·ä¼Šè¨è€¶ç»´å¥‡Â·ç´¢å°”ä»å°¼ç´" target="_blank" rel="noopener">äºšå†å±±å¤§Â·ä¼Šè¨è€¶ç»´å¥‡Â·ç´¢å°”ä»å°¼ç´</a></p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/image-20200222212219674.png" alt="image-20200222212219674"></p><p><strong>ä½†ï¼Œé¢å¯¹è¿™ä¸ªæ»¡å˜´è°è¨€çš„ç¤¾ä¼šä½ åˆèƒ½åšä»€ä¹ˆï¼Ÿ</strong></p><p>æœ€è¿‘ä¹Ÿæ€è€ƒäº†ä¸€äº›äº‹å„¿ï¼Œä¹Ÿå†³å®šä»¥åä¸å†å†²å¡”äº†ğŸ˜‚ï¼Œä¹Ÿå¼€å§‹<code>è‡ªæˆ‘é˜‰å‰²</code>ã€<code>è‡ªæˆ‘å®¡æŸ¥</code>ä¸€ä¸‹ï¼ŒæŠŠè€å¤§å“¥ä¸çˆ±å¬çš„è¯ä»åšå®¢ä¸Šéƒ½åˆ äº†ğŸ˜ã€‚äººåœ¨å¢™å†…å¹¶ä¸æ˜¯è¯´å®³æ€•ä»€ä¹ˆï¼Œæœ€é‡è¦æ˜¯å‡ºäºå¯¹å®¶äººçš„ä¿æŠ¤ï¼Œä¸æƒ³å› ä¸ºæˆ‘çš„<code>ä¸å½“è¨€è®º</code>è€Œè®©ä»–ä»¬æ‹…æƒŠå—æ€•ã€‚çˆ¶æ¯éƒ½å·²ç»å¹´è¿‡åŠç™¾ï¼Œä½œä¸ºå„¿å¥³è®©çˆ¶æ¯å¹³å®‰åº¦è¿‡ä¸€ä¸ªå¹¸ç¦çš„æ™šå¹´ï¼Œæ˜¯æˆ‘ä½™ç”Ÿå”¯ä¸€å€¼å¾—åšçš„äº‹æƒ…äº†ã€‚æ‰€ä»¥è¯´è‡ªå·±åº”å½“ç†æ€§ä¸€äº›ï¼Œä¿æŠ¤å¥½å®¶äººï¼Œä¸è®©ä»–ä»¬è€äººå®¶ä¸ºè‡ªå·±å—ç½ªã€‚è¯´å‡ºçš„æ¯ä¸€å¥è¯å‰éƒ½è¦è‡ªæˆ‘å®¡æŸ¥ä¸€ä¸‹ï¼Œå…å¾—è€å¤§å“¥è§‰ç€å¾ˆåˆºè€³ï¼Œå¬åˆ°äº†å°±å»æˆ‘å®¶ç»´ç¨³æŠ“äººï¼Œæˆ‘ä¸€ä»‹è‰æ°‘ä¹Ÿææƒ§ææƒç»Ÿæ²»ï¼Œæˆ‘ä¸æ•¢æƒ³è±¡è¢«ä¸€å †é»‘çš®æš´åŠ›æŠ„å®¶çš„é‚£ç§åœºé¢ã€‚æ´»åœ¨ä¸€ä¸ªå½“ä»Šè¿™ä¸ª 1984 èˆ¬çš„ç¤¾ä¼šé‡Œï¼ŒçœŸçš„æœ‰ç‚¹ç”Ÿä¸å¦‚æ­»çš„æ„Ÿè§‰ã€‚ä½†è‡ªå·±æ­»äº†ï¼Œçˆ¶æ¯çš„ä½™ç”Ÿå°±å¤±å»äº†ä¿æŠ¤ï¼Œæ‰€ä»¥æˆ‘è¿˜è¦æ´»ä¸‹å»ä¿æŠ¤å¥½å®¶äººä»¬ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘å”¯ä¸€æ¸´æœ›æ´»ä¸‹å»çš„ç†ç”±å§ã€‚ä¹Ÿæ­£å¦‚ HBO  è¿·ä½ å‰§ <a href="https://zh.wikipedia.org/zh-cn/åˆ‡å°”è¯ºè´åˆ©_(è¿·ä½ å‰§)" target="_blank" rel="noopener">åˆ‡å°”è¯ºè´åˆ©</a> S01E04 ä¸­é²é‡Œæ–¯Â·è°¢å°”æ¯”çº³å¯¹ä¹Œæ‹‰å¨œÂ·éœç¼ªå…‹æ‰€è¯´çš„ï¼š</p><blockquote><p>Iâ€™ve know braver souls than you, Khomyuk. Men who had their moment and did nothing. Because when itâ€™s your life and the lives of everyone you love, your moral conviction doesnâ€™t mean anything. It leaves you. And all you.</p></blockquote><p>æˆ‘è§è¿‡æ¯”ä½ æ›´å‹‡æ•¢çš„äººï¼Œä»–ä»¬é¢ä¸´æŠ‰æ‹©å´æ²‰é»˜ä»¥å¯¹ã€‚å› ä¸ºå½“å…³ç³»åˆ°ä½ å’Œä½ æ‰€çˆ±ä¹‹äººçš„ç”Ÿå‘½æ—¶ï¼Œä½ çš„é“å¾·ä¿¡å¿µä¾¿ä¸€æ–‡ä¸å€¼ï¼Œä¸å¤å­˜åœ¨ã€‚é‚£ä¸€åˆ» ä½ åªæƒ³èº²è¿‡é‚£ä¸€æªã€‚</p><blockquote><p>Freedom has many difficulties and democracy is not perfect, but we have never had to put a wall up to keep our people in, to prevent them from leaving us.<br>â€”â€”çº¦ç¿° Â· è‚¯å°¼è¿ª ã€Šæˆ‘æ˜¯æŸæ—äººã€‹</p></blockquote><p>è‡ªç”±æœ‰è®¸å¤šå›°éš¾ï¼Œæ°‘ä¸»äº¦éå®Œç¾ï¼Œç„¶è€Œæˆ‘ä»¬ä»æœªå»ºé€ ä¸€å µå¢™æŠŠæˆ‘ä»¬çš„äººæ°‘å…³åœ¨é‡Œé¢ï¼Œä¸å‡†ä»–ä»¬ç¦»å¼€ã€‚</p><blockquote><p>30 å¹´è¿‡å»äº†ï¼ŒæŸæ—å¢™å·²ç»ä¸åœ¨äº†ï¼Œå¦ä¸€å µå¢™å´è¶Šæ¥è¶Šé«˜ã€‚å…±åŒç‚¹æ˜¯ï¼Œä¸¤å µ â€œå¢™â€ éƒ½æ˜¯ç”¨æ¥é˜»æ­¢æœ¬å›½äººæ°‘å¯¹è‡ªç”±çš„è¿½æ±‚ã€‚ä¸åŒç‚¹æ˜¯ï¼Œå¾·å›½äººç”¨ä¸€ç³»åˆ—å¯æ­Œå¯æ³£çš„è¡ŒåŠ¨æ­Œé¢‚äº†æœ‰å²ä»¥æ¥æœ€ä¼Ÿå¤§çš„é€ƒäº¡ï¼Œä¸ºäº†è¿½æ±‚è‡ªç”±è€Œè¿›è¡Œçš„å‰ä»†åç»§çš„é€ƒç¦»â€”â€”å‘å¾€è‡ªç”±ï¼Œæ˜¯äººç±»ä¸ç”Ÿä¿±æ¥çš„æœ¬èƒ½ã€‚æŸæ—å¢™æœ€ç»ˆè¢«æ‹†æ¯äº†ã€‚</p></blockquote><p><code>æ­¤å¤„å¼•ç”¨</code> å°åœŸè±†çš„ <a href="https://www.bennythink.com/ballon.html" target="_blank" rel="noopener">è‡ªç”±çš„æ°”çƒ</a></p><hr><p>å‰æ®µæ—¶é—´è‡ªæˆ‘äººè‚‰äº†ä¸€ä¸‹ï¼Œå‘ç°æˆ‘è¿˜æ˜¯æ³„éœ²äº†å¤ªå¤šä¸ªäººç›¸å…³çš„ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯ç»è¿‡ç»„ç»‡å’Œæ¢³ç†ä¹‹åï¼Œå†åŠ ä¸Šå›½å†…å…¬å®‰ç³»ç»Ÿé‡Œçš„æ•°æ®ï¼Œè¿˜æ˜¯èƒ½å¾ˆç²¾å‡†åœ°å®šä½åˆ°æˆ‘æœ¬äººã€‚è™½ç„¶æ¥è¯´æˆ‘å°½å¯èƒ½åœ°å‡å°‘ä¸ªäººä¿¡æ¯çš„æ³„éœ²ï¼Œä½†è¿˜æ˜¯åšçš„ä¸å½»åº•ï¼Œç•™ä¸‹äº†å¾ˆå¤šæŠŠæŸ„ã€‚æ‰€ä»¥è¯´ä¸ºäº†å®‰å…¨èµ·è§ 3 æœˆ 1 æ—¥å‰æˆ‘ä¼šåˆ æ‰ä¸€äº›æ–‡ç« ï¼Œè¿˜è¯·å„ä½è¯»è€…è§è°…ã€‚å–œæ¬¢çš„æ–‡ç« æ²¡åˆ ä¹‹å‰å¯ä»¥æŠŠæˆ‘çš„ markdown <a href="https://github.com/muzi502/blog" target="_blank" rel="noopener">æºç </a> æ–‡ä»¶ä¿å­˜ä¸‹æ¥ï¼Œå»ºè®®è½¬æ¢æˆ .pdf æ–¹ä¾¿å­˜æ¡£ã€‚å¹³æ—¶çš„æˆ‘ä¹Ÿæ˜¯è¿™æ ·æ”¶è—å’Œæ•´ç†æ–‡ç« çš„ï¼Œä¸€äº›ä¼˜ç§€çš„æ–‡ç« è‡ªå·±ä¼šä¿å­˜ä¸º .md ç„¶åä½¿ç”¨ <a href="https://typora.io/" target="_blank" rel="noopener">Typora</a> å¯¼å‡ºä¸º .pdf ã€‚ä¸€äº›æƒ³è¦ä»”ç»†é˜…è¯»çš„æ–‡ç« çš„å°±ä½¿ç”¨ <a href="https://calibre-ebook.com/" target="_blank" rel="noopener">calibre</a> è½¬æ¢æˆ azw3 ï¼Œç„¶ååœ¨ kindle osais ä¸Šä»”ç»†å“è¯»ğŸ˜‚ã€‚</p><h2 id="è¿‡å»"><a href="#è¿‡å»" class="headerlink" title="è¿‡å»"></a>è¿‡å»</h2><p>è¿‡å¹´æ—¶å®…åœ¨å®¶é‡Œçœ‹ã€Šç›—ç«è€…ï¼šä¸­å›½æ•™è‚²æ”¹é©è°ƒæŸ¥ã€‹æ·±æœ‰æ„Ÿè§¦ï¼š</p><p>åƒå°½æ•™è‚²ä½“åˆ¶è‹¦å¤´çš„è‡ªå·±ï¼Œèµ°å‡ºå¤§å­¦ä¹‹åå›å¤´çœ‹ï¼Œå‘ç°å®ƒåŸºæœ¬ä¸Šæ²¡æœ‰æ”¹å–„ã€‚ä¸€ä¸ªç¼ºä¹ç‹¬ç«‹ä¹‹ç²¾ç¥ã€è‡ªç”±ä¹‹æ€æƒ³çš„åº”è¯•æ•™è‚²ï¼Œåœ¨å…šçš„æ„å¿—å–ä»£å›½å®¶æ„å¿—çš„å…šåŒ–æ•™è‚²ä¹‹ä¸‹ï¼Œåªèƒ½åŸ¹å…»å‡ºä¸€é¢—é¢—å›½å®¶æœºå™¨çš„èºä¸é’‰ï¼Œè€Œå¾ˆéš¾åŸ¹å…»å‡ºä¸€åç‹¬ç«‹äººæ ¼å’Œæ€æƒ³çš„åˆæ ¼å…¬æ°‘ã€‚å¤§å­¦é‡Œç¦æ­¢è®¨è®ºå¸æ³•ç‹¬ç«‹ã€æ°‘ä¸»å®ªæ”¿ã€å…¬æ°‘ç¤¾ä¼šã€è¨€è®ºè‡ªç”±ã€æ–°é—»è‡ªç”±ç­‰ï¼Œè¿™æ ·çš„å¤§å­¦ä¹Ÿå°±åˆ«æŒ‡æœ›èƒ½æœ‰ä»€ä¹ˆç‹¬æ ‘ä¸€å¸œçš„æ€æƒ³äº†ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/image-20200222213454438.png" alt="image-20200222213454438"></p><h2 id="äºŒæœˆ"><a href="#äºŒæœˆ" class="headerlink" title="äºŒæœˆ"></a>äºŒæœˆ</h2><p>æˆ‘çš„ä¸–ç•Œé‡Œæ•´ä¸ªäºŒæœˆçš„å¤©ç©ºéƒ½æ˜¯ç°è’™è’™çš„ï¼Œä¸»è¦æ˜¯å› ä¸ºå¤–å©†å»ä¸–çš„ç¼˜æ•…å§ã€‚å¿ƒæƒ…ä¹Ÿä¸€ç›´ä½è½è‡³ä»Šæ— æ³•ä»é‚£ç§ç—›è‹¦ä¸­æŒ£æ‰å‡ºæ¥ã€‚å°½ç®¡è¯•å›¾è®©è‡ªå·±å¼€å¿ƒä¸€äº›ï¼Œæ¯”å¦‚æ”¶è—å’Œå®šåˆ¶ä¸€äº›äºŒæ¬¡å…ƒæ’ç”»ï¼›å‰æ‰‹ä¹°äº†å¾ˆå¤šæœ€å–œæ¬¢åƒçš„æ°´æœï¼ˆå› ä¸ºæˆ‘æ˜¯ä¸ªç´ é£Ÿè€…ï¼ŒğŸŒğŸˆğŸ‰ğŸ‡ğŸ“ğŸ‘ğŸ¥æ˜¯æˆ‘æœ€å–œæ¬¢çš„é£Ÿç‰©ï¼‰ï¼›ä¸€ç®±ç®±è‡ªå·±æœ€å–œæ¬¢åƒçš„è‰è“ğŸ“ï¼›çœ‹äº†å¾ˆå¤šäºåœ°çƒå’Œå®‡å®™èµ·æºçš„çºªå½•ç‰‡ğŸ˜‚ï¼›çœ‹äº†ä¸€äº›å¤ç”Ÿç‰©å­¦çš„ç§‘æ™®ä¹¦ç±ğŸ¤£ï¼›ç­‰ç­‰éƒ½æ˜¯æƒ³è®©è‡ªå·±èµ°å‡ºé˜´å½±å¼€å¿ƒä¸€ç‚¹â€¦â€¦å¯ğŸ˜ï¼Œç—›è‹¦è¿˜æ˜¯æ— æ³•æ©ç›–çš„ï¼Œç‹¬è‡ªä¸€ä¸ªäººç”Ÿæ´»ï¼Œå½“å¤œæ·±äººé™æ—¶çœ‹å®Œä¹¦èººåºŠä¸Šç¡è§‰æ—¶ï¼Œæ€»ä¼šè¾—è½¬åä¾§ç¡ä¸ç€ï¼Œæƒ³èµ·å¤–å©†ç¦»ä¸–é‚£å¤©çš„ç»è¿‡ã€‚çœ¼æ³ªæ€»ä¼šä¸äº‰æ°”åœ°æµï¼Œæƒ³èµ·äº†å…³äºå¾ˆå¤šå°æ—¶å€™çš„äº‹å„¿ï¼Œæƒ³èµ·äº†å¥¶å¥¶ï¼Œå„¿æ—¶æ€»ä¼šç’å¡ç»™æˆ‘å’Œå¼Ÿå¼Ÿä¸€ç‚¹é›¶èŠ±é’±ï¼›æƒ³èµ·äº†ç¥–è¾ˆä¸‰ä»£åœ¨æ–‡é©æ—¶è¢«æ•´å¾—æƒ¨å…®å…®çš„å®¶æ—å†å²ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/image-20200222220307529.png" alt="image-20200222220307529"></p><p>æœ‰æ—¶å€™è‡ªå·±ç‹¬è‡ªä¸€ä¸ªäººè§¦æ™¯ç”Ÿæƒ…æ—¶å·å·åœ°æµæ³ªï¼Œè¶Šé•¿å¤§è¶Šæ˜¯ä½“ä¼šåˆ°<strong>è¡€æµ“äºæ°´çš„äº²æƒ…æœ‰æ—¶ç»ä¸èµ·é£å¹é›¨æ‰“ï¼Œè„†å¼±æ— æ¯”ã€‚</strong></p><h3 id="ä¸€ç‚¹é¸¡æ±¤"><a href="#ä¸€ç‚¹é¸¡æ±¤" class="headerlink" title="ä¸€ç‚¹é¸¡æ±¤"></a>ä¸€ç‚¹é¸¡æ±¤</h3><p>ä¸ç”±å¾—æ„Ÿå¹ï¼Œäººçš„ä¸€ç”Ÿå°±æ˜¯ä¸æ–­æ¥å—æ¶æ‰“çš„è¿‡ç¨‹ï¼Œç—›è‹¦å¾€å¾€æ˜¯å¿…ç„¶ä¼´éšæˆ‘ä»¬èº«è¾¹çš„ï¼Œæ¯ä¸ªäººæ³¨å®šè¦ç»å†æ°¸è¿œéƒ½æ— æ³•æ»¡è¶³çš„æ¬²æœ›ï¼Œè€Œå¹¸ç¦åˆæ˜¯åœ¨æ»¡è¶³æ¬²æœ›ä¹‹åå­˜ç»­å¦‚æ­¤åœ°çŸ­æš‚ã€‚å½“äººä»¬è®¤ä¸ºç»å†äº†åƒè¾›ä¸‡è‹¦ï¼Œåˆ°è¾¾äº†äººç”Ÿä¹‹å·…æ—¶ï¼Œå®é™…ä¸Šåˆè¦å¸¦ç€å·¨å¤§çš„ææƒ§è¢«æ­»ç¥æ— æƒ…åœ°æ”¶å‰²ï¼Œå¥½æ¶ˆæ¯æ˜¯ï¼Œæ­»äº¡æ˜¯æˆ‘ä»¬äººç”Ÿæœ€åä¸€ä¸ªç—›è‹¦ã€‚ä¸¤åƒå¤šå¹´å‰çš„ã€Šé“å¾·ç»ã€‹é‡Œè¯´è¿‡ï¼šâ€œå¤©åœ°ä¸ä»ï¼Œä»¥ä¸‡ç‰©ä¸ºåˆ(chu)ç‹—ï¼› åœ£äººä¸ä»ï¼Œä»¥ç™¾å§“ä¸ºåˆç‹—ã€‚â€äººç±»åœ¨è¿™ä¸ªå­¤ç‹¬çš„æ˜Ÿçƒä¸Šå·²ç»æœ‰äº†å‡ ç™¾ä¸‡å¹´ï¼Œå¤ªé˜³åº•ä¸‹æ²¡æœ‰æ–°é²œäº‹ï¼Œæˆ‘ä»¬æ¯å¤©æ‹…å¿ƒæ¯å¤©ç—›è‹¦çš„äº‹æƒ…ï¼Œå·²ç»é‡å¤äº†åƒä¸‡éï¼Œè€å¤©çˆ·å·²ç»æŠŠæˆ‘ä»¬å½“æˆè‰æ‰çš„ç‹—ï¼Œæˆ‘ä»¬åˆä½•å¿…è‡ªå·±å¤©å¤©æš—è‡ªç¥ä¼¤å‘¢ï¼Ÿ</p><p>æœ‰æ—¶å€™ä¼šæœ‰ä¸€ç§å¹»è§‰ï¼šäººçš„ä¸€ç”Ÿè¯»çš„ä¹¦è¶Šå¤šè¶Šèƒ½å¦ç„¶åœ°é¢å¯¹ç”Ÿæ­»å§ã€‚äº†è§£å…ˆè´¤å“²äººçš„å†å²ï¼Œçœ‹çœ‹åˆ«äººçš„äººç”Ÿï¼Œå°±èƒ½æ˜ç™½ä¸€ä¸ªå¾ˆç®€å•çš„é“ç†ã€‚æ¯ä¸ªäººçš„å¹¸ç¦éƒ½æ˜¯å¦‚æ­¤çŸ­æš‚ï¼Œåœ¨è‡ªå·±ç¢°åˆ°ä¼¤å¿ƒæ¬²ç»çš„äº‹æƒ…ä¹‹åï¼Œèƒ½æƒ³ä¸€æƒ³ï¼Œæ—¢ç„¶é‚£äº›æ¯ä¸ªäººéƒ½åœ¨å¿ƒä¸­æ€€ç€å·¨å¤§çš„ç—›è‹¦ï¼Œé‚£ä¹ˆï¼Œæˆ‘ä»¬åˆä½•å¿…è¿½æ±‚è‡ªå·±ä¸èƒ½è¢«ä¼¤å®³å‘¢ï¼Ÿä¸–ç•Œä¸Šæ²¡æœ‰æˆ‘ä»¬å¿…é¡»è¦å¾—åˆ°çš„ä¸œè¥¿ï¼Œä¹Ÿæ²¡æœ‰æˆ‘ä»¬ä¸èƒ½æ— æ³•å¤±å»çš„ä¸œè¥¿ï¼Œæˆ‘ä»¬åˆä½•å¿…å»è¿½æ±‚ä¸å¯èƒ½å­˜åœ¨çš„äº‹æƒ…å‘¢ï¼Ÿ</p><p>æ¨èé˜…è¯» <a href="https://lmzdx.com/" target="_blank" rel="noopener">è½¯ä»¶é‚£äº›äº‹å„¿</a></p><h3 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h3><blockquote><p>åŒºå—é“¾ä»¥å¤ªåŠ ETH ä¸Šä¸ºææ–‡äº®åŒ»ç”Ÿæ ‘äº†ä¸€åº§ç¢‘ï¼ŒåŒºå—é«˜åº¦ <code>9432824</code>ã€‚ææ–‡äº®åŒ»ç”Ÿçš„äº‹è¿¹å°†è¢«æ°¸è¿œé“­è®°ï¼Œä¸å¯ç¯¡æ”¹ï¼Œä¸å¯åˆ é™¤ã€‚<a href="https://etherscan.io/address/0x6e46d3ab7335fffb0d14927e0b418cc08fe60505" target="_blank" rel="noopener">åœ°å€</a>ã€‚ä¸Šä¸€ä¸ªäººæ˜¯å²³æ˜•ã€‚<a href="https://etherscan.io/tx/0x2d6a7b0f6adeff38423d4c62cd8b6ccb708ddad85da5d3d06756ad4d8a04a6a2" target="_blank" rel="noopener">åœ°å€</a></p></blockquote><p><code>æ­¤å¤„å¼•ç”¨</code> <a href="https://twitter.com/muzi_ii/status/1225688296447045632" target="_blank" rel="noopener">æœ¬äººæ¨æ–‡</a></p><p><img src="https://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/sourchttps://cdn.jsdelivr.net/gh/muzi502/blog/source/img/image-20200222222234929.png" alt="image-20200222222234929"></p><blockquote><p>ä¸æ‡‚å¸¸è¯†æœªççœ¼çœ‹ä¸–ç•Œä¹‹äººå¤šå¦‚è‰è½ï¼ŒçœŸç›¸ä¸è¢«æèµ·å°±ä¼šè¢«äººé—å¿˜ã€‚ä¸èƒ½ä¹ æƒ¯äº†é»‘æš—å°±ä¸ºé»‘æš—è¾©æŠ¤ï¼Œè¶Šæ˜¯æ¼†é»‘çš„å¤œè¶Šè¦å‘å‡ºè¤ç«çš„å…‰èŠ’ã€‚æ¸´æœ›è‡ªç”±çš„å¿ƒä»æœªå†·å´ï¼Œç­‰çŸ³å¤´å¼€èŠ±ï¼ŒçŸ¥å…¶ä¸å¯è€Œä¸ºä¹‹ï¼Œä¸ºè‡ªç”±ç†æ€§å‘å£°ã€‚ä¼ æ’­å¸¸è¯†ä¸æ€æƒ³ï¼Œä¿æŒç†æ€§ä¸å®½å®¹ï¼Œæ‹¥æœ‰å¥½å¥‡å¿ƒä¸æ±‚çŸ¥æ¬²ï¼Œçƒ­çˆ±ç”Ÿæ´»ï¼Œäº«å—ç¾å¥½ã€‚ä»ä¸€è¨€ä¸€è¡Œæ”¹å˜è¿™çš„å†å²</p></blockquote><p><code>æ­¤å¤„å¼•ç”¨</code> <a href="https://t.me/moecao/10729" target="_blank" rel="noopener">NOONE</a></p><blockquote><p>æˆ–è®¸ï¼Œåœ¨å…šå›½å¼ºå¤§çš„æœºå™¨ä¸‹ï¼Œæ— çŸ¥å’Œææƒ§æ˜¯å¯ä»¥å…»æˆçš„ï¼Œä¿¡æ¯å’Œæ–°é—»æ˜¯å¯èƒ½å±è”½çš„ï¼Œç°å®å’ŒçœŸç›¸æ˜¯å¯ä»¥è¢«æ‰­æ›²çš„ã€‚ä½†äº²èº«ç»å†äº†ï¼Œè§è¯äº†ï¼Œå°±ä¸èƒ½å‡è£…æ— çŸ¥ï¼Œä¸èƒ½æ”¾å¼ƒè®°å½•ï¼Œä¸èƒ½åè€Œå¾…æ¯™ã€‚é»‘æš—æ— è¾¹ï¼Œä»…å‰©çš„ä¸€ä¸çœŸå®å’Œäº®å…‰ï¼Œç»å¯¹ä¸èƒ½æ‹±æ‰‹ç›¸è®©ã€‚</p></blockquote><p><code>æ­¤å¤„å¼•ç”¨</code> <a href="https://matters.news/@sophia/%E8%AE%B0%E5%BD%95%E6%88%91%E7%9A%84-%E5%8F%8D%E9%80%81%E4%B8%AD-%E5%A4%A7%E6%B8%B8%E8%A1%8C-zdpuAysW5ZoQVpbPWDWDK22Dg6jF3GSGYBfx4uk3buXQSkLsA" target="_blank" rel="noopener">è®°å½•æˆ‘çš„â€œåé€ä¸­â€å¤§æ¸¸è¡Œ</a></p><h2 id="æœªæ¥"><a href="#æœªæ¥" class="headerlink" title="æœªæ¥"></a>æœªæ¥</h2><p>è‡ªä»å»å¹´å¼€å§‹å…»æˆäº†å†™æ—¥è®°çš„ä¹ æƒ¯ä¹‹åï¼Œå°±ç¬”è€•ä¸è¾åœ°è®°å½•ç€ç»å†çš„äº‹æƒ…ã€‚å°¤å…¶æ˜¯ä»Šå¹´å†™çš„ä¸œè¥¿å®åœ¨æ˜¯å¤ªå¤šäº†ï¼Œä½†è‡³ä»Šéƒ½æœªæ›¾å…¬å¼€è¿‡ï¼Œæƒ³æƒ³æ—¥åæˆåŠŸè·‘è·¯ä¹‹ååœ¨ä¸€ä¸ªå®‰å…¨çš„åœ°æ–¹å†åŒ¿åå‘è¡¨å‡ºæ¥å§ã€‚æœ‰ç§è§‚ç‚¹è®¤ä¸º <strong>åœ¨ä¸“åˆ¶ç»Ÿæ²»ä¸‹ï¼Œäººä»¬ä¸ä½†è¦åœ¨ç°å®ä¸–ç•Œå—åˆ°å‹è¿«ï¼Œè€Œä¸”è¿˜è¦åœ¨ç²¾ç¥ä¸–ç•Œå—åˆ°ç¦é”¢ã€‚å¤„äºè¿™ç§åŒé‡å¥´å½¹çŠ¶æ€ä¸‹çš„äººä»¬ï¼Œé™¤äº†è¢«è¿«å˜ç€èŠ±æ ·é¢‚æ‰¬å‹è¿«è€…çš„â€œä¼Ÿå¤§ã€å…‰è£å’Œæ­£ç¡®â€å¤–ï¼Œå¾ˆéš¾åˆ›é€ å‡ºçœŸæ­£æœ‰ä»·å€¼çš„æ€æƒ³æˆæœã€‚</strong>ä½†æœ‰æ—¶æˆ‘åœ¨æƒ³æˆ‘ä»¬è¿™ä¸€ä»£äººæˆ–è®¸æœ‰æœºä¼šèƒ½å†™å‡ºå½“ä»£ä¸­å›½ç‰ˆçš„ã€Š1984ã€‹ã€ã€ŠåŠ¨ç‰©åº„å›­ã€‹ã€ã€Šå¤æ‹‰æ ¼ç¾¤å²›ã€‹ã€ã€Šå¤æ‹‰æ ¼ã€‹ï¼Œæ¯•ç«Ÿæˆ‘ä»¬è¿™ä¸€ä»£äººè§è¯äº†ä¸€ä¸ªæ¯” 1984 è¿˜è’å”å¯ç¬‘çš„<strong>ææƒä¸“åˆ¶ç‹¬è£æš´æ”¿</strong>çš„ç¤¾ä¼šã€‚æˆ‘ä»¬å”¯ä¸€èƒ½åšçš„å°±æ˜¯çœŸå®çš„è®°å½•ï¼Œå°†è¿™æ®µå†å²è®°å½•ä¸‹æ¥ï¼Œå°†è‡ªç”±çš„ç«ç§ä¼ é€’ç»™ä¸‹ä¸€ä»£å§ã€‚</p><p>æ‰€ä»¥è¯´æ—¥åæˆ‘ä¼šå°†æ›´å¤šçš„æ—¶é—´å’Œç²¾åŠ›æ”¾åœ¨æŠ€æœ¯æ–¹é¢ï¼Œæœªæ¥åšå®¢æ›´æ–°çš„å†…å®¹ä¹Ÿå°†æ˜¯æŠ€æœ¯ç›¸å…³çš„ã€‚ç±»ä¼¼ä»Šå¤©çš„æ–‡ç« å°±ä¸å†å‘è¡¨äº†ã€‚ä½†è¿™å¹¶ä¸ä»£è¡¨æˆ‘æ”¾å¼ƒäº†è®°å½•å’Œæ€è€ƒï¼Œæˆ‘åªæ˜¯å·å·åœ°è®°å½•å’Œæ€è€ƒå†™ä½œï¼Œæˆ–è®¸å“ªå¤©ä½ ä¼šè‡ªç”±äº’è”ç½‘ä¸Šçš„ä¸€ä¸ªä¸èµ·çœ¼çš„è§’è½çœ‹åˆ°æˆ‘çš„æ–‡å­—ğŸ˜‚ã€‚æ‰€ä»¥æˆ‘è¿˜ä¼šæ˜¯ä½ ä»¬å°è±¡ä¸­çš„é‚£ä¸ªæœ¨å­ï¼Œæ˜¯ä¸ä¼šæ”¹å˜æ»´ğŸ˜˜ã€‚</p><h2 id="æ¨è"><a href="#æ¨è" class="headerlink" title="æ¨è"></a>æ¨è</h2><h3 id="èµ„æº"><a href="#èµ„æº" class="headerlink" title="èµ„æº"></a>èµ„æº</h3><blockquote><p>æˆ‘è€äººå®¶å…±äº«çš„ç”µå­ä¹¦: <a href="https://t.co/b7HaePeiBu" target="_blank" rel="noopener">https://t.co/b7HaePeiBu</a></p><p>è·‘è·¯æ•…äº‹é›†: <a href="https://t.co/ZkY4bFCr5O" target="_blank" rel="noopener">https://t.co/ZkY4bFCr5O</a></p><p>è·‘è·¯ä¿¡æ¯: <a href="https://t.co/lMcPNuj1RN" target="_blank" rel="noopener">https://t.co/lMcPNuj1RN</a></p><p>å…³äºè·‘è·¯å’¨è¯¢çš„å…¬å‘Šï¼š <a href="https://t.co/GQSBIeh6L7" target="_blank" rel="noopener">https://t.co/GQSBIeh6L7</a></p></blockquote><p><code>æ­¤å¤„å¼•ç”¨</code><a href="https://twitter.com/LiYing_2015/status/1227630570361876480" target="_blank" rel="noopener">æé¢–çš„æ¨æ–‡</a></p><h3 id="ä¹¦ç±"><a href="#ä¹¦ç±" class="headerlink" title="ä¹¦ç±"></a>ä¹¦ç±</h3><table><thead><tr><th>ã€Šé€šå¾€å¥´å½¹ä¹‹è·¯ã€‹</th></tr></thead><tbody><tr><td>ã€Šè‡ªç”±å®ªç« ã€‹</td></tr><tr><td>ã€Šè‡´å‘½çš„è‡ªè´Ÿã€‹</td></tr><tr><td>ã€Šè‡ªç”±ä¸ç¹è£çš„å›½åº¦ã€‹</td></tr><tr><td>ã€Šäººç±»ä¸å¹³ç­‰çš„èµ·æºå’ŒåŸºç¡€ã€‹</td></tr><tr><td>ã€Šè®ºå›½å®¶çš„ä½œç”¨ã€‹</td></tr><tr><td>ã€Šç¤¾ä¼šä¸»ä¹‰ï¼šç¤¾ä¼šå­¦ä¸ç»æµå­¦çš„åˆ†æã€‹</td></tr><tr><td>ã€Šæ³•å¾‹ã€ç«‹æ³•ä¸è‡ªç”±ã€‹</td></tr><tr><td>ã€Šè§„åˆ™ä¸æƒ©ç½šï¼šç›‘ç‹±çš„è¯ç”Ÿã€‹</td></tr><tr><td>ã€Šæ°‘ä¸»çš„å¥‡è¿¹ã€‹</td></tr><tr><td>ã€Š1984ã€‹</td></tr><tr><td>ã€Šææƒä¸»ä¹‰çš„èµ·æºã€‹</td></tr><tr><td>ã€Šè®ºé©å‘½ã€‹</td></tr><tr><td>ã€Šè¿‡å»ä¸æœªæ¥ä¹‹é—´ã€‹</td></tr><tr><td>ã€Šç‹¬è£è€…æ‰‹å†Œã€‹</td></tr><tr><td>ã€ŠåŠ¨ç‰©å†œåº„ã€‹</td></tr><tr><td>ã€Šç¾ä¸½æ–°ä¸–ç•Œã€‹</td></tr><tr><td>ã€Šå¨±ä¹è‡³æ­»ã€‹</td></tr><tr><td>ã€Šå…¬æ­£ï¼šè¯¥å¦‚ä½•åšæ˜¯å¥½ã€‹</td></tr><tr><td>ã€Šå“ˆä½›å¤§å­¦å…¬å¼€è¯¾ï¼šå…¬æ­£-è¯¥å¦‚ä½•åšæ˜¯å¥½ã€‹</td></tr><tr><td>ã€Šå­¦ä¼šæé—® - æ‰¹åˆ¤æ€§æ€ç»´æŒ‡å—ã€‹</td></tr><tr><td>ã€Šèµ°å‡ºå¸åˆ¶ã€‹</td></tr><tr><td>è®¸ç« æ¶¦ï¼šæˆ‘ä»¬å½“ä¸‹çš„ææƒ§ä¸æœŸå¾…</td></tr><tr><td>ã€Šå“ˆè€¶å…‹ä½œå“é›†ã€‹</td></tr><tr><td>ã€Šæ–°å¸¸è¯†ï¼šä¸€å…šä¸“æ”¿çš„æ€§è´¨å’Œåæœã€‹</td></tr><tr><td>ã€Šä¸­å›½å›½å®¶æ²»ç†çš„åˆ¶åº¦é€»è¾‘ï¼šä¸€ä¸ªç»„ç»‡å­¦ç ”ç©¶ã€‹</td></tr><tr><td>ã€Šå›½å®¶å»ºè®¾ä¸æ”¿åºœè¡Œä¸ºã€‹</td></tr><tr><td>ã€Šä»¥åˆ©ä¸ºåˆ©ï¼šè´¢æ”¿å…³ç³»ä¸åœ°æ–¹æ”¿åºœè¡Œä¸ºã€‹</td></tr><tr><td>ã€Šè½¬å‹ä¸­çš„åœ°æ–¹æ”¿åºœï¼šå®˜å‘˜æ¿€åŠ±ä¸æ²»ç†ã€‹</td></tr></tbody></table><h3 id="å½±è§†"><a href="#å½±è§†" class="headerlink" title="å½±è§†"></a>å½±è§†</h3><ul><li>åˆ‡å°”è¯ºè´åˆ©</li><li>åä¸½çš„å‡æœŸ</li><li>å‡ºç§Ÿè½¦å¸æœº</li><li>1987ï¼šé»æ˜åˆ°æ¥çš„é‚£å¤©</li><li>å‡›å†¬çƒˆç«ï¼šä¹Œå…‹å…°ä¸ºè‡ªç”±ä¹‹æˆ˜</li><li>ç¬¬å››å…¬æ°‘</li><li>æ°”çƒ</li><li>è¿”æ ¡</li><li>ç›—ç«è€…ï¼šä¸­å›½æ•™è‚²æ”¹é©è°ƒæŸ¥</li><li><a href="https://www.youtube.com/watch?v=KuUm8syt30U" target="_blank" rel="noopener">èŠ±å„¿ä¸ºä»€ä¹ˆè¿™æ ·çº¢</a></li></ul><h3 id="æ–‡ç« "><a href="#æ–‡ç« " class="headerlink" title="æ–‡ç« "></a>æ–‡ç« </h3><ul><li><p><a href="https://lmzdx.com/" target="_blank" rel="noopener">è½¯ä»¶é‚£äº›äº‹å„¿</a></p></li><li><p><a href="https://terminus2049.github.io/archive/2020/02/14/xueguang-zhou.html" target="_blank" rel="noopener">æœ€æ–°è®¿è°ˆè¯‘æ–‡| å‘¨é›ªå…‰ï¼šæ–°å‹å† çŠ¶ç—…æ¯’æš´éœ²äº†ä¸­å›½å›½å®¶æ²»ç†ä¸­çš„æ ¹æœ¬æ€§å¼ åŠ›</a></p></li><li><p><a href="https://matters.news/@2020Era/æ­¦æ±‰è‚ºç‚50å¤©-å…¨ä½“ä¸­å›½äººéƒ½åœ¨æ‰¿å—åª’ä½“æ­»äº¡çš„ä»£ä»·-zdpuB35z4kGhHnfq9qupMsVh41RP9UDhbB6x9x3XTsfmURDNL" target="_blank" rel="noopener">æ­¦æ±‰è‚ºç‚50å¤©ï¼Œå…¨ä½“ä¸­å›½äººéƒ½åœ¨æ‰¿å—åª’ä½“æ­»äº¡çš„ä»£ä»·</a></p></li><li><p><a href="https://matters.news/@Zhizhu_2019/è½‰è¼‰-è¨±ç« æ½¤-æ„¤æ€’çš„äººæ°‘å·²ä¸å†ææƒ§-zdpuAtQTLkEf6MGa17RjcBdJFHFZAdRTfHPUgDBkCVkTUSg3o" target="_blank" rel="noopener">è¨±ç« æ½¤ã€Šæ„¤æ€’çš„äººæ°‘å·²ä¸å†ææƒ§ã€‹</a></p></li><li><p><a href="https://terminus2049.github.io/archive/2020/02/07/if-you-are-angry-with-govenment.html" target="_blank" rel="noopener">å¦‚æœæœ‰äººè§‰å¾—ç¥–å›½ä¸å¥½</a></p></li><li><p><a href="https://matters.news/@philosophia/å¯¹æœ¬æ¬¡ç–«æƒ…çš„ç»“æ„æ€§åæ€-è°£è¨€-å®˜åƒšå’Œå›½å®¶ä¸»ä¹‰-ä¸Š-zdpuAzU8UUWBV3sB7c9h6FVbGZSrsc9L9qUEdHBBpDRJzTHzu" target="_blank" rel="noopener">å¯¹æœ¬æ¬¡ç–«æƒ…çš„ç»“æ„æ€§åæ€ï¼šè°£è¨€ã€å®˜åƒšå’Œå›½å®¶ä¸»ä¹‰</a></p></li><li><p><a href="https://jiashigrsyt1.github.io/" target="_blank" rel="noopener">ä½³å£«å·¥äººå£°æ´å›¢å®˜ç½‘ â€“ åŒæˆ˜æ–—ï¼Œå…±è¿›é€€</a></p></li><li><p><a href="https://sikaozhe1997.github.io/Xin-Yue/" target="_blank" rel="noopener">å²³æ˜•äº‹ä»¶</a></p></li><li><p><a href="https://telegra.ph/ä¸ºææ–‡äº®åŒ»ç”Ÿç«‹ä¼ åæˆ‘è¢«çº¦è°ˆ8å°æ—¶è‡³ä»Šå¤©å‡Œæ™¨-02-06" target="_blank" rel="noopener">ä¸ºææ–‡äº®åŒ»ç”Ÿç«‹ä¼ åï¼Œæˆ‘è¢«çº¦è°ˆ8å°æ—¶è‡³ä»Šå¤©å‡Œæ™¨ â€“ Telegraph</a></p></li><li><p><a href="https://telegra.ph/2019-nCoV-02-14" target="_blank" rel="noopener">ä¸€ç¯‡è®£å‘Šï¼šThe Man Who Knew.</a></p></li><li><p><a href="https://chinatimeline.github.io/" target="_blank" rel="noopener">æ—¶ä»£é€é•œ</a></p></li><li><p><a href="https://terminus2049.github.io/archive/2020/02/19/da-jia.html" target="_blank" rel="noopener">ç«¯ç‚¹æ˜Ÿ</a></p></li><li><p><a href="https://terminus2049.github.io/archive/2020/02/19/da-jia.html" target="_blank" rel="noopener">è…¾è®¯å¤§å®¶ï½œæ¯”ç—…æ¯’å¯æ€•ï¼šè¢«è°£è¨€æ“çºµçš„äººç±»æš´åŠ›å²</a></p></li><li><p><a href="http://www.bbc.com/zhongwen/simp/chinese-news-43972586" target="_blank" rel="noopener">æ±¶å·åœ°éœ‡åå¹´ç³»åˆ—â€”å…¬æ°‘ç¤¾ä¼šä»çˆ†å‘åˆ°æ²‰å¯‚çš„è‰°éš¾ä¹‹è·¯</a></p></li></ul><h2 id="ç»“æŸ"><a href="#ç»“æŸ" class="headerlink" title="ç»“æŸ"></a>ç»“æŸ</h2><p><strong>ä¸€ä¸ªå¥åº·çš„ç¤¾ä¼šä¸è¯¥åªæœ‰ä¸€ç§å£°éŸ³ã€‚</strong>â€”- ææ–‡äº®ï¼Œ2 æœˆ 1 æ—¥ä¸æ²»ç–—æœŸé—´æ¥å—ã€Šè´¢æ–°ã€‹ä¸“è®¿ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        
        
          &lt;blockquote&gt;
&lt;p&gt;è‡´æœªæ¥ã€è¿‡å»ä»¥åŠæ€æƒ³è‡ªç”±çš„æ—¶ä»£ï¼š
        
      
    
    </summary>
    
    
      <category term="ç”Ÿæ´»" scheme="https://blog.k8s.li/categories/%E7%94%9F%E6%B4%BB/"/>
    
    
      <category term="æ€è€ƒ" scheme="https://blog.k8s.li/tags/%E6%80%9D%E8%80%83/"/>
    
  </entry>
  
</feed>
